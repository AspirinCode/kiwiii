{"version":3,"file":"kwnetwork.js","sources":["../src/common/file.js","../src/network/component.js","../src/network/view.js","../src/common/mapper.js","../src/component/modal.js","../src/component/formBox.js","../src/component/formListBox.js","../src/component/formRangeBox.js","../src/component/formBoxGroup.js","../src/network/controlBox.js","../src/network/interaction.js","../src/network/force.js","../src/common/legacySchema.js","../src/network/networkApp.js","../src/common/KArray.js","../src/common/misc.js","../src/common/idb.js","../src/common/fetcher.js","../src/common/core.js","../src/component/button.js","../src/common/scale.js","../src/dialog/community.js","../src/dialog/rename.js","../src/network/communityDetection.js","../src/network/state.js","../src/network.js"],"sourcesContent":["\n/** @module common/file */\n\nimport pako from 'pako';\n\n\nfunction readFile(file, sizeLimit, blob) {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    const truncated = sizeLimit ? file.slice(0, sizeLimit) : file;\n    reader.onload = event => resolve(event.target.result);\n    reader.onerror = error => reject(error);\n    if (blob) {\n      reader.readAsArrayBuffer(truncated);\n    } else {\n      reader.readAsText(truncated);\n    }\n  });\n}\n\n\nfunction parseJSON(data, compressed) {\n  const text = compressed ? pako.inflate(data, {to: 'string'}) : data;\n  return JSON.parse(text);\n}\n\n\nfunction loadJSON(file) {\n  const compressed = file.name.endsWith('c') || file.name.endsWith('.gz');\n  return readFile(file, false, compressed)\n    .then(data => parseJSON(data, compressed));\n}\n\n\nfunction fetchJSON(url) {\n  const decoded = decodeURIComponent(url);\n  const compressed = decoded.endsWith('c') || decoded.endsWith('.gz');\n  return fetch(decoded)\n    .then(res => compressed ? res.arrayBuffer() : res.json())\n    .then(data => parseJSON(data, compressed));\n}\n\n\nfunction downloadDataFile(data, name) {\n  try {\n    // cannot hundle large file with dataURI scheme\n    // url = 'data:application/json,' + encodeURIComponent(JSON.stringify(json))\n    const url = window.URL.createObjectURL(new Blob([data]));\n    const a = document.createElement('a');\n    a.download = name;\n    a.href = url;\n    // a.click() does not work on firefox\n    a.dispatchEvent(new MouseEvent('click', {\n      'view': window,\n      'bubbles': true,\n      'cancelable': false\n    }));\n    // window.URL.revokeObjectURL(url) does not work on firefox\n  } catch (e) {\n    // no DOM (unit testing)\n  }\n}\n\n\nfunction downloadJSON(json, name, compress=true) {\n  const str = JSON.stringify(json);\n  const data = compress ? pako.gzip(str) : str;\n  const c = compress ? 'c' : 'r';\n  const ext = json.hasOwnProperty('edges') ? `.gf${c}` :  `.nd${c}`;\n  downloadDataFile(data, `${name}${ext}`);\n}\n\n\nexport default {\n  readFile, parseJSON, loadJSON, fetchJSON,\n  downloadDataFile, downloadJSON\n};\n","\n/** @module network/component */\n\nimport d3 from 'd3';\n\nimport {default as scale} from '../common/scale.js';\nimport {default as misc} from '../common/misc.js';\n\n\nconst svgWidth = 180;  //TODO\nconst svgHeight = 180;  //TODO\n\n\nfunction updateNodes(selection, records, showStruct) {\n  const nodes = selection.selectAll('.node')\n    .data(records, d => d.index);\n  nodes.exit().remove();\n  const entered = nodes.enter()\n    .append('g')\n      .attr('class', 'node')\n      .call(updateNodeCoords);\n  entered.append('circle')\n      .attr('class', 'node-symbol');\n  entered.append('g')\n      .attr('class', 'node-content')\n      .attr('transform', `translate(${-svgWidth / 2},${-svgHeight / 2})`);\n  entered.append('text')\n      .attr('class', 'node-label')\n      .attr('x', 0)\n      .attr('text-anchor', 'middle');\n  const merged = entered.merge(nodes);\n  if (showStruct) {\n    merged.select('.node-content').html(d => d.structure);\n  } else {\n    merged.select('.node-content').select('svg').remove();\n  }\n}\n\n\nfunction updateEdges(selection, records) {\n  const edges = selection.selectAll('.link')\n    .data(records, d => `${d.source}_${d.target}`);\n  edges.exit().remove();\n  const entered = edges.enter()\n    .append('g')\n      .attr('class', 'link');\n  entered.append('line')\n      .attr('class', 'edge-line')\n      .style('stroke', '#999')\n      .style('stroke-opacity', 0.6);\n  entered.append('text')\n      .attr('class', 'edge-label')\n      .attr('text-anchor', 'middle')\n      .text(d => d.weight);\n  // draw all components and then\n  entered.call(updateEdgeCoords);\n}\n\n\nfunction updateNodeAttrs(selection, state) {\n  selection.selectAll('.node')\n    .each(function (d) {\n      const color = scale.scaleFunction(state.nodeColor)(d[state.nodeColor.field]);\n      const size = scale.scaleFunction(state.nodeSize)(d[state.nodeSize.field]);\n      const labelColor = scale.scaleFunction(state.nodeLabelColor)(d[state.nodeLabelColor.field]);\n      d3.select(this).select('.node-symbol')\n          .attr('r', size)\n          .style('fill', color);\n      d3.select(this).select('.node-label')\n          .text(d => {\n            if (state.nodeLabel.text === null) return '';\n            const field = state.data.nodes.fields.find(e => e.key === state.nodeLabel.text);\n            if (field.format === 'd3_format') {\n              return misc.formatNum(d[state.nodeLabel.text], field.d3_format);\n            }\n            return d[state.nodeLabel.text];\n          })\n          .attr('font-size', state.nodeLabel.size)\n          .attr('y', parseFloat(size) + parseInt(state.nodeLabel.size))\n          .attr('visibility', state.nodeLabel.visible ? 'inherit' : 'hidden')\n          .style('fill', labelColor);\n    });\n}\n\n\nfunction updateEdgeAttrs(selection, state) {\n  selection.selectAll('.link').select('.edge-line')\n    .style('stroke-width', d => scale.scaleFunction(state.edgeWidth)(d.weight));\n  selection.selectAll('.link').select('.edge-label')\n    .attr('visibility', state.edgeLabel.visible ? 'inherit' : 'hidden')\n    .attr('font-size', state.edgeLabel.size);\n}\n\n\nfunction updateNodeCoords(selection) {\n  selection.attr('transform', d => `translate(${d.x}, ${d.y})`);\n}\n\n\nfunction updateEdgeCoords(selection) {\n  selection.attr('transform', d => `translate(${d.sx}, ${d.sy})`);\n  selection.select('.edge-line')\n    .attr('x1', 0)\n    .attr('y1', 0)\n    .attr('x2', d => d.tx - d.sx)\n    .attr('y2', d => d.ty - d.sy);\n  selection.select('.edge-label')\n    .attr('x', d => (d.tx - d.sx) / 2)\n    .attr('y', d => (d.ty - d.sy) / 2);\n}\n\n\nfunction updateAttrs(selection, state) {\n  selection.select('.nw-nodes').call(updateNodeAttrs, state);\n  selection.select('.nw-edges').call(updateEdgeAttrs, state);\n}\n\n\nfunction updateComponents(selection, state) {\n  const nodesToRender = state.nodesToRender();\n  const numNodes = nodesToRender.length;\n  if (state.enableFocusedView) {\n    state.focusedView = numNodes < state.focusedViewThreshold;\n  }\n  if (state.enableOverlookView) {\n    state.overlookView = numNodes > state.overlookViewThreshold;\n  }\n  const edgesToRender = state.overlookView ? [] : state.edgesToRender();\n  selection.select('.nw-nodes')\n    .call(updateNodes, nodesToRender, state.focusedView);\n  selection.select('.nw-edges')\n    .call(updateEdges, edgesToRender);\n  selection.call(updateAttrs, state);\n  // Rebind event listeners\n  if (state.zoomListener) {\n    selection.call(state.zoomListener);\n  }\n  if (state.dragListener) {\n    selection.select('.nw-nodes').selectAll('.node')\n      .call(state.dragListener);\n  }\n}\n\n\nfunction moveNode(selection, x, y) {\n  selection.attr('transform', `translate(${x}, ${y})`);\n}\n\n\nfunction moveEdge(selection, sx, sy, tx, ty) {\n  selection.attr('transform', `translate(${sx}, ${sy})`);\n  selection.select('.edge-line')\n    .attr('x1', 0)\n    .attr('y1', 0)\n    .attr('x2', tx - sx)\n    .attr('y2', ty - sy);\n  selection.select('.edge-label')\n    .attr('x', (tx - sx) / 2)\n    .attr('y', (ty - sy) / 2);\n}\n\n\nfunction move(selection, node, x, y) {\n  const n = d3.select(node).call(moveNode, x, y).datum();\n  selection.select('.nw-edges')\n    .selectAll(\".link\")\n    .filter(d => n.adjacency.map(e => e[1]).includes(d.num))\n    .each(function (d) {\n      if (n.index === d.source.index) {\n        d3.select(this).call(moveEdge, x, y, d.tx, d.ty);\n      } else if (n.index === d.target.index) {\n        d3.select(this).call(moveEdge, d.sx, d.sy, x, y);\n      }\n    });\n}\n\n\nfunction transform(selection, tx, ty, tk) {\n  selection.select('.nw-field')\n    .attr('transform', `translate(${tx}, ${ty}) scale(${tk})`);\n}\n\n\nfunction resizeViewBox(selection, width, height) {\n  selection.attr('viewBox', `0 0 ${width} ${height}`);\n  selection.select('.nw-view-boundary')\n    .attr('width', width)\n    .attr('height', height);\n}\n\n\nexport default {\n  updateNodes, updateEdges, updateNodeCoords, updateEdgeCoords,\n  updateNodeAttrs, updateEdgeAttrs, updateAttrs, updateComponents,\n  move, transform, resizeViewBox\n};\n","\n/** @module network/view */\n\nimport {default as component} from './component.js';\n\n\nfunction networkViewFrame(selection, state) {\n  selection\n    .style('width', '100%')\n    .style('height', '100%');\n  selection.select('.nw-view').remove(); // Clean up\n  selection.append('svg')\n    .classed('nw-view', true);\n  selection.call(resize, state);\n}\n\n\nfunction resize(selection, state) {\n  const area = selection.node();\n  state.setViewBox(area.offsetWidth, area.offsetHeight);\n  selection.select('.nw-view')\n    .call(component.resizeViewBox, area.offsetWidth, area.offsetHeight);\n}\n\n\nfunction networkView(selection, state) {\n  selection\n    .attr('preserveAspectRatio', 'xMinYMin meet')\n    .attr('pointer-events', 'all')\n    .attr('viewBox', `0 0 ${state.viewBox.right} ${state.viewBox.bottom}`)\n    .style('width', '100%')\n    .style('height', '100%');\n\n  // Clean up\n  selection.select('.nw-view-boundary').remove();\n  selection.select('.nw-field').remove();\n\n  // Render\n  selection.append('rect')\n      .classed('nw-view-boundary', true)\n      .attr('x', 0)\n      .attr('y', 0)\n      .attr('width', state.viewBox.right)\n      .attr('height', state.viewBox.bottom)\n      .attr('fill', '#ffffff')\n      .attr('stroke-width', 1)\n      .attr('stroke', '#cccccc');\n  const field = selection.append('g')\n      .classed('nw-field', true)\n      .style('opacity', 1e-6);\n  field.transition()\n      .duration(1000)\n      .style('opacity', 1);\n  const edges = field.append('g').classed('nw-edges', true);\n  const nodes = field.append('g').classed('nw-nodes', true);\n\n  // Set notifiers\n  state.updateComponentNotifier = () => {\n    selection.call(component.updateComponents, state);\n  };\n  state.updateNodeNotifier = () => {\n    nodes.call(component.updateNodes, state.nodesToRender());\n  };\n  state.updateEdgeNotifier = () => {\n    edges.call(component.updateEdges, state.edgesToRender());\n  };\n  state.updateNodeAttrNotifier = () => {\n    nodes.call(component.updateNodeAttrs, state);\n  };\n  state.updateEdgeAttrNotifier = () => {\n    edges.call(component.updateEdgeAttrs, state);\n  };\n\n  // Update graph components\n  selection.call(component.updateComponents, state);\n}\n\n\nexport default {\n  networkViewFrame, resize, networkView\n};\n","\n/** @module common/mapper */\n\nimport KArray from './KArray.js';\nimport {default as misc} from './misc.js';\n\n\n/**\n * Convert single field mapping to multi field mapping\n * @param {object} mapping - single field mapping\n * @return {object} multi field mapping\n */\nfunction singleToMulti(mapping) {\n  const newMapping = {};\n  Object.entries(mapping.mapping).forEach(m => {\n    newMapping[m[0]] = [m[1]];\n  });\n  return {\n    created: mapping.created,\n    fields: [mapping.field],\n    key: mapping.key,\n    mapping: newMapping\n  };\n}\n\n\n/**\n * Convert field mapping to table\n * @param {object} mapping - field mapping\n * @return {object} table object\n */\nfunction mappingToTable(mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  const keyField = {key: mp.key, format: 'text'};\n  const data = {\n    fields: misc.defaultFieldProperties([keyField].concat(mp.fields)),\n    records: Object.entries(mp.mapping).map(entry => {\n      const rcd = {};\n      rcd[mp.key] = entry[0];\n      mp.fields.forEach((f, i) => {\n        rcd[f.key] = entry[1][i];\n      });\n      return rcd;\n    })\n  };\n  return data;\n}\n\n\n/**\n * Convert table to field mapping\n * @param {object} table - table\n * @param {object} key - key\n * @return {object} field mapping\n */\nfunction tableToMapping(table, key, ignore=['index']) {\n  const now = new Date();\n  const mapping = {\n    created: now.toString(),\n    fields: misc.defaultFieldProperties(table.fields\n      .filter(e => e.key !== key)\n      .filter(e => !ignore.includes(e.key))),\n    key: key,\n    mapping: {}\n  };\n  table.records.forEach(row => {\n    mapping.mapping[row[key]] = mapping.fields.map(e => row[e.key]);\n  });\n  return mapping;\n}\n\n\n/**\n * Convert csv text to field mapping\n * @param {string} csvString - csv data text\n * @return {object} field mapping\n */\nfunction csvToMapping(csvString) {\n  const lines = csvString.split(/\\n|\\r|\\r\\n/);\n  const header = lines.shift().split(',');\n  const key = header.shift();\n  const now = new Date();\n  const headerIdx = [];\n  const fields = [];\n  header.forEach((h, i) => {\n    if (h === '') return;\n    headerIdx.push(i);\n    fields.push({key: h, format: 'text'});\n  });\n  const mapping = {\n    created: now.toString(),\n    fields: misc.defaultFieldProperties(fields),\n    key: key,\n    mapping: {}\n  };\n  lines.forEach(line => {\n    const values = line.split(',');\n    const k = values.shift();\n    mapping.mapping[k] = Array(headerIdx.length);\n    headerIdx.forEach(i => {\n      mapping.mapping[k][i] = values[i];\n    });\n  });\n  return mapping;\n}\n\n\n/**\n * Apply mapping to the data (in-place)\n * @param {object} data - datatable JSON\n * @param {object} mapping - mapping JSON\n * @return {undefined} undefined\n */\nfunction apply(data, mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  data.records\n    .filter(rcd => mp.mapping.hasOwnProperty(rcd[mp.key]))\n    .forEach(rcd => {\n      mp.fields.forEach((fd, i) => {\n        rcd[fd.key] = mp.mapping[rcd[mp.key]][i];\n      });\n    });\n  data.fields = KArray.from(data.fields)\n    .concat(misc.defaultFieldProperties(mp.fields))\n    .unique('key').toArray();\n}\n\n\nexport default {\n  singleToMulti, mappingToTable, tableToMapping, csvToMapping, apply\n};\n","\n/** @module component/modal */\n\nimport d3 from 'd3';\n\n\nfunction dialogBase(selection, id) {\n  selection\n      .classed('modal', true)\n      .attr('tabindex', -1)\n      .attr('role', 'dialog')\n      .attr('aria-labelledby', '')\n      .attr('aria-hidden', true)\n      .attr('id', id);\n  selection.select('.modal-dialog').remove();  // Clean up\n  selection.append('div')\n      .classed('modal-dialog', true)\n      .attr('role', 'document')\n    .append('div')\n      .classed('modal-content', true);\n}\n\n\nfunction confirmDialog(selection, id, message) {\n  const base = selection.call(dialogBase, id)\n      .select('.modal-content');\n  // body\n  base.append('div')\n      .classed('modal-body', true)\n    .append('div')\n      .classed('message', true)\n      .text(message);\n  // footer\n  const footer = base.append('div')\n      .classed('modal-footer', true);\n  footer.append('button')\n      .classed('btn', true)\n      .classed('btn-outline-secondary', true)\n      .classed('cancel', true)\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .text('Cancel');\n  footer.append('button')\n      .classed('btn', true)\n      .classed('btn-warning', true)\n      .classed('ok', true)\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .attr('data-target', `${id}-submit`)\n      .text('OK')\n      .on('click', () => {\n        d3.select('#loading-icon').style('display', 'inline');\n        selection.dispatch('submit');\n      });\n}\n\n\nfunction submitDialog(selection, id, title) {\n  const base = selection.call(dialogBase, id)\n      .select('.modal-content');\n  // header\n  const header = base.append('div')\n      .classed('modal-header', true);\n  header.append('h4')\n      .classed('modal-title', true)\n      .text(title);\n  header.append('button')\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .attr('aria-label', 'Close')\n      .classed('close', true)\n    .append('span')\n      .attr('aria-hidden', true)\n      .html('&times;');\n  // body\n  base.append('div')\n      .classed('modal-body', true);\n  // footer\n  base.append('div')\n      .classed('modal-footer', true)\n    .append('button')\n      .classed('btn', true)\n      .classed('btn-primary', true)\n      .classed('submit', true)\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .attr('data-target', `${id}-submit`)\n      .text('Submit')\n      .on('click', () => {\n        d3.select('#loading-icon').style('display', 'inline');\n        selection.dispatch('submit');\n      });\n}\n\n\nexport default {\n  confirmDialog, submitDialog\n};\n","\n/** @module component/formBox */\n\n\nfunction textBox(selection, id, label, size, value) {  // TODO: remove size\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .attr('for', id)\n      .text(label);\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('id', id)\n      .attr('type', 'text')\n      .attr('size', size);\n  selection.call(updateTextBox, value);\n}\n\nfunction updateTextBox(selection, value) {\n  selection.select('input').property('value', value);\n}\n\nfunction textBoxValue(selection) {\n  return selection.select('input').property('value');\n}\n\n\nfunction readonlyBox(selection, id, label, value) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .attr('for', id)\n      .text(label);\n  selection.append('input')\n      .classed('form-control-plaintext', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('id', id)\n      .attr('type', 'text')\n      .property('readonly', true);\n  selection.call(updateTextBox, value);\n}\n\n\nfunction textareaBox(selection, id, label, rows, placeholder, value) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .attr('for', id)\n      .text(label);\n  selection.append('textarea')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('rows', rows)\n      .attr('placeholder', placeholder)\n      .attr('id', id);\n  selection.call(updateTextareaBox, value);\n}\n\nfunction updateTextareaBox(selection, value) {\n  selection.select('textarea').property('value', value);\n}\n\nfunction textareaBoxValue(selection) {\n  const value = selection.select('textarea').property('value');\n  if (value) return value;  // TODO: 0 is falsy\n  const placeholder = selection.select('textarea').attr('placeholder');\n  if (placeholder) return placeholder;\n  return '';\n}\n\nfunction textareaBoxLines(selection) {\n  const value = selection.select('textarea').property('value');\n  if (value) return value.split('\\n').filter(e => e.length > 0);\n  const placeholder = selection.select('textarea').attr('placeholder');\n  if (placeholder) return placeholder.split('\\n').filter(e => e.length > 0);\n  return [];\n}\n\n\nfunction checkBox(selection, id, label, checked) {\n  const box = selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('form-check', true)\n    .append('label')\n      .classed('form-check-label', true)\n      .classed('col-form-label-sm', true);\n  box.append('input')\n      .classed('form-check-input', true)\n      .attr('type', 'checkbox')\n      .attr('id', id);\n  box.append('span')\n      .text(label);\n  selection.call(updateCheckBox, checked);\n}\n\nfunction updateCheckBox(selection, checked) {\n  selection.select('input').property('checked', checked);\n}\n\nfunction checkBoxValue(selection) {\n  return selection.select('input').property('checked');\n}\n\n\nfunction numberBox(selection, id, label, min, max, step, value) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .attr('for', id)\n      .text(label);\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('id', id)\n      .attr('type', 'number')\n      .attr('min', min)\n      .attr('max', max)\n      .attr('step', step);\n  selection.call(updateNumberBox, value);\n}\n\nfunction updateNumberBox(selection, value) {\n  selection.select('input').property('value', value);\n}\n\nfunction numberBoxValue(selection) {\n  return selection.select('input').property('value');\n}\n\n\nfunction fileInputBox(selection, id, label, accept) {\nselection\n    .classed('form-group', true)\n    .classed('form-row', true);\nselection.append('label')\n    .classed('col-form-label', true)\n    .classed('col-form-label-sm', true)\n    .classed('col-4', true)\n    .attr('for', id)\n    .text(label);\nselection.append('input')\n    .classed('form-control', true)\n    .classed('form-control-sm', true)\n    .classed('form-control-file', true)\n    .classed('col-8', true)\n    .attr('type', 'file')\n    .attr('accept', accept)\n    .attr('id', id);\n}\n\nfunction fileInputBoxValue(selection) {\n  return selection.select('input').property('files')[0];\n}\n\n\nexport default {\n  textBox, updateTextBox, textBoxValue, readonlyBox,\n  textareaBox, updateTextareaBox, textareaBoxValue, textareaBoxLines,\n  checkBox, updateCheckBox, checkBoxValue,\n  numberBox, updateNumberBox, numberBoxValue,\n  fileInputBox, fileInputBoxValue\n};\n","\n/** @module component/formListBox */\n\nimport d3 from 'd3';\n\n\n/**\n * Render select box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction selectBox(selection, id, label, fields, value) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .attr('for', id)\n      .text(label);\n  selection.append('select')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('id', id);\n  if (fields) {\n    selection.call(selectBoxItems, fields);\n    selection.call(updateSelectBox, value);\n  }\n}\n\nfunction selectBoxItems(selection, items) {\n  const options = selection.select('select')\n    .selectAll('option')\n      .data(items, d => d.key);\n  options.exit().remove();\n  options.enter()\n    .append('option')\n      .attr('value', d => d.key)\n      .text(d => d.name);\n}\n\nfunction updateSelectBox(selection, value) {\n  selection.select('select').property('value', value);\n}\n\nfunction selectBoxValue(selection) {\n  return selection.select('select').property('value');\n}\n\n\n/**\n * Render select box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction checklistBox(selection, id, label, fields, values) {\n  // TODO: scroll\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('ul')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('id', id);\n  if (fields) {\n    selection.call(checklistBoxItems, fields);\n    selection.call(updateChecklistBox, values);\n  }\n}\n\nfunction checklistBoxItems(selection, items) {\n  const listitems = selection.select('ul')\n    .selectAll('li')\n      .data(items, d => d.key);\n  listitems.exit().remove();\n  const form = listitems.enter()\n    .append('li')\n      .attr('class', 'form-check')\n    .append('label')\n      .attr('class', 'form-check-label');\n  form.append('input')\n      .attr('type', 'checkbox')\n      .attr('class', 'form-check-input')\n      .property('value', d => d.key);\n  form.append('span')\n      .text(d => d.name);\n}\n\nfunction updateChecklistBox(selection, values) {\n  if (!values) return;\n  selection.selectAll('input')\n    .each(function (d) {\n      d3.select(this).property('checked', values.includes(d.key));\n    });\n}\n\nfunction checklistBoxValue(selection) {\n  return selection.selectAll('input:checked').data().map(d => d.key);\n}\n\n\nexport default {\n  selectBox, selectBoxItems, updateSelectBox, selectBoxValue,\n  checklistBox, checklistBoxItems, updateChecklistBox, checklistBoxValue\n};\n","\n/** @module component/formRangeBox */\n\nimport d3 from 'd3';\n\n\n/**\n * Render range box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction rangeBox(selection, id, label, range) {\n  selection\n      .classed('form-row', true)\n      .classed('align-items-center', true)\n      .attr('id', id);\n  selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .classed('mb-1', true)\n      .text(label);\n  const f = selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .classed('mb-1', true);\n  f.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('py-0', true)\n      .attr('for', `${id}-from`)\n      .text('min');\n  f.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('min', true)\n      .attr('type', 'text')\n      .attr('id', `${id}-from`);\n  const t = selection.append('div')\n      .classed('form-group', true)\n      .classed('col-4', true)\n      .classed('mb-1', true);\n  t.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('py-0', true)\n      .attr('for', `${id}-to`)\n      .text('max');\n  t.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('max', true)\n      .attr('type', 'text')\n      .attr('id', `${id}-to`);\n  // TODO: validation\n  // not null, undef, text\n  // min <= max\n  selection.call(updateRangeBox, range);\n}\n\n\nfunction updateRangeBox(selection, range) {\n  // TODO: validation\n  // not null, undef, text\n  // min <= max\n  selection.select('.min').property('value', range[0]);\n  selection.select('.max').property('value', range[1]);\n}\n\n\nfunction rangeBoxValue(selection) {\n  return [\n    parseFloat(selection.select('.min').property('value')),\n    parseFloat(selection.select('.max').property('value'))\n  ];\n}\n\n\n/**\n * Render color scale box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction colorScaleBox(selection, id, label, range) {\n  selection\n      .classed('form-row', true)\n      .classed('align-items-center', true)\n      .attr('id', id);\n  selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-3', true)\n      .classed('mb-1', true)\n      .text(label);\n  const f = selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-3', true)\n      .classed('mb-1', true);\n  f.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('py-0', true)\n      .attr('for', `${id}-from`)\n      .text('min');\n  f.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('min', true)\n      .attr('type', 'color')\n      .attr('id', `${id}-from`);\n  const m = selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-3', true)\n      .classed('mb-1', true);\n  m.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('py-0', true)\n      .attr('for', `${id}-mid`)\n      .text('mid');\n  m.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('mid', true)\n      .attr('type', 'color')\n      .attr('id', `${id}-mid`);\n  const t = selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-3', true)\n      .classed('mb-1', true);\n  t.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('py-0', true)\n      .attr('for', `${id}-to`)\n      .text('max');\n  t.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('max', true)\n      .attr('type', 'color')\n      .attr('id', `${id}-to`);\n  selection\n      .call(updateColorScaleBox, range)\n      .on('change', () => {\n        // avoid update by mousemove on the colorpicker\n        d3.event.stopPropagation();\n      });\n}\n\n\nfunction updateColorScaleBox(selection, range) {\n  let rangeArray;\n  if (range.length == 2) {\n    rangeArray = [range[0], null, range[1]];\n  } else if (range.length == 3) {\n    rangeArray = [range[0], range[1], range[2]];\n  } else {\n    rangeArray = [null, null, null];\n  }\n  selection.select('.min')\n      .property('value', rangeArray[0])\n      .property('disabled', rangeArray[0] === null)\n      .style('opacity', rangeArray[0] === null ? 0.3 : null);\n  selection.select('.mid')\n      .attr('value', rangeArray[1])\n      .property('disabled', rangeArray[1] === null)\n      .style('opacity', rangeArray[1] === null ? 0.3 : null);\n  selection.select('.max')\n      .property('value', rangeArray[2])\n      .property('disabled', rangeArray[2] === null)\n      .style('opacity', rangeArray[2] === null ? 0.3 : null);\n}\n\n\nfunction colorScaleBoxValue(selection) {\n  const arr = [];\n  if (!selection.select('.min').property('disabled')) {\n    arr.push(selection.select('.min').property('value'));\n  }\n  if (!selection.select('.mid').property('disabled')) {\n    arr.push(selection.select('.mid').property('value'));\n  }\n  if (!selection.select('.max').property('disabled')) {\n    arr.push(selection.select('.max').property('value'));\n  }\n  return arr;\n}\n\n\nexport default {\n  rangeBox, updateRangeBox, rangeBoxValue,\n  colorScaleBox, updateColorScaleBox, colorScaleBoxValue\n};\n","\n/** @module component/formBoxGroup */\n\nimport d3 from 'd3';\n\nimport {default as lbox} from '../component/formListBox.js';\nimport {default as rbox} from '../component/formRangeBox.js';\nimport {default as scaledef} from '../common/scale.js';\n\n\n/**\n * Render color range control box group\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction colorRangeGroup(selection, id, palettes, rangeTypes, range) {\n  selection\n      .classed('mb-3', true);\n  selection.append('div')\n      .classed('palette', true)\n      .classed('mb-1', true)\n      .call(lbox.selectBox, `${id}-palette`, 'Color palette', palettes, 'hoge');\n  selection.append('div')\n      .classed('rangetype', true)\n      .classed('mb-1', true)\n      .call(\n        lbox.selectBox, `${id}-rangetype`, 'Range type', rangeTypes,\n        scaledef.colorRangeTypes.find(e => e.size === range.length).key\n      );\n  selection.append('div')\n      .classed('range', true)\n      .classed('mb-1', true)\n      .call(rbox.colorScaleBox, `${id}-range`, 'Range', range);\n  selection.call(updateColorRangeGroup, range);\n}\n\n\nfunction updateColorRangeGroup(selection, range) {\n  selection.select('.palette')\n      .call(\n        lbox.updateSelectBox,\n        scaledef.colorRangeTypes.find(e => e.size === range.length).key\n      )\n      .on('change', function () {\n        const value = lbox.selectBoxValue(d3.select(this));\n        const p = scaledef.colorPalettes.find(e => e.key === value);\n        const t = scaledef.colorRangeTypes.find(e => e.size === p.range.length);\n        selection.select('.rangetype').call(lbox.updateSelectBox, t.key);\n        selection.select('.range').call(rbox.updateColorScaleBox, p.range);\n      });\n  selection.select('.rangetype')\n      .on('change', function () {\n        const value = lbox.selectBoxValue(d3.select(this));\n        const size = scaledef.colorRangeTypes.find(e => e.key === value).size;\n        selection.select('.range').select('.min')\n            .property('disabled', size > 3)\n            .style('opacity', size <= 3 ? null : 0.3);\n        selection.select('.range').select('.mid')\n            .property('disabled', size !== 3)\n            .style('opacity', size === 3 ? null : 0.3);\n        selection.select('.range').select('.max')\n            .property('disabled', size > 3)\n            .style('opacity', size <= 3 ? null : 0.3);\n      });\n  selection.select('.range')\n      .call(rbox.updateColorScaleBox, range)\n      .on('focusin', () => {\n        selection.dispatch('change');\n      });\n}\n\n\nfunction colorRangeGroupValue(selection) {\n  const type = lbox.selectBoxValue(selection.select('.rangetype'));\n  const values = rbox.colorScaleBoxValue(selection.select('.range'));\n  if (!values.length) {\n    return scaledef.colorRangeTypes.find(e => e.key === type).range;\n  } else {\n    return values;\n  }\n}\n\n\n/**\n * Render scale and domain control box group\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction scaleBoxGroup(selection, id, presets, scaleTypes, scale, domain) {\n  selection\n      .classed('mb-3', true);\n  selection.append('div')\n      .classed('preset', true)\n      .classed('mb-1', true)\n      .call(lbox.selectBox, `${id}-preset`, 'Scale preset', presets, '');\n  selection.append('div')\n      .classed('scale', true)\n      .classed('mb-1', true)\n      .call(lbox.selectBox, `${id}-scale`, 'Scale type', scaleTypes, scale);\n  selection.append('div')\n      .classed('domain', true)\n      .classed('mb-1', true)\n      .call(rbox.rangeBox, `${id}-domain`, 'Domain', domain);\n  selection.call(updateScaleBoxGroup, scale, domain);\n}\n\n\nfunction updateScaleBoxGroup(selection, scale, domain) {\n  selection.select('.preset')\n    .on('change', function () {\n      const value = lbox.selectBoxValue(d3.select(this));\n      const p = scaledef.presets.find(e => e.key == value);\n      selection.select('.scale').call(lbox.updateSelectBox, p.scale);\n      selection.select('.domain').call(rbox.updateRangeBox, p.domain);\n    });\n  selection.select('.scale')\n      .call(lbox.updateSelectBox, scale)\n      .on('change', () => {\n        selection.select('.domain').dispatch('change');\n      });\n  selection.select('.domain')\n      .call(rbox.updateRangeBox, domain)\n      .on('change', function () {\n        const isLog = lbox.selectBoxValue(selection.select('.scale')) === 'log';\n        const domain = rbox.rangeBoxValue(d3.select(this));\n        const invalid = d => isNaN(d) || (isLog && d <= 0);\n        d3.select(this).select('.min')\n            .style('background-color', invalid(domain[0]) ? '#ffcccc' : '#ffffff');\n        d3.select(this).select('.max')\n            .style('background-color', invalid(domain[1]) ? '#ffcccc' : '#ffffff');\n      });\n}\n\n\nfunction scaleBoxGroupValue(selection) {\n  const scale = lbox.selectBoxValue(selection.select('.scale'));\n  const domain = rbox.rangeBoxValue(selection.select('.domain'));\n  return {scale: scale, domain: domain};\n}\n\n\nexport default {\n  colorRangeGroup, updateColorRangeGroup, colorRangeGroupValue,\n  scaleBoxGroup, updateScaleBoxGroup, scaleBoxGroupValue\n};\n","\n/** @module network/controlBox */\n\nimport d3 from 'd3';\n\nimport {default as misc} from '../common/misc.js';\nimport {default as scaledef} from '../common/scale.js';\n\nimport {default as box} from '../component/formBox.js';\nimport {default as lbox} from '../component/formListBox.js';\nimport {default as rbox} from '../component/formRangeBox.js';\nimport {default as button} from '../component/button.js';\nimport {default as group} from '../component/formBoxGroup.js';\n\n\nfunction mainControlBox(selection, state) {\n  // Zoom\n  selection.append('div')\n      .classed('mb-3', true)\n    .append('div')\n      .classed('fit', true)\n      .call(button.buttonBox, 'fit-to-screen', 'Fit to screen', 'primary');\n  // View modes\n  const viewModes = selection.append('div')\n      .classed('mb-3', true);\n    viewModes.append('div')\n      .classed('focused', true)\n      .classed('mb-1', true)\n      .call(box.checkBox, 'focused', 'Enable focused view', state.enableFocusedView);\n    viewModes.append('div')\n      .classed('overlook', true)\n      .classed('mb-1', true)\n      .call(box.checkBox, 'overlook', 'Enable overlook view', state.enableOverlookView);\n  // Network threshold\n  const thldGroup = selection.append('div')\n      .classed('mb-3', true);\n  thldGroup.append('div')\n      .classed('thld', true)\n      .classed('mb-1', true)\n      .call(box.numberBox, 'thld', 'Network threshold',\n            state.networkThresholdCutoff, 1.000, 0.01, state.networkThreshold);\n  thldGroup.append('div')\n      .classed('logd', true)\n      .classed('mb-1', true)\n      .call(box.readonlyBox, 'logd', 'logD', null);\n  // Force layout\n  const forceBox = selection.append('div')\n      .classed('form-group', true)\n      .classed('form-row', true);\n  forceBox.append('div')\n      .classed('col-6', true)\n    .append('span')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('mb-1', true)\n      .text('Temperature');\n  forceBox.append('div')\n      .classed('col-12', true)\n    .append('div')\n      .classed('progress', true)\n    .append('div')\n      .classed('progress-bar', true)\n      .classed('w-30', true)\n      .attr('id', 'temperature')\n      .attr('role', 'progressbar')\n      .attr('aria-valuemin', 0)\n      .attr('aria-valuemax', 100);\n  forceBox.append('div')\n      .classed('col-12', true)\n    .append('div')\n      .classed('stick', true)\n      .classed('mb-1', true)\n      .call(box.checkBox, 'stick-nodes', 'Stick nodes', !state.simulationOnLoad);\n  forceBox.append('div')\n      .classed('col-12', true)\n    .append('div')\n      .classed('restart', true)\n      .classed('mb-1', true)\n      .call(button.buttonBox, 'restart-force', 'Activate', 'warning');\n\n  selection.call(updateMainControlBox, state);\n}\n\n\nfunction updateMainControlBox(selection, state) {\n  // Snapshot\n  selection.select('.snapshot')\n      .on('click', function () { state.snapshotNotifier(); });\n  // Zoom\n  selection.select('.fit')\n      .on('click', function () { state.fitNotifier(); });\n  // Focused view\n  selection.select('.focused')\n      .call(box.updateCheckBox, state.enableFocusedView)\n      .on('change', function () {\n        state.enableFocusedView = box.checkBoxValue(d3.select(this));\n        state.focusedView = box.checkBoxValue(d3.select(this));\n        state.updateComponentNotifier();\n      });\n  // Overlook view\n  selection.select('.overlook')\n      .call(box.updateCheckBox, state.enableOverlookView)\n      .on('change', function () {\n        state.enableOverlookView = box.checkBoxValue(d3.select(this));\n        state.overlookView = box.checkBoxValue(d3.select(this));\n        state.updateComponentNotifier();\n      });\n  // Network threshold\n  selection.select('.thld')\n      .call(box.updateNumberBox, state.networkThreshold)\n      .on('change', function () {\n        const value = box.numberBoxValue(d3.select(this));\n        state.networkThreshold = value;\n        state.updateComponentNotifier();\n        state.setForceNotifier();\n        const numEdges = state.edges.filter(e => e.weight >= value).length;\n        const n = state.nodes.length;\n        const combinations = n * (n - 1) / 2;\n        const logD = d3.format('.2f')(Math.log10(numEdges / combinations));\n        selection.select('.logd').call(box.updateTextBox, logD);\n      })\n      .dispatch('change');\n  // Force layout\n  selection.select('.stick')\n      .call(box.updateCheckBox, !state.simulationOnLoad)\n      .on('change', function () {\n        const value = box.checkBoxValue(d3.select(this));\n        if (value) {\n          state.stickNotifier();\n          selection.select('.progress')\n            .style('background-color', '#a3e4d7');\n        } else {\n          state.relaxNotifier();\n          selection.select('.progress')\n            .style('background-color', '#e9ecef');\n        }\n      });\n  selection.select('.restart')\n      .on('click', function () { state.restartNotifier(); });\n}\n\n\n\nfunction nodeColorControlBox(selection, state) {\n  selection.append('div')\n      .classed('field', true)\n      .call(\n        lbox.selectBox, 'color-field', 'Field',\n        state.data.nodes.fields.filter(e => misc.sortType(e.format) !== 'none'),\n        state.nodeColor.field || ''\n      );\n  selection.append('div')\n      .classed('range', true)\n      .call(\n        group.colorRangeGroup, 'color', scaledef.colorPalettes,\n        scaledef.colorRangeTypes, state.nodeColor.range\n      );\n  selection.append('div')\n      .classed('scale', true)\n      .call(\n        group.scaleBoxGroup, 'color', scaledef.presets,\n        scaledef.types.filter(e => e.key !== 'ordinal'),\n        state.nodeColor.scale, state.nodeColor.domain\n      );\n\n  selection.call(updateNodeColorControlBox, state);\n}\n\n\nfunction updateNodeColorControlBox(selection, state) {\n  selection.select('.field')\n    .call(lbox.updateSelectBox, state.nodeColor.field)\n    .on('change', function () {\n      state.nodeColor.field = lbox.selectBoxValue(d3.select(this));\n      state.updateNodeAttrNotifier();\n    });\n  selection.select('.range')\n    .call(group.updateColorRangeGroup, state.nodeColor.range)\n    .on('change', function () {\n      const values = group.colorRangeGroupValue(d3.select(this));\n      state.nodeColor.range = values;\n      if (values.length > 3) {\n        state.nodeColor.scale = 'ordinal';\n        selection.select('.scale').selectAll('select,input')\n          .property('disabled', true)\n          .style('opacity', 0.3);\n      } else {\n        selection.select('.scale').selectAll('select,input')\n          .property('disabled', false)\n          .style('opacity', null);\n      }\n      state.updateNodeAttrNotifier();\n    }\n  );\n  selection.select('.scale')\n    .call(group.updateScaleBoxGroup, state.nodeColor.scale, state.nodeColor.domain)\n    .on('change', function () {\n      const values = group.scaleBoxGroupValue(d3.select(this));\n      state.nodeColor.scale = values.scale;\n      state.nodeColor.domain = values.domain;\n      state.updateNodeAttrNotifier();\n    }\n  );\n}\n\n\nfunction nodeSizeControlBox(selection, state) {\n  selection.append('div')\n    .classed('field', true)\n    .call(\n      lbox.selectBox, 'size-field', 'Field',\n      state.data.nodes.fields.filter(e => misc.sortType(e.format) === 'numeric'),\n      state.nodeSize.field || ''\n    );\n  selection.append('div')\n    .classed('range', true)\n    .classed('mb-3', true)\n    .call(rbox.rangeBox, 'size-range', 'Range', state.nodeSize.range);\n  selection.append('div')\n    .classed('scale', true)\n    .call(\n      group.scaleBoxGroup, 'size',\n      scaledef.presets.filter(e => e.scale !== 'ordinal'),\n      scaledef.types.filter(e => e.key !== 'ordinal'),\n      state.nodeSize.scale, state.nodeSize.domain\n    );\n  selection.call(updateNodeSizeControlBox, state);\n}\n\n\nfunction updateNodeSizeControlBox(selection, state) {\n  selection.select('.field')\n    .call(lbox.updateSelectBox, state.nodeSize.field)\n    .on('change', function () {\n      state.nodeSize.field = lbox.selectBoxValue(d3.select(this));\n      state.updateNodeAttrNotifier();\n    });\n  selection.select('.range')\n    .call(rbox.updateRangeBox, state.nodeSize.range)\n    .on('change', function () {\n      state.nodeSize.range = rbox.rangeBoxValue(d3.select(this));\n      state.updateNodeAttrNotifier();\n    });\n  selection.select('.scale')\n    .call(group.updateScaleBoxGroup, state.nodeSize.scale, state.nodeSize.domain)\n    .on('change', function () {\n      const values = group.scaleBoxGroupValue(d3.select(this));\n      state.nodeSize.scale = values.scale;\n      state.nodeSize.domain = values.domain;\n      state.updateNodeAttrNotifier();\n    }\n  );\n}\n\n\nfunction nodeLabelControlBox(selection, state) {\n  // nodeLabel.visible\n  selection.append('div')\n    .append('div')\n      .classed('visible', true)\n      .call(box.checkBox, 'label-visible', 'Show node labels', state.nodeLabel.visible);\n  // nodeLabel\n  const labelGroup = selection.append('div')\n      .classed('mb-3', true);\n  labelGroup.append('div')\n      .classed('text', true)\n      .classed('mb-1', true)\n      .call(\n        lbox.selectBox, 'label-text', 'Text field',\n        state.data.nodes.fields.filter(e => misc.sortType(e.format) !== 'none'),\n        state.nodeLabel.text || ''\n      );\n  labelGroup.append('div')\n      .classed('size', true)\n      .classed('mb-1', true)\n      .call(\n        box.numberBox, 'label-size', 'Font size', 6, 100, 1, state.nodeLabel.size\n      );\n  // nodeLabelColor\n  selection.append('div')\n      .classed('field', true)\n      .call(\n        lbox.selectBox, 'label-field', 'Color field',\n        state.data.nodes.fields.filter(e => misc.sortType(e.format) !== 'none'),\n        state.nodeLabelColor.field || ''\n      );\n  selection.append('div')\n      .classed('range', true)\n      .call(\n        group.colorRangeGroup, 'label', scaledef.colorPalettes,\n        scaledef.colorRangeTypes, state.nodeLabelColor.range\n      );\n  selection.append('div')\n      .classed('scale', true)\n      .call(\n        group.scaleBoxGroup, 'label', scaledef.presets,\n        scaledef.types.filter(e => e.key !== 'ordinal'),\n        state.nodeLabelColor.scale, state.nodeLabelColor.domain\n      );\n  selection.call(updateNodeLabelControlBox, state);\n}\n\n\nfunction updateNodeLabelControlBox(selection, state) {\n  // nodeLabel.visible\n  selection.select('.visible')\n      .call(box.updateCheckBox, state.nodeLabel.visible)\n      .on('change', function () {\n        state.nodeLabel.visible = box.checkBoxValue(d3.select(this));\n        state.updateNodeAttrNotifier();\n      });\n  // nodeLabel\n  selection.select('.text')\n      .call(lbox.updateSelectBox, state.nodeLabel.text)\n      .on('change', function () {\n        state.nodeLabel.text = lbox.selectBoxValue(d3.select(this));\n        state.updateNodeAttrNotifier();\n      });\n  selection.select('.size')\n      .call(box.updateNumberBox, state.nodeLabel.size)\n      .on('change', function () {\n        state.nodeLabel.size = box.numberBoxValue(d3.select(this));\n        state.updateNodeAttrNotifier();\n      });\n  // nodeLabelColor\n  selection.select('.field')\n      .call(lbox.updateSelectBox, state.nodeLabelColor.field)\n      .on('change', function () {\n        state.nodeLabelColor.field = lbox.selectBoxValue(d3.select(this));\n        state.updateNodeAttrNotifier();\n      });\n  selection.select('.range')\n      .call(group.updateColorRangeGroup, state.nodeLabelColor.range)\n      .on('change', function () {\n        const values = group.colorRangeGroupValue(d3.select(this));\n        state.nodeLabelColor.range = values;\n        if (values.length > 3) {\n          state.nodeLabelColor.scale = 'ordinal';\n          selection.select('.scale').selectAll('select,input')\n            .property('disabled', true)\n            .style('opacity', 0.3);\n        } else {\n          state.nodeLabelColor.scale = lbox.selectBoxValue(selection.select('.range'));\n          selection.select('.scale').selectAll('select,input')\n            .property('disabled', false)\n            .style('opacity', null);\n        }\n        state.updateNodeAttrNotifier();\n      });\n  selection.select('.scale')\n      .call(\n        group.updateScaleBoxGroup, state.nodeLabelColor.scale,\n        state.nodeLabelColor.domain\n      )\n      .on('change', function () {\n        const values = group.scaleBoxGroupValue(d3.select(this));\n        state.nodeLabelColor.scale = values.scale;\n        state.nodeLabelColor.domain = values.domain;\n        state.updateNodeAttrNotifier();\n      }\n    );\n}\n\n\nfunction edgeControlBox(selection, state) {\n  // edgeLabel\n  const labelGroup = selection.append('div')\n      .classed('mb-3', true);\n  labelGroup.append('div')\n      .classed('label', true)\n      .classed('mb-1', true)\n      .call(\n        box.checkBox, 'edge-label-visible', 'Show edge weight label',\n        state.edgeLabel.visible\n      );\n  labelGroup.append('div')\n      .classed('size', true)\n      .classed('mb-1', true)\n      .call(\n        box.numberBox, 'edge-label-size', 'Weight label font size',\n        6, 100, 1, state.edgeLabel.size\n      );\n  // edgeWidth\n  const widthGroup = selection.append('div')\n      .classed('mb-3', true);\n  widthGroup.append('div')\n      .classed('range', true)\n      .classed('mb-3', true)\n      .call(rbox.rangeBox, 'edge-width-range', 'Range', state.edgeWidth.range);\n  widthGroup.append('div')\n      .classed('scale', true)\n      .classed('mb-1', true)\n      .call(\n        lbox.selectBox, 'edge-width-scale', 'Scale type',\n        scaledef.types.filter(e => e.key !== 'ordinal'), state.edgeWidth.scale\n      );\n  widthGroup.append('div')\n      .classed('domain', true)\n      .classed('mb-1', true)\n      .call(rbox.rangeBox, 'edge-width-domain', 'Domain', state.edgeWidth.domain);\n}\n\nfunction updateEdgeControlBox(selection, state) {\n  // edgeLabel\n  selection.select('.label')\n      .call(box.updateCheckBox, state.edgeLabel.visible)\n      .on('change', function () {\n        state.edgeLabel.visible = box.checkBoxValue(d3.select(this));\n        state.updateEdgeAttrNotifier();\n      });\n  selection.select('.size')\n      .call(box.updateNumberBox, state.edgeLabel.size)\n      .on('change', function () {\n        state.edgeLabel.size = box.numberBoxValue(d3.select(this));\n        state.updateEdgeAttrNotifier();\n      });\n  // edgeWidth\n  selection.select('.range')\n      .call(rbox.updateRangeBox, state.edgeWidth.range)\n      .on('change', function () {\n        state.edgeWidth.range = rbox.rangeBoxValue(d3.select(this));\n        state.updateEdgeAttrNotifier();\n      });\n  selection.select('.scale')\n      .call(lbox.updateSelectBox, state.edgeWidth.scale)\n      .on('change', function () {\n        state.edgeWidth.scale = lbox.selectBoxValue(d3.select(this));\n        state.updateEdgeAttrNotifier();\n      });\n  selection.select('.domain')\n      .call(rbox.updateRangeBox, state.edgeWidth.domain)\n      .on('change', function () {\n        state.edgeWidth.domain = rbox.rangeBoxValue(d3.select(this));\n        state.updateEdgeAttrNotifier();\n      });\n}\n\n\nfunction controlBoxFrame(selection, navID, contentID) {\n  selection.append('nav')\n    .append('div')\n      .classed('nav', true)\n      .classed('nav-tabs', true)\n      .attr('id', navID)\n      .attr('role', 'tablist');\n  selection.append('div')\n      .classed('tab-content', true)\n      .classed('p-2', true)\n      .attr('id', contentID);\n}\n\n\nfunction controlBoxNav(selection, id, label) {\n  selection\n      .classed('nav-item', true)\n      .classed('nav-link', true)\n      .classed('py-1', true)\n      .attr('id', `${id}-tab`)\n      .attr('data-toggle', 'tab')\n      .attr('href', `#${id}`)\n      .attr('role', 'tab')\n      .attr('aria-controls', id)\n      .attr('aria-selected', 'false')\n      .text(label);\n}\n\n\nfunction controlBoxItem(selection, id) {\n  selection\n      .classed('tab-pane', true)\n      .classed('fade', true)\n      .classed('container', true)\n      .classed('px-0', true)\n      .attr('id', id)\n      .attr('role', 'tabpanel')\n      .attr('aria-labelledby', `${id}-tab`);\n}\n\n\nfunction controlBox(selection, state) {\n  // Clean up\n  selection.select('nav').remove();\n  selection.select('.tab-content').remove();\n\n  selection.call(\n    controlBoxFrame, 'control-frame-nav', 'control-frame-content');\n  const tabs = selection.select('.nav-tabs');\n  const content = selection.select('.tab-content');\n\n  // Main\n  tabs.append('a')\n      .classed('active', true)\n      .attr('aria-selected', 'true')\n      .call(controlBoxNav, 'control-main', 'Main');\n  content.append('div')\n      .classed('show', true)\n      .classed('active', true)\n      .classed('control-main', true)\n      .call(controlBoxItem, 'control-main')\n      .call(mainControlBox, state);\n\n  // Color\n  tabs.append('a')\n      .call(controlBoxNav, 'control-color', 'Color');\n  content.append('div')\n      .classed('control-color', true)\n      .call(controlBoxItem, 'control-color')\n      .call(nodeColorControlBox, state);\n\n  // Size\n  tabs.append('a')\n      .call(controlBoxNav, 'control-size', 'Size');\n  content.append('div')\n      .classed('control-size', true)\n      .call(controlBoxItem, 'control-size')\n      .call(nodeSizeControlBox, state);\n\n  // Label\n  tabs.append('a')\n      .call(controlBoxNav, 'control-label', 'Label');\n  content.append('div')\n      .classed('control-label', true)\n      .call(controlBoxItem, 'control-label')\n      .call(nodeLabelControlBox, state);\n\n  // Edge\n  tabs.append('a')\n      .call(controlBoxNav, 'control-edge', 'Edge');\n  content.append('div')\n      .classed('control-edge', true)\n      .call(controlBoxItem, 'control-edge')\n      .call(edgeControlBox, state);\n\n  selection.call(updateControlBox, state);\n}\n\n\nfunction updateControlBox(selection, state) {\n  selection.select('.control-main')\n      .call(updateMainControlBox, state);\n  selection.select('.control-color')\n      .call(updateNodeColorControlBox, state);\n  selection.select('.control-size')\n      .call(updateNodeSizeControlBox, state);\n  selection.select('.control-label')\n      .call(updateNodeLabelControlBox, state);\n  selection.select('.control-edge')\n      .call(updateEdgeControlBox, state);\n}\n\n\nexport default {\n  controlBox, updateControlBox\n};\n","\n/** @module network/interaction */\n\nimport d3 from 'd3';\n\nimport {default as component} from './component.js';\n\n\nfunction dragListener(selection, state) {\n  return d3.drag()\n    .on('drag', function () {\n      selection.call(component.move, this, d3.event.x, d3.event.y);\n    })\n    .on('end', function (d) {\n      state.setCoords(d.index, d3.event.x, d3.event.y);\n    });\n}\n\n\nfunction zoomListener(selection, state) {\n  return d3.zoom()\n    .on('zoom', function() {\n      const t = d3.event.transform;\n      selection.call(component.transform, t.x, t.y, t.k);\n      // Smooth transition\n      if (!state.focusedView) {\n        const p = state.prevTransform;\n        const xMoved = t.x > p.x + 20 || t.x < p.x - 20;\n        const yMoved = t.y > p.y + 20 || t.y < p.y - 20;\n        const zoomIn = t.k > p.k;\n        if (xMoved || yMoved && !zoomIn) {\n          state.setTransform(t.x, t.y, t.k);\n          state.prevTransform = {x: t.x, y: t.y, k: t.k};\n          selection\n            .call(component.updateComponents, state);\n        }\n      }\n    })\n    .on('end', function() {\n      const t = d3.event.transform;\n      state.setTransform(t.x, t.y, t.k);\n      state.prevTransform = {x: t.x, y: t.y, k: t.k};\n      selection\n        .call(component.updateComponents, state);\n    });\n}\n\n\nfunction setInteraction(selection, state) {\n  state.zoomListener = zoomListener(selection, state);\n  state.dragListener = dragListener(selection, state);\n  selection.call(state.zoomListener);\n  selection.select('.nw-nodes')\n    .selectAll('.node')\n      .call(state.dragListener);\n  state.fitNotifier = () => {\n    selection.call(fit, state);\n  };\n  // Resume zoom event\n  const t = state.transform;\n  selection\n      .call(component.transform, t.x, t.y, t.k)\n      .call(\n        d3.zoom().transform,\n        d3.zoomIdentity.translate(t.x, t.y).scale(t.k)\n      );\n\n}\n\n\nfunction fit(selection, state) {\n  const viewBox = selection.select('.nw-view-boundary').node().getBBox();\n  const viewBoxRatio = viewBox.width / viewBox.height;\n  const boundaryHeight = state.boundary.bottom - state.boundary.top;\n  const boundaryWidth = state.boundary.right - state.boundary.left;\n  const boundaryRatio = boundaryWidth / boundaryHeight;\n  const scale = viewBoxRatio >= boundaryRatio\n    ? viewBox.height / boundaryHeight\n    : viewBox.width / boundaryWidth;\n  const tx = -state.boundary.left * scale;\n  const ty = -state.boundary.top * scale;\n  state.setTransform(tx, ty, scale);\n  selection\n      .call(component.updateComponents, state)\n      .call(component.transform, tx, ty, scale)\n      .call(\n        d3.zoom().transform,\n        d3.zoomIdentity.translate(tx, ty).scale(scale)\n      );\n}\n\n\nexport default {\n  dragListener, zoomListener, setInteraction, fit\n};\n","\n/** @module network/force */\n\nimport d3 from 'd3';\n\nimport {default as component} from './component.js';\nimport {default as interaction} from './interaction.js';\n\n\nfunction forceSimulation(width, height) {\n  return d3.forceSimulation()\n    .force('link',\n      d3.forceLink().id(d => d.index)\n        .distance(60)\n        .strength(1))\n    .force('charge',\n      d3.forceManyBody()\n        .strength(-600)\n        .distanceMin(15)\n        .distanceMax(720))\n    .force('collide',\n      d3.forceCollide()\n        .radius(90))\n    .force('center',\n      d3.forceCenter(width / 2, height / 2))\n    .force('x',\n      d3.forceX()\n        .strength(0.002))\n    .force('y',\n      d3.forceY()\n        .strength(0.002))\n    .stop();\n}\n\n\nfunction showTemperature(simulation) {\n  const alpha = simulation.alpha();\n  const isStopped = alpha <= simulation.alphaMin();\n  // TODO: select temperature indicator\n  const progress = parseInt(isStopped ? 0 : alpha * 100);\n  d3.select('#temperature')\n    .classed('bg-success', isStopped)\n    .classed('bg-warning', !isStopped)\n    .style('width', `${progress}%`)\n    .attr('aria-valuenow', progress);\n}\n\n\nfunction forceDragListener(selection, simulation, state) {\n  return d3.drag()\n    .on('start', () => {\n      if (!d3.event.active) selection.call(relax, simulation, state);\n    })\n    .on('drag', d => {\n      d.fx = d3.event.x;\n      d.fy = d3.event.y;\n    })\n    .on('end', d => {\n      if (!d3.event.active) simulation.alphaTarget(0);\n      d.fx = null;\n      d.fy = null;\n    });\n}\n\n\nfunction end(selection, simulation, state) {\n  const coords = state.nodes.map(e => ({x: e.x, y: e.y}));\n  state.setAllCoords(coords);\n  selection\n    .call(component.updateComponents, state);\n  showTemperature(simulation);\n}\n\n\nfunction stick(selection, simulation, state) {\n  simulation.alpha(0).stop();\n  selection.select('.nw-nodes').selectAll('.node')\n    .each(d => {\n      d.fx = d.x;\n      d.fy = d.y;\n    });\n  state.dragListener = interaction.dragListener(selection, state);\n  selection.call(end, simulation, state);\n}\n\n\nfunction unstick(selection, simulation, state) {\n  selection.select('.nw-nodes').selectAll('.node')\n    .each(d => {\n      d.fx = null;\n      d.fy = null;\n    });\n  state.dragListener = forceDragListener(selection, simulation, state);\n  // Render all nodes and do not render edges\n  // TODO: edge rendering behavior should be changed by data size or setting\n  const coords = state.nodes.map(e => ({x: e.x, y: e.y}));\n  state.setAllCoords(coords);\n  selection\n    .call(component.updateComponents, state);\n}\n\n\nfunction relax(selection, simulation, state) {\n  selection.call(unstick, simulation, state);\n  simulation.alpha(0.1).restart();\n}\n\n\nfunction restart(selection, simulation, state) {\n  selection.call(unstick, simulation, state);\n  simulation.alpha(1).restart();\n}\n\n\nfunction setForce(selection, simulation, state) {\n  const forceEdges = state.edges\n    .filter(e => e.weight >= state.networkThreshold);\n  simulation.nodes(state.nodes)\n    .force('link').links(forceEdges);\n}\n\nfunction activate(selection, simulation, state) {\n  selection.call(setForce, simulation, state);\n  simulation\n    .on('tick', () => {\n      selection.select('.nw-nodes').selectAll(\".node\")\n        .call(component.updateNodeCoords);\n      const coords = state.nodes.map(e => ({x: e.x, y: e.y}));\n      state.setAllCoords(coords);\n      selection.select('.nw-edges').selectAll(\".link\")\n        .call(component.updateEdgeCoords);\n      showTemperature(simulation);\n    })\n    .on('end', () => selection.call(end, simulation, state));\n  state.setForceNotifier = () => {\n    selection.call(setForce, simulation, state);\n  };\n  state.stickNotifier = () => {\n    selection.call(stick, simulation, state);\n  };\n  state.relaxNotifier = () => {\n    selection.call(relax, simulation, state);\n  };\n  state.restartNotifier = () => {\n    selection.call(restart, simulation, state);\n  };\n  if (state.simulationOnLoad) {\n    selection.call(restart, simulation, state);\n  } else {\n    selection.call(stick, simulation, state);\n  }\n}\n\n\nexport default {\n  forceSimulation, activate, stick, relax, restart\n};\n","\n/** @module common/legacySchema */\n\nimport d3 from 'd3';\nimport {default as misc} from './misc.js';\n\n\nconst statusConv = {\n  Queued: 'ready',\n  'In progress': 'running',\n  Aborting: 'running',\n  Aborted: 'aborted',\n  Completed: 'done',\n  Failure: 'failure'\n};\n\nconst dataTypeConv = {\n  datatable: 'nodes',\n  connection: 'edges'\n};\n\nfunction v07_to_v08_nodes(json) {\n  const fields = json.columns.map(e => {\n    if (e.sort === 'numeric') {\n      e.format = 'numeric';\n    } else if (e.sort === 'text') {\n      e.format = 'text';\n    } else if (e.sort === 'none') {\n      e.format = 'raw';\n    }\n    return e;\n  });\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    status: statusConv[json.status],\n    fields: fields,\n    records: json.records,\n    query: json.query,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n  };\n}\n\nfunction v07_to_v08_edges(json, nodeFields) {\n  const snp = {\n    fieldTransform: json.snapshot.fieldTransform,\n    nodePositions: json.snapshot.nodePositions,\n    nodeColor: {},\n    nodeSize: {},\n    nodeLabel: {},\n    edge: {}\n  };\n  if (json.snapshot.hasOwnProperty('nodeColor')) {\n    snp.nodeColor.id = json.snapshot.nodeColor.id;\n    snp.nodeColor.scale = json.snapshot.nodeColor.scale;\n    snp.nodeColor.field = nodeFields.find(e => e.key === json.snapshot.nodeColor.column);\n  } else {\n    snp.nodeColor = {\n      id: 'color', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeSize')) {\n    snp.nodeSize.id = json.snapshot.nodeSize.id;\n    snp.nodeSize.scale = json.snapshot.nodeSize.scale;\n    snp.nodeSize.field = nodeFields.find(e => e.key === json.snapshot.nodeSize.column);\n  } else {\n    snp.nodeSize = {\n      id: 'size', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: [20, 20], unknown: 20}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeLabel')) {\n    snp.nodeLabel.id = json.snapshot.nodeLabel.id;\n    snp.nodeLabel.size = json.snapshot.nodeLabel.size;\n    snp.nodeLabel.text = json.snapshot.nodeLabel.text;\n    snp.nodeLabel.visible = json.snapshot.nodeLabel.visible;\n    snp.nodeLabel.scale = json.snapshot.nodeLabel.scale;\n    snp.nodeLabel.field = nodeFields.find(e => e.key === json.snapshot.nodeLabel.column);\n  } else {\n    snp.nodeLabel = {\n      id: 'label', size: 12, text: 'index', visible: false, field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeContent')) {\n    snp.nodeContent = json.snapshot.nodeContent;\n  } else {\n    snp.nodeContent = {structure: {visible: false}};\n  }\n  if (json.snapshot.hasOwnProperty('edge')) {\n    snp.edge = json.snapshot.edge;\n  } else {\n    snp.edge = {\n      id: 'label', label: {size: 10, visible: false}, visible: true,\n      scale: {scale: 'linear', domain: [0, 1], range: [5, 5], unknown: 5}\n    };\n  }\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    reference: {\n      nodes: json.nodeTableId\n    },\n    status: statusConv[json.status],\n    fields: misc.defaultFieldProperties([\n      {'key': 'source'},\n      {'key': 'target'},\n      {'key': 'weight'}\n    ]),\n    records: json.records,\n    query: json.query,\n    networkThreshold: json.networkThreshold,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n    snapshot: snp\n  };\n}\n\n\nfunction v08_nodes(json) {\n  json.records.forEach((e, i) => {\n    e.index = i;\n    e.structure = e._structure;\n    delete e._index;\n    delete e._structure;\n  });\n  json.fields.forEach(e => {\n    if (e.key === '_index') e.key = 'index';\n    if (e.key === '_structure') e.key = 'structure';\n    if (e.sort === 'numeric') e.format = 'numeric';\n    if (e.sort === 'text') e.format = 'text';\n    if (e.sort === 'none') e.format = 'raw';\n  });\n  return json;\n}\n\nfunction v08_graph(json) {\n  if (!json.edges.hasOwnProperty('reference')) { // ver0.8.0-0.8.1\n    json.edges.reference = {nodes: json.edges.nodesID};\n  }\n  if (json.nodes.fields.find(e => e.key === '_index')) {\n    const idx_converter = {};\n    json.nodes.records.forEach((e, i) => {\n        e.index = i;\n        e.structure = e._structure;\n        idx_converter[e._index] = e.index;\n        delete e._index;\n        delete e._structure;\n    });\n    json.edges.records.forEach(e => {\n        e.source = idx_converter[e.source];\n        e.target = idx_converter[e.target];\n    });\n    json.nodes.fields.forEach(e => {\n      if (e.key === '_index') e.key = 'index';\n      if (e.key === '_structure') e.key = 'structure';\n      if (e.sort === 'numeric') e.format = 'numeric';\n      if (e.sort === 'text') e.format = 'text';\n      if (e.sort === 'none') e.format = 'raw';\n    });\n  }\n  return json;\n}\n\nfunction v10_nodes(json) {\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: json.dataType,\n    schemaVersion: '0.10',\n    revision: json.revision,\n    status: json.status,\n    fields: json.fields,\n    records: json.records,\n    query: json.query,\n    progress: json.progress,\n    execTime: json.execTime,\n    created: json.created,\n    reference: {}\n  };\n}\n\n\nfunction v10_edges(json) {\n  const snapshot = {\n    networkThreshold: json.networkThreshold\n  };\n  snapshot.nodeContentVisible = json.snapshot.nodeContent.structure.visible;\n  snapshot.nodeColor = json.snapshot.nodeColor.scale || {};\n  if (snapshot.nodeColor.field) {\n    snapshot.nodeColor.field = json.snapshot.nodeColor.field.key;\n    if (snapshot.nodeColor.field === '_index') {\n      snapshot.nodeColor.field = 'index';\n    }\n  }\n  if (snapshot.nodeColor.scale === 'ordinal') {\n    snapshot.nodeColor.range = d3.schemeCategory20;\n  }\n  snapshot.nodeSize = json.snapshot.nodeSize.scale || {};\n  if (json.snapshot.nodeSize.field) {\n    snapshot.nodeSize.field = json.snapshot.nodeSize.field.key;\n    if (snapshot.nodeSize.field === '_index') {\n      snapshot.nodeSize.field = 'index';\n    }\n  }\n  snapshot.nodeLabel = {};\n  if (json.snapshot.nodeLabel.text) {\n    snapshot.nodeLabel.text = json.snapshot.nodeLabel.text.key;\n    if (snapshot.nodeLabel.text === '_index') {\n      snapshot.nodeLabel.text = 'index';\n    }\n  }\n  snapshot.nodeLabel.size = json.snapshot.nodeLabel.size;\n  snapshot.nodeLabel.visible = json.snapshot.nodeLabel.visible;\n  snapshot.nodeLabelColor = json.snapshot.nodeLabel.scale || {};\n  if (json.snapshot.nodeLabel.field) {\n    snapshot.nodeLabelColor.field = json.snapshot.nodeLabel.field.key;\n    if (snapshot.nodeLabelColor.field === '_index') {\n      snapshot.nodeLabelColor.field = 'index';\n    }\n  }\n  if (snapshot.nodeLabelColor.scale === 'ordinal') {\n    snapshot.nodeLabelColor.range = d3.schemeCategory20;\n  }\n  snapshot.edgeVisible = json.snapshot.edge.visible;\n  snapshot.edgeWidth = json.snapshot.edge.scale || {};\n  snapshot.edgeLabel = {};\n  snapshot.edgeLabel.size = json.snapshot.edge.label.size;\n  snapshot.edgeLabel.visible = json.snapshot.edge.label.visible;\n  snapshot.networkThreshold = json.networkThreshold || json.query.threshold;\n  snapshot.coords = json.snapshot.nodePositions;\n  // TODO: when created date is lost\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: json.dataType,\n    schemaVersion: '0.10',\n    revision: json.revision,\n    status: json.status,\n    fields: json.fields,\n    records: json.records,\n    query: {params: json.query},\n    progress: json.progress,\n    execTime: json.execTime,\n    created: json.created,\n    snapshot: snapshot,\n    reference: json.reference\n  };\n}\n\nfunction convertTable(json) {\n  let data = json;\n  if (!(data.hasOwnProperty('schemaVersion') || data.hasOwnProperty('$schema'))) { // v0.7\n    data = v07_to_v08_nodes(data);\n  }\n  if (data.schemaVersion == '0.8') {\n    data = v08_nodes(data);\n    data = v10_nodes(data);\n  }\n  if (!data.hasOwnProperty('$schema')) {\n    delete data.schemaVersion;\n    delete data.revision;\n    data.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n  }\n  return data;\n}\n\nfunction convertNetwork(json) {\n  let data = json;\n  if (!(data.edges.hasOwnProperty('schemaVersion') || data.edges.hasOwnProperty('$schema'))) { // v0.7\n    data.nodes = v07_to_v08_nodes(data.nodes);\n    data.edges = v07_to_v08_edges(data.edges, data.nodes.fields);\n  }\n  if (data.edges.schemaVersion == '0.8' || data.edges.schemaVersion === 0.1) {  // wrong conversion of '0.10'\n    data = v08_graph(data);\n    data.nodes = v10_nodes(data.nodes);\n    data.edges = v10_edges(data.edges);\n  }\n  if (!data.edges.hasOwnProperty('$schema')) {\n    delete data.nodes.schemaVersion;\n    delete data.edges.schemaVersion;\n    delete data.nodes.revision;\n    delete data.edges.revision;\n    data.nodes.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n    data.edges.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n  }\n  return data;\n}\n\n\nexport default {\n  convertTable, convertNetwork\n};\n","\n/** @module network/networkApp */\n\nimport d3 from 'd3';\n\nimport {default as core} from '../common/core.js';\nimport {default as hfile} from '../common/file.js';\nimport {default as idb} from '../common/idb.js';\nimport {default as mapper} from '../common/mapper.js';\nimport {default as misc} from '../common/misc.js';\n\nimport {default as button} from '../component/button.js';\nimport {default as modal} from '../component/modal.js';\n\nimport {default as communityDialog} from '../dialog/community.js';\nimport {default as renameDialog} from '../dialog/rename.js';\n\nimport {default as view} from './view.js';\nimport {default as control} from './controlBox.js';\nimport {default as interaction} from './interaction.js';\nimport {default as force} from './force.js';\nimport {default as community} from './communityDetection.js';\nimport NetworkState from './state.js';\n\n\nfunction getGraph(storeID) {\n  return idb.getItemByID(storeID)\n    .then(edges => {\n      return idb.getItemByID(edges.reference.nodes)\n        .then(nodes => {\n          return {edges: edges, nodes: nodes};\n        });\n    });\n}\n\n\nfunction app(data) {\n  // TODO: define field size according to the data size\n  const width = 1200;\n  const height = 1200;\n  const state = new NetworkState(data, width, height);\n  const simulation = force.forceSimulation(width, height);\n  const frame = d3.select('#nw-frame')\n      .call(view.networkViewFrame, state);\n  frame.select('.nw-view')\n      .call(view.networkView, state)\n      .call(interaction.setInteraction, state)\n      .call(force.activate, simulation, state);\n  d3.select('#nw-control')\n      .call(control.controlBox, state);\n\n  // Resize window\n  window.onresize = () =>\n    d3.select('#nw-frame').call(view.resize, state);\n\n  // Menubar\n  const menubar = d3.select('#menubar');\n  menubar.selectAll('div,span,a').remove();\n  // Network view control\n  const menu = menubar.append('div')\n      .call(button.dropdownMenuButton, null, 'View control', 'primary')\n      .select('.dropdown-menu');\n  menu.append('a')\n      .classed('communityd', true)\n      .call(communityDialog.menuLink);\n  menu.append('a')\n      .classed('renamed', true)\n      .call(renameDialog.menuLink);\n  menu.append('a')\n      .classed('saveview', true)\n      .call(button.dropdownMenuItem, null, 'Save to local storage')\n      .on('click', function () {\n        if (state.data.edges.storeID) {\n          return idb.updateItem(state.data.edges.storeID, item => {\n            item.id = misc.uuidv4();\n            item.name = state.data.edges.name;\n            item.snapshot = state.snapshot();\n          })\n          .then(() => console.info('Snapshot saved'));\n        } else {\n          const data = state.export();\n          return idb.putItem(data.nodes)\n            .then(storeID => {\n              data.edges.reference.nodes = storeID;\n              return idb.putItem(data.edges);\n            })\n            .then(storeID => {\n              window.location = `network.html?id=${storeID}`;\n            });\n        }\n      });\n  menu.append('a')\n      .call(button.dropdownMenuItem, null, 'Export to JSON')\n      .on('click', () => {\n        const data = state.export();\n        // Delete local store information\n        delete data.nodes.storeID;\n        delete data.edges.storeID;\n        delete data.edges.reference.nodes;\n        hfile.downloadJSON(data, data.edges.name);\n      });\n  if (state.data.nodes.storeID) {\n    // Node datagrid link\n    menubar.append('a')\n        .call(button.menuButtonLink, null, 'Node datagrid', 'outline-secondary')\n        .attr('href', `datagrid.html?id=${state.data.nodes.storeID}`)\n        .attr('target', '_blank');\n  }\n  // Control panel\n  menubar.append('a')\n      .call(button.menuButtonLink, null, 'Control panel', 'outline-secondary')\n      .attr('href', 'control.html')\n      .attr('target', '_blank');\n  // Fetch control\n  const ongoing = ['running', 'ready'].includes(state.data.edges.status);\n  if (ongoing) {\n    menubar.append('a')\n        .call(button.menuButtonLink, null, 'Refresh', 'outline-secondary')\n        .on('click', function () {\n          core.fetchProgress(state.data.edges.storeID)\n            .then(() => getGraph(state.data.edges.storeID))\n            .then(app);\n        });\n    menubar.append('a')\n        .call(button.menuButtonLink, null, 'Abort server job', 'warning')\n        .attr('data-toggle', 'modal')\n        .attr('data-target', '#abort-dialog');\n    menubar.append('span')\n        .classed('progress', true)\n      .append('progress')\n        .attr('max', 100)\n        .attr('value', state.data.edges.progress)\n        .text(`${state.data.edges.progress}%`);\n  }\n  menubar.append('span')\n    .classed('title', true)\n    .text(state.data.edges.name);\n  menubar.append('span')\n      .classed('status', true)\n      .text(`(${state.data.edges.status} - ${state.data.edges.records.length} connections created in ${state.data.edges.execTime} sec.)`);\n\n  // Dialogs\n  const dialogs = d3.select('#dialogs');\n  dialogs.selectAll('div').remove();  // Clean up\n  dialogs.append('div')\n      .classed('communityd', true)\n      .call(communityDialog.body);\n  dialogs.append('div')\n      .classed('renamed', true)\n      .call(renameDialog.body, state.data.edges.name);\n  dialogs.append('div')\n      .classed('abortd', true)\n      .call(\n        modal.confirmDialog, 'abort-dialog',\n        'Are you sure you want to abort this calculation job?'\n      );\n  updateApp(state);\n}\n\n\nfunction updateApp(state) {\n  // Title\n  d3.select('title').text(state.data.edges.name);\n  d3.select('#menubar').select('.title').text(state.data.edges.name);\n  // Dialogs\n  const dialogs = d3.select('#dialogs');\n  // Rename dialog\n  dialogs.select('.renamed')\n      .call(renameDialog.updateBody, state)\n      .on('submit', function () {\n        state.data.edges.name = renameDialog.value(d3.select(this));\n        updateApp(state);\n      });\n  // Abort dialog\n  dialogs.select('.abortd')\n      .on('submit', function () {\n        core.fetchProgress(state.data.edges.storeID, 'abort')\n          .then(() => getGraph(state.data.edges.storeID))\n          .then(app);\n      });\n  // Community dialog\n  dialogs.select('.communityd')\n      .on('submit', function () {\n        const value = communityDialog.value(d3.select(this));\n        const nodeIds = state.data.nodes.records.map(e => e.index);\n        const edges = state.data.edges.records\n          .filter(e => e.weight >= state.networkThreshold);\n        const comm = community.communityDetection(\n          nodeIds, edges, {nulliso: value.nulliso}\n        );\n        const mapping = {\n          key: 'index',\n          field: misc.defaultFieldProperties(\n            [{key: value.name, format: 'd3_format', d3_format: 'd'}]\n          )[0],\n          mapping: comm\n        };\n        mapper.apply(state.data.nodes, mapping);\n        state.nodeColor = {\n          field: value.name, scale: 'ordinal', domain: null,\n          range: d3.schemeCategory10, unknown: '#cccccc'\n        };\n        $('#community-dialog').modal('hide');  // TODO:\n        d3.select('#loading-icon').style('display', 'none');\n        app(state.export());\n      });\n}\n\n\nexport default {\n  getGraph, app, updateApp\n};\n","\n/** @module common/KArray */\n\n\nclass KArray extends Array {\n  /**\n   * Return array of object filtered by given unique key\n   */\n  unique(key) {\n    return this.reduce((a, b) => {\n      if (a.find(e => e[key] === b[key]) === undefined) a.push(b);\n      return a;\n    }, new KArray());\n  }\n\n\n  /**\n   * Merge arrays\n   */\n  extend() {\n    return this.reduce((a, b) => {\n      Array.prototype.push.apply(a, b);\n      return a;\n    }, new KArray());\n  }\n\n\n  // Merge arrays(Asynchronous)\n  extendAsync() {\n    return Promise.all(this).then(res => {\n      return res.reduce((a, b) => {\n        Array.prototype.push.apply(a, b);\n        return a;\n      }, new KArray());\n    });\n  }\n\n  toArray() {\n    return Array.from(this);\n  }\n\n  toObject() {\n    const obj = {};\n    this.forEach(kv => {\n      obj[kv[0]] = kv[1];\n    });\n    return obj;\n  }\n}\n\nexport default KArray;\n","\n/** @module common/misc */\n\nimport d3 from 'd3';\n\nimport KArray from './KArray.js';\n\n\nfunction defaultFieldProperties(fields) {\n  return fields.map(e => {\n    if (!e.hasOwnProperty('name')) e.name = e.key;\n    if (!e.hasOwnProperty('visible')) e.visible = true;\n    if (e.hasOwnProperty('d3_format')) e.format = 'd3_format';\n    if (!e.hasOwnProperty('format')) e.format = 'raw';\n    return e;\n  });\n}\n\n\nfunction sortType(fmt) {\n  if (['numeric', 'd3_format'].includes(fmt)) return 'numeric';\n  if (['text', 'compound_id'].includes(fmt)) return 'text';\n  return 'none';\n}\n\n\n/**\n * Format number\n * @param {object} value - value\n * @param {string} type - si | scientific | rounded | raw\n */\nfunction formatNum(value, d3format) {\n  if (value === undefined || value === null || Number.isNaN(value)) return '';\n  return value == parseFloat(value) ? d3.format(d3format)(value) : value;\n}\n\n\nfunction partialMatch(query, target) {\n  if (target === undefined || target === null || target === '') return false;\n  return target.toString().toUpperCase()\n    .indexOf(query.toString().toUpperCase()) !== -1;\n}\n\n\nfunction URLQuery() {\n  return KArray.from(window.location.search.substring(1).split(\"&\"))\n    .map(e => e.split('=')).toObject();\n}\n\n\n// Ref. https://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript\nfunction uuidv4() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n    var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\n    return v.toString(16);\n  });\n}\n\n\nexport default {\n  defaultFieldProperties, sortType, formatNum, partialMatch, URLQuery, uuidv4\n};\n","\n/** @module common/idb */\n\nimport Dexie from 'Dexie';\n\nimport {default as misc} from './misc.js';\n\n\nconst schema = {\n  items: 'storeID, dataType, created'\n};\n\nlet idb = new Dexie('Store');\nidb.version(1).stores(schema);\n\n\n/**\n * Returns all data store items\n * @return {array} data store objects\n */\nfunction getAllItems() {\n  return idb.items\n    .orderBy('created')\n    .reverse()\n    .toArray();\n}\n\n\n/**\n * Get data store items by data type\n * @param {string} type - 'nodes' or 'edges'\n * @return {array} data store objects\n */\nfunction getItemsByDataType(type) {\n  return idb.items\n    .where('dataType')\n    .equals(type)\n    .reverse()\n    .sortBy('created')\n    .catch(err => {\n      console.error(`IDBError: Unexpected dataType: ${type}`, err);\n    });\n}\n\n\n/**\n * Get data store items by store ID\n * @param {string} storeID - store ID\n * @return {array} data store object\n */\nfunction getItemByID(storeID) {\n  return idb.items\n    .where('storeID')\n    .equals(storeID)\n    .first()\n    .catch(err => {\n      console.error(`IDBError: Unexpected table ID: ${storeID}`, err);\n    });\n}\n\n\n/**\n * Delete a data object from the store\n * @param {string} storeID - store ID\n * @return {integer} - number of deleted items\n */\nfunction deleteItem(storeID) {\n  return idb.items\n    .where('storeID')\n    .equals(storeID)\n    .delete();\n}\n\n\n/**\n * Insert a data object to the store\n * @param {object} data - data\n * @return {string} - storeID if sucessfully added\n */\nfunction putItem(data) {\n  if (!data.storeID) {\n    data.storeID = misc.uuidv4();\n  }\n  return idb.items.put(data);\n}\n\n\n/**\n * Update data object in the store\n * @param {string} storeID - store ID\n * @param {function} updateFunc - update function\n * @return {integer} - number of updated items\n */\nfunction updateItem(storeID, updateFunc) {\n  return idb.items\n    .where('storeID')\n    .equals(storeID)\n    .modify(updateFunc)\n    .catch(err => {\n      console.error('IDBError: Update failed', err);\n    });\n}\n\n\n/**\n * Delete all data store\n * Try this before dealing with local db issues\n */\nfunction reset() {\n  return idb.delete().then(() => {\n    idb = new Dexie('Store');\n    idb.version(1).stores(schema);\n  });\n}\n\n\nexport default {\n  getAllItems, getItemsByDataType, getItemByID,\n  deleteItem, putItem, updateItem, reset\n};\n","\n/** @module common/fetcher */\n\n\nconst baseURL = '';\n\nfunction get(url, query={}) {\n  const isEmpty = Object.keys(query).length;\n  const q = isEmpty ? `?query=${JSON.stringify(query)}` : '';\n  return fetch(\n    `${baseURL}${url}${q}`,\n    {\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\nfunction json(response) {\n  return response.json();\n}\n\nfunction text(response) {\n  return response.text();\n}\n\nfunction blob(response) {\n  return response.blob();\n}\n\nfunction post(url, formdata) {\n  return fetch(\n    `${baseURL}${url}`,\n    {\n      method: 'POST',\n      body: formdata,\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\n\nfunction error(err) {\n  console.error(err);\n  return null;\n}\n\n\nexport default {\n  get, json, text, blob, post, error\n};\n","\n/** @module common/core */\n\nimport {default as idb} from './idb.js';\nimport {default as fetcher} from './fetcher.js';\nimport {default as misc} from './misc.js';\n\n\nfunction fetchProgress(storeID, command='update') {\n  return idb.getItemByID(storeID)\n    .then(data => {\n      if (!data) return Promise.reject(`Store: ${storeID} is not available`);\n      if (!['ready', 'running'].includes(data.status)) return;\n      const query = {id: data.reference.workflow, command: command};\n      return fetcher.get('progress', query)\n        .then(fetcher.json)\n        .then(data => {\n          if (data.status === 'failure') {  // No data found on server\n            return idb.updateItem(storeID, item => {\n              item.status = 'failure';\n            });\n          }\n          return idb.updateItem(storeID, item => {\n            item.status = data.status;\n            item.progress = data.progress;\n            item.execTime = data.execTime;\n            item.fields = misc.defaultFieldProperties(data.fields);\n            item.records = data.records;\n          });\n        });\n    });\n}\n\n\nexport default {\n  fetchProgress\n};\n","\n/** @module component/button */\n\nimport d3 from 'd3';\n\n\nfunction buttonBox(selection, id, label, type) {\n  selection\n      .classed('form-group', true)\n      .classed('mb-1', true)\n    .append('button')\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed('btn-sm', true)\n      .attr('id', id)\n      .text(label);\n}\n\n\nfunction menuButton(selection, id, label, type) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .attr('id', id)\n      .text(label);\n}\n\n\nfunction menuButtonLink(selection, id, label, type) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .attr('role', 'button')\n      .attr('href', '#')\n      .attr('id', id)\n      .text(label);\n}\n\n\nfunction menuModalLink(selection, id, label, type, target) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .attr('role', 'button')\n      .attr('data-toggle', 'modal')\n      .attr('data-target', `#${target}`)\n      .attr('id', id)\n      .text(label);\n}\n\n\nfunction dropdownMenuButton(selection, id, label, type) {\n  selection\n      .classed('btn-group', true)\n      .classed('mr-1', true)\n      .attr('id', id);\n  selection.append('button')\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed('btn-sm', true)\n      .classed('dropdown-toggle', true)\n      .attr('data-toggle', 'dropdown')\n      .text(label);\n  selection.append('div')\n      .classed('dropdown-menu', true);\n}\n\n\nfunction dropdownMenuItem(selection, id, label) {\n  selection.classed('dropdown-item', true)\n      .attr('id', id)\n      .text(label);\n}\n\nfunction dropdownMenuModal(selection, id, label, target) {\n  selection.classed('dropdown-item', true)\n      .attr('id', id)\n      .attr('data-toggle', 'modal')\n      .attr('data-target', `#${target}`)\n      .text(label);\n}\n\n\nfunction dropdownMenuFile(selection, id, label, accept) {\n  selection.classed('dropdown-item', true)\n      .attr('id', id)\n      .text(label)\n      .on('click', function () {\n        d3.select(this).select('input').node().click();\n      })\n    .append('form')\n      .style('display', 'none')\n    .append('input')\n      .attr('type', 'file')\n      .attr('accept', accept);\n}\n\n\nfunction dropdownMenuFileValue(selection) {\n  return selection.select('input').node().files[0];\n}\n\n\nexport default {\n  buttonBox, menuButton, menuButtonLink, menuModalLink,\n  dropdownMenuButton, dropdownMenuItem, dropdownMenuModal,\n  dropdownMenuFile, dropdownMenuFileValue\n};\n","\n/** @module common/scale */\n\n\nimport d3 from 'd3';\n\n\nconst presets = [\n  {key: 'activity', name: 'Activity', scale: 'log', domain: [1e-4, 1e-6]},\n  {key: 'percent', name: 'Percent', scale: 'linear', domain: [0, 100]},\n  {key: 'tf', name: 'True/False', scale: 'quantize', domain: [1, 0]},\n  {key: 'mw', name: 'MW', scale: 'linear', domain: [200, 600]},\n  {key: 'logp', name: 'LogP', scale: 'linear', domain: [-2, 8]}\n];\n\n\nconst types = [\n  {key: 'linear', name: 'Linear', func: d3.scaleLinear()},\n  {key: 'log', name: 'Log', func: d3.scaleLog()},\n  {key: 'quantize', name: 'Quantize', func: d3.scaleQuantize()},\n  {key: 'ordinal', name: 'Ordinal', func: d3.scaleOrdinal()}  // not for sizeScale\n];\n\n\nconst colorPalettes = [\n  {key: 'aquamarine', name: 'Aquamarine',\n   range: ['#778899', '#7fffd4'], unknown: '#696969'},\n  {key: 'chartreuse', name: 'Chartreuse',\n   range: ['#778899', '#7fff00'], unknown: '#696969'},\n  {key: 'salmon', name: 'Salmon',\n   range: ['#778899', '#fa8072'], unknown: '#696969'},\n  {key: 'violet', name: 'Violet',\n   range: ['#778899', '#ee82ee'], unknown: '#696969'},\n  {key: 'temperature', name: 'Temperature',\n   range: ['#87ceeb', '#fff5ee', '#fa8072'], unknown: '#696969'},\n  {key: 'spectrum', name: 'Spectrum',\n   range: ['#6495ed', '#ccff66', '#ffa500'], unknown: '#696969'}\n];\n\n\n// TODO: Remove gray (for unknown) from categorical 20 and 40\nconst colorRangeTypes = [\n  {key: 'continuous', name: 'Continuous', size: 2},\n  {key: 'two-piece', name: 'Two-piece', size: 3},\n  {key: 'category10', name: 'Category 10', size: 10,\n   range: d3.schemeCategory10, unknown: '#cccccc'},\n  {key: 'category20', name: 'Category 20', size: 20,\n   range: d3.schemeCategory20, unknown: '#cccccc'},\n  {key: 'category40', name: 'Category 40', size: 40,\n   range: d3.schemeCategory20b.concat(d3.schemeCategory20c), unknown: '#cccccc'}\n];\n\n\nfunction scaleFunction(attr) {\n  let sf = types.find(e => e.key == attr.scale).func;\n  let domain = attr.domain;\n  if (attr.range.length == 3) {\n    const mid = (parseFloat(attr.domain[0]) + parseFloat(attr.domain[1])) / 2;\n    domain = [attr.domain[0], mid, attr.domain[1]];\n  }\n  if (attr.scale !== 'ordinal') {\n    sf = sf.domain(domain);\n  }\n  sf = sf.range(attr.range);\n  if (['linear', 'log'].includes(attr.scale)) {\n    sf = sf.clamp(true);\n  }\n  return d => {\n    if (d === '' || typeof d === 'undefined' || d === null) {\n      return attr.unknown;  // invalid values\n    }\n    if (attr.scale !== 'ordinal' && parseFloat(d) != d) {\n      return attr.unknown;  // texts\n    }\n    if (attr.scale === 'log' && d <= 0) {\n      return attr.unknown;  // negative values in log scale\n    }\n    const result = sf(d);\n    if (result === undefined) {\n      return attr.unknown;  // TODO: specify unexpected behavior\n    }\n    return result;\n  };\n}\n\n\nexport default {\n  presets, types, colorPalettes, colorRangeTypes,\n  scaleFunction\n};\n","\n/** @module dialog/community */\n\n\nimport {default as button} from '../component/button.js';\nimport {default as box} from '../component/formBox.js';\nimport {default as modal} from '../component/modal.js';\n\n\nconst id = 'community-dialog';\nconst title = 'Comunity detection';\n\n\nfunction menuLink(selection) {\n  selection.call(button.dropdownMenuModal, 'community', title, id);\n}\n\n\nfunction body(selection) {\n  const dialog = selection.call(modal.submitDialog, id, title);\n  // Name\n  dialog.select('.modal-body').append('div')\n      .classed('name', true)\n      .call(box.textBox, 'comm-name', 'New name', 40, 'comm_');\n  // Assign null to isolated nodes\n  dialog.select('.modal-body').append('div')\n      .classed('nulliso', true)\n      .call(box.checkBox, 'comm-nulliso', 'Assign null to isolated nodes', true);\n}\n\n\nfunction value(selection) {\n  return {\n    name: box.textBoxValue(selection.select('.name')),\n    nulliso: box.checkBoxValue(selection.select('.nulliso'))\n  };\n}\n\n\nexport default {\n  menuLink, body, value\n};\n","\n/** @module dialog/rename */\n\n\nimport {default as button} from '../component/button.js';\nimport {default as box} from '../component/formBox.js';\nimport {default as modal} from '../component/modal.js';\n\n\nconst id = 'rename-dialog';\nconst title = 'Rename view';\n\n\nfunction menuLink(selection) {\n  selection.call(button.dropdownMenuModal, 'rename', title, id);\n}\n\n\nfunction body(selection, name) {\n  selection.call(modal.submitDialog, id, title)\n    .select('.modal-body').append('div')\n      .classed('rename', true)\n      .call(box.textBox, 'rename', 'New name', 40, name);\n}\n\n\nfunction updateBody(selection, state) {\n  selection.select('.rename')\n      .call(box.updateTextBox, state.data.name);\n}\n\n\nfunction value(selection) {\n  return box.textBoxValue(selection.select('.rename'));\n}\n\n\nexport default {\n  menuLink, body, updateBody, value\n};\n","\n/** @module network/communityDetection */\n\nimport jLouvain from 'jLouvain';\n\n\nexport function communityDetection(nodes, edges, option) {\n  // TODO: partition resolution setting\n  // TODO: Error at edges.length 0\n  if (!edges.length) {\n    const community = {};\n    nodes.forEach(e => { community[e] = option.nulliso ? null : e; });\n    return community;\n  }\n  const clusters = {};\n  const community = jLouvain().nodes(nodes).edges(edges)();\n  Object.entries(community).forEach(e => {\n    if (!clusters.hasOwnProperty(e[1])) {\n      clusters[e[1]] = [];\n    }\n    clusters[e[1]].push(e[0]);\n  });\n  // Sort by cluster size\n  Object.entries(clusters)\n    .sort((a, b) => a[1].length < b[1].length)\n    .forEach((cluster, i) => {\n      if (cluster[1].length === 1) {\n        community[cluster[1][0]] = option.nulliso ? null : i;\n      } else {\n        cluster[1].forEach(e => {\n          community[e] = i;\n        });\n      }\n    });\n  return community;\n}\n\n\nexport default {\n  communityDetection\n};\n","\n/** @module network/state */\n\nimport d3 from 'd3';\n\nimport {default as legacy} from '../common/legacySchema.js';\nimport {default as misc} from '../common/misc.js';\n\n\nexport default class NetworkState {\n  constructor(data, width, height) {\n    // View modes\n\n    // Focused view mode (num of nodes displayed are less than the thld)\n    // Show node contents\n    // Disable smooth transition\n    this.focusedViewThreshold = 100;\n    this.enableFocusedView = true;\n    this.focusedView = false;\n    // Overlook view mode (num of nodes displayed are less than the thld)\n    // Hide edges\n    this.overlookViewThreshold = 500;\n    this.enableOverlookView = true;\n    this.overlookView = false;\n\n    // Import from legacy format data\n    this.data = legacy.convertNetwork(data);\n\n    this.nodes = JSON.parse(JSON.stringify(this.data.nodes.records));  // Working copy\n    this.edges = JSON.parse(JSON.stringify(this.data.edges.records));  // Working copy\n\n    // Adjacency\n    // Assuming that the network is undirected graph and\n    // source index < target index\n    this.nodes.forEach(n => {\n      n.adjacency = [];\n    });\n    this.edges.forEach((e, i) => {\n      e.num = i;  // e.index will be overwritten by d3-force\n      this.nodes[e.source].adjacency.push([e.target, i]);\n      this.nodes[e.target].adjacency.push([e.source, i]);\n    });\n\n    // Snapshot\n    const snp = this.data.edges.snapshot || {\n      nodeColor: {}, nodeSize: {}, nodeLabel: {}, nodeLabelColor: {},\n      edgeWidth: {}, edgeLabel: {}\n    };\n\n    // Node attributes\n    // this.nodeContentVisible = snp.nodeContentVisible || true;\n\n    // nodeColor\n    this.nodeColor = {};\n    this.nodeColor.field = snp.nodeColor.field || null;\n    this.nodeColor.scale = snp.nodeColor.scale || 'linear';\n    this.nodeColor.domain = snp.nodeColor.domain || [0, 1];\n    this.nodeColor.range = snp.nodeColor.range || ['#7fffd4', '#7fffd4'];\n    this.nodeColor.unknown = snp.nodeColor.unknown || ['#7fffd4'];\n\n    // nodeSize\n    this.nodeSize = {};\n    this.nodeSize.field = snp.nodeSize.field || null;\n    this.nodeSize.scale = snp.nodeSize.scale || 'linear';\n    this.nodeSize.domain = snp.nodeSize.domain || [1, 1];\n    this.nodeSize.range = snp.nodeSize.range || [40, 40];\n    this.nodeSize.unknown = snp.nodeSize.unknown || 40;\n\n    // nodeLabel\n    this.nodeLabel = {};\n    this.nodeLabel.text = snp.nodeLabel.text || null;\n    this.nodeLabel.size = snp.nodeLabel.size || 12;\n    this.nodeLabel.visible = snp.nodeLabel.visible || false;\n\n    // nodeLabelColor\n    this.nodeLabelColor = {};\n    this.nodeLabelColor.field = snp.nodeLabelColor.field || null;\n    this.nodeLabelColor.scale = snp.nodeLabelColor.scale || 'linear';\n    this.nodeLabelColor.domain = snp.nodeLabelColor.domain || [1, 1];\n    this.nodeLabelColor.range = snp.nodeLabelColor.range || ['#7fffd4', '#7fffd4'];\n    this.nodeLabelColor.unknown = snp.nodeLabelColor.unknown || ['#333333'];\n\n    // Edge attributes\n    // this.edgeVisible = snp.edgeVisible || true;\n    this.networkThresholdCutoff = data.edges.query.params.threshold;\n    this.networkThreshold = snp.networkThreshold || data.edges.query.params.threshold;\n\n    // edgeWidth\n    this.edgeWidth = {};\n    this.edgeWidth.scale = snp.edgeWidth.scale || 'linear';\n    this.edgeWidth.domain = snp.edgeWidth.domain || [0.5, 1];\n    this.edgeWidth.range = snp.edgeWidth.range || [1, 5];\n    this.edgeWidth.unknown = snp.edgeWidth.unknown || 1;\n\n    // edgeLabel\n    this.edgeLabel = {};\n    this.edgeLabel.size = snp.edgeLabel.size || 12;\n    this.edgeLabel.visible = snp.edgeLabel.visible || false;\n\n    // Transform\n    this.transform = snp.fieldTransform || {x: 0, y: 0, k: 1};\n\n    // Event listener\n    this.zoomListener = null;\n    this.dragListener = null;\n\n    // Update notifier\n    this.updateComponentNotifier = null;\n    this.updateNodeNotifier = null;\n    this.updateEdgeNotifier = null;\n    this.updateNodeAttrNotifier = null;\n    this.updateEdgeAttrNotifier = null;\n    // Snapshot\n    this.snapShotNotifier = null;\n    // Zoom control\n    this.fitNotifier = null;\n    // Force control\n    this.setForceNotifier = null;\n    this.stickNotifier = null;\n    this.relaxNotifier = null;\n    this.restartNotifier = null;\n\n    // Working memory\n    this.forceField = {top: 0, right: width, bottom: height, left: 0};\n    this.viewBox = {top: 0, right: width, bottom: height, left: 0};\n    this.focusArea = {};\n    this.boundary = {};\n    this.prevTransform = {\n      x: this.transform.x, y: this.transform.y, k: this.transform.k\n    };\n\n    if (snp.coords) {\n      this.simulationOnLoad = false;\n      // Set default state\n      this.setAllCoords(snp.coords);\n      this.setFocusArea();\n      this.setBoundary();\n    } else {\n      this.simulationOnLoad = true;\n    }\n  }\n\n  setBoundary() {\n    const xs = this.nodes.map(e => e.x);\n    const ys = this.nodes.map(e => e.y);\n    this.boundary.top = Math.min.apply(null, ys);\n    this.boundary.left = Math.min.apply(null, xs);\n    this.boundary.bottom = Math.max.apply(null, ys);\n    this.boundary.right = Math.max.apply(null, xs);\n    // this.showBoundary(); // debug\n  }\n\n  setFocusArea() {\n    const tx = this.transform.x;\n    const ty = this.transform.y;\n    const tk = this.transform.k;\n    const margin = 50;\n    this.focusArea.top = (this.viewBox.top - ty) / tk - margin;\n    this.focusArea.left = (this.viewBox.left - tx) / tk - margin;\n    this.focusArea.bottom = (this.viewBox.bottom - ty) / tk + margin;\n    this.focusArea.right = (this.viewBox.right - tx) / tk + margin;\n    // this.showFocusArea();  // debug\n  }\n\n  setTransform(tx, ty, tk) {\n    this.transform.x = tx;\n    this.transform.y = ty;\n    this.transform.k = tk;\n    // this.showTransform(); // debug\n    this.setFocusArea();\n  }\n\n  setViewBox(width, height) {\n    this.viewBox.right = width;\n    this.viewBox.bottom = height;\n    // this.showViewBox();  // debug\n    this.setFocusArea();\n  }\n\n  setAllCoords(coordsList) {\n    this.nodes.forEach(n => {\n      n.x = coordsList[n.index].x;\n      n.y = coordsList[n.index].y;\n      // this.edges can be changed by forceSimulation so use adjacency\n      n.adjacency.forEach(e => {\n        const nbr = e[0];\n        const edge = e[1];\n        if (n.index < nbr) {\n          this.edges[edge].sx = coordsList[n.index].x;\n          this.edges[edge].sy = coordsList[n.index].y;\n        } else {\n          this.edges[edge].tx = coordsList[n.index].x;\n          this.edges[edge].ty = coordsList[n.index].y;\n        }\n      });\n    });\n    this.setBoundary();\n  }\n\n  setCoords(n, x, y) {\n    this.nodes[n].x = x;\n    this.nodes[n].y = y;\n    this.nodes[n].adjacency.forEach(e => {\n      const nbr = e[0];\n      const edge = e[1];\n      if (n < nbr) {\n        this.edges[edge].sx = x;\n        this.edges[edge].sy = y;\n      } else {\n        this.edges[edge].tx = x;\n        this.edges[edge].ty = y;\n      }\n    });\n    this.setBoundary();\n  }\n\n  nodesToRender() {\n    return this.nodes.filter(\n      e => e.y > this.focusArea.top && e.x > this.focusArea.left\n        && e.y < this.focusArea.bottom && e.x < this.focusArea.right\n    );\n  }\n\n  edgesToRender() {\n    return this.edges.filter(\n      e => e.weight >= this.networkThreshold\n        && this.focusArea.top < Math.max(e.sy, e.ty)\n        && this.focusArea.left < Math.max(e.sx, e.tx)\n        && this.focusArea.bottom > Math.min(e.sy, e.ty)\n        && this.focusArea.right > Math.min(e.sx, e.tx)\n    );\n  }\n\n  snapshot() {\n    return {\n      nodeColor: this.nodeColor,\n      nodeSize: this.nodeSize,\n      nodeLabel: this.nodeLabel,\n      nodeLabelColor: this.nodeLabelColor,\n      edgeWidth: this.edgeWidth,\n      edgeLabel: this.edgeLabel,\n      networkThreshold: this.networkThreshold,\n      networkThresholdCutoff: this.networkThresholdCutoff,\n      fieldTransform: this.transform,\n      coords: this.nodes.map(e => ({x: e.x, y: e.y}))\n    };\n  }\n\n  export() {\n    this.data.edges.id = misc.uuidv4();\n    this.data.edges.snapshot = this.snapshot();\n    return JSON.parse(JSON.stringify(this.data));\n  }\n\n  showTransform() {\n    d3.select('#debug-transform')\n      .text(JSON.stringify(this.transform));\n  }\n\n  showBoundary() {\n    d3.select('#debug-boundary')\n      .text(JSON.stringify(this.boundary));\n  }\n\n  showFocusArea() {\n    d3.select('#debug-focusarea')\n      .text(JSON.stringify(this.focusArea));\n  }\n\n  showViewBox() {\n    d3.select('#debug-viewbox')\n      .text(JSON.stringify(this.viewBox));\n  }\n}\n","\n/** @module network */\n\nimport d3 from 'd3';\n\nimport {default as core} from './common/core.js';\nimport {default as hfile} from './common/file.js';\nimport {default as misc} from './common/misc.js';\n\nimport {default as button} from './component/button.js';\n\nimport {default as view} from './network/view.js';\nimport {default as networkApp} from './network/networkApp.js';\n\n\nfunction run() {\n  // TODO: offline mode flags\n  const localFile = document.location.protocol !== \"file:\";  // TODO\n  const offLine = 'onLine' in navigator && !navigator.onLine;  // TODO\n  const storeID = misc.URLQuery().id || null;\n  const dataURL = misc.URLQuery().location || null;\n  if (storeID) {\n    // Load from IndexedDB store\n    return core.fetchProgress(storeID, 'update')\n      .then(() => networkApp.getGraph(storeID))\n      .then(networkApp.app);\n  } else if (dataURL) {\n    // Fetch via HTTP\n    return hfile.fetchJSON(dataURL)\n      .then(networkApp.app);\n  } else {\n    // New network\n    const menubar = d3.select('#menubar');\n    menubar.selectAll('div,a').remove();\n    const menu = menubar.append('div')\n        .call(button.dropdownMenuButton, null, '+ New network', 'primary')\n        .select('.dropdown-menu');\n    menu.append('a')\n        .call(button.dropdownMenuFile, 'import', 'Import view', '.gfc,.gfr,.json,.gz')\n        .on('change', function () {\n          const file = button.dropdownMenuFileValue(d3.select(this));\n          hfile.loadJSON(file).then(networkApp.app);\n        });\n    menubar.append('a')\n        .call(button.menuButton, null, 'Control panel', 'outline-secondary')\n        .attr('href', 'control.html')\n        .attr('target', '_blank');\n  }\n}\n\n\nexport default {\n  view, run\n};\n"],"names":["readFile","file","sizeLimit","blob","Promise","resolve","reject","reader","FileReader","truncated","slice","onload","event","target","result","onerror","error","readAsArrayBuffer","readAsText","parseJSON","data","compressed","text","pako","inflate","to","JSON","parse","downloadDataFile","name","url","window","URL","createObjectURL","Blob","a","document","createElement","download","href","dispatchEvent","MouseEvent","view","bubbles","cancelable","e","updateNodes","selection","records","showStruct","nodes","selectAll","d","index","exit","remove","entered","enter","append","attr","call","updateNodeCoords","svgWidth","svgHeight","merged","merge","select","html","structure","updateEdges","edges","source","style","weight","updateEdgeCoords","updateNodeAttrs","state","each","color","scale","scaleFunction","nodeColor","field","size","nodeSize","labelColor","nodeLabelColor","d3","this","nodeLabel","fields","find","key","format","misc","formatNum","d3_format","parseFloat","parseInt","visible","updateEdgeAttrs","edgeWidth","edgeLabel","x","y","sx","sy","tx","ty","updateAttrs","moveNode","moveEdge","resize","area","node","setViewBox","offsetWidth","offsetHeight","component","resizeViewBox","singleToMulti","mapping","newMapping","Object","entries","forEach","m","created","dialogBase","id","classed","updateTextBox","value","property","updateTextareaBox","updateCheckBox","checked","updateNumberBox","selectBoxItems","items","options","updateSelectBox","checklistBoxItems","listitems","form","updateChecklistBox","values","includes","updateRangeBox","range","updateColorScaleBox","rangeArray","length","updateColorRangeGroup","lbox","scaledef","colorRangeTypes","on","selectBoxValue","p","colorPalettes","t","rbox","dispatch","updateScaleBoxGroup","domain","presets","isLog","rangeBoxValue","invalid","isNaN","mainControlBox","button","buttonBox","viewModes","box","checkBox","enableFocusedView","enableOverlookView","thldGroup","numberBox","networkThresholdCutoff","networkThreshold","readonlyBox","forceBox","simulationOnLoad","updateMainControlBox","snapshotNotifier","fitNotifier","checkBoxValue","focusedView","updateComponentNotifier","overlookView","numberBoxValue","setForceNotifier","numEdges","filter","n","combinations","logD","Math","log10","stickNotifier","relaxNotifier","restartNotifier","nodeColorControlBox","selectBox","sortType","group","colorRangeGroup","scaleBoxGroup","types","updateNodeColorControlBox","updateNodeAttrNotifier","colorRangeGroupValue","scaleBoxGroupValue","nodeSizeControlBox","rangeBox","updateNodeSizeControlBox","nodeLabelControlBox","labelGroup","updateNodeLabelControlBox","edgeControlBox","widthGroup","updateEdgeControlBox","updateEdgeAttrNotifier","controlBoxFrame","navID","contentID","controlBoxNav","label","controlBoxItem","updateControlBox","dragListener","drag","move","setCoords","zoomListener","zoom","transform","k","prevTransform","xMoved","yMoved","zoomIn","setTransform","updateComponents","fit","viewBox","getBBox","viewBoxRatio","width","height","boundaryHeight","boundary","bottom","top","boundaryWidth","right","left","zoomIdentity","translate","showTemperature","simulation","alpha","isStopped","alphaMin","progress","end","coords","map","setAllCoords","stick","stop","fx","fy","interaction","unstick","active","relax","alphaTarget","forceDragListener","restart","setForce","forceEdges","force","links","v07_to_v08_nodes","json","columns","sort","dataType","dataTypeConv","schemaVersion","revision","status","statusConv","query","taskCount","searchCount","doneCount","searchDoneCount","resultCount","recordCount","execTime","startDate","responseDate","v10_nodes","reference","getGraph","storeID","idb","getItemByID","then","app","NetworkState","forceSimulation","networkViewFrame","networkView","setInteraction","activate","control","controlBox","onresize","menubar","menu","dropdownMenuButton","communityDialog","menuLink","renameDialog","dropdownMenuItem","updateItem","item","uuidv4","snapshot","console","info","export","putItem","location","hfile","downloadJSON","menuButtonLink","core","fetchProgress","dialogs","body","modal","confirmDialog","updateApp","updateBody","nodeIds","comm","community","communityDetection","nulliso","defaultFieldProperties","mapper","apply","schemeCategory10","unknown","$","KArray","Array","[object Object]","reduce","b","undefined","push","prototype","all","res","from","obj","kv","hasOwnProperty","fmt","d3format","Number","partialMatch","toString","toUpperCase","indexOf","URLQuery","search","substring","split","toObject","replace","c","r","random","schema","Dexie","version","stores","getAllItems","orderBy","reverse","toArray","getItemsByDataType","type","where","equals","sortBy","catch","err","first","deleteItem","delete","put","updateFunc","modify","reset","baseURL","get","q","keys","stringify","fetch","credentials","Error","statusText","response","post","formdata","method","command","workflow","fetcher","loadJSON","endsWith","fetchJSON","decoded","decodeURIComponent","arrayBuffer","compress","str","gzip","menuButton","menuModalLink","dropdownMenuModal","dropdownMenuFile","accept","click","dropdownMenuFileValue","files","func","scaleLinear","scaleLog","scaleQuantize","scaleOrdinal","schemeCategory20","schemeCategory20b","concat","schemeCategory20c","sf","mid","clamp","nodesToRender","numNodes","focusedViewThreshold","overlookViewThreshold","edgesToRender","datum","adjacency","num","tk","transition","duration","updateNodeNotifier","updateEdgeNotifier","mappingToTable","mp","keyField","entry","rcd","f","i","tableToMapping","table","ignore","Date","row","csvToMapping","csvString","lines","header","shift","now","headerIdx","h","line","fd","unique","message","base","footer","submitDialog","title","textBox","textBoxValue","textareaBox","rows","placeholder","textareaBoxValue","textareaBoxLines","min","max","step","fileInputBox","fileInputBoxValue","dialog","checklistBox","checklistBoxValue","colorScaleBox","stopPropagation","colorScaleBoxValue","arr","palettes","rangeTypes","scaleTypes","tabs","content","forceLink","distance","strength","forceManyBody","distanceMin","distanceMax","forceCollide","radius","forceCenter","forceX","forceY","option","clusters","jLouvain","cluster","Queued","In progress","Aborting","Aborted","Completed","Failure","datatable","connection","convertTable","_structure","_index","v08_nodes","$schema","convertNetwork","nodeFields","snp","fieldTransform","nodePositions","edge","column","nodeContent","nodeTableId","v07_to_v08_edges","nodesID","idx_converter","v08_graph","nodeContentVisible","edgeVisible","threshold","params","v10_edges","legacy","snapShotNotifier","forceField","focusArea","setFocusArea","setBoundary","xs","ys","coordsList","nbr","run","protocol","navigator","onLine","dataURL","networkApp"],"mappings":"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"}