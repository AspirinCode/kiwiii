{"version":3,"file":"kwprofile.js","sources":["../src/component/table.js","../src/common/misc.js","../src/common/fetcher.js","../src/component/button.js","../src/profile.js"],"sourcesContent":["\n/** @module component/table */\n\n// Simple tables\n// use dataGrid.js for interactive and smooth datatable\n\n\nimport d3 from 'd3';\n\nimport {default as misc} from '../common/misc.js';\n\n\nfunction render(selection, id, caption, fields, records) {\n  selection\n      .classed('table', true)\n      .classed('table-striped', true)\n      .classed('table-hover', true)\n      .attr('id', id);\n  if (caption) {\n    selection.append('caption').text(caption);\n  }\n  selection.append('thead').append('tr');\n  selection.append('tbody');\n  if (fields) {\n    selection.call(updateHeader, fields, records);\n  }\n}\n\n\nfunction updateHeader(selection, fields, records) {\n  const header = selection.select('thead tr')\n    .selectAll('th')\n      .data(fields);\n  header.exit().remove();\n  header.enter().append('th')\n      .text(d => d.name);\n  if (records) {\n    selection.call(updateContents, records, d => d.key, updateRowFunc(fields));\n  }\n}\n\n\nfunction updateContents(selection, records, keyFunc, rowFactory) {  // TODO: specify key\n  const rows = selection.select('tbody')\n    .selectAll('tr')\n      .data(records, keyFunc);\n  rows.exit().remove();\n  rows.enter().append('tr')\n    .merge(rows)\n      .each(function (d) {\n        d3.select(this).selectAll('td').remove();\n        d3.select(this).call(rowFactory, d);\n      });\n}\n\n\nfunction updateRowFunc(fields) {\n  return (selection, record) => {\n    fields.forEach(field => {\n      const value = record[field.key];\n      const cell = selection.append('td')\n        .classed('align-middle', true);\n      if (value === undefined) return;\n      if (field.format === 'd3_format') {\n        cell.text(misc.formatNum(value, field.d3_format));\n      }\n      else if (field.format === 'plot') {\n        cell.text('[plot]');\n      }\n      else if (field.format === 'image') {\n        cell.text('[image]');\n      }\n      else if (field.format === 'control') {\n        cell.call(value);\n      } else {\n        cell.text(value);\n      }\n    });\n  };\n}\n\n\nexport default {\n  render, updateHeader, updateContents\n};\n","\n/** @module common/misc */\n\nimport d3 from 'd3';\nimport _ from 'lodash';\n\n\nfunction defaultFieldProperties(fields) {\n  return fields.map(e => {\n    if (!e.hasOwnProperty('name')) e.name = e.key;\n    if (!e.hasOwnProperty('visible')) e.visible = true;\n    if (e.hasOwnProperty('d3_format')) e.format = 'd3_format';\n    if (!e.hasOwnProperty('format')) e.format = 'raw';\n    return e;\n  });\n}\n\n\nfunction sortType(fmt) {\n  if (['numeric', 'd3_format'].includes(fmt)) return 'numeric';\n  if (['text', 'compound_id'].includes(fmt)) return 'text';\n  return 'none';\n}\n\n\n/**\n * Format number\n * @param {object} value - value\n * @param {string} type - si | scientific | rounded | raw\n */\nfunction formatNum(value, d3format) {\n  if (value === undefined || value === null || Number.isNaN(value)) return '';\n  return value == parseFloat(value) ? d3.format(d3format)(value) : value;\n}\n\n\nfunction partialMatch(query, target) {\n  if (target === undefined || target === null || target === '') return false;\n  return target.toString().toUpperCase()\n    .indexOf(query.toString().toUpperCase()) !== -1;\n}\n\n\nfunction URLQuery() {\n  const pairs = window.location.search.substring(1).split(\"&\")\n    .map(e => e.split('='));\n  return _.fromPairs(pairs);\n}\n\n\n// Ref. https://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript\nfunction uuidv4() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n    var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\n    return v.toString(16);\n  });\n}\n\n\nexport default {\n  defaultFieldProperties, sortType, formatNum, partialMatch, URLQuery, uuidv4\n};\n","\n/** @module common/fetcher */\n\n\nconst baseURL = '';\n\nfunction get(url, query={}) {\n  const isEmpty = Object.keys(query).length;\n  const q = isEmpty ? `?query=${JSON.stringify(query)}` : '';\n  return fetch(\n    `${baseURL}${url}${q}`,\n    {\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\nfunction json(response) {\n  return response.json();\n}\n\nfunction text(response) {\n  return response.text();\n}\n\nfunction blob(response) {\n  return response.blob();\n}\n\nfunction post(url, formdata) {\n  return fetch(\n    `${baseURL}${url}`,\n    {\n      method: 'POST',\n      body: formdata,\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\n\nfunction error(err) {\n  console.error(err);\n  return null;\n}\n\n\nexport default {\n  get, json, text, blob, post, error\n};\n","\n/** @module component/button */\n\nimport d3 from 'd3';\n\n\nfunction buttonBox(selection, id, label, type) {\n  selection\n      .classed('form-group', true)\n      .classed('mb-1', true)\n    .append('button')\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed('btn-sm', true)\n      .attr('id', id)\n      .text(label);\n}\n\n\nfunction menuButton(selection, id, label, type) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .attr('id', id)\n      .text(label);\n}\n\n\nfunction menuButtonLink(selection, id, label, type) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .attr('role', 'button')\n      .attr('href', '#')\n      .attr('id', id)\n      .text(label);\n}\n\n\nfunction menuModalLink(selection, id, label, type, target) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .attr('id', id)\n      .attr('href', '#')\n      .attr('role', 'button')\n      .attr('data-toggle', 'modal')\n      .attr('data-target', `#${target}`)\n      .text(label);\n}\n\n\nfunction dropdownMenuButton(selection, id, label, type) {\n  selection\n      .classed('btn-group', true)\n      .classed('mr-1', true)\n      .attr('id', id);\n  selection.append('button')\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed('btn-sm', true)\n      .classed('dropdown-toggle', true)\n      .attr('data-toggle', 'dropdown')\n      .text(label);\n  selection.append('div')\n      .classed('dropdown-menu', true);\n}\n\n\nfunction dropdownMenuItem(selection, id, label) {\n  selection.classed('dropdown-item', true)\n      .attr('id', id)\n      .attr('href', '#')\n      .text(label);\n}\n\nfunction dropdownMenuModal(selection, id, label, target) {\n  selection.classed('dropdown-item', true)\n      .attr('id', id)\n      .attr('href', '#')\n      .attr('data-toggle', 'modal')\n      .attr('data-target', `#${target}`)\n      .text(label);\n}\n\n\nfunction dropdownMenuFile(selection, id, label, accept) {\n  selection.classed('dropdown-item', true)\n      .attr('id', id)\n      .attr('href', '#')\n      .text(label)\n      .on('click', function () {\n        d3.select(this).select('input').node().click();\n      })\n    .append('form')\n      .style('display', 'none')\n    .append('input')\n      .attr('type', 'file')\n      .attr('accept', accept);\n}\n\n\nfunction dropdownMenuFileValue(selection) {\n  return selection.select('input').node().files[0];\n}\n\n\nexport default {\n  buttonBox, menuButton, menuButtonLink, menuModalLink,\n  dropdownMenuButton, dropdownMenuItem, dropdownMenuModal,\n  dropdownMenuFile, dropdownMenuFileValue\n};\n","\n/** @module profile */\n\nimport d3 from 'd3';\n\nimport {default as misc} from './common/misc.js';\nimport {default as fetcher} from './common/fetcher.js';\n\nimport {default as button} from './component/button.js';\nimport {default as table} from './component/table.js';\n\n\nfunction updateChem(compoundID, resources) {\n  d3.select('title').text(compoundID);\n  const query = {\n    workflow: 'search',\n    targets: resources.filter(e => e.domain === 'chemical').map(e => e.id),\n    key: 'compound_id',\n    values: [compoundID]\n  };\n  return fetcher.get(query.workflow, query)\n    .then(fetcher.json)\n    .then(res => {\n      const rcd = res.records[0];\n      d3.select('#compoundid').html(rcd.compound_id);\n      d3.select('#compounddb').html(\n        resources.find(e => e.id === rcd.__source).name);\n      d3.select('#structure').html(rcd.structure);\n      const fields = misc.defaultFieldProperties([\n        {key: 'key'}, {key: 'value'}\n      ]);\n      const records = res.fields\n        .filter(e => !['structure', 'index', 'compound_id'].includes(e.key))\n        .map(e => ({ key: e.name, value: rcd[e.key] }));\n      d3.select('#properties')\n        .call(table.render, null, null, fields, records);\n      return rcd;\n    }, fetcher.error);\n}\n\n\nfunction updateChemAliases(resources, qrcd) {\n  const query = {\n    workflow: 'exact',\n    targets: resources.filter(e => e.domain === 'chemical').map(e => e.id),\n    queryMol: {\n      format: 'dbid',\n      source: qrcd.__source,\n      value: qrcd.compound_id\n    },\n    params: {ignoreHs: true}\n  };\n  return fetcher.get(query.workflow, query)\n    .then(fetcher.json)\n    .then(res => {\n      const fields = misc.defaultFieldProperties([\n        {key: 'compound_id'}, {key: 'database'}\n      ]);\n      const records = res.records\n        .filter(rcd => rcd.compound_id !== qrcd.compound_id ||\n                rcd.__source !== qrcd.__source)\n        .map(rcd => {\n          return {\n            compound_id: `<a href=\"profile.html?compound=${rcd.compound_id}\" target=\"_blank\">${rcd.compound_id}</a>`,\n            database: resources.find(e => e.id === rcd.__source).name\n          };\n        });\n      d3.select('#aliases')\n        .call(table.render, fields, records);\n    }, fetcher.error);\n}\n\n\nfunction updateActivities(compoundID, resources) {\n  // Prevent implicit submission\n  /* TODO: instant search component\n  document.getElementById('search')\n    .addEventListener('keypress', event => {\n      if (event.keyCode === 13) event.preventDefault();\n    });\n  d3.select('#search').on('keyup', function () {\n    const match = obj => Object.values(obj)\n      .some(e => fmt.partialMatch(d3form.value(this), e));\n    d3.select('#results tbody').selectAll('tr')\n      .style('visibility', d => match(d) ? null : 'hidden')\n      .style('position', d => match(d) ? null : 'absolute');\n  });\n  */\n  const query = {\n    workflow: 'profile',\n    compound_id: compoundID,\n    targets: resources.filter(e => e.domain === 'activity').map(e => e.id),\n  };\n  return fetcher.get(query.workflow, query)\n    .then(fetcher.json)\n    .then(res => {\n      const fields= misc.defaultFieldProperties([\n        {key: 'assay_id', name: 'Assay ID', format: 'text'},\n        {key: 'value_type', name: 'Value type', format: 'text'},\n        {key: 'value', name: 'Value', format: 'numeric'}\n      ]);\n      // TODO: use datagrid?\n      d3.select('#results').call(table.render, null, null, fields, res.records);\n    }, fetcher.error);\n}\n\n\nfunction run() {\n  // Menubar\n  const menubar = d3.select('#menubar');\n  menubar.append('a')\n      .call(button.menuButton, null, 'Control panel', 'outline-secondary')\n      .attr('href', 'control.html')\n      .attr('target', '_blank');\n\n  // Compound row\n  const chemDataRow = d3.select('#contents')\n    .append('div')\n      .classed('row', true);\n  const firstCol = chemDataRow.append('div')\n      .classed('col-sm-4', true);\n  firstCol.append('h5').text('Compound ID');\n  firstCol.append('div')\n      .attr('id', 'compoundid')\n      .classed('mb-2');\n  firstCol.append('h5').text('Database');\n  firstCol.append('div')\n      .attr('id', 'compounddb')\n      .classed('mb-2');\n  firstCol.append('h5').text('Structure');\n  firstCol.append('div')\n      .attr('id', 'structure')\n      .classed('mb-2');\n  const propCol = chemDataRow.append('div')\n      .classed('col-sm-4', true);\n  propCol.append('h5').text('Compound properties');\n  propCol.append('table')\n      .attr('id', 'properties')\n      .style('display', 'inline-block');\n  const aliaseCol = chemDataRow.append('div')\n      .classed('col-sm-4', true);\n  aliaseCol.append('h5').text('Compound structure aliases');\n  aliaseCol.append('table')\n      .attr('id', 'aliases')\n      .style('display', 'inline-block');\n  const compoundID = misc.URLQuery().compound || null;\n\n  // Result row\n  const resultRow = d3.select('#contents')\n    .append('div')\n      .classed('row', true);\n  const results = resultRow.append('div')\n      .classed('col-sm-12', true);\n  results.append('h5').text('Assay results and annotations');\n  results.append('input')\n      .classed('form-control', true)\n      .attr('type', 'text')\n      .attr('placeholder', 'Search')\n      .attr('id', 'search');\n  results.append('table')\n      .attr('id', 'results');\n\n  if (!compoundID) return;\n  // TODO: offline mode flags\n  const localFile = document.location.protocol !== \"file:\";\n  const offLine = 'onLine' in navigator && !navigator.onLine;\n  return fetcher.get('schema')\n    .then(fetcher.json)\n    .then(schema => {\n      console.info('Off-line mode is disabled for debugging');\n      return Promise.all([\n        updateChem(compoundID, schema.resources)\n          .then(qrcd => updateChemAliases(schema.resources, qrcd)),\n        updateActivities(compoundID, schema.resources)\n      ]);\n    }, () => {\n      console.info('Server did not respond');\n    });\n}\n\n\nexport default {\n  run\n};\n"],"names":["updateHeader","selection","fields","records","header","select","selectAll","data","exit","remove","enter","append","text","d","name","call","updateContents","key","record","forEach","field","value","cell","classed","undefined","format","misc","formatNum","d3_format","updateRowFunc","keyFunc","rowFactory","rows","merge","each","d3","this","defaultFieldProperties","map","e","hasOwnProperty","visible","sortType","fmt","includes","d3format","Number","isNaN","parseFloat","partialMatch","query","target","toString","toUpperCase","indexOf","URLQuery","pairs","window","location","search","substring","split","_","fromPairs","uuidv4","replace","c","r","Math","random","baseURL","get","url","q","Object","keys","length","JSON","stringify","fetch","credentials","then","res","status","Promise","reject","Error","statusText","resolve","json","response","blob","post","formdata","method","body","error","err","console","buttonBox","id","label","type","attr","menuButton","menuButtonLink","menuModalLink","dropdownMenuButton","dropdownMenuItem","dropdownMenuModal","dropdownMenuFile","accept","on","node","click","style","dropdownMenuFileValue","files","render","caption","run","button","chemDataRow","firstCol","propCol","aliaseCol","compoundID","compound","results","document","protocol","navigator","onLine","fetcher","schema","info","all","resources","workflow","targets","filter","domain","values","rcd","html","compound_id","find","__source","structure","table","updateChem","qrcd","queryMol","source","params","ignoreHs","database","updateChemAliases","updateActivities"],"mappings":"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"}