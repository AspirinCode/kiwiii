{"version":3,"file":"kwprofile.js","sources":["../src/component/table.js","../src/common/KArray.js","../src/common/misc.js","../src/common/fetcher.js","../src/component/button.js","../src/profile.js"],"sourcesContent":["\n/** @module component/table */\n\n// Simple tables\n// use dataGrid.js for interactive and smooth datatable\n\n\nimport d3 from 'd3';\n\nimport {default as misc} from '../common/misc.js';\n\n\nfunction render(selection, id, caption, fields, records) {\n  selection\n      .classed('table', true)\n      .classed('table-striped', true)\n      .classed('table-hover', true)\n      .attr('id', id);\n  if (caption) {\n  selection.append('caption')\n      .text(caption);\n  }\n  selection.append('thead')\n    .append('tr');\n  selection.append('tbody');\n  if (fields) {\n    selection.call(updateHeader, fields, records);\n  }\n}\n\n\nfunction updateHeader(selection, fields, records) {\n  const header = selection.select('thead tr')\n    .selectAll('th')\n      .data(fields);\n  header.exit().remove();\n  header.enter()\n    .append('th')\n      .text(d => d.name);\n  if (records) {\n    selection.call(updateContents, records, d => d.key, updateRowFunc(fields));\n  }\n}\n\n\nfunction updateContents(selection, records, keyFunc, rowFactory) {  // TODO: specify key\n  const rows = selection.select('tbody')\n    .selectAll('tr')\n      .data(records, keyFunc);\n  rows.exit().remove();\n  rows.enter()\n    .append('tr')\n    .merge(rows)\n    .each(function (d) {\n      d3.select(this)\n        .selectAll('td').remove();\n      d3.select(this)\n        .call(rowFactory, d);\n    });\n}\n\n\nfunction updateRowFunc(fields) {\n  return (selection, record) => {\n    fields.forEach(field => {\n      const value = record[field.key];\n      const cell = selection.append('td')\n        .classed('align-middle', true);\n      if (value === undefined) return;\n      if (field.format === 'd3_format') {\n        cell.text(misc.formatNum(value, field.d3_format));\n      }\n      else if (field.format === 'plot') {\n        cell.text('[plot]');\n      }\n      else if (field.format === 'image') {\n        cell.text('[image]');\n      }\n      else if (field.format === 'control') {\n        cell.call(value);\n      } else {\n        cell.text(value);\n      }\n    });\n  };\n}\n\n\nexport default {\n  render, updateHeader, updateContents\n};\n","\n/** @module common/KArray */\n\n\nclass KArray extends Array {\n  /**\n   * Return array of object filtered by given unique key\n   */\n  unique(key) {\n    return this.reduce((a, b) => {\n      if (a.find(e => e[key] === b[key]) === undefined) a.push(b);\n      return a;\n    }, new KArray());\n  }\n\n\n  /**\n   * Merge arrays\n   */\n  extend() {\n    return this.reduce((a, b) => {\n      Array.prototype.push.apply(a, b);\n      return a;\n    }, new KArray());\n  }\n\n\n  // Merge arrays(Asynchronous)\n  extendAsync() {\n    return Promise.all(this).then(res => {\n      return res.reduce((a, b) => {\n        Array.prototype.push.apply(a, b);\n        return a;\n      }, new KArray());\n    });\n  }\n\n  toArray() {\n    return Array.from(this);\n  }\n\n  toObject() {\n    const obj = {};\n    this.forEach(kv => {\n      obj[kv[0]] = kv[1];\n    });\n    return obj;\n  }\n}\n\nexport default KArray;\n","\n/** @module common/misc */\n\nimport d3 from 'd3';\n\nimport KArray from './KArray.js';\n\n\nfunction defaultFieldProperties(fields) {\n  return fields.map(e => {\n    if (!e.hasOwnProperty('name')) e.name = e.key;\n    if (!e.hasOwnProperty('visible')) e.visible = true;\n    if (e.hasOwnProperty('d3_format')) e.format = 'd3_format';\n    if (!e.hasOwnProperty('format')) e.format = 'raw';\n    return e;\n  });\n}\n\n\nfunction sortType(fmt) {\n  if (['numeric', 'd3_format'].includes(fmt)) return 'numeric';\n  if (['text', 'compound_id'].includes(fmt)) return 'text';\n  return 'none';\n}\n\n\n/**\n * Format number\n * @param {object} value - value\n * @param {string} type - si | scientific | rounded | raw\n */\nfunction formatNum(value, d3format) {\n  if (value === undefined || value === null || Number.isNaN(value)) return '';\n  return value == parseFloat(value) ? d3.format(d3format)(value) : value;\n}\n\n\nfunction partialMatch(query, target) {\n  if (target === undefined || target === null || target === '') return false;\n  return target.toString().toUpperCase()\n    .indexOf(query.toString().toUpperCase()) !== -1;\n}\n\n\nfunction URLQuery() {\n  return KArray.from(window.location.search.substring(1).split(\"&\"))\n    .map(e => e.split('=')).toObject();\n}\n\n\n// Ref. https://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript\nfunction uuidv4() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n    var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\n    return v.toString(16);\n  });\n}\n\n\nexport default {\n  defaultFieldProperties, sortType, formatNum, partialMatch, URLQuery, uuidv4\n};\n","\n/** @module common/fetcher */\n\n\nconst baseURL = '';\n\nfunction get(url, query={}) {\n  const isEmpty = Object.keys(query).length;\n  const q = isEmpty ? `?query=${JSON.stringify(query)}` : '';\n  return fetch(\n    `${baseURL}${url}${q}`,\n    {\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\nfunction json(response) {\n  return response.json();\n}\n\nfunction text(response) {\n  return response.text();\n}\n\nfunction blob(response) {\n  return response.blob();\n}\n\nfunction post(url, formdata) {\n  return fetch(\n    `${baseURL}${url}`,\n    {\n      method: 'POST',\n      body: formdata,\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\n\nfunction error(err) {\n  console.error(err);\n  return null;\n}\n\n\nexport default {\n  get, json, text, blob, post, error\n};\n","\n/** @module component/button */\n\nimport d3 from 'd3';\n\n\nfunction buttonBox(selection, id, label, type) {\n  selection\n      .classed('form-group', true)\n      .classed('mb-1', true)\n    .append('button')\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed('btn-sm', true)\n      .attr('id', id)\n      .text(label);\n}\n\n\nfunction menuButton(selection, id, label, type) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .attr('id', id)\n      .text(label);\n}\n\n\nfunction menuButtonLink(selection, id, label, type) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .attr('role', 'button')\n      .attr('href', '#')\n      .attr('id', id)\n      .text(label);\n}\n\n\nfunction menuModalLink(selection, id, label, type, target) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .attr('role', 'button')\n      .attr('data-toggle', 'modal')\n      .attr('data-target', `#${target}`)\n      .attr('id', id)\n      .text(label);\n}\n\n\nfunction dropdownMenuButton(selection, id, label, type) {\n  selection\n      .classed('btn-group', true)\n      .classed('mr-1', true)\n      .attr('id', id);\n  selection.append('button')\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed('btn-sm', true)\n      .classed('dropdown-toggle', true)\n      .attr('data-toggle', 'dropdown')\n      .text(label);\n  selection.append('div')\n      .classed('dropdown-menu', true);\n}\n\n\nfunction dropdownMenuItem(selection, id, label) {\n  selection.classed('dropdown-item', true)\n      .attr('id', id)\n      .text(label);\n}\n\nfunction dropdownMenuModal(selection, id, label, target) {\n  selection.classed('dropdown-item', true)\n      .attr('id', id)\n      .attr('data-toggle', 'modal')\n      .attr('data-target', `#${target}`)\n      .text(label);\n}\n\n\nfunction dropdownMenuFile(selection, id, label, accept) {\n  selection.classed('dropdown-item', true)\n      .attr('id', id)\n      .text(label)\n      .on('click', function () {\n        d3.select(this).select('input').node().click();\n      })\n    .append('form')\n      .style('display', 'none')\n    .append('input')\n      .attr('type', 'file')\n      .attr('accept', accept);\n}\n\n\nfunction dropdownMenuFileValue(selection) {\n  return selection.select('input').node().files[0];\n}\n\n\nexport default {\n  buttonBox, menuButton, menuButtonLink, menuModalLink,\n  dropdownMenuButton, dropdownMenuItem, dropdownMenuModal,\n  dropdownMenuFile, dropdownMenuFileValue\n};\n","\n/** @module profile */\n\nimport d3 from 'd3';\n\nimport {default as misc} from './common/misc.js';\nimport {default as fetcher} from './common/fetcher.js';\n\nimport {default as button} from './component/button.js';\nimport {default as table} from './component/table.js';\n\n\nfunction updateChem(compoundID, resources) {\n  d3.select('title').text(compoundID);\n  const query = {\n    workflow: 'search',\n    targets: resources.filter(e => e.domain === 'chemical').map(e => e.id),\n    key: 'compound_id',\n    values: [compoundID]\n  };\n  return fetcher.get(query.workflow, query)\n    .then(fetcher.json)\n    .then(res => {\n      const rcd = res.records[0];\n      d3.select('#compoundid').html(rcd.compound_id);\n      d3.select('#compounddb').html(\n        resources.find(e => e.id === rcd.__source).name);\n      d3.select('#structure').html(rcd.structure);\n      const fields = misc.defaultFieldProperties([\n        {key: 'key'}, {key: 'value'}\n      ]);\n      const records = res.fields\n        .filter(e => !['structure', 'index', 'compound_id'].includes(e.key))\n        .map(e => ({ key: e.name, value: rcd[e.key] }));\n      d3.select('#properties')\n        .call(table.render, null, null, fields, records);\n      return rcd;\n    }, fetcher.error);\n}\n\n\nfunction updateChemAliases(resources, qrcd) {\n  const query = {\n    workflow: 'exact',\n    targets: resources.filter(e => e.domain === 'chemical').map(e => e.id),\n    queryMol: {\n      format: 'dbid',\n      source: qrcd.__source,\n      value: qrcd.compound_id\n    },\n    params: {ignoreHs: true}\n  };\n  return fetcher.get(query.workflow, query)\n    .then(fetcher.json)\n    .then(res => {\n      const fields = misc.defaultFieldProperties([\n        {key: 'compound_id'}, {key: 'database'}\n      ]);\n      const records = res.records\n        .filter(rcd => rcd.compound_id !== qrcd.compound_id ||\n                rcd.__source !== qrcd.__source)\n        .map(rcd => {\n          return {\n            compound_id: `<a href=\"profile.html?compound=${rcd.compound_id}\" target=\"_blank\">${rcd.compound_id}</a>`,\n            database: resources.find(e => e.id === rcd.__source).name\n          };\n        });\n      d3.select('#aliases')\n        .call(table.render, fields, records);\n    }, fetcher.error);\n}\n\n\nfunction updateActivities(compoundID, resources) {\n  // Prevent implicit submission\n  /* TODO: instant search component\n  document.getElementById('search')\n    .addEventListener('keypress', event => {\n      if (event.keyCode === 13) event.preventDefault();\n    });\n  d3.select('#search').on('keyup', function () {\n    const match = obj => Object.values(obj)\n      .some(e => fmt.partialMatch(d3form.value(this), e));\n    d3.select('#results tbody').selectAll('tr')\n      .style('visibility', d => match(d) ? null : 'hidden')\n      .style('position', d => match(d) ? null : 'absolute');\n  });\n  */\n  const query = {\n    workflow: 'profile',\n    compound_id: compoundID,\n    targets: resources.filter(e => e.domain === 'activity').map(e => e.id),\n  };\n  return fetcher.get(query.workflow, query)\n    .then(fetcher.json)\n    .then(res => {\n      const fields= misc.defaultFieldProperties([\n        {key: 'assay_id', name: 'Assay ID', format: 'text'},\n        {key: 'value_type', name: 'Value type', format: 'text'},\n        {key: 'value', name: 'Value', format: 'numeric'}\n      ]);\n      // TODO: use datagrid?\n      d3.select('#results').call(table.render, null, null, fields, res.records);\n    }, fetcher.error);\n}\n\n\nfunction run() {\n  // Menubar\n  const menubar = d3.select('#menubar');\n  menubar.append('a')\n      .call(button.menuButton, null, 'Control panel', 'outline-secondary')\n      .attr('href', 'control.html')\n      .attr('target', '_blank');\n\n  // Compound row\n  const chemDataRow = d3.select('#contents')\n    .append('div')\n      .classed('row', true);\n  const firstCol = chemDataRow.append('div')\n      .classed('col-sm-4', true);\n  firstCol.append('h5').text('Compound ID');\n  firstCol.append('div')\n      .attr('id', 'compoundid')\n      .classed('mb-2');\n  firstCol.append('h5').text('Database');\n  firstCol.append('div')\n      .attr('id', 'compounddb')\n      .classed('mb-2');\n  firstCol.append('h5').text('Structure');\n  firstCol.append('div')\n      .attr('id', 'structure')\n      .classed('mb-2');\n  const propCol = chemDataRow.append('div')\n      .classed('col-sm-4', true);\n  propCol.append('h5').text('Compound properties');\n  propCol.append('table')\n      .attr('id', 'properties')\n      .style('display', 'inline-block');\n  const aliaseCol = chemDataRow.append('div')\n      .classed('col-sm-4', true);\n  aliaseCol.append('h5').text('Compound structure aliases');\n  aliaseCol.append('table')\n      .attr('id', 'aliases')\n      .style('display', 'inline-block');\n  const compoundID = misc.URLQuery().compound || null;\n\n  // Result row\n  const resultRow = d3.select('#contents')\n    .append('div')\n      .classed('row', true);\n  const results = resultRow.append('div')\n      .classed('col-sm-12', true);\n  results.append('h5').text('Assay results and annotations');\n  results.append('input')\n      .classed('form-control', true)\n      .attr('type', 'text')\n      .attr('placeholder', 'Search')\n      .attr('id', 'search');\n  results.append('table')\n      .attr('id', 'results');\n\n  if (!compoundID) return;\n  // TODO: offline mode flags\n  const localFile = document.location.protocol !== \"file:\";\n  const offLine = 'onLine' in navigator && !navigator.onLine;\n  return fetcher.get('schema')\n    .then(fetcher.json)\n    .catch(() => {})\n    .then(schema => {\n      console.info('Off-line mode is disabled for debugging');\n      return Promise.all([\n        updateChem(compoundID, schema.resources)\n          .then(qrcd => updateChemAliases(schema.resources, qrcd)),\n        updateActivities(compoundID, schema.resources)\n      ]);\n    });\n}\n\n\nexport default {\n  run\n};\n"],"names":["updateHeader","selection","fields","records","header","select","selectAll","data","exit","remove","enter","append","text","d","name","call","updateContents","key","record","forEach","field","value","cell","classed","undefined","format","misc","formatNum","d3_format","updateRowFunc","keyFunc","rowFactory","rows","merge","each","d3","this","KArray","Array","[object Object]","reduce","a","b","find","e","push","prototype","apply","Promise","all","then","res","from","obj","kv","defaultFieldProperties","map","hasOwnProperty","visible","sortType","fmt","includes","d3format","Number","isNaN","parseFloat","partialMatch","query","target","toString","toUpperCase","indexOf","URLQuery","window","location","search","substring","split","toObject","uuidv4","replace","c","r","Math","random","baseURL","get","url","q","Object","keys","length","JSON","stringify","fetch","credentials","status","reject","Error","statusText","resolve","json","response","blob","post","formdata","method","body","error","err","console","buttonBox","id","label","type","attr","menuButton","menuButtonLink","menuModalLink","dropdownMenuButton","dropdownMenuItem","dropdownMenuModal","dropdownMenuFile","accept","on","node","click","style","dropdownMenuFileValue","files","render","caption","run","button","chemDataRow","firstCol","propCol","aliaseCol","compoundID","compound","results","document","protocol","navigator","onLine","fetcher","catch","schema","info","resources","workflow","targets","filter","domain","values","rcd","html","compound_id","__source","structure","table","updateChem","qrcd","queryMol","source","params","ignoreHs","database","updateChemAliases","updateActivities"],"mappings":";8MA+BA,SAASA,EAAaC,EAAWC,EAAQC,GACvC,MAAMC,EAASH,EAAUI,OAAO,YAC7BC,UAAU,MACRC,KAAKL,GACVE,EAAOI,OAAOC,SACdL,EAAOM,QACJC,OAAO,MACLC,KAAKC,GAAKA,EAAEC,MACbX,GACFF,EAAUc,KAAKC,EAAgBb,EAASU,GAAKA,EAAEI,IAsBnD,SAAuBf,GACrB,MAAO,CAACD,EAAWiB,KACjBhB,EAAOiB,QAAQC,IACb,MAAMC,EAAQH,EAAOE,EAAMH,KACrBK,EAAOrB,EAAUU,OAAO,MAC3BY,QAAQ,gBAAgB,QACbC,IAAVH,IACiB,cAAjBD,EAAMK,OACRH,EAAKV,KAAKc,EAAKC,UAAUN,EAAOD,EAAMQ,YAEd,SAAjBR,EAAMK,OACbH,EAAKV,KAAK,UAEc,UAAjBQ,EAAMK,OACbH,EAAKV,KAAK,WAEc,YAAjBQ,EAAMK,OACbH,EAAKP,KAAKM,GAEVC,EAAKV,KAAKS,OAzCsCQ,CAAc3B,IAKtE,SAASc,EAAef,EAAWE,EAAS2B,EAASC,GACnD,MAAMC,EAAO/B,EAAUI,OAAO,SAC3BC,UAAU,MACRC,KAAKJ,EAAS2B,GACnBE,EAAKxB,OAAOC,SACZuB,EAAKtB,QACFC,OAAO,MACPsB,MAAMD,GACNE,KAAK,SAAUrB,GACdsB,EAAG9B,OAAO+B,MACP9B,UAAU,MAAMG,SACnB0B,EAAG9B,OAAO+B,MACPrB,KAAKgB,EAAYlB,wDCrDpBwB,UAAeC,MAInBC,OAAOtB,GACL,OAAOmB,KAAKI,OAAO,CAACC,EAAGC,UACkBlB,IAAnCiB,EAAEE,KAAKC,GAAKA,EAAE3B,KAASyB,EAAEzB,KAAqBwB,EAAEI,KAAKH,GAClDD,GACN,IAAIJ,GAOTE,SACE,OAAOH,KAAKI,OAAO,CAACC,EAAGC,KACrBJ,MAAMQ,UAAUD,KAAKE,MAAMN,EAAGC,GACvBD,GACN,IAAIJ,GAKTE,cACE,OAAOS,QAAQC,IAAIb,MAAMc,KAAKC,GACrBA,EAAIX,OAAO,CAACC,EAAGC,KACpBJ,MAAMQ,UAAUD,KAAKE,MAAMN,EAAGC,GACvBD,GACN,IAAIJ,IAIXE,UACE,OAAOD,MAAMc,KAAKhB,MAGpBG,WACE,MAAMc,KAIN,OAHAjB,KAAKjB,QAAQmC,IACXD,EAAIC,EAAG,IAAMA,EAAG,KAEXD,GCaX,OACEE,uBAzDF,SAKgCrD,GAC9B,OAAOA,EAAOsD,IAAIZ,IACXA,EAAEa,eAAe,UAASb,EAAE9B,KAAO8B,EAAE3B,KACrC2B,EAAEa,eAAe,aAAYb,EAAEc,SAAU,GAC1Cd,EAAEa,eAAe,eAAcb,EAAEnB,OAAS,aACzCmB,EAAEa,eAAe,YAAWb,EAAEnB,OAAS,OACrCmB,KA8Cee,SAzC1B,SAAkBC,GAChB,OAAK,UAAW,aAAaC,SAASD,GAAa,WAC9C,OAAQ,eAAeC,SAASD,GAAa,OAC3C,QAsC2BjC,UA7BpC,SAAmBN,EAAOyC,GACxB,YAActC,IAAVH,GAAiC,OAAVA,GAAkB0C,OAAOC,MAAM3C,GAAe,GAClEA,GAAS4C,WAAW5C,GAASc,EAAGV,OAAOqC,EAAV3B,CAAoBd,GAASA,GA2BpB6C,aAvB/C,SAAsBC,EAAOC,GAC3B,YAAe5C,IAAX4C,GAAmC,OAAXA,GAA8B,KAAXA,IAEC,IADzCA,EAAOC,WAAWC,cACtBC,QAAQJ,EAAME,WAAWC,gBAoB+BE,SAhB7D,WACE,OAAOnC,EAAOe,KAAKqB,OAAOC,SAASC,OAAOC,UAAU,GAAGC,MAAM,MAC1DrB,IAAIZ,GAAKA,EAAEiC,MAAM,MAAMC,YAc2CC,OATvE,WACE,MAAO,uCAAuCC,QAAQ,QAAS,SAASC,GACtE,IAAIC,EAAoB,GAAhBC,KAAKC,SAAgB,EAC7B,OADyC,KAALH,EAAWC,EAAS,EAAJA,EAAU,GACrDb,SAAS,QClDtB,MAAMgB,EAAU,GAqDhB,OACEC,IApDF,SAAaC,EAAKpB,MAChB,MACMqB,EADUC,OAAOC,KAAKvB,GAAOwB,iBACLC,KAAKC,UAAU1B,KAAW,GACxD,OAAO2B,SACFT,IAAUE,IAAMC,KAEjBO,YAAa,YAEf7C,KAAKC,GACc,MAAfA,EAAI6C,OACChD,QAAQiD,OAAO,IAAIC,MAAM/C,EAAIgD,aAE/BnD,QAAQoD,QAAQjD,KAwCpBkD,KApCP,SAAcC,GACZ,OAAOA,EAASD,QAmCLzF,KAhCb,SAAc0F,GACZ,OAAOA,EAAS1F,QA+BC2F,KA5BnB,SAAcD,GACZ,OAAOA,EAASC,QA2BOC,KAxBzB,SAAcjB,EAAKkB,GACjB,OAAOX,SACFT,IAAUE,KAEXmB,OAAQ,OACRC,KAAMF,EACNV,YAAa,YAEf7C,KAAKC,GACc,MAAfA,EAAI6C,OACChD,QAAQiD,OAAO,IAAIC,MAAM/C,EAAIgD,aAE/BnD,QAAQoD,QAAQjD,KAYIyD,MAP/B,SAAeC,GAEb,OADAC,QAAQF,MAAMC,GACP,UCyDPE,UA3GF,SAGmB9G,EAAW+G,EAAIC,EAAOC,GACvCjH,EACKsB,QAAQ,cAAc,GACtBA,QAAQ,QAAQ,GAClBZ,OAAO,UACLY,QAAQ,OAAO,GACfA,eAAe2F,KAAQ,GACvB3F,QAAQ,UAAU,GAClB4F,KAAK,KAAMH,GACXpG,KAAKqG,IA+FCG,WA3Fb,SAAoBnH,EAAW+G,EAAIC,EAAOC,GACxCjH,EACKsB,QAAQ,OAAO,GACfA,eAAe2F,KAAQ,GACvB3F,QAAQ,UAAU,GAClBA,QAAQ,QAAQ,GAChB4F,KAAK,KAAMH,GACXpG,KAAKqG,IAoFaI,eAhFzB,SAAwBpH,EAAW+G,EAAIC,EAAOC,GAC5CjH,EACKsB,QAAQ,OAAO,GACfA,eAAe2F,KAAQ,GACvB3F,QAAQ,UAAU,GAClBA,QAAQ,QAAQ,GAChB4F,KAAK,OAAQ,UACbA,KAAK,OAAQ,KACbA,KAAK,KAAMH,GACXpG,KAAKqG,IAuE6BK,cAnEzC,SAAuBrH,EAAW+G,EAAIC,EAAOC,EAAM9C,GACjDnE,EACKsB,QAAQ,OAAO,GACfA,eAAe2F,KAAQ,GACvB3F,QAAQ,UAAU,GAClBA,QAAQ,QAAQ,GAChB4F,KAAK,OAAQ,UACbA,KAAK,cAAe,SACpBA,KAAK,kBAAmB/C,KACxB+C,KAAK,KAAMH,GACXpG,KAAKqG,IA0DVM,mBAtDF,SAA4BtH,EAAW+G,EAAIC,EAAOC,GAChDjH,EACKsB,QAAQ,aAAa,GACrBA,QAAQ,QAAQ,GAChB4F,KAAK,KAAMH,GAChB/G,EAAUU,OAAO,UACZY,QAAQ,OAAO,GACfA,eAAe2F,KAAQ,GACvB3F,QAAQ,UAAU,GAClBA,QAAQ,mBAAmB,GAC3B4F,KAAK,cAAe,YACpBvG,KAAKqG,GACVhH,EAAUU,OAAO,OACZY,QAAQ,iBAAiB,IAyCViG,iBArCtB,SAA0BvH,EAAW+G,EAAIC,GACvChH,EAAUsB,QAAQ,iBAAiB,GAC9B4F,KAAK,KAAMH,GACXpG,KAAKqG,IAkC4BQ,kBA/BxC,SAA2BxH,EAAW+G,EAAIC,EAAO7C,GAC/CnE,EAAUsB,QAAQ,iBAAiB,GAC9B4F,KAAK,KAAMH,GACXG,KAAK,cAAe,SACpBA,KAAK,kBAAmB/C,KACxBxD,KAAKqG,IA2BVS,iBAvBF,SAA0BzH,EAAW+G,EAAIC,EAAOU,GAC9C1H,EAAUsB,QAAQ,iBAAiB,GAC9B4F,KAAK,KAAMH,GACXpG,KAAKqG,GACLW,GAAG,QAAS,WACXzF,EAAG9B,OAAO+B,MAAM/B,OAAO,SAASwH,OAAOC,UAE1CnH,OAAO,QACLoH,MAAM,UAAW,QACnBpH,OAAO,SACLwG,KAAK,OAAQ,QACbA,KAAK,SAAUQ,IAYFK,sBARpB,SAA+B/H,GAC7B,OAAOA,EAAUI,OAAO,SAASwH,OAAOI,MAAM,QJhB9CC,OAlFF,SAKgBjI,EAAW+G,EAAImB,EAASjI,EAAQC,GAC9CF,EACKsB,QAAQ,SAAS,GACjBA,QAAQ,iBAAiB,GACzBA,QAAQ,eAAe,GACvB4F,KAAK,KAAMH,GACZmB,GACJlI,EAAUU,OAAO,WACZC,KAAKuH,GAEVlI,EAAUU,OAAO,SACdA,OAAO,MACVV,EAAUU,OAAO,SACbT,GACFD,EAAUc,KAAKf,EAAcE,EAAQC,IA+D/BH,aAAAA,EAAcgB,eAAAA,UK4FtBoH,IA1EF,WAEkBjG,EAAG9B,OAAO,YAClBM,OAAO,KACVI,KAAKsH,EAAOjB,WAAY,KAAM,gBAAiB,qBAC/CD,KAAK,OAAQ,gBACbA,KAAK,SAAU,UAGpB,MAAMmB,EAAcnG,EAAG9B,OAAO,aAC3BM,OAAO,OACLY,QAAQ,OAAO,GACdgH,EAAWD,EAAY3H,OAAO,OAC/BY,QAAQ,YAAY,GACzBgH,EAAS5H,OAAO,MAAMC,KAAK,eAC3B2H,EAAS5H,OAAO,OACXwG,KAAK,KAAM,cACX5F,QAAQ,QACbgH,EAAS5H,OAAO,MAAMC,KAAK,YAC3B2H,EAAS5H,OAAO,OACXwG,KAAK,KAAM,cACX5F,QAAQ,QACbgH,EAAS5H,OAAO,MAAMC,KAAK,aAC3B2H,EAAS5H,OAAO,OACXwG,KAAK,KAAM,aACX5F,QAAQ,QACb,MAAMiH,EAAUF,EAAY3H,OAAO,OAC9BY,QAAQ,YAAY,GACzBiH,EAAQ7H,OAAO,MAAMC,KAAK,uBAC1B4H,EAAQ7H,OAAO,SACVwG,KAAK,KAAM,cACXY,MAAM,UAAW,gBACtB,MAAMU,EAAYH,EAAY3H,OAAO,OAChCY,QAAQ,YAAY,GACzBkH,EAAU9H,OAAO,MAAMC,KAAK,8BAC5B6H,EAAU9H,OAAO,SACZwG,KAAK,KAAM,WACXY,MAAM,UAAW,gBACtB,MAAMW,EAAahH,EAAK8C,WAAWmE,UAAY,KAMzCC,EAHYzG,EAAG9B,OAAO,aACzBM,OAAO,OACLY,QAAQ,OAAO,GACMZ,OAAO,OAC5BY,QAAQ,aAAa,GAU1B,GATAqH,EAAQjI,OAAO,MAAMC,KAAK,iCAC1BgI,EAAQjI,OAAO,SACVY,QAAQ,gBAAgB,GACxB4F,KAAK,OAAQ,QACbA,KAAK,cAAe,UACpBA,KAAK,KAAM,UAChByB,EAAQjI,OAAO,SACVwG,KAAK,KAAM,YAEXuB,EAAY,OAIjB,OAFkBG,SAASnE,SAASoE,SACpB,WAAYC,WAAcA,UAAUC,OAC7CC,EAAQ3D,IAAI,UAChBpC,KAAK+F,EAAQ5C,MACb6C,MAAM,QACNhG,KAAKiG,IACJrC,QAAQsC,KAAK,2CACNpG,QAAQC,KAxKrB,SASoByF,EAAYW,GAC9BlH,EAAG9B,OAAO,SAASO,KAAK8H,GACxB,MAAMvE,GACJmF,SAAU,SACVC,QAASF,EAAUG,OAAO5G,GAAkB,aAAbA,EAAE6G,QAAuBjG,IAAIZ,GAAKA,EAAEoE,IACnE/F,IAAK,cACLyI,QAAShB,IAEX,OAAOO,EAAQ3D,IAAInB,EAAMmF,SAAUnF,GAChCjB,KAAK+F,EAAQ5C,MACbnD,KAAKC,IACJ,MAAMwG,EAAMxG,EAAIhD,QAAQ,GACxBgC,EAAG9B,OAAO,eAAeuJ,KAAKD,EAAIE,aAClC1H,EAAG9B,OAAO,eAAeuJ,KACvBP,EAAU1G,KAAKC,GAAKA,EAAEoE,KAAO2C,EAAIG,UAAUhJ,MAC7CqB,EAAG9B,OAAO,cAAcuJ,KAAKD,EAAII,WACjC,MAAM7J,EAASwB,EAAK6B,yBACjBtC,IAAK,QAASA,IAAK,WAEhBd,EAAUgD,EAAIjD,OACjBsJ,OAAO5G,KAAO,YAAa,QAAS,eAAeiB,SAASjB,EAAE3B,MAC9DuC,IAAIZ,KAAQ3B,IAAK2B,EAAE9B,KAAMO,MAAOsI,EAAI/G,EAAE3B,QAGzC,OAFAkB,EAAG9B,OAAO,eACPU,KAAKiJ,EAAM9B,OAAQ,KAAM,KAAMhI,EAAQC,GACnCwJ,GACNV,EAAQrC,OAuIPqD,CAAWvB,EAAYS,EAAOE,WAC3BnG,KAAKgH,IApIhB,SAA2Bb,EAAWa,GACpC,MAAM/F,GACJmF,SAAU,QACVC,QAASF,EAAUG,OAAO5G,GAAkB,aAAbA,EAAE6G,QAAuBjG,IAAIZ,GAAKA,EAAEoE,IACnEmD,UACE1I,OAAQ,OACR2I,OAAQF,EAAKJ,SACbzI,MAAO6I,EAAKL,aAEdQ,QAASC,UAAU,IAErB,OAAOrB,EAAQ3D,IAAInB,EAAMmF,SAAUnF,GAChCjB,KAAK+F,EAAQ5C,MACbnD,KAAKC,IACJ,MAAMjD,EAASwB,EAAK6B,yBACjBtC,IAAK,gBAAiBA,IAAK,cAExBd,EAAUgD,EAAIhD,QACjBqJ,OAAOG,GAAOA,EAAIE,cAAgBK,EAAKL,aAChCF,EAAIG,WAAaI,EAAKJ,UAC7BtG,IAAImG,KAEDE,8CAA+CF,EAAIE,gCAAgCF,EAAIE,kBACvFU,SAAUlB,EAAU1G,KAAKC,GAAKA,EAAEoE,KAAO2C,EAAIG,UAAUhJ,QAG3DqB,EAAG9B,OAAO,YACPU,KAAKiJ,EAAM9B,OAAQhI,EAAQC,IAC7B8I,EAAQrC,QAwGS4D,CAAkBrB,EAAOE,UAAWa,IApG5D,SAA0BxB,EAAYW,GAepC,MAAMlF,GACJmF,SAAU,UACVO,YAAanB,EACba,QAASF,EAAUG,OAAO5G,GAAkB,aAAbA,EAAE6G,QAAuBjG,IAAIZ,GAAKA,EAAEoE,KAErE,OAAOiC,EAAQ3D,IAAInB,EAAMmF,SAAUnF,GAChCjB,KAAK+F,EAAQ5C,MACbnD,KAAKC,IACJ,MAAMjD,EAAQwB,EAAK6B,yBAChBtC,IAAK,WAAYH,KAAM,WAAYW,OAAQ,SAC3CR,IAAK,aAAcH,KAAM,aAAcW,OAAQ,SAC/CR,IAAK,QAASH,KAAM,QAASW,OAAQ,aAGxCU,EAAG9B,OAAO,YAAYU,KAAKiJ,EAAM9B,OAAQ,KAAM,KAAMhI,EAAQiD,EAAIhD,UAChE8I,EAAQrC,OAuEP6D,CAAiB/B,EAAYS,EAAOE"}