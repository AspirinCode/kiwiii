{"version":3,"file":"kwprofile.js","sources":["../src/common/misc.js","../src/common/fetcher.js","../src/component/button.js","../src/component/table.js","../src/profile.js"],"sourcesContent":["\n/** @module common/misc */\n\nimport d3 from 'd3';\nimport _ from 'lodash';\n\n\nfunction defaultFieldProperties(fields) {\n  return fields.map(e => {\n    if (!e.hasOwnProperty('name')) e.name = e.key;\n    if (!e.hasOwnProperty('visible')) e.visible = true;\n    if (e.hasOwnProperty('d3_format')) e.format = 'd3_format';\n    if (!e.hasOwnProperty('format')) e.format = 'raw';\n    return e;\n  });\n}\n\n\nfunction sortType(fmt) {\n  if (['numeric', 'd3_format'].includes(fmt)) return 'numeric';\n  if (['text', 'compound_id', 'assay_id', 'list'].includes(fmt)) return 'text';\n  return 'none';\n}\n\n\n/**\n * Format number\n * @param {object} value - value\n * @param {string} type - si | scientific | rounded | raw\n */\nfunction formatNum(value, d3format) {\n  if (value === undefined || value === null || Number.isNaN(value)) return '';\n  return value == parseFloat(value) ? d3.format(d3format)(value) : value;\n}\n\n\nfunction partialMatch(query, target) {\n  if (target === undefined || target === null || target === '') return false;\n  return target.toString().toUpperCase()\n    .indexOf(query.toString().toUpperCase()) !== -1;\n}\n\n\nfunction URLQuery() {\n  const pairs = window.location.search.substring(1).split(\"&\")\n    .map(e => e.split('='));\n  return _.fromPairs(pairs);\n}\n\n\n// Ref. https://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript\nfunction uuidv4() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n    var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\n    return v.toString(16);\n  });\n}\n\n\nexport default {\n  defaultFieldProperties, sortType, formatNum, partialMatch, URLQuery, uuidv4\n};\n","\n/** @module common/fetcher */\n\n\nconst baseURL = '';\n\nfunction get(url, query={}) {\n  const isEmpty = Object.keys(query).length;\n  const q = isEmpty ? `?query=${JSON.stringify(query)}` : '';\n  return fetch(\n    `${baseURL}${url}${q}`,\n    {\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\nfunction json(response) {\n  return response.json();\n}\n\nfunction text(response) {\n  return response.text();\n}\n\nfunction blob(response) {\n  return response.blob();\n}\n\nfunction post(url, formdata) {\n  return fetch(\n    `${baseURL}${url}`,\n    {\n      method: 'POST',\n      body: formdata,\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\n\nfunction error(err) {\n  console.error(err);\n  return null;\n}\n\n\nexport default {\n  get, json, text, blob, post, error\n};\n","\n/** @module component/button */\n\nimport d3 from 'd3';\n\n\nfunction buttonBox(selection, id, label, type) {\n  selection\n      .classed('form-group', true)\n      .classed('mb-1', true)\n    .append('button')\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed('btn-sm', true)\n      .attr('id', id)\n      .text(label);\n}\n\n\nfunction menuButton(selection, id, label, type) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .attr('id', id)\n      .text(label);\n}\n\n\nfunction menuButtonLink(selection, id, label, type) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .attr('role', 'button')\n      .attr('href', '#')\n      .attr('id', id)\n      .text(label);\n}\n\n\nfunction menuModalLink(selection, id, label, type, target) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .attr('id', id)\n      .attr('href', '#')\n      .attr('role', 'button')\n      .attr('data-toggle', 'modal')\n      .attr('data-target', `#${target}`)\n      .text(label);\n}\n\n\nfunction dropdownMenuButton(selection, id, label, type) {\n  selection\n      .classed('btn-group', true)\n      .classed('mr-1', true)\n      .attr('id', id);\n  selection.append('button')\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed('btn-sm', true)\n      .classed('dropdown-toggle', true)\n      .attr('data-toggle', 'dropdown')\n      .text(label);\n  selection.append('div')\n      .classed('dropdown-menu', true);\n}\n\n\nfunction dropdownMenuItem(selection, id, label) {\n  selection.classed('dropdown-item', true)\n      .attr('id', id)\n      .attr('href', '#')\n      .text(label);\n}\n\nfunction dropdownMenuModal(selection, id, label, target) {\n  selection.classed('dropdown-item', true)\n      .attr('id', id)\n      .attr('href', '#')\n      .attr('data-toggle', 'modal')\n      .attr('data-target', `#${target}`)\n      .text(label);\n}\n\n\nfunction dropdownMenuFile(selection, id, label, accept) {\n  selection.classed('dropdown-item', true)\n      .attr('id', id)\n      .attr('href', '#')\n      .text(label)\n      .on('click', function () {\n        d3.select(this).select('input').node().click();\n      })\n    .append('form')\n      .style('display', 'none')\n    .append('input')\n      .attr('type', 'file')\n      .attr('accept', accept);\n}\n\n\nfunction dropdownMenuFileValue(selection) {\n  return selection.select('input').node().files[0];\n}\n\n\nexport default {\n  buttonBox, menuButton, menuButtonLink, menuModalLink,\n  dropdownMenuButton, dropdownMenuItem, dropdownMenuModal,\n  dropdownMenuFile, dropdownMenuFileValue\n};\n","\n/** @module component/table */\n\n// Simple tables\n// use dataGrid.js for interactive and smooth datatable\n\n\nimport d3 from 'd3';\n\nimport {default as misc} from '../common/misc.js';\n\n\nfunction render(selection, id, caption, fields, records) {\n  selection\n      .classed('table', true)\n      .classed('table-striped', true)\n      .classed('table-hover', true)\n      .attr('id', id);\n  if (caption) {\n    selection.append('caption').text(caption);\n  }\n  selection.append('thead').append('tr');\n  selection.append('tbody');\n  if (fields) {\n    selection.call(updateHeader, fields, records);\n  }\n}\n\n\nfunction updateHeader(selection, fields, records) {\n  const header = selection.select('thead tr')\n    .selectAll('th')\n      .data(fields);\n  header.exit().remove();\n  header.enter().append('th')\n      .text(d => d.name);\n  if (records) {\n    selection.call(updateContents, records, d => d.key, updateRowFunc(fields));\n  }\n}\n\n\nfunction updateContents(selection, records, keyFunc, rowFactory) {  // TODO: specify key\n  const rows = selection.select('tbody')\n    .selectAll('tr')\n      .data(records, keyFunc);\n  rows.exit().remove();\n  rows.enter().append('tr')\n    .merge(rows)\n      .each(function (d) {\n        d3.select(this).selectAll('td').remove();\n        d3.select(this).call(rowFactory, d);\n      });\n}\n\n\nfunction updateRowFunc(fields) {\n  return (selection, record) => {\n    fields.forEach(field => {\n      const value = record[field.key];\n      const cell = selection.append('td')\n        .classed('align-middle', true);\n      if (value === undefined) return;\n      if (field.format === 'd3_format') {\n        cell.text(misc.formatNum(value, field.d3_format));\n      }\n      else if (field.format === 'plot') {\n        cell.text('[plot]');\n      }\n      else if (field.format === 'image') {\n        cell.text('[image]');\n      }\n      else if (field.format === 'control') {\n        cell.call(value);\n      } else {\n        cell.text(value);\n      }\n    });\n  };\n}\n\n\nexport default {\n  render, updateHeader, updateContents\n};\n","\n/** @module profile */\n\nimport d3 from 'd3';\n\nimport {default as misc} from './common/misc.js';\nimport {default as fetcher} from './common/fetcher.js';\n\nimport {default as button} from './component/button.js';\nimport {default as table} from './component/table.js';\n\n\nfunction updateChem(compoundID, resources) {\n  d3.select('title').text(compoundID);\n  const query = {\n    workflow: 'search',\n    targets: resources.filter(e => e.domain === 'chemical').map(e => e.id),\n    key: 'compound_id',\n    values: [compoundID]\n  };\n  return fetcher.get(query.workflow, query)\n    .then(fetcher.json)\n    .then(res => {\n      const rcd = res.records[0];\n      d3.select('#compoundid').html(rcd.compound_id);\n      d3.select('#compounddb').html(\n        resources.find(e => e.id === rcd.__source).name);\n      d3.select('#structure').html(rcd.structure);\n      const fields = misc.defaultFieldProperties([\n        {key: 'key'}, {key: 'value'}\n      ]);\n      const records = res.fields\n        .filter(e => !['structure', 'index', 'compound_id'].includes(e.key))\n        .map(e => ({ key: e.name, value: rcd[e.key] }));\n      d3.select('#properties')\n        .call(table.render, null, null, fields, records);\n      return rcd;\n    }, fetcher.error);\n}\n\n\nfunction updateChemAliases(resources, qrcd) {\n  const query = {\n    workflow: 'exact',\n    targets: resources.filter(e => e.domain === 'chemical').map(e => e.id),\n    queryMol: {\n      format: 'dbid',\n      source: qrcd.__source,\n      value: qrcd.compound_id\n    },\n    params: {ignoreHs: true}\n  };\n  return fetcher.get(query.workflow, query)\n    .then(fetcher.json)\n    .then(res => {\n      const fields = misc.defaultFieldProperties([\n        {key: 'compound_id'}, {key: 'database'}\n      ]);\n      const records = res.records\n        .filter(rcd => rcd.compound_id !== qrcd.compound_id ||\n                rcd.__source !== qrcd.__source)\n        .map(rcd => {\n          return {\n            compound_id: `<a href=\"profile.html?compound=${rcd.compound_id}\" target=\"_blank\">${rcd.compound_id}</a>`,\n            database: resources.find(e => e.id === rcd.__source).name\n          };\n        });\n      d3.select('#aliases')\n        .call(table.render, fields, records);\n    }, fetcher.error);\n}\n\n\nfunction updateActivities(compoundID, resources) {\n  // Prevent implicit submission\n  /* TODO: instant search component\n  document.getElementById('search')\n    .addEventListener('keypress', event => {\n      if (event.keyCode === 13) event.preventDefault();\n    });\n  d3.select('#search').on('keyup', function () {\n    const match = obj => Object.values(obj)\n      .some(e => fmt.partialMatch(d3form.value(this), e));\n    d3.select('#results tbody').selectAll('tr')\n      .style('visibility', d => match(d) ? null : 'hidden')\n      .style('position', d => match(d) ? null : 'absolute');\n  });\n  */\n  const query = {\n    workflow: 'profile',\n    compound_id: compoundID,\n    targets: resources.filter(e => e.domain === 'activity').map(e => e.id),\n  };\n  return fetcher.get(query.workflow, query)\n    .then(fetcher.json)\n    .then(res => {\n      const fields= misc.defaultFieldProperties([\n        {key: 'assay_id', name: 'Assay ID', format: 'text'},\n        {key: 'value_type', name: 'Value type', format: 'text'},\n        {key: 'value', name: 'Value', format: 'numeric'}\n      ]);\n      // TODO: use datagrid?\n      d3.select('#results').call(table.render, null, null, fields, res.records);\n    }, fetcher.error);\n}\n\n\nfunction run() {\n  // Menubar\n  const menubar = d3.select('#menubar');\n  menubar.append('a')\n      .call(button.menuButton, null, 'Control panel', 'outline-secondary')\n      .attr('href', 'control.html')\n      .attr('target', '_blank');\n\n  // Compound row\n  const chemDataRow = d3.select('#contents')\n    .append('div')\n      .classed('row', true);\n  const firstCol = chemDataRow.append('div')\n      .classed('col-sm-4', true);\n  firstCol.append('h5').text('Compound ID');\n  firstCol.append('div')\n      .attr('id', 'compoundid')\n      .classed('mb-2');\n  firstCol.append('h5').text('Database');\n  firstCol.append('div')\n      .attr('id', 'compounddb')\n      .classed('mb-2');\n  firstCol.append('h5').text('Structure');\n  firstCol.append('div')\n      .attr('id', 'structure')\n      .classed('mb-2');\n  const propCol = chemDataRow.append('div')\n      .classed('col-sm-4', true);\n  propCol.append('h5').text('Compound properties');\n  propCol.append('table')\n      .attr('id', 'properties')\n      .style('display', 'inline-block');\n  const aliaseCol = chemDataRow.append('div')\n      .classed('col-sm-4', true);\n  aliaseCol.append('h5').text('Compound structure aliases');\n  aliaseCol.append('table')\n      .attr('id', 'aliases')\n      .style('display', 'inline-block');\n  const compoundID = misc.URLQuery().compound || null;\n\n  // Result row\n  const resultRow = d3.select('#contents')\n    .append('div')\n      .classed('row', true);\n  const results = resultRow.append('div')\n      .classed('col-sm-12', true);\n  results.append('h5').text('Assay results and annotations');\n  results.append('input')\n      .classed('form-control', true)\n      .attr('type', 'text')\n      .attr('placeholder', 'Search')\n      .attr('id', 'search');\n  results.append('table')\n      .attr('id', 'results');\n\n  if (!compoundID) return;\n  // TODO: offline mode flags\n  const localFile = document.location.protocol !== \"file:\";\n  const offLine = 'onLine' in navigator && !navigator.onLine;\n  return fetcher.get('schema')\n    .then(fetcher.json)\n    .then(schema => {\n      console.info('Off-line mode is disabled for debugging');\n      return Promise.all([\n        updateChem(compoundID, schema.resources)\n          .then(qrcd => updateChemAliases(schema.resources, qrcd)),\n        updateActivities(compoundID, schema.resources)\n      ]);\n    }, () => {\n      console.info('Server did not respond');\n    });\n}\n\n\nexport default {\n  run\n};\n"],"names":["defaultFieldProperties","fields","map","e","hasOwnProperty","name","key","visible","format","sortType","fmt","includes","formatNum","value","d3format","Number","isNaN","parseFloat","d3","partialMatch","query","target","toString","toUpperCase","indexOf","URLQuery","pairs","window","location","search","substring","split","_","fromPairs","uuidv4","replace","c","r","Math","random","baseURL","get","url","q","Object","keys","length","JSON","stringify","fetch","credentials","then","res","status","Promise","reject","Error","statusText","resolve","json","response","text","blob","post","formdata","method","body","error","err","console","buttonBox","selection","id","label","type","classed","append","attr","menuButton","menuButtonLink","menuModalLink","dropdownMenuButton","dropdownMenuItem","dropdownMenuModal","dropdownMenuFile","accept","on","select","this","node","click","style","dropdownMenuFileValue","files","updateHeader","records","header","selectAll","data","exit","remove","enter","d","call","updateContents","record","forEach","field","cell","undefined","misc","d3_format","updateRowFunc","keyFunc","rowFactory","rows","merge","each","render","caption","run","button","chemDataRow","firstCol","propCol","aliaseCol","compoundID","compound","results","document","protocol","navigator","onLine","fetcher","schema","info","all","resources","workflow","targets","filter","domain","values","rcd","html","compound_id","find","__source","structure","table","updateChem","qrcd","queryMol","source","params","ignoreHs","database","updateChemAliases","updateActivities"],"mappings":"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"}