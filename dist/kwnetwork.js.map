{"version":3,"file":"kwnetwork.js","sources":["../src/common/misc.js","../src/common/idb.js","../src/common/fetcher.js","../src/common/core.js","../src/common/file.js","../src/component/button.js","../src/common/legacySchema.js","../src/network/state.js","../src/common/scale.js","../src/network/component.js","../src/network/view.js","../src/network/interaction.js","../src/network/force.js","../src/common/mapper.js","../src/component/modal.js","../src/component/formBox.js","../src/dialog/community.js","../src/dialog/rename.js","../src/component/formListBox.js","../src/component/formRangeBox.js","../src/component/formBoxGroup.js","../src/network/controlBox.js","../src/network/communityDetection.js","../src/network/networkApp.js","../src/network.js"],"sourcesContent":["\n/** @module common/misc */\n\nimport d3 from 'd3';\nimport _ from 'lodash';\n\n\nfunction defaultFieldProperties(fields) {\n  return fields.map(e => {\n    if (!e.hasOwnProperty('name')) e.name = e.key;\n    if (!e.hasOwnProperty('visible')) e.visible = true;\n    if (e.hasOwnProperty('d3_format')) e.format = 'd3_format';\n    if (!e.hasOwnProperty('format')) e.format = 'raw';\n    return e;\n  });\n}\n\n\nfunction sortType(fmt) {\n  if (['numeric', 'd3_format'].includes(fmt)) return 'numeric';\n  if (['text', 'compound_id', 'assay_id', 'list'].includes(fmt)) return 'text';\n  return 'none';\n}\n\n\n/**\n * Format number\n * @param {object} value - value\n * @param {string} type - si | scientific | rounded | raw\n */\nfunction formatNum(value, d3format) {\n  if (value === undefined || value === null || Number.isNaN(value)) return '';\n  return value == parseFloat(value) ? d3.format(d3format)(value) : value;\n}\n\n\nfunction partialMatch(query, target) {\n  if (target === undefined || target === null || target === '') return false;\n  return target.toString().toUpperCase()\n    .indexOf(query.toString().toUpperCase()) !== -1;\n}\n\n\nfunction URLQuery() {\n  const pairs = window.location.search.substring(1).split(\"&\")\n    .map(e => e.split('='));\n  return _.fromPairs(pairs);\n}\n\n\n// Ref. https://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript\nfunction uuidv4() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n    var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\n    return v.toString(16);\n  });\n}\n\n\nexport default {\n  defaultFieldProperties, sortType, formatNum, partialMatch, URLQuery, uuidv4\n};\n","\n/** @module common/idb */\n\nimport Dexie from 'Dexie';\n\nimport {default as misc} from './misc.js';\n\n\nconst schema = {\n  items: 'storeID, dataType, created'\n};\n\nlet idb = new Dexie('Store');\nidb.version(1).stores(schema);\n\n\n/**\n * Returns all data store items\n * @return {array} data store objects\n */\nfunction getAllItems() {\n  return idb.items\n    .orderBy('created')\n    .reverse()\n    .toArray();\n}\n\n\n/**\n * Get data store items by data type\n * @param {string} type - 'nodes' or 'edges'\n * @return {array} data store objects\n */\nfunction getItemsByDataType(type) {\n  return idb.items\n    .where('dataType')\n    .equals(type)\n    .reverse()\n    .sortBy('created')\n    .catch(err => {\n      console.error(`IDBError: Unexpected dataType: ${type}`, err);\n    });\n}\n\n\n/**\n * Get data store items by store ID\n * @param {string} storeID - store ID\n * @return {array} data store object\n */\nfunction getItemByID(storeID) {\n  return idb.items\n    .where('storeID')\n    .equals(storeID)\n    .first()\n    .catch(err => {\n      console.error(`IDBError: Unexpected table ID: ${storeID}`, err);\n    });\n}\n\n\n/**\n * Delete a data object from the store\n * @param {string} storeID - store ID\n * @return {integer} - number of deleted items\n */\nfunction deleteItem(storeID) {\n  return idb.items\n    .where('storeID')\n    .equals(storeID)\n    .delete();\n}\n\n\n/**\n * Insert a data object to the store\n * @param {object} data - data\n * @return {string} - storeID if sucessfully added\n */\nfunction putItem(data) {\n  if (!data.storeID) {\n    data.storeID = misc.uuidv4();\n  }\n  return idb.items.put(data);\n}\n\n\n/**\n * Update data object in the store\n * @param {string} storeID - store ID\n * @param {function} updateFunc - update function\n * @return {integer} - number of updated items\n */\nfunction updateItem(storeID, updateFunc) {\n  return idb.items\n    .where('storeID')\n    .equals(storeID)\n    .modify(updateFunc)\n    .catch(err => {\n      console.error('IDBError: Update failed', err);\n    });\n}\n\n\n/**\n * Delete all data store\n * Try this before dealing with local db issues\n */\nfunction reset() {\n  return idb.delete().then(() => {\n    idb = new Dexie('Store');\n    idb.version(1).stores(schema);\n  });\n}\n\n\nexport default {\n  getAllItems, getItemsByDataType, getItemByID,\n  deleteItem, putItem, updateItem, reset\n};\n","\n/** @module common/fetcher */\n\n\nconst baseURL = '';\n\nfunction get(url, query={}) {\n  const isEmpty = Object.keys(query).length;\n  const q = isEmpty ? `?query=${JSON.stringify(query)}` : '';\n  return fetch(\n    `${baseURL}${url}${q}`,\n    {\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\nfunction json(response) {\n  return response.json();\n}\n\nfunction text(response) {\n  return response.text();\n}\n\nfunction blob(response) {\n  return response.blob();\n}\n\nfunction post(url, formdata) {\n  return fetch(\n    `${baseURL}${url}`,\n    {\n      method: 'POST',\n      body: formdata,\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\n\nfunction error(err) {\n  console.error(err);\n  return null;\n}\n\n\nexport default {\n  get, json, text, blob, post, error\n};\n","\n/** @module common/core */\n\nimport {default as idb} from './idb.js';\nimport {default as fetcher} from './fetcher.js';\nimport {default as misc} from './misc.js';\n\n\nfunction fetchProgress(storeID, command='update') {\n  return idb.getItemByID(storeID)\n    .then(data => {\n      if (!data) return Promise.reject(`Store: ${storeID} is not available`);\n      if (!['ready', 'running'].includes(data.status)) return;\n      const query = {id: data.reference.workflow, command: command};\n      return fetcher.get('progress', query)\n        .then(fetcher.json)\n        .then(data => {\n          if (data.status === 'failure') {  // No data found on server\n            return idb.updateItem(storeID, item => {\n              item.status = 'failure';\n            });\n          }\n          return idb.updateItem(storeID, item => {\n            item.status = data.status;\n            item.progress = data.progress;\n            item.execTime = data.execTime;\n            item.fields = misc.defaultFieldProperties(data.fields);\n            item.records = data.records;\n          });\n        });\n    });\n}\n\n\nexport default {\n  fetchProgress\n};\n","\n/** @module common/file */\n\nimport pako from 'pako';\n\n\nfunction readFile(file, sizeLimit, blob) {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    const truncated = sizeLimit ? file.slice(0, sizeLimit) : file;\n    reader.onload = event => resolve(event.target.result);\n    reader.onerror = error => reject(error);\n    if (blob) {\n      reader.readAsArrayBuffer(truncated);\n    } else {\n      reader.readAsText(truncated);\n    }\n  });\n}\n\n\nfunction parseJSON(data, compressed) {\n  const text = compressed ? pako.inflate(data, {to: 'string'}) : data;\n  return JSON.parse(text);\n}\n\n\nfunction loadJSON(file) {\n  const compressed = file.name.endsWith('c') || file.name.endsWith('.gz');\n  return readFile(file, false, compressed)\n    .then(data => parseJSON(data, compressed));\n}\n\n\nfunction fetchJSON(url) {\n  const decoded = decodeURIComponent(url);\n  const compressed = decoded.endsWith('c') || decoded.endsWith('.gz');\n  return fetch(decoded)\n    .then(res => compressed ? res.arrayBuffer() : res.json())\n    .then(data => parseJSON(data, compressed));\n}\n\n\nfunction downloadDataFile(data, name) {\n  try {\n    // cannot hundle large file with dataURI scheme\n    // url = 'data:application/json,' + encodeURIComponent(JSON.stringify(json))\n    const url = window.URL.createObjectURL(new Blob([data]));\n    const a = document.createElement('a');\n    a.download = name;\n    a.href = url;\n    // a.click() does not work on firefox\n    a.dispatchEvent(new MouseEvent('click', {\n      'view': window,\n      'bubbles': true,\n      'cancelable': false\n    }));\n    // window.URL.revokeObjectURL(url) does not work on firefox\n  } catch (e) {\n    // no DOM (unit testing)\n  }\n}\n\n\nfunction downloadJSON(json, name, compress=true) {\n  const str = JSON.stringify(json);\n  const data = compress ? pako.gzip(str) : str;\n  const c = compress ? 'c' : 'r';\n  const ext = json.hasOwnProperty('edges') ? `.gf${c}` :  `.nd${c}`;\n  downloadDataFile(data, `${name}${ext}`);\n}\n\n\nexport default {\n  readFile, parseJSON, loadJSON, fetchJSON,\n  downloadDataFile, downloadJSON\n};\n","\n/** @module component/button */\n\nimport d3 from 'd3';\n\n\nfunction buttonBox(selection, id, label, type) {\n  selection\n      .classed('form-group', true)\n      .classed('mb-1', true)\n    .append('button')\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed('btn-sm', true)\n      .attr('id', id)\n      .text(label);\n}\n\n\nfunction menuButton(selection, id, label, type) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .attr('id', id)\n      .text(label);\n}\n\n\nfunction menuButtonLink(selection, id, label, type) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .attr('role', 'button')\n      .attr('href', '#')\n      .attr('id', id)\n      .text(label);\n}\n\n\nfunction menuModalLink(selection, id, label, type, target) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .attr('id', id)\n      .attr('href', '#')\n      .attr('role', 'button')\n      .attr('data-toggle', 'modal')\n      .attr('data-target', `#${target}`)\n      .text(label);\n}\n\n\nfunction dropdownMenuButton(selection, id, label, type) {\n  selection\n      .classed('btn-group', true)\n      .classed('mr-1', true)\n      .attr('id', id);\n  selection.append('button')\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed('btn-sm', true)\n      .classed('dropdown-toggle', true)\n      .attr('data-toggle', 'dropdown')\n      .text(label);\n  selection.append('div')\n      .classed('dropdown-menu', true);\n}\n\n\nfunction dropdownMenuItem(selection, id, label) {\n  selection.classed('dropdown-item', true)\n      .attr('id', id)\n      .attr('href', '#')\n      .text(label);\n}\n\nfunction dropdownMenuModal(selection, id, label, target) {\n  selection.classed('dropdown-item', true)\n      .attr('id', id)\n      .attr('href', '#')\n      .attr('data-toggle', 'modal')\n      .attr('data-target', `#${target}`)\n      .text(label);\n}\n\n\nfunction dropdownMenuFile(selection, id, label, accept) {\n  selection.classed('dropdown-item', true)\n      .attr('id', id)\n      .attr('href', '#')\n      .text(label)\n      .on('click', function () {\n        d3.select(this).select('input').node().click();\n      })\n    .append('form')\n      .style('display', 'none')\n    .append('input')\n      .attr('type', 'file')\n      .attr('accept', accept);\n}\n\n\nfunction dropdownMenuFileValue(selection) {\n  return selection.select('input').node().files[0];\n}\n\n\nexport default {\n  buttonBox, menuButton, menuButtonLink, menuModalLink,\n  dropdownMenuButton, dropdownMenuItem, dropdownMenuModal,\n  dropdownMenuFile, dropdownMenuFileValue\n};\n","\n/** @module common/legacySchema */\n\nimport d3 from 'd3';\nimport {default as misc} from './misc.js';\n\n\nconst statusConv = {\n  Queued: 'ready',\n  'In progress': 'running',\n  Aborting: 'running',\n  Aborted: 'aborted',\n  Completed: 'done',\n  Failure: 'failure'\n};\n\nconst dataTypeConv = {\n  datatable: 'nodes',\n  connection: 'edges'\n};\n\nfunction v07_to_v08_nodes(json) {\n  const fields = json.columns.map(e => {\n    if (e.sort === 'numeric') {\n      e.format = 'numeric';\n    } else if (e.sort === 'text') {\n      e.format = 'text';\n    } else if (e.sort === 'none') {\n      e.format = 'raw';\n    }\n    return e;\n  });\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    status: statusConv[json.status],\n    fields: fields,\n    records: json.records,\n    query: json.query,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n  };\n}\n\nfunction v07_to_v08_edges(json, nodeFields) {\n  const snp = {\n    fieldTransform: json.snapshot.fieldTransform,\n    nodePositions: json.snapshot.nodePositions,\n    nodeColor: {},\n    nodeSize: {},\n    nodeLabel: {},\n    edge: {}\n  };\n  if (json.snapshot.hasOwnProperty('nodeColor')) {\n    snp.nodeColor.id = json.snapshot.nodeColor.id;\n    snp.nodeColor.scale = json.snapshot.nodeColor.scale;\n    snp.nodeColor.field = nodeFields.find(e => e.key === json.snapshot.nodeColor.column);\n  } else {\n    snp.nodeColor = {\n      id: 'color', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeSize')) {\n    snp.nodeSize.id = json.snapshot.nodeSize.id;\n    snp.nodeSize.scale = json.snapshot.nodeSize.scale;\n    snp.nodeSize.field = nodeFields.find(e => e.key === json.snapshot.nodeSize.column);\n  } else {\n    snp.nodeSize = {\n      id: 'size', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: [20, 20], unknown: 20}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeLabel')) {\n    snp.nodeLabel.id = json.snapshot.nodeLabel.id;\n    snp.nodeLabel.size = json.snapshot.nodeLabel.size;\n    snp.nodeLabel.text = json.snapshot.nodeLabel.text;\n    snp.nodeLabel.visible = json.snapshot.nodeLabel.visible;\n    snp.nodeLabel.scale = json.snapshot.nodeLabel.scale;\n    snp.nodeLabel.field = nodeFields.find(e => e.key === json.snapshot.nodeLabel.column);\n  } else {\n    snp.nodeLabel = {\n      id: 'label', size: 12, text: 'index', visible: false, field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeContent')) {\n    snp.nodeContent = json.snapshot.nodeContent;\n  } else {\n    snp.nodeContent = {structure: {visible: false}};\n  }\n  if (json.snapshot.hasOwnProperty('edge')) {\n    snp.edge = json.snapshot.edge;\n  } else {\n    snp.edge = {\n      id: 'label', label: {size: 10, visible: false}, visible: true,\n      scale: {scale: 'linear', domain: [0, 1], range: [5, 5], unknown: 5}\n    };\n  }\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    reference: {\n      nodes: json.nodeTableId\n    },\n    status: statusConv[json.status],\n    fields: misc.defaultFieldProperties([\n      {'key': 'source'},\n      {'key': 'target'},\n      {'key': 'weight'}\n    ]),\n    records: json.records,\n    query: json.query,\n    networkThreshold: json.networkThreshold,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n    snapshot: snp\n  };\n}\n\n\nfunction v08_nodes(json) {\n  json.records.forEach((e, i) => {\n    e.index = i;\n    e.structure = e._structure;\n    delete e._index;\n    delete e._structure;\n  });\n  json.fields.forEach(e => {\n    if (e.key === '_index') e.key = 'index';\n    if (e.key === '_structure') e.key = 'structure';\n    if (e.sort === 'numeric') e.format = 'numeric';\n    if (e.sort === 'text') e.format = 'text';\n    if (e.sort === 'none') e.format = 'raw';\n  });\n  return json;\n}\n\nfunction v08_graph(json) {\n  if (!json.edges.hasOwnProperty('reference')) { // ver0.8.0-0.8.1\n    json.edges.reference = {nodes: json.edges.nodesID};\n  }\n  if (json.nodes.fields.find(e => e.key === '_index')) {\n    const idx_converter = {};\n    json.nodes.records.forEach((e, i) => {\n        e.index = i;\n        e.structure = e._structure;\n        idx_converter[e._index] = e.index;\n        delete e._index;\n        delete e._structure;\n    });\n    json.edges.records.forEach(e => {\n        e.source = idx_converter[e.source];\n        e.target = idx_converter[e.target];\n    });\n    json.nodes.fields.forEach(e => {\n      if (e.key === '_index') e.key = 'index';\n      if (e.key === '_structure') e.key = 'structure';\n      if (e.sort === 'numeric') e.format = 'numeric';\n      if (e.sort === 'text') e.format = 'text';\n      if (e.sort === 'none') e.format = 'raw';\n    });\n  }\n  return json;\n}\n\nfunction v10_nodes(json) {\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: json.dataType,\n    schemaVersion: '0.10',\n    revision: json.revision,\n    status: json.status,\n    fields: json.fields,\n    records: json.records,\n    query: json.query,\n    progress: json.progress,\n    execTime: json.execTime,\n    created: json.created,\n    reference: {}\n  };\n}\n\n\nfunction v10_edges(json) {\n  const snapshot = {\n    networkThreshold: json.networkThreshold\n  };\n  snapshot.nodeContentVisible = json.snapshot.nodeContent.structure.visible;\n  snapshot.nodeColor = json.snapshot.nodeColor.scale || {};\n  if (snapshot.nodeColor.field) {\n    snapshot.nodeColor.field = json.snapshot.nodeColor.field.key;\n    if (snapshot.nodeColor.field === '_index') {\n      snapshot.nodeColor.field = 'index';\n    }\n  }\n  if (snapshot.nodeColor.scale === 'ordinal') {\n    snapshot.nodeColor.range = d3.schemeCategory20;\n  }\n  snapshot.nodeSize = json.snapshot.nodeSize.scale || {};\n  if (json.snapshot.nodeSize.field) {\n    snapshot.nodeSize.field = json.snapshot.nodeSize.field.key;\n    if (snapshot.nodeSize.field === '_index') {\n      snapshot.nodeSize.field = 'index';\n    }\n  }\n  snapshot.nodeLabel = {};\n  if (json.snapshot.nodeLabel.text) {\n    snapshot.nodeLabel.text = json.snapshot.nodeLabel.text.key;\n    if (snapshot.nodeLabel.text === '_index') {\n      snapshot.nodeLabel.text = 'index';\n    }\n  }\n  snapshot.nodeLabel.size = json.snapshot.nodeLabel.size;\n  snapshot.nodeLabel.visible = json.snapshot.nodeLabel.visible;\n  snapshot.nodeLabelColor = json.snapshot.nodeLabel.scale || {};\n  if (json.snapshot.nodeLabel.field) {\n    snapshot.nodeLabelColor.field = json.snapshot.nodeLabel.field.key;\n    if (snapshot.nodeLabelColor.field === '_index') {\n      snapshot.nodeLabelColor.field = 'index';\n    }\n  }\n  if (snapshot.nodeLabelColor.scale === 'ordinal') {\n    snapshot.nodeLabelColor.range = d3.schemeCategory20;\n  }\n  snapshot.edgeVisible = json.snapshot.edge.visible;\n  snapshot.edgeWidth = json.snapshot.edge.scale || {};\n  snapshot.edgeLabel = {};\n  snapshot.edgeLabel.size = json.snapshot.edge.label.size;\n  snapshot.edgeLabel.visible = json.snapshot.edge.label.visible;\n  snapshot.networkThreshold = json.networkThreshold || json.query.threshold;\n  snapshot.coords = json.snapshot.nodePositions;\n  // TODO: when created date is lost\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: json.dataType,\n    schemaVersion: '0.10',\n    revision: json.revision,\n    status: json.status,\n    fields: json.fields,\n    records: json.records,\n    query: {params: json.query},\n    progress: json.progress,\n    execTime: json.execTime,\n    created: json.created,\n    snapshot: snapshot,\n    reference: json.reference\n  };\n}\n\nfunction convertTable(json) {\n  let data = json;\n  if (!(data.hasOwnProperty('schemaVersion') || data.hasOwnProperty('$schema'))) { // v0.7\n    data = v07_to_v08_nodes(data);\n  }\n  if (data.schemaVersion == '0.8') {\n    data = v08_nodes(data);\n    data = v10_nodes(data);\n  }\n  if (!data.hasOwnProperty('$schema')) {\n    delete data.schemaVersion;\n    delete data.revision;\n    data.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n  }\n  data.fields.filter(e => e.key === 'structure')\n    .forEach(e => {\n      e.format = 'svg';\n    });\n  return data;\n}\n\nfunction convertNetwork(json) {\n  let data = json;\n  if (!(data.edges.hasOwnProperty('schemaVersion') || data.edges.hasOwnProperty('$schema'))) { // v0.7\n    data.nodes = v07_to_v08_nodes(data.nodes);\n    data.edges = v07_to_v08_edges(data.edges, data.nodes.fields);\n  }\n  if (data.edges.schemaVersion == '0.8' || data.edges.schemaVersion === 0.1) {  // wrong conversion of '0.10'\n    data = v08_graph(data);\n    data.nodes = v10_nodes(data.nodes);\n    data.edges = v10_edges(data.edges);\n  }\n  if (!data.edges.hasOwnProperty('$schema')) {\n    delete data.nodes.schemaVersion;\n    delete data.edges.schemaVersion;\n    delete data.nodes.revision;\n    delete data.edges.revision;\n    data.nodes.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n    data.edges.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n  }\n  return data;\n}\n\n\nexport default {\n  convertTable, convertNetwork\n};\n","\n/** @module network/state */\n\nimport d3 from 'd3';\n\nimport {default as legacy} from '../common/legacySchema.js';\nimport {default as misc} from '../common/misc.js';\n\n\nexport default class NetworkState {\n  constructor(data, width, height) {\n    // View modes\n\n    // Focused view mode (num of nodes displayed are less than the thld)\n    // Show node contents\n    // Disable smooth transition\n    this.focusedViewThreshold = 100;\n    this.enableFocusedView = true;\n    this.focusedView = false;\n    // Overlook view mode (num of nodes displayed are less than the thld)\n    // Hide edges\n    this.overlookViewThreshold = 500;\n    this.enableOverlookView = true;\n    this.overlookView = false;\n\n    // Import from legacy format data\n    this.data = legacy.convertNetwork(data);\n\n    this.nodes = JSON.parse(JSON.stringify(this.data.nodes.records));  // Working copy\n    this.edges = JSON.parse(JSON.stringify(this.data.edges.records));  // Working copy\n\n    // Adjacency\n    // Assuming that the network is undirected graph and\n    // source index < target index\n    this.nodes.forEach(n => {\n      n.adjacency = [];\n    });\n    this.edges.forEach((e, i) => {\n      e.num = i;  // e.index will be overwritten by d3-force\n      this.nodes[e.source].adjacency.push([e.target, i]);\n      this.nodes[e.target].adjacency.push([e.source, i]);\n    });\n\n    // Snapshot\n    const snp = this.data.edges.snapshot || {\n      nodeColor: {}, nodeSize: {}, nodeLabel: {}, nodeLabelColor: {},\n      edgeWidth: {}, edgeLabel: {}\n    };\n\n    // Node attributes\n    // this.nodeContentVisible = snp.nodeContentVisible || true;\n\n    // nodeColor\n    this.nodeColor = {};\n    this.nodeColor.field = snp.nodeColor.field || null;\n    this.nodeColor.scale = snp.nodeColor.scale || 'linear';\n    this.nodeColor.domain = snp.nodeColor.domain || [0, 1];\n    this.nodeColor.range = snp.nodeColor.range || ['#7fffd4', '#7fffd4'];\n    this.nodeColor.unknown = snp.nodeColor.unknown || ['#7fffd4'];\n\n    // nodeSize\n    this.nodeSize = {};\n    this.nodeSize.field = snp.nodeSize.field || null;\n    this.nodeSize.scale = snp.nodeSize.scale || 'linear';\n    this.nodeSize.domain = snp.nodeSize.domain || [1, 1];\n    this.nodeSize.range = snp.nodeSize.range || [40, 40];\n    this.nodeSize.unknown = snp.nodeSize.unknown || 40;\n\n    // nodeLabel\n    this.nodeLabel = {};\n    this.nodeLabel.text = snp.nodeLabel.text || null;\n    this.nodeLabel.size = snp.nodeLabel.size || 12;\n    this.nodeLabel.visible = snp.nodeLabel.visible || false;\n\n    // nodeLabelColor\n    this.nodeLabelColor = {};\n    this.nodeLabelColor.field = snp.nodeLabelColor.field || null;\n    this.nodeLabelColor.scale = snp.nodeLabelColor.scale || 'linear';\n    this.nodeLabelColor.domain = snp.nodeLabelColor.domain || [1, 1];\n    this.nodeLabelColor.range = snp.nodeLabelColor.range || ['#7fffd4', '#7fffd4'];\n    this.nodeLabelColor.unknown = snp.nodeLabelColor.unknown || ['#333333'];\n\n    // Edge attributes\n    // this.edgeVisible = snp.edgeVisible || true;\n    this.networkThresholdCutoff = data.edges.query.params.threshold;\n    this.networkThreshold = snp.networkThreshold || data.edges.query.params.threshold;\n\n    // edgeWidth\n    this.edgeWidth = {};\n    this.edgeWidth.scale = snp.edgeWidth.scale || 'linear';\n    this.edgeWidth.domain = snp.edgeWidth.domain || [0.5, 1];\n    this.edgeWidth.range = snp.edgeWidth.range || [1, 5];\n    this.edgeWidth.unknown = snp.edgeWidth.unknown || 1;\n\n    // edgeLabel\n    this.edgeLabel = {};\n    this.edgeLabel.size = snp.edgeLabel.size || 12;\n    this.edgeLabel.visible = snp.edgeLabel.visible || false;\n\n    // Transform\n    this.transform = snp.fieldTransform || {x: 0, y: 0, k: 1};\n\n    // Event listener\n    this.zoomListener = null;\n    this.dragListener = null;\n\n    // Update notifier\n    this.updateComponentNotifier = null;\n    this.updateNodeNotifier = null;\n    this.updateEdgeNotifier = null;\n    this.updateNodeAttrNotifier = null;\n    this.updateEdgeAttrNotifier = null;\n    // Snapshot\n    this.snapShotNotifier = null;\n    // Zoom control\n    this.fitNotifier = null;\n    // Force control\n    this.setForceNotifier = null;\n    this.stickNotifier = null;\n    this.relaxNotifier = null;\n    this.restartNotifier = null;\n\n    // Working memory\n    this.forceField = {top: 0, right: width, bottom: height, left: 0};\n    this.viewBox = {top: 0, right: width, bottom: height, left: 0};\n    this.focusArea = {};\n    this.boundary = {};\n    this.prevTransform = {\n      x: this.transform.x, y: this.transform.y, k: this.transform.k\n    };\n\n    if (snp.coords) {\n      this.simulationOnLoad = false;\n      // Set default state\n      this.setAllCoords(snp.coords);\n      this.setFocusArea();\n      this.setBoundary();\n    } else {\n      this.simulationOnLoad = true;\n    }\n  }\n\n  setBoundary() {\n    const xs = this.nodes.map(e => e.x);\n    const ys = this.nodes.map(e => e.y);\n    this.boundary.top = Math.min.apply(null, ys);\n    this.boundary.left = Math.min.apply(null, xs);\n    this.boundary.bottom = Math.max.apply(null, ys);\n    this.boundary.right = Math.max.apply(null, xs);\n    // this.showBoundary(); // debug\n  }\n\n  setFocusArea() {\n    const tx = this.transform.x;\n    const ty = this.transform.y;\n    const tk = this.transform.k;\n    const margin = 50;\n    this.focusArea.top = (this.viewBox.top - ty) / tk - margin;\n    this.focusArea.left = (this.viewBox.left - tx) / tk - margin;\n    this.focusArea.bottom = (this.viewBox.bottom - ty) / tk + margin;\n    this.focusArea.right = (this.viewBox.right - tx) / tk + margin;\n    // this.showFocusArea();  // debug\n  }\n\n  setTransform(tx, ty, tk) {\n    this.transform.x = tx;\n    this.transform.y = ty;\n    this.transform.k = tk;\n    // this.showTransform(); // debug\n    this.setFocusArea();\n  }\n\n  setViewBox(width, height) {\n    this.viewBox.right = width;\n    this.viewBox.bottom = height;\n    // this.showViewBox();  // debug\n    this.setFocusArea();\n  }\n\n  setAllCoords(coordsList) {\n    this.nodes.forEach(n => {\n      n.x = coordsList[n.index].x;\n      n.y = coordsList[n.index].y;\n      // this.edges can be changed by forceSimulation so use adjacency\n      n.adjacency.forEach(e => {\n        const nbr = e[0];\n        const edge = e[1];\n        if (n.index < nbr) {\n          this.edges[edge].sx = coordsList[n.index].x;\n          this.edges[edge].sy = coordsList[n.index].y;\n        } else {\n          this.edges[edge].tx = coordsList[n.index].x;\n          this.edges[edge].ty = coordsList[n.index].y;\n        }\n      });\n    });\n    this.setBoundary();\n  }\n\n  setCoords(n, x, y) {\n    this.nodes[n].x = x;\n    this.nodes[n].y = y;\n    this.nodes[n].adjacency.forEach(e => {\n      const nbr = e[0];\n      const edge = e[1];\n      if (n < nbr) {\n        this.edges[edge].sx = x;\n        this.edges[edge].sy = y;\n      } else {\n        this.edges[edge].tx = x;\n        this.edges[edge].ty = y;\n      }\n    });\n    this.setBoundary();\n  }\n\n  nodesToRender() {\n    return this.nodes.filter(\n      e => e.y > this.focusArea.top && e.x > this.focusArea.left\n        && e.y < this.focusArea.bottom && e.x < this.focusArea.right\n    );\n  }\n\n  edgesToRender() {\n    return this.edges.filter(\n      e => e.weight >= this.networkThreshold\n        && this.focusArea.top < Math.max(e.sy, e.ty)\n        && this.focusArea.left < Math.max(e.sx, e.tx)\n        && this.focusArea.bottom > Math.min(e.sy, e.ty)\n        && this.focusArea.right > Math.min(e.sx, e.tx)\n    );\n  }\n\n  snapshot() {\n    return {\n      nodeColor: this.nodeColor,\n      nodeSize: this.nodeSize,\n      nodeLabel: this.nodeLabel,\n      nodeLabelColor: this.nodeLabelColor,\n      edgeWidth: this.edgeWidth,\n      edgeLabel: this.edgeLabel,\n      networkThreshold: this.networkThreshold,\n      networkThresholdCutoff: this.networkThresholdCutoff,\n      fieldTransform: this.transform,\n      coords: this.nodes.map(e => ({x: e.x, y: e.y}))\n    };\n  }\n\n  export() {\n    this.data.edges.id = misc.uuidv4();\n    this.data.edges.snapshot = this.snapshot();\n    return JSON.parse(JSON.stringify(this.data));\n  }\n\n  showTransform() {\n    d3.select('#debug-transform')\n      .text(JSON.stringify(this.transform));\n  }\n\n  showBoundary() {\n    d3.select('#debug-boundary')\n      .text(JSON.stringify(this.boundary));\n  }\n\n  showFocusArea() {\n    d3.select('#debug-focusarea')\n      .text(JSON.stringify(this.focusArea));\n  }\n\n  showViewBox() {\n    d3.select('#debug-viewbox')\n      .text(JSON.stringify(this.viewBox));\n  }\n}\n","\n/** @module common/scale */\n\nimport d3 from 'd3';\n\n\nconst presets = [\n  {key: 'activity', name: 'Activity', scale: 'log', domain: [1e-4, 1e-6]},\n  {key: 'percent', name: 'Percent', scale: 'linear', domain: [0, 100]},\n  {key: 'tf', name: 'True/False', scale: 'quantize', domain: [1, 0]},\n  {key: 'mw', name: 'MW', scale: 'linear', domain: [200, 600]},\n  {key: 'logp', name: 'LogP', scale: 'linear', domain: [-2, 8]}\n];\n\n\nconst types = [\n  {key: 'linear', name: 'Linear', func: d3.scaleLinear()},\n  {key: 'log', name: 'Log', func: d3.scaleLog()},\n  {key: 'quantize', name: 'Quantize', func: d3.scaleQuantize()},\n  {key: 'ordinal', name: 'Ordinal', func: d3.scaleOrdinal()}  // not for sizeScale\n];\n\n\nconst colorPalettes = [\n  {key: 'aquamarine', name: 'Aquamarine',\n   range: ['#778899', '#7fffd4'], unknown: '#f0f0f0'},\n  {key: 'chartreuse', name: 'Chartreuse',\n   range: ['#778899', '#7fff00'], unknown: '#f0f0f0'},\n  {key: 'salmon', name: 'Salmon',\n   range: ['#778899', '#fa8072'], unknown: '#f0f0f0'},\n  {key: 'violet', name: 'Violet',\n   range: ['#778899', '#ee82ee'], unknown: '#f0f0f0'},\n  {key: 'temperature', name: 'Temperature',\n   range: ['#87ceeb', '#fff5ee', '#fa8072'], unknown: '#f0f0f0'},\n  {key: 'spectrum', name: 'Spectrum',\n   range: ['#6495ed', '#ccff66', '#ffa500'], unknown: '#f0f0f0'}\n];\n\n\n// TODO: Remove gray (for unknown) from categorical 20 and 40\nconst colorRangeTypes = [\n  {key: 'continuous', name: 'Continuous', size: 2},\n  {key: 'two-piece', name: 'Two-piece', size: 3},\n  {key: 'category10', name: 'Category 10', size: 10,\n   range: d3.schemeCategory10, unknown: '#f0f0f0'},\n  {key: 'category20', name: 'Category 20', size: 20,\n   range: d3.schemePaired.concat(d3.schemeSet2), unknown: '#f0f0f0'},\n  {key: 'category40', name: 'Category 40', size: 40,\n   range: d3.schemePaired.concat(d3.schemePastel2, d3.schemeSet2, d3.schemeSet3),\n   unknown: '#f0f0f0'}\n];\n\n\nfunction scaleFunction(attr) {\n  let sf = types.find(e => e.key == attr.scale).func;\n  let domain = attr.domain;\n  if (attr.range.length == 3) {\n    const mid = (parseFloat(attr.domain[0]) + parseFloat(attr.domain[1])) / 2;\n    domain = [attr.domain[0], mid, attr.domain[1]];\n  }\n  if (attr.scale !== 'ordinal') {\n    sf = sf.domain(domain);\n  }\n  sf = sf.range(attr.range);\n  if (['linear', 'log'].includes(attr.scale)) {\n    sf = sf.clamp(true);\n  }\n  return d => {\n    if (d === '' || typeof d === 'undefined' || d === null) {\n      return attr.unknown;  // invalid values\n    }\n    if (attr.scale !== 'ordinal' && parseFloat(d) != d) {\n      return attr.unknown;  // texts\n    }\n    if (attr.scale === 'log' && d <= 0) {\n      return attr.unknown;  // negative values in log scale\n    }\n    const result = sf(d);\n    if (result === undefined) {\n      return attr.unknown;  // TODO: specify unexpected behavior\n    }\n    return result;\n  };\n}\n\n\nexport default {\n  presets, types, colorPalettes, colorRangeTypes,\n  scaleFunction\n};\n","\n/** @module network/component */\n\nimport d3 from 'd3';\n\nimport {default as scale} from '../common/scale.js';\nimport {default as misc} from '../common/misc.js';\n\n\nconst svgWidth = 180;  //TODO\nconst svgHeight = 180;  //TODO\n\n\nfunction updateNodes(selection, records, showStruct) {\n  const nodes = selection.selectAll('.node')\n    .data(records, d => d.index);\n  nodes.exit().remove();\n  const entered = nodes.enter()\n    .append('g')\n      .attr('class', 'node')\n      .call(updateNodeCoords);\n  entered.append('circle')\n      .attr('class', 'node-symbol');\n  entered.append('g')\n      .attr('class', 'node-content')\n      .attr('transform', `translate(${-svgWidth / 2},${-svgHeight / 2})`);\n  entered.append('text')\n      .attr('class', 'node-label')\n      .attr('x', 0)\n      .attr('text-anchor', 'middle');\n  const merged = entered.merge(nodes);\n  if (showStruct) {\n    merged.select('.node-content').html(d => d.structure);\n  } else {\n    merged.select('.node-content').select('svg').remove();\n  }\n}\n\n\nfunction updateEdges(selection, records) {\n  const edges = selection.selectAll('.link')\n    .data(records, d => `${d.source}_${d.target}`);\n  edges.exit().remove();\n  const entered = edges.enter()\n    .append('g')\n      .attr('class', 'link');\n  entered.append('line')\n      .attr('class', 'edge-line')\n      .style('stroke', '#999')\n      .style('stroke-opacity', 0.6);\n  entered.append('text')\n      .attr('class', 'edge-label')\n      .attr('text-anchor', 'middle')\n      .text(d => d.weight);\n  // draw all components and then\n  entered.call(updateEdgeCoords);\n}\n\n\nfunction updateNodeAttrs(selection, state) {\n  selection.selectAll('.node')\n    .each(function (d) {\n      const color = scale.scaleFunction(state.nodeColor)(d[state.nodeColor.field]);\n      const size = scale.scaleFunction(state.nodeSize)(d[state.nodeSize.field]);\n      const labelColor = scale.scaleFunction(state.nodeLabelColor)(d[state.nodeLabelColor.field]);\n      d3.select(this).select('.node-symbol')\n          .attr('r', size)\n          .style('fill', color);\n      d3.select(this).select('.node-label')\n          .text(d => {\n            if (state.nodeLabel.text === null) return '';\n            const field = state.data.nodes.fields.find(e => e.key === state.nodeLabel.text);\n            if (field.format === 'd3_format') {\n              return misc.formatNum(d[state.nodeLabel.text], field.d3_format);\n            }\n            return d[state.nodeLabel.text];\n          })\n          .attr('font-size', state.nodeLabel.size)\n          .attr('y', parseFloat(size) + parseInt(state.nodeLabel.size))\n          .attr('visibility', state.nodeLabel.visible ? 'inherit' : 'hidden')\n          .style('fill', labelColor);\n    });\n}\n\n\nfunction updateEdgeAttrs(selection, state) {\n  selection.selectAll('.link').select('.edge-line')\n    .style('stroke-width', d => scale.scaleFunction(state.edgeWidth)(d.weight));\n  selection.selectAll('.link').select('.edge-label')\n    .attr('visibility', state.edgeLabel.visible ? 'inherit' : 'hidden')\n    .attr('font-size', state.edgeLabel.size);\n}\n\n\nfunction updateNodeCoords(selection) {\n  selection.attr('transform', d => `translate(${d.x}, ${d.y})`);\n}\n\n\nfunction updateEdgeCoords(selection) {\n  selection.attr('transform', d => `translate(${d.sx}, ${d.sy})`);\n  selection.select('.edge-line')\n    .attr('x1', 0)\n    .attr('y1', 0)\n    .attr('x2', d => d.tx - d.sx)\n    .attr('y2', d => d.ty - d.sy);\n  selection.select('.edge-label')\n    .attr('x', d => (d.tx - d.sx) / 2)\n    .attr('y', d => (d.ty - d.sy) / 2);\n}\n\n\nfunction updateAttrs(selection, state) {\n  selection.select('.nw-nodes').call(updateNodeAttrs, state);\n  selection.select('.nw-edges').call(updateEdgeAttrs, state);\n}\n\n\nfunction updateComponents(selection, state) {\n  const nodesToRender = state.nodesToRender();\n  const numNodes = nodesToRender.length;\n  if (state.enableFocusedView) {\n    state.focusedView = numNodes < state.focusedViewThreshold;\n  }\n  if (state.enableOverlookView) {\n    state.overlookView = numNodes > state.overlookViewThreshold;\n  }\n  const edgesToRender = state.overlookView ? [] : state.edgesToRender();\n  selection.select('.nw-nodes')\n    .call(updateNodes, nodesToRender, state.focusedView);\n  selection.select('.nw-edges')\n    .call(updateEdges, edgesToRender);\n  selection.call(updateAttrs, state);\n  // Rebind event listeners\n  if (state.zoomListener) {\n    selection.call(state.zoomListener);\n  }\n  if (state.dragListener) {\n    selection.select('.nw-nodes').selectAll('.node')\n      .call(state.dragListener);\n  }\n}\n\n\nfunction moveNode(selection, x, y) {\n  selection.attr('transform', `translate(${x}, ${y})`);\n}\n\n\nfunction moveEdge(selection, sx, sy, tx, ty) {\n  selection.attr('transform', `translate(${sx}, ${sy})`);\n  selection.select('.edge-line')\n    .attr('x1', 0)\n    .attr('y1', 0)\n    .attr('x2', tx - sx)\n    .attr('y2', ty - sy);\n  selection.select('.edge-label')\n    .attr('x', (tx - sx) / 2)\n    .attr('y', (ty - sy) / 2);\n}\n\n\nfunction move(selection, node, x, y) {\n  const n = d3.select(node).call(moveNode, x, y).datum();\n  selection.select('.nw-edges')\n    .selectAll(\".link\")\n    .filter(d => n.adjacency.map(e => e[1]).includes(d.num))\n    .each(function (d) {\n      if (n.index === d.source.index || n.index === d.source) {\n        d3.select(this).call(moveEdge, x, y, d.tx, d.ty);\n      } else if (n.index === d.target.index || n.index === d.target) {\n        d3.select(this).call(moveEdge, d.sx, d.sy, x, y);\n      }\n    });\n}\n\n\nfunction transform(selection, tx, ty, tk) {\n  selection.select('.nw-field')\n    .attr('transform', `translate(${tx}, ${ty}) scale(${tk})`);\n}\n\n\nfunction resizeViewBox(selection, width, height) {\n  selection.attr('viewBox', `0 0 ${width} ${height}`);\n  selection.select('.nw-view-boundary')\n    .attr('width', width)\n    .attr('height', height);\n}\n\n\nexport default {\n  updateNodes, updateEdges, updateNodeCoords, updateEdgeCoords,\n  updateNodeAttrs, updateEdgeAttrs, updateAttrs, updateComponents,\n  move, transform, resizeViewBox\n};\n","\n/** @module network/view */\n\nimport {default as component} from './component.js';\n\n\nfunction networkViewFrame(selection, state) {\n  selection\n    .style('width', '100%')\n    .style('height', '100%');\n  selection.select('.nw-view').remove(); // Clean up\n  selection.append('svg')\n    .classed('nw-view', true);\n  selection.call(resize, state);\n}\n\n\nfunction resize(selection, state) {\n  const area = selection.node();\n  state.setViewBox(area.offsetWidth, area.offsetHeight);\n  selection.select('.nw-view')\n    .call(component.resizeViewBox, area.offsetWidth, area.offsetHeight);\n}\n\n\nfunction networkView(selection, state) {\n  selection\n    .attr('preserveAspectRatio', 'xMinYMin meet')\n    .attr('pointer-events', 'all')\n    .attr('viewBox', `0 0 ${state.viewBox.right} ${state.viewBox.bottom}`)\n    .style('width', '100%')\n    .style('height', '100%');\n\n  // Clean up\n  selection.select('.nw-view-boundary').remove();\n  selection.select('.nw-field').remove();\n\n  // Render\n  selection.append('rect')\n      .classed('nw-view-boundary', true)\n      .attr('x', 0)\n      .attr('y', 0)\n      .attr('width', state.viewBox.right)\n      .attr('height', state.viewBox.bottom)\n      .attr('fill', '#ffffff')\n      .attr('stroke-width', 1)\n      .attr('stroke', '#cccccc');\n  const field = selection.append('g')\n      .classed('nw-field', true)\n      .style('opacity', 1e-6);\n  field.transition()\n      .duration(1000)\n      .style('opacity', 1);\n  const edges = field.append('g').classed('nw-edges', true);\n  const nodes = field.append('g').classed('nw-nodes', true);\n\n  // Set notifiers\n  state.updateComponentNotifier = () => {\n    selection.call(component.updateComponents, state);\n  };\n  state.updateNodeNotifier = () => {\n    nodes.call(component.updateNodes, state.nodesToRender());\n  };\n  state.updateEdgeNotifier = () => {\n    edges.call(component.updateEdges, state.edgesToRender());\n  };\n  state.updateNodeAttrNotifier = () => {\n    nodes.call(component.updateNodeAttrs, state);\n  };\n  state.updateEdgeAttrNotifier = () => {\n    edges.call(component.updateEdgeAttrs, state);\n  };\n\n  // Update graph components\n  selection.call(component.updateComponents, state);\n}\n\n\nexport default {\n  networkViewFrame, resize, networkView\n};\n","\n/** @module network/interaction */\n\nimport d3 from 'd3';\n\nimport {default as component} from './component.js';\n\n\nfunction dragListener(selection, state) {\n  return d3.drag()\n    .on('drag', function () {\n      selection.call(component.move, this, d3.event.x, d3.event.y);\n    })\n    .on('end', function (d) {\n      state.setCoords(d.index, d3.event.x, d3.event.y);\n    });\n}\n\n\nfunction zoomListener(selection, state) {\n  return d3.zoom()\n    .on('zoom', function() {\n      const t = d3.event.transform;\n      selection.call(component.transform, t.x, t.y, t.k);\n      // Smooth transition\n      if (!state.focusedView) {\n        const p = state.prevTransform;\n        const xMoved = t.x > p.x + 20 || t.x < p.x - 20;\n        const yMoved = t.y > p.y + 20 || t.y < p.y - 20;\n        const zoomIn = t.k > p.k;\n        if (xMoved || yMoved && !zoomIn) {\n          state.setTransform(t.x, t.y, t.k);\n          state.prevTransform = {x: t.x, y: t.y, k: t.k};\n          selection\n            .call(component.updateComponents, state);\n        }\n      }\n    })\n    .on('end', function() {\n      const t = d3.event.transform;\n      state.setTransform(t.x, t.y, t.k);\n      state.prevTransform = {x: t.x, y: t.y, k: t.k};\n      selection\n        .call(component.updateComponents, state);\n    });\n}\n\n\nfunction setInteraction(selection, state) {\n  state.zoomListener = zoomListener(selection, state);\n  state.dragListener = dragListener(selection, state);\n  selection.call(state.zoomListener);\n  selection.select('.nw-nodes')\n    .selectAll('.node')\n      .call(state.dragListener);\n  state.fitNotifier = () => {\n    selection.call(fit, state);\n  };\n  // Resume zoom event\n  const t = state.transform;\n  selection\n      .call(component.transform, t.x, t.y, t.k)\n      .call(\n        d3.zoom().transform,\n        d3.zoomIdentity.translate(t.x, t.y).scale(t.k)\n      );\n\n}\n\n\nfunction fit(selection, state) {\n  const viewBox = selection.select('.nw-view-boundary').node().getBBox();\n  const viewBoxRatio = viewBox.width / viewBox.height;\n  const boundaryHeight = state.boundary.bottom - state.boundary.top;\n  const boundaryWidth = state.boundary.right - state.boundary.left;\n  const boundaryRatio = boundaryWidth / boundaryHeight;\n  const scale = viewBoxRatio >= boundaryRatio\n    ? viewBox.height / boundaryHeight\n    : viewBox.width / boundaryWidth;\n  const tx = -state.boundary.left * scale;\n  const ty = -state.boundary.top * scale;\n  state.setTransform(tx, ty, scale);\n  selection\n      .call(component.updateComponents, state)\n      .call(component.transform, tx, ty, scale)\n      .call(\n        d3.zoom().transform,\n        d3.zoomIdentity.translate(tx, ty).scale(scale)\n      );\n}\n\n\nexport default {\n  dragListener, zoomListener, setInteraction, fit\n};\n","\n/** @module network/force */\n\nimport d3 from 'd3';\n\nimport {default as component} from './component.js';\nimport {default as interaction} from './interaction.js';\n\n\nfunction forceSimulation(width, height) {\n  return d3.forceSimulation()\n    .force('link',\n      d3.forceLink().id(d => d.index)\n        .distance(60)\n        .strength(1))\n    .force('charge',\n      d3.forceManyBody()\n        .strength(-600)\n        .distanceMin(15)\n        .distanceMax(720))\n    .force('collide',\n      d3.forceCollide()\n        .radius(90))\n    .force('center',\n      d3.forceCenter(width / 2, height / 2))\n    .force('x',\n      d3.forceX()\n        .strength(0.002))\n    .force('y',\n      d3.forceY()\n        .strength(0.002))\n    .stop();\n}\n\n\nfunction showTemperature(simulation) {\n  const alpha = simulation.alpha();\n  const isStopped = alpha <= simulation.alphaMin();\n  // TODO: select temperature indicator\n  const progress = parseInt(isStopped ? 0 : alpha * 100);\n  d3.select('#temperature')\n    .classed('bg-success', isStopped)\n    .classed('bg-warning', !isStopped)\n    .style('width', `${progress}%`)\n    .attr('aria-valuenow', progress);\n}\n\n\nfunction forceDragListener(selection, simulation, state) {\n  return d3.drag()\n    .on('start', () => {\n      if (!d3.event.active) selection.call(relax, simulation, state);\n    })\n    .on('drag', d => {\n      d.fx = d3.event.x;\n      d.fy = d3.event.y;\n    })\n    .on('end', d => {\n      if (!d3.event.active) simulation.alphaTarget(0);\n      d.fx = null;\n      d.fy = null;\n    });\n}\n\n\nfunction end(selection, simulation, state) {\n  const coords = state.nodes.map(e => ({x: e.x, y: e.y}));\n  state.setAllCoords(coords);\n  selection\n    .call(component.updateComponents, state);\n  showTemperature(simulation);\n}\n\n\nfunction stick(selection, simulation, state) {\n  simulation.alpha(0).stop();\n  selection.select('.nw-nodes').selectAll('.node')\n    .each(d => {\n      d.fx = d.x;\n      d.fy = d.y;\n    });\n  state.dragListener = interaction.dragListener(selection, state);\n  selection.call(end, simulation, state);\n}\n\n\nfunction unstick(selection, simulation, state) {\n  selection.select('.nw-nodes').selectAll('.node')\n    .each(d => {\n      d.fx = null;\n      d.fy = null;\n    });\n  state.dragListener = forceDragListener(selection, simulation, state);\n  // Render all nodes and do not render edges\n  // TODO: edge rendering behavior should be changed by data size or setting\n  const coords = state.nodes.map(e => ({x: e.x, y: e.y}));\n  state.setAllCoords(coords);\n  selection\n    .call(component.updateComponents, state);\n}\n\n\nfunction relax(selection, simulation, state) {\n  selection.call(unstick, simulation, state);\n  simulation.alpha(0.1).restart();\n}\n\n\nfunction restart(selection, simulation, state) {\n  selection.call(unstick, simulation, state);\n  simulation.alpha(1).restart();\n}\n\n\nfunction setForce(selection, simulation, state) {\n  const forceEdges = state.edges\n    .filter(e => e.weight >= state.networkThreshold);\n  simulation.nodes(state.nodes)\n    .force('link').links(forceEdges);\n}\n\nfunction activate(selection, simulation, state) {\n  selection.call(setForce, simulation, state);\n  simulation\n    .on('tick', () => {\n      selection.select('.nw-nodes').selectAll(\".node\")\n        .call(component.updateNodeCoords);\n      const coords = state.nodes.map(e => ({x: e.x, y: e.y}));\n      state.setAllCoords(coords);\n      selection.select('.nw-edges').selectAll(\".link\")\n        .call(component.updateEdgeCoords);\n      showTemperature(simulation);\n    })\n    .on('end', () => selection.call(end, simulation, state));\n  state.setForceNotifier = () => {\n    selection.call(setForce, simulation, state);\n  };\n  state.stickNotifier = () => {\n    selection.call(stick, simulation, state);\n  };\n  state.relaxNotifier = () => {\n    selection.call(relax, simulation, state);\n  };\n  state.restartNotifier = () => {\n    selection.call(restart, simulation, state);\n  };\n  if (state.simulationOnLoad) {\n    selection.call(restart, simulation, state);\n  } else {\n    selection.call(stick, simulation, state);\n  }\n}\n\n\nexport default {\n  forceSimulation, activate, stick, relax, restart\n};\n","\n/** @module common/mapper */\n\nimport _ from 'lodash';\n\nimport {default as misc} from './misc.js';\n\n\n/**\n * Convert single field mapping to multi field mapping\n * @param {object} mapping - single field mapping\n * @return {object} multi field mapping\n */\nfunction singleToMulti(mapping) {\n  const newMapping = {};\n  Object.entries(mapping.mapping).forEach(m => {\n    newMapping[m[0]] = [m[1]];\n  });\n  return {\n    created: mapping.created,\n    fields: [mapping.field],\n    key: mapping.key,\n    mapping: newMapping\n  };\n}\n\n\n/**\n * Convert field mapping to table\n * @param {object} mapping - field mapping\n * @return {object} table object\n */\nfunction mappingToTable(mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  const keyField = {key: mp.key, format: 'text'};\n  const data = {\n    fields: misc.defaultFieldProperties([keyField].concat(mp.fields)),\n    records: Object.entries(mp.mapping).map(entry => {\n      const rcd = {};\n      rcd[mp.key] = entry[0];\n      mp.fields.forEach((f, i) => {\n        rcd[f.key] = entry[1][i];\n      });\n      return rcd;\n    })\n  };\n  return data;\n}\n\n\n/**\n * Convert table to field mapping\n * @param {object} table - table\n * @param {object} key - key\n * @return {object} field mapping\n */\nfunction tableToMapping(table, key, ignore=['index']) {\n  const now = new Date();\n  const mapping = {\n    created: now.toString(),\n    fields: misc.defaultFieldProperties(table.fields\n      .filter(e => e.key !== key)\n      .filter(e => !ignore.includes(e.key))),\n    key: key,\n    mapping: {}\n  };\n  table.records.forEach(row => {\n    mapping.mapping[row[key]] = mapping.fields.map(e => row[e.key]);\n  });\n  return mapping;\n}\n\n\n/**\n * Convert csv text to field mapping\n * @param {string} csvString - csv data text\n * @return {object} field mapping\n */\nfunction csvToMapping(csvString) {\n  const lines = csvString.split(/\\n|\\r|\\r\\n/);\n  const header = lines.shift().split(',');\n  const key = header.shift();\n  const now = new Date();\n  const headerIdx = [];\n  const fields = [];\n  header.forEach((h, i) => {\n    if (h === '') return;\n    headerIdx.push(i);\n    fields.push({key: h, format: 'text'});\n  });\n  const mapping = {\n    created: now.toString(),\n    fields: misc.defaultFieldProperties(fields),\n    key: key,\n    mapping: {}\n  };\n  lines.forEach(line => {\n    const values = line.split(',');\n    const k = values.shift();\n    mapping.mapping[k] = Array(headerIdx.length);\n    headerIdx.forEach(i => {\n      mapping.mapping[k][i] = values[i];\n    });\n  });\n  return mapping;\n}\n\n\n/**\n * Apply mapping to the data (in-place)\n * @param {object} data - datatable JSON\n * @param {object} mapping - mapping JSON\n * @return {undefined} undefined\n */\nfunction apply(data, mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  data.records\n    .filter(rcd => mp.mapping.hasOwnProperty(rcd[mp.key]))\n    .forEach(rcd => {\n      mp.fields.forEach((fd, i) => {\n        rcd[fd.key] = mp.mapping[rcd[mp.key]][i];\n      });\n    });\n  data.fields =  _(data.fields)\n    .concat(misc.defaultFieldProperties(mp.fields))\n    .uniqBy('key')\n    .value();\n}\n\nexport default {\n  singleToMulti, mappingToTable, tableToMapping, csvToMapping, apply\n};\n","\n/** @module component/modal */\n\nimport d3 from 'd3';\n\n\nfunction dialogBase(selection, id) {\n  selection\n      .classed('modal', true)\n      .attr('tabindex', -1)\n      .attr('role', 'dialog')\n      .attr('aria-labelledby', '')\n      .attr('aria-hidden', true)\n      .attr('id', id);\n  selection.select('.modal-dialog').remove();  // Clean up\n  selection.append('div')\n      .classed('modal-dialog', true)\n      .attr('role', 'document')\n    .append('div')\n      .classed('modal-content', true);\n}\n\n\nfunction confirmDialog(selection, id, message) {\n  const base = selection.call(dialogBase, id)\n      .select('.modal-content');\n  // body\n  base.append('div')\n      .classed('modal-body', true)\n    .append('div')\n      .classed('message', true)\n      .text(message);\n  // footer\n  const footer = base.append('div')\n      .classed('modal-footer', true);\n  footer.append('button')\n      .classed('btn', true)\n      .classed('btn-outline-secondary', true)\n      .classed('cancel', true)\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .text('Cancel');\n  footer.append('button')\n      .classed('btn', true)\n      .classed('btn-warning', true)\n      .classed('ok', true)\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .attr('data-target', `${id}-submit`)\n      .text('OK')\n      .on('click', () => {\n        d3.select('#loading-icon').style('display', 'inline');\n        selection.dispatch('submit');\n      });\n}\n\n\nfunction submitDialog(selection, id, title) {\n  const base = selection.call(dialogBase, id)\n      .select('.modal-content');\n  // header\n  const header = base.append('div')\n      .classed('modal-header', true);\n  header.append('h4')\n      .classed('modal-title', true)\n      .text(title);\n  header.append('button')\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .attr('aria-label', 'Close')\n      .classed('close', true)\n    .append('span')\n      .attr('aria-hidden', true)\n      .html('&times;');\n  // body\n  base.append('div')\n      .classed('modal-body', true);\n  // footer\n  base.append('div')\n      .classed('modal-footer', true)\n    .append('button')\n      .classed('btn', true)\n      .classed('btn-primary', true)\n      .classed('submit', true)\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .attr('data-target', `${id}-submit`)\n      .text('Submit')\n      .on('click', () => {\n        d3.select('#loading-icon').style('display', 'inline');\n        selection.dispatch('submit');\n      });\n}\n\n\nexport default {\n  confirmDialog, submitDialog\n};\n","\n/** @module component/formBox */\n\n\nfunction textBox(selection, id, label, size, value) {  // TODO: remove size\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .attr('for', id)\n      .text(label);\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('id', id)\n      .attr('type', 'text')\n      .attr('size', size);\n  selection.call(updateTextBox, value);\n}\n\nfunction updateTextBox(selection, value) {\n  selection.select('input').property('value', value);\n}\n\nfunction textBoxValue(selection) {\n  return selection.select('input').property('value');\n}\n\n\nfunction readonlyBox(selection, id, label, value) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .attr('for', id)\n      .text(label);\n  selection.append('input')\n      .classed('form-control-plaintext', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('id', id)\n      .attr('type', 'text')\n      .property('readonly', true);\n  selection.call(updateTextBox, value);\n}\n\n\nfunction textareaBox(selection, id, label, rows, placeholder, value) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .attr('for', id)\n      .text(label);\n  selection.append('textarea')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('rows', rows)\n      .attr('placeholder', placeholder)\n      .attr('id', id);\n  selection.call(updateTextareaBox, value);\n}\n\nfunction updateTextareaBox(selection, value) {\n  selection.select('textarea').property('value', value);\n}\n\nfunction textareaBoxValue(selection) {\n  const value = selection.select('textarea').property('value');\n  if (value) return value;  // TODO: 0 is falsy\n  const placeholder = selection.select('textarea').attr('placeholder');\n  if (placeholder) return placeholder;\n  return '';\n}\n\nfunction textareaBoxLines(selection) {\n  const value = selection.select('textarea').property('value');\n  if (value) return value.split('\\n').filter(e => e.length > 0);\n  const placeholder = selection.select('textarea').attr('placeholder');\n  if (placeholder) return placeholder.split('\\n').filter(e => e.length > 0);\n  return [];\n}\n\n\nfunction checkBox(selection, id, label, checked) {\n  const box = selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('form-check', true)\n    .append('label')\n      .classed('form-check-label', true)\n      .classed('col-form-label-sm', true);\n  box.append('input')\n      .classed('form-check-input', true)\n      .attr('type', 'checkbox')\n      .attr('id', id);\n  box.append('span')\n      .text(label);\n  selection.call(updateCheckBox, checked);\n}\n\nfunction updateCheckBox(selection, checked) {\n  selection.select('input').property('checked', checked);\n}\n\nfunction checkBoxValue(selection) {\n  return selection.select('input').property('checked');\n}\n\n\nfunction numberBox(selection, id, label, min, max, step, value) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .attr('for', id)\n      .text(label);\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('id', id)\n      .attr('type', 'number')\n      .attr('min', min)\n      .attr('max', max)\n      .attr('step', step);\n  selection.call(updateNumberBox, value);\n}\n\nfunction updateNumberBox(selection, value) {\n  selection.select('input').property('value', value);\n}\n\nfunction numberBoxValue(selection) {\n  return selection.select('input').property('value');\n}\n\n\nfunction fileInputBox(selection, id, label, accept) {\nselection\n    .classed('form-group', true)\n    .classed('form-row', true);\nselection.append('label')\n    .classed('col-form-label', true)\n    .classed('col-form-label-sm', true)\n    .classed('col-4', true)\n    .attr('for', id)\n    .text(label);\nselection.append('input')\n    .classed('form-control', true)\n    .classed('form-control-sm', true)\n    .classed('form-control-file', true)\n    .classed('col-8', true)\n    .attr('type', 'file')\n    .attr('accept', accept)\n    .attr('id', id);\n}\n\nfunction fileInputBoxValue(selection) {\n  return selection.select('input').property('files')[0];\n}\n\n\nexport default {\n  textBox, updateTextBox, textBoxValue, readonlyBox,\n  textareaBox, updateTextareaBox, textareaBoxValue, textareaBoxLines,\n  checkBox, updateCheckBox, checkBoxValue,\n  numberBox, updateNumberBox, numberBoxValue,\n  fileInputBox, fileInputBoxValue\n};\n","\n/** @module dialog/community */\n\n\nimport {default as button} from '../component/button.js';\nimport {default as box} from '../component/formBox.js';\nimport {default as modal} from '../component/modal.js';\n\n\nconst id = 'community-dialog';\nconst title = 'Comunity detection';\n\n\nfunction menuLink(selection) {\n  selection.call(button.dropdownMenuModal, 'community', title, id);\n}\n\n\nfunction body(selection) {\n  const dialog = selection.call(modal.submitDialog, id, title);\n  // Name\n  dialog.select('.modal-body').append('div')\n      .classed('name', true)\n      .call(box.textBox, 'comm-name', 'New name', 40, 'comm_');\n  // Assign null to isolated nodes\n  dialog.select('.modal-body').append('div')\n      .classed('nulliso', true)\n      .call(box.checkBox, 'comm-nulliso', 'Assign null to isolated nodes', true);\n}\n\n\nfunction value(selection) {\n  return {\n    name: box.textBoxValue(selection.select('.name')),\n    nulliso: box.checkBoxValue(selection.select('.nulliso'))\n  };\n}\n\n\nexport default {\n  menuLink, body, value\n};\n","\n/** @module dialog/rename */\n\n\nimport {default as button} from '../component/button.js';\nimport {default as box} from '../component/formBox.js';\nimport {default as modal} from '../component/modal.js';\n\n\nconst id = 'rename-dialog';\nconst title = 'Rename';\n\n\nfunction menuLink(selection) {\n  selection.call(button.dropdownMenuModal, 'rename', title, id);\n}\n\n\nfunction body(selection, name) {\n  selection.call(modal.submitDialog, id, title)\n    .select('.modal-body').append('div')\n      .classed('rename', true)\n      .call(box.textBox, 'rename', 'New name', 40, name);\n}\n\n\nfunction updateBody(selection, state) {\n  selection.select('.rename')\n      .call(box.updateTextBox, state.data.name);\n}\n\n\nfunction value(selection) {\n  return box.textBoxValue(selection.select('.rename'));\n}\n\n\nexport default {\n  menuLink, body, updateBody, value\n};\n","\n/** @module component/formListBox */\n\nimport d3 from 'd3';\n\n\n/**\n * Render select box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction selectBox(selection, id, label, fields, value) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .attr('for', id)\n      .text(label);\n  selection.append('select')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('id', id);\n  if (fields) {\n    selection.call(selectBoxItems, fields);\n    selection.call(updateSelectBox, value);\n  }\n}\n\nfunction selectBoxItems(selection, items) {\n  const options = selection.select('select')\n    .selectAll('option')\n      .data(items, d => d.key);\n  options.exit().remove();\n  options.enter()\n    .append('option')\n      .attr('value', d => d.key)\n      .text(d => d.name);\n}\n\nfunction updateSelectBox(selection, value) {\n  selection.select('select').property('value', value);\n}\n\nfunction selectBoxValue(selection) {\n  return selection.select('select').property('value');\n}\n\n\n/**\n * Render select box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction checklistBox(selection, id, label, fields, values) {\n  // TODO: scroll\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('ul')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('id', id);\n  if (fields) {\n    selection.call(checklistBoxItems, fields);\n    selection.call(updateChecklistBox, values);\n  }\n}\n\nfunction checklistBoxItems(selection, items) {\n  const listitems = selection.select('ul')\n    .selectAll('li')\n      .data(items, d => d.key);\n  listitems.exit().remove();\n  const form = listitems.enter()\n    .append('li')\n      .attr('class', 'form-check')\n    .append('label')\n      .attr('class', 'form-check-label');\n  form.append('input')\n      .attr('type', 'checkbox')\n      .attr('class', 'form-check-input')\n      .property('value', d => d.key);\n  form.append('span')\n      .text(d => d.name);\n}\n\nfunction updateChecklistBox(selection, values) {\n  if (!values) return;\n  selection.selectAll('input')\n    .each(function (d) {\n      d3.select(this).property('checked', values.includes(d.key));\n    });\n}\n\nfunction checklistBoxValue(selection) {\n  return selection.selectAll('input:checked').data().map(d => d.key);\n}\n\n\nexport default {\n  selectBox, selectBoxItems, updateSelectBox, selectBoxValue,\n  checklistBox, checklistBoxItems, updateChecklistBox, checklistBoxValue\n};\n","\n/** @module component/formRangeBox */\n\nimport d3 from 'd3';\n\n\n/**\n * Render range box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction rangeBox(selection, id, label, range) {\n  selection\n      .classed('form-row', true)\n      .classed('align-items-center', true)\n      .attr('id', id);\n  selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .classed('mb-1', true)\n      .text(label);\n  const f = selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .classed('mb-1', true);\n  f.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('py-0', true)\n      .attr('for', `${id}-from`)\n      .text('min');\n  f.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('min', true)\n      .attr('type', 'text')\n      .attr('id', `${id}-from`);\n  const t = selection.append('div')\n      .classed('form-group', true)\n      .classed('col-4', true)\n      .classed('mb-1', true);\n  t.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('py-0', true)\n      .attr('for', `${id}-to`)\n      .text('max');\n  t.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('max', true)\n      .attr('type', 'text')\n      .attr('id', `${id}-to`);\n  // TODO: validation\n  // not null, undef, text\n  // min <= max\n  selection.call(updateRangeBox, range);\n}\n\n\nfunction updateRangeBox(selection, range) {\n  // TODO: validation\n  // not null, undef, text\n  // min <= max\n  selection.select('.min').property('value', range[0]);\n  selection.select('.max').property('value', range[1]);\n}\n\n\nfunction rangeBoxValue(selection) {\n  return [\n    parseFloat(selection.select('.min').property('value')),\n    parseFloat(selection.select('.max').property('value'))\n  ];\n}\n\n\n/**\n * Render color scale box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction colorScaleBox(selection, id, label, range) {\n  selection\n      .classed('form-row', true)\n      .classed('align-items-center', true)\n      .attr('id', id);\n  selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-3', true)\n      .classed('mb-1', true)\n      .text(label);\n  const f = selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-3', true)\n      .classed('mb-1', true);\n  f.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('py-0', true)\n      .attr('for', `${id}-from`)\n      .text('min');\n  f.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('min', true)\n      .attr('type', 'color')\n      .attr('id', `${id}-from`);\n  const m = selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-3', true)\n      .classed('mb-1', true);\n  m.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('py-0', true)\n      .attr('for', `${id}-mid`)\n      .text('mid');\n  m.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('mid', true)\n      .attr('type', 'color')\n      .attr('id', `${id}-mid`);\n  const t = selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-3', true)\n      .classed('mb-1', true);\n  t.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('py-0', true)\n      .attr('for', `${id}-to`)\n      .text('max');\n  t.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('max', true)\n      .attr('type', 'color')\n      .attr('id', `${id}-to`);\n  selection\n      .call(updateColorScaleBox, range)\n      .on('change', () => {\n        // avoid update by mousemove on the colorpicker\n        d3.event.stopPropagation();\n      });\n}\n\n\nfunction updateColorScaleBox(selection, range) {\n  let rangeArray;\n  if (range.length == 2) {\n    rangeArray = [range[0], null, range[1]];\n  } else if (range.length == 3) {\n    rangeArray = [range[0], range[1], range[2]];\n  } else {\n    rangeArray = [null, null, null];\n  }\n  selection.select('.min')\n      .property('value', rangeArray[0])\n      .property('disabled', rangeArray[0] === null)\n      .style('opacity', rangeArray[0] === null ? 0.3 : null);\n  selection.select('.mid')\n      .attr('value', rangeArray[1])\n      .property('disabled', rangeArray[1] === null)\n      .style('opacity', rangeArray[1] === null ? 0.3 : null);\n  selection.select('.max')\n      .property('value', rangeArray[2])\n      .property('disabled', rangeArray[2] === null)\n      .style('opacity', rangeArray[2] === null ? 0.3 : null);\n}\n\n\nfunction colorScaleBoxValue(selection) {\n  const arr = [];\n  if (!selection.select('.min').property('disabled')) {\n    arr.push(selection.select('.min').property('value'));\n  }\n  if (!selection.select('.mid').property('disabled')) {\n    arr.push(selection.select('.mid').property('value'));\n  }\n  if (!selection.select('.max').property('disabled')) {\n    arr.push(selection.select('.max').property('value'));\n  }\n  return arr;\n}\n\n\nexport default {\n  rangeBox, updateRangeBox, rangeBoxValue,\n  colorScaleBox, updateColorScaleBox, colorScaleBoxValue\n};\n","\n/** @module component/formBoxGroup */\n\nimport d3 from 'd3';\n\nimport {default as lbox} from '../component/formListBox.js';\nimport {default as rbox} from '../component/formRangeBox.js';\nimport {default as scaledef} from '../common/scale.js';\n\n\n/**\n * Render color range control box group\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction colorRangeGroup(selection, id, palettes, rangeTypes, range) {\n  selection\n      .classed('mb-3', true);\n  selection.append('div')\n      .classed('palette', true)\n      .classed('mb-1', true)\n      .call(lbox.selectBox, `${id}-palette`, 'Color palette', palettes, 'hoge');\n  selection.append('div')\n      .classed('rangetype', true)\n      .classed('mb-1', true)\n      .call(\n        lbox.selectBox, `${id}-rangetype`, 'Range type', rangeTypes,\n        scaledef.colorRangeTypes.find(e => e.size === range.length).key\n      );\n  selection.append('div')\n      .classed('range', true)\n      .classed('mb-1', true)\n      .call(rbox.colorScaleBox, `${id}-range`, 'Range', range);\n  selection.call(updateColorRangeGroup, range);\n}\n\n\nfunction updateColorRangeGroup(selection, range) {\n  selection.select('.palette')\n      .call(\n        lbox.updateSelectBox,\n        scaledef.colorRangeTypes.find(e => e.size === range.length).key\n      )\n      .on('change', function () {\n        const value = lbox.selectBoxValue(d3.select(this));\n        const p = scaledef.colorPalettes.find(e => e.key === value);\n        const t = scaledef.colorRangeTypes.find(e => e.size === p.range.length);\n        selection.select('.rangetype').call(lbox.updateSelectBox, t.key);\n        selection.select('.range').call(rbox.updateColorScaleBox, p.range);\n      });\n  selection.select('.rangetype')\n      .on('change', function () {\n        const value = lbox.selectBoxValue(d3.select(this));\n        const size = scaledef.colorRangeTypes.find(e => e.key === value).size;\n        selection.select('.range').select('.min')\n            .property('disabled', size > 3)\n            .style('opacity', size <= 3 ? null : 0.3);\n        selection.select('.range').select('.mid')\n            .property('disabled', size !== 3)\n            .style('opacity', size === 3 ? null : 0.3);\n        selection.select('.range').select('.max')\n            .property('disabled', size > 3)\n            .style('opacity', size <= 3 ? null : 0.3);\n      });\n  selection.select('.range')\n      .call(rbox.updateColorScaleBox, range)\n      .on('focusin', () => {\n        selection.dispatch('change');\n      });\n}\n\n\nfunction colorRangeGroupValue(selection) {\n  const type = lbox.selectBoxValue(selection.select('.rangetype'));\n  const values = rbox.colorScaleBoxValue(selection.select('.range'));\n  if (!values.length) {\n    return scaledef.colorRangeTypes.find(e => e.key === type).range;\n  } else {\n    return values;\n  }\n}\n\n\n/**\n * Render scale and domain control box group\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction scaleBoxGroup(selection, id, presets, scaleTypes, scale, domain) {\n  selection\n      .classed('mb-3', true);\n  selection.append('div')\n      .classed('preset', true)\n      .classed('mb-1', true)\n      .call(lbox.selectBox, `${id}-preset`, 'Scale preset', presets, '');\n  selection.append('div')\n      .classed('scale', true)\n      .classed('mb-1', true)\n      .call(lbox.selectBox, `${id}-scale`, 'Scale type', scaleTypes, scale);\n  selection.append('div')\n      .classed('domain', true)\n      .classed('mb-1', true)\n      .call(rbox.rangeBox, `${id}-domain`, 'Domain', domain);\n  selection.call(updateScaleBoxGroup, scale, domain);\n}\n\n\nfunction updateScaleBoxGroup(selection, scale, domain) {\n  selection.select('.preset')\n    .on('change', function () {\n      const value = lbox.selectBoxValue(d3.select(this));\n      const p = scaledef.presets.find(e => e.key == value);\n      selection.select('.scale').call(lbox.updateSelectBox, p.scale);\n      selection.select('.domain').call(rbox.updateRangeBox, p.domain);\n    });\n  selection.select('.scale')\n      .call(lbox.updateSelectBox, scale)\n      .on('change', () => {\n        selection.select('.domain').dispatch('change');\n      });\n  selection.select('.domain')\n      .call(rbox.updateRangeBox, domain)\n      .on('change', function () {\n        const isLog = lbox.selectBoxValue(selection.select('.scale')) === 'log';\n        const domain = rbox.rangeBoxValue(d3.select(this));\n        const invalid = d => isNaN(d) || (isLog && d <= 0);\n        d3.select(this).select('.min')\n            .style('background-color', invalid(domain[0]) ? '#ffcccc' : '#ffffff');\n        d3.select(this).select('.max')\n            .style('background-color', invalid(domain[1]) ? '#ffcccc' : '#ffffff');\n      });\n}\n\n\nfunction scaleBoxGroupValue(selection) {\n  const scale = lbox.selectBoxValue(selection.select('.scale'));\n  const domain = rbox.rangeBoxValue(selection.select('.domain'));\n  return {scale: scale, domain: domain};\n}\n\n\nexport default {\n  colorRangeGroup, updateColorRangeGroup, colorRangeGroupValue,\n  scaleBoxGroup, updateScaleBoxGroup, scaleBoxGroupValue\n};\n","\n/** @module network/controlBox */\n\nimport d3 from 'd3';\n\nimport {default as misc} from '../common/misc.js';\nimport {default as scaledef} from '../common/scale.js';\n\nimport {default as box} from '../component/formBox.js';\nimport {default as lbox} from '../component/formListBox.js';\nimport {default as rbox} from '../component/formRangeBox.js';\nimport {default as button} from '../component/button.js';\nimport {default as group} from '../component/formBoxGroup.js';\n\n\nfunction mainControlBox(selection, state) {\n  // Zoom\n  selection.append('div')\n      .classed('mb-3', true)\n    .append('div')\n      .classed('fit', true)\n      .call(button.buttonBox, 'fit-to-screen', 'Fit to screen', 'primary');\n  // View modes\n  const viewModes = selection.append('div')\n      .classed('mb-3', true);\n    viewModes.append('div')\n      .classed('focused', true)\n      .classed('mb-1', true)\n      .call(box.checkBox, 'focused', 'Enable focused view', state.enableFocusedView);\n    viewModes.append('div')\n      .classed('overlook', true)\n      .classed('mb-1', true)\n      .call(box.checkBox, 'overlook', 'Enable overlook view', state.enableOverlookView);\n  // Network threshold\n  const thldGroup = selection.append('div')\n      .classed('mb-3', true);\n  thldGroup.append('div')\n      .classed('thld', true)\n      .classed('mb-1', true)\n      .call(box.numberBox, 'thld', 'Network threshold',\n            state.networkThresholdCutoff, 1.000, 0.01, state.networkThreshold);\n  thldGroup.append('div')\n      .classed('logd', true)\n      .classed('mb-1', true)\n      .call(box.readonlyBox, 'logd', 'logD', null);\n  // Force layout\n  const forceBox = selection.append('div')\n      .classed('form-group', true)\n      .classed('form-row', true);\n  forceBox.append('div')\n      .classed('col-6', true)\n    .append('span')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('mb-1', true)\n      .text('Temperature');\n  forceBox.append('div')\n      .classed('col-12', true)\n    .append('div')\n      .classed('progress', true)\n    .append('div')\n      .classed('progress-bar', true)\n      .classed('w-30', true)\n      .attr('id', 'temperature')\n      .attr('role', 'progressbar')\n      .attr('aria-valuemin', 0)\n      .attr('aria-valuemax', 100);\n  forceBox.append('div')\n      .classed('col-12', true)\n    .append('div')\n      .classed('stick', true)\n      .classed('mb-1', true)\n      .call(box.checkBox, 'stick-nodes', 'Stick nodes', !state.simulationOnLoad);\n  forceBox.append('div')\n      .classed('col-12', true)\n    .append('div')\n      .classed('restart', true)\n      .classed('mb-1', true)\n      .call(button.buttonBox, 'restart-force', 'Activate', 'warning');\n\n  selection.call(updateMainControlBox, state);\n}\n\n\nfunction updateMainControlBox(selection, state) {\n  // Snapshot\n  selection.select('.snapshot')\n      .on('click', function () { state.snapshotNotifier(); });\n  // Zoom\n  selection.select('.fit')\n      .on('click', function () { state.fitNotifier(); });\n  // Focused view\n  selection.select('.focused')\n      .call(box.updateCheckBox, state.enableFocusedView)\n      .on('change', function () {\n        state.enableFocusedView = box.checkBoxValue(d3.select(this));\n        state.focusedView = box.checkBoxValue(d3.select(this));\n        state.updateComponentNotifier();\n      });\n  // Overlook view\n  selection.select('.overlook')\n      .call(box.updateCheckBox, state.enableOverlookView)\n      .on('change', function () {\n        state.enableOverlookView = box.checkBoxValue(d3.select(this));\n        state.overlookView = box.checkBoxValue(d3.select(this));\n        state.updateComponentNotifier();\n      });\n  // Network threshold\n  selection.select('.thld')\n      .call(box.updateNumberBox, state.networkThreshold)\n      .on('change', function () {\n        const value = box.numberBoxValue(d3.select(this));\n        state.networkThreshold = value;\n        state.updateComponentNotifier();\n        state.setForceNotifier();\n        const numEdges = state.edges.filter(e => e.weight >= value).length;\n        const n = state.nodes.length;\n        const combinations = n * (n - 1) / 2;\n        const logD = d3.format('.2f')(Math.log10(numEdges / combinations));\n        selection.select('.logd').call(box.updateTextBox, logD);\n      })\n      .dispatch('change');\n  // Force layout\n  selection.select('.stick')\n      .call(box.updateCheckBox, !state.simulationOnLoad)\n      .on('change', function () {\n        const value = box.checkBoxValue(d3.select(this));\n        if (value) {\n          state.stickNotifier();\n          selection.select('.progress')\n            .style('background-color', '#a3e4d7');\n        } else {\n          state.relaxNotifier();\n          selection.select('.progress')\n            .style('background-color', '#e9ecef');\n        }\n      });\n  selection.select('.restart')\n      .on('click', function () { state.restartNotifier(); });\n}\n\n\n\nfunction nodeColorControlBox(selection, state) {\n  selection.append('div')\n      .classed('field', true)\n      .call(\n        lbox.selectBox, 'color-field', 'Field',\n        state.data.nodes.fields.filter(e => misc.sortType(e.format) !== 'none'),\n        state.nodeColor.field || ''\n      );\n  selection.append('div')\n      .classed('range', true)\n      .call(\n        group.colorRangeGroup, 'color', scaledef.colorPalettes,\n        scaledef.colorRangeTypes, state.nodeColor.range\n      );\n  selection.append('div')\n      .classed('scale', true)\n      .call(\n        group.scaleBoxGroup, 'color', scaledef.presets,\n        scaledef.types.filter(e => e.key !== 'ordinal'),\n        state.nodeColor.scale, state.nodeColor.domain\n      );\n\n  selection.call(updateNodeColorControlBox, state);\n}\n\n\nfunction updateNodeColorControlBox(selection, state) {\n  selection.select('.field')\n    .call(lbox.updateSelectBox, state.nodeColor.field)\n    .on('change', function () {\n      state.nodeColor.field = lbox.selectBoxValue(d3.select(this));\n      state.updateNodeAttrNotifier();\n    });\n  selection.select('.range')\n    .call(group.updateColorRangeGroup, state.nodeColor.range)\n    .on('change', function () {\n      const values = group.colorRangeGroupValue(d3.select(this));\n      state.nodeColor.range = values;\n      if (values.length > 3) {\n        state.nodeColor.scale = 'ordinal';\n        selection.select('.scale').selectAll('select,input')\n          .property('disabled', true)\n          .style('opacity', 0.3);\n      } else {\n        selection.select('.scale').selectAll('select,input')\n          .property('disabled', false)\n          .style('opacity', null);\n      }\n      state.updateNodeAttrNotifier();\n    }\n  );\n  selection.select('.scale')\n    .call(group.updateScaleBoxGroup, state.nodeColor.scale, state.nodeColor.domain)\n    .on('change', function () {\n      const values = group.scaleBoxGroupValue(d3.select(this));\n      state.nodeColor.scale = values.scale;\n      state.nodeColor.domain = values.domain;\n      state.updateNodeAttrNotifier();\n    }\n  );\n}\n\n\nfunction nodeSizeControlBox(selection, state) {\n  selection.append('div')\n    .classed('field', true)\n    .call(\n      lbox.selectBox, 'size-field', 'Field',\n      state.data.nodes.fields.filter(e => misc.sortType(e.format) === 'numeric'),\n      state.nodeSize.field || ''\n    );\n  selection.append('div')\n    .classed('range', true)\n    .classed('mb-3', true)\n    .call(rbox.rangeBox, 'size-range', 'Range', state.nodeSize.range);\n  selection.append('div')\n    .classed('scale', true)\n    .call(\n      group.scaleBoxGroup, 'size',\n      scaledef.presets.filter(e => e.scale !== 'ordinal'),\n      scaledef.types.filter(e => e.key !== 'ordinal'),\n      state.nodeSize.scale, state.nodeSize.domain\n    );\n  selection.call(updateNodeSizeControlBox, state);\n}\n\n\nfunction updateNodeSizeControlBox(selection, state) {\n  selection.select('.field')\n    .call(lbox.updateSelectBox, state.nodeSize.field)\n    .on('change', function () {\n      state.nodeSize.field = lbox.selectBoxValue(d3.select(this));\n      state.updateNodeAttrNotifier();\n    });\n  selection.select('.range')\n    .call(rbox.updateRangeBox, state.nodeSize.range)\n    .on('change', function () {\n      state.nodeSize.range = rbox.rangeBoxValue(d3.select(this));\n      state.updateNodeAttrNotifier();\n    });\n  selection.select('.scale')\n    .call(group.updateScaleBoxGroup, state.nodeSize.scale, state.nodeSize.domain)\n    .on('change', function () {\n      const values = group.scaleBoxGroupValue(d3.select(this));\n      state.nodeSize.scale = values.scale;\n      state.nodeSize.domain = values.domain;\n      state.updateNodeAttrNotifier();\n    }\n  );\n}\n\n\nfunction nodeLabelControlBox(selection, state) {\n  // nodeLabel.visible\n  selection.append('div')\n    .append('div')\n      .classed('visible', true)\n      .call(box.checkBox, 'label-visible', 'Show node labels', state.nodeLabel.visible);\n  // nodeLabel\n  const labelGroup = selection.append('div')\n      .classed('mb-3', true);\n  labelGroup.append('div')\n      .classed('text', true)\n      .classed('mb-1', true)\n      .call(\n        lbox.selectBox, 'label-text', 'Text field',\n        state.data.nodes.fields.filter(e => misc.sortType(e.format) !== 'none'),\n        state.nodeLabel.text || ''\n      );\n  labelGroup.append('div')\n      .classed('size', true)\n      .classed('mb-1', true)\n      .call(\n        box.numberBox, 'label-size', 'Font size', 6, 100, 1, state.nodeLabel.size\n      );\n  // nodeLabelColor\n  selection.append('div')\n      .classed('field', true)\n      .call(\n        lbox.selectBox, 'label-field', 'Color field',\n        state.data.nodes.fields.filter(e => misc.sortType(e.format) !== 'none'),\n        state.nodeLabelColor.field || ''\n      );\n  selection.append('div')\n      .classed('range', true)\n      .call(\n        group.colorRangeGroup, 'label', scaledef.colorPalettes,\n        scaledef.colorRangeTypes, state.nodeLabelColor.range\n      );\n  selection.append('div')\n      .classed('scale', true)\n      .call(\n        group.scaleBoxGroup, 'label', scaledef.presets,\n        scaledef.types.filter(e => e.key !== 'ordinal'),\n        state.nodeLabelColor.scale, state.nodeLabelColor.domain\n      );\n  selection.call(updateNodeLabelControlBox, state);\n}\n\n\nfunction updateNodeLabelControlBox(selection, state) {\n  // nodeLabel.visible\n  selection.select('.visible')\n      .call(box.updateCheckBox, state.nodeLabel.visible)\n      .on('change', function () {\n        state.nodeLabel.visible = box.checkBoxValue(d3.select(this));\n        state.updateNodeAttrNotifier();\n      });\n  // nodeLabel\n  selection.select('.text')\n      .call(lbox.updateSelectBox, state.nodeLabel.text)\n      .on('change', function () {\n        state.nodeLabel.text = lbox.selectBoxValue(d3.select(this));\n        state.updateNodeAttrNotifier();\n      });\n  selection.select('.size')\n      .call(box.updateNumberBox, state.nodeLabel.size)\n      .on('change', function () {\n        state.nodeLabel.size = box.numberBoxValue(d3.select(this));\n        state.updateNodeAttrNotifier();\n      });\n  // nodeLabelColor\n  selection.select('.field')\n      .call(lbox.updateSelectBox, state.nodeLabelColor.field)\n      .on('change', function () {\n        state.nodeLabelColor.field = lbox.selectBoxValue(d3.select(this));\n        state.updateNodeAttrNotifier();\n      });\n  selection.select('.range')\n      .call(group.updateColorRangeGroup, state.nodeLabelColor.range)\n      .on('change', function () {\n        const values = group.colorRangeGroupValue(d3.select(this));\n        state.nodeLabelColor.range = values;\n        if (values.length > 3) {\n          state.nodeLabelColor.scale = 'ordinal';\n          selection.select('.scale').selectAll('select,input')\n            .property('disabled', true)\n            .style('opacity', 0.3);\n        } else {\n          state.nodeLabelColor.scale = lbox.selectBoxValue(selection.select('.range'));\n          selection.select('.scale').selectAll('select,input')\n            .property('disabled', false)\n            .style('opacity', null);\n        }\n        state.updateNodeAttrNotifier();\n      });\n  selection.select('.scale')\n      .call(\n        group.updateScaleBoxGroup, state.nodeLabelColor.scale,\n        state.nodeLabelColor.domain\n      )\n      .on('change', function () {\n        const values = group.scaleBoxGroupValue(d3.select(this));\n        state.nodeLabelColor.scale = values.scale;\n        state.nodeLabelColor.domain = values.domain;\n        state.updateNodeAttrNotifier();\n      }\n    );\n}\n\n\nfunction edgeControlBox(selection, state) {\n  // edgeLabel\n  const labelGroup = selection.append('div')\n      .classed('mb-3', true);\n  labelGroup.append('div')\n      .classed('label', true)\n      .classed('mb-1', true)\n      .call(\n        box.checkBox, 'edge-label-visible', 'Show edge weight label',\n        state.edgeLabel.visible\n      );\n  labelGroup.append('div')\n      .classed('size', true)\n      .classed('mb-1', true)\n      .call(\n        box.numberBox, 'edge-label-size', 'Weight label font size',\n        6, 100, 1, state.edgeLabel.size\n      );\n  // edgeWidth\n  const widthGroup = selection.append('div')\n      .classed('mb-3', true);\n  widthGroup.append('div')\n      .classed('range', true)\n      .classed('mb-3', true)\n      .call(rbox.rangeBox, 'edge-width-range', 'Range', state.edgeWidth.range);\n  widthGroup.append('div')\n      .classed('scale', true)\n      .classed('mb-1', true)\n      .call(\n        lbox.selectBox, 'edge-width-scale', 'Scale type',\n        scaledef.types.filter(e => e.key !== 'ordinal'), state.edgeWidth.scale\n      );\n  widthGroup.append('div')\n      .classed('domain', true)\n      .classed('mb-1', true)\n      .call(rbox.rangeBox, 'edge-width-domain', 'Domain', state.edgeWidth.domain);\n}\n\nfunction updateEdgeControlBox(selection, state) {\n  // edgeLabel\n  selection.select('.label')\n      .call(box.updateCheckBox, state.edgeLabel.visible)\n      .on('change', function () {\n        state.edgeLabel.visible = box.checkBoxValue(d3.select(this));\n        state.updateEdgeAttrNotifier();\n      });\n  selection.select('.size')\n      .call(box.updateNumberBox, state.edgeLabel.size)\n      .on('change', function () {\n        state.edgeLabel.size = box.numberBoxValue(d3.select(this));\n        state.updateEdgeAttrNotifier();\n      });\n  // edgeWidth\n  selection.select('.range')\n      .call(rbox.updateRangeBox, state.edgeWidth.range)\n      .on('change', function () {\n        state.edgeWidth.range = rbox.rangeBoxValue(d3.select(this));\n        state.updateEdgeAttrNotifier();\n      });\n  selection.select('.scale')\n      .call(lbox.updateSelectBox, state.edgeWidth.scale)\n      .on('change', function () {\n        state.edgeWidth.scale = lbox.selectBoxValue(d3.select(this));\n        state.updateEdgeAttrNotifier();\n      });\n  selection.select('.domain')\n      .call(rbox.updateRangeBox, state.edgeWidth.domain)\n      .on('change', function () {\n        state.edgeWidth.domain = rbox.rangeBoxValue(d3.select(this));\n        state.updateEdgeAttrNotifier();\n      });\n}\n\n\nfunction controlBoxFrame(selection, navID, contentID) {\n  selection.append('nav')\n    .append('div')\n      .classed('nav', true)\n      .classed('nav-tabs', true)\n      .attr('id', navID)\n      .attr('role', 'tablist');\n  selection.append('div')\n      .classed('tab-content', true)\n      .classed('p-2', true)\n      .attr('id', contentID);\n}\n\n\nfunction controlBoxNav(selection, id, label) {\n  selection\n      .classed('nav-item', true)\n      .classed('nav-link', true)\n      .classed('py-1', true)\n      .attr('id', `${id}-tab`)\n      .attr('data-toggle', 'tab')\n      .attr('href', `#${id}`)\n      .attr('role', 'tab')\n      .attr('aria-controls', id)\n      .attr('aria-selected', 'false')\n      .text(label);\n}\n\n\nfunction controlBoxItem(selection, id) {\n  selection\n      .classed('tab-pane', true)\n      .classed('fade', true)\n      .classed('container', true)\n      .classed('px-0', true)\n      .attr('id', id)\n      .attr('role', 'tabpanel')\n      .attr('aria-labelledby', `${id}-tab`);\n}\n\n\nfunction controlBox(selection, state) {\n  // Clean up\n  selection.select('nav').remove();\n  selection.select('.tab-content').remove();\n\n  selection.call(\n    controlBoxFrame, 'control-frame-nav', 'control-frame-content');\n  const tabs = selection.select('.nav-tabs');\n  const content = selection.select('.tab-content');\n\n  // Main\n  tabs.append('a')\n      .classed('active', true)\n      .attr('aria-selected', 'true')\n      .call(controlBoxNav, 'control-main', 'Main');\n  content.append('div')\n      .classed('show', true)\n      .classed('active', true)\n      .classed('control-main', true)\n      .call(controlBoxItem, 'control-main')\n      .call(mainControlBox, state);\n\n  // Color\n  tabs.append('a')\n      .call(controlBoxNav, 'control-color', 'Color');\n  content.append('div')\n      .classed('control-color', true)\n      .call(controlBoxItem, 'control-color')\n      .call(nodeColorControlBox, state);\n\n  // Size\n  tabs.append('a')\n      .call(controlBoxNav, 'control-size', 'Size');\n  content.append('div')\n      .classed('control-size', true)\n      .call(controlBoxItem, 'control-size')\n      .call(nodeSizeControlBox, state);\n\n  // Label\n  tabs.append('a')\n      .call(controlBoxNav, 'control-label', 'Label');\n  content.append('div')\n      .classed('control-label', true)\n      .call(controlBoxItem, 'control-label')\n      .call(nodeLabelControlBox, state);\n\n  // Edge\n  tabs.append('a')\n      .call(controlBoxNav, 'control-edge', 'Edge');\n  content.append('div')\n      .classed('control-edge', true)\n      .call(controlBoxItem, 'control-edge')\n      .call(edgeControlBox, state);\n\n  selection.call(updateControlBox, state);\n}\n\n\nfunction updateControlBox(selection, state) {\n  selection.select('.control-main')\n      .call(updateMainControlBox, state);\n  selection.select('.control-color')\n      .call(updateNodeColorControlBox, state);\n  selection.select('.control-size')\n      .call(updateNodeSizeControlBox, state);\n  selection.select('.control-label')\n      .call(updateNodeLabelControlBox, state);\n  selection.select('.control-edge')\n      .call(updateEdgeControlBox, state);\n}\n\n\nexport default {\n  controlBox, updateControlBox\n};\n","\n/** @module network/communityDetection */\n\nimport jLouvain from 'jLouvain';\n\n\nexport function communityDetection(nodes, edges, option) {\n  // TODO: partition resolution setting\n  // TODO: Error at edges.length 0\n  if (!edges.length) {\n    const community = {};\n    nodes.forEach(e => { community[e] = option.nulliso ? null : e; });\n    return community;\n  }\n  const clusters = {};\n  const community = jLouvain().nodes(nodes).edges(edges)();\n  Object.entries(community).forEach(e => {\n    if (!clusters.hasOwnProperty(e[1])) {\n      clusters[e[1]] = [];\n    }\n    clusters[e[1]].push(e[0]);\n  });\n  // Sort by cluster size\n  Object.entries(clusters)\n    .sort((a, b) => a[1].length < b[1].length)\n    .forEach((cluster, i) => {\n      if (cluster[1].length === 1) {\n        community[cluster[1][0]] = option.nulliso ? null : i;\n      } else {\n        cluster[1].forEach(e => {\n          community[e] = i;\n        });\n      }\n    });\n  return community;\n}\n\n\nexport default {\n  communityDetection\n};\n","\n/** @module network/networkApp */\n\nimport d3 from 'd3';\n\nimport {default as core} from '../common/core.js';\nimport {default as hfile} from '../common/file.js';\nimport {default as idb} from '../common/idb.js';\nimport {default as mapper} from '../common/mapper.js';\nimport {default as misc} from '../common/misc.js';\nimport {default as scale} from '../common/scale.js';\n\nimport {default as button} from '../component/button.js';\nimport {default as modal} from '../component/modal.js';\n\nimport {default as communityDialog} from '../dialog/community.js';\nimport {default as renameDialog} from '../dialog/rename.js';\n\nimport {default as view} from './view.js';\nimport {default as control} from './controlBox.js';\nimport {default as interaction} from './interaction.js';\nimport {default as force} from './force.js';\nimport {default as community} from './communityDetection.js';\nimport NetworkState from './state.js';\n\n\nfunction getGraph(storeID) {\n  return idb.getItemByID(storeID)\n    .then(edges => {\n      return idb.getItemByID(edges.reference.nodes)\n        .then(nodes => {\n          return {edges: edges, nodes: nodes};\n        });\n    });\n}\n\n\nfunction app(data) {\n  // TODO: define field size according to the data size\n  const width = 1200;\n  const height = 1200;\n  const state = new NetworkState(data, width, height);\n  const simulation = force.forceSimulation(width, height);\n  const frame = d3.select('#nw-frame')\n      .call(view.networkViewFrame, state);\n  frame.select('.nw-view')\n      .call(view.networkView, state)\n      .call(interaction.setInteraction, state)\n      .call(force.activate, simulation, state);\n  d3.select('#nw-control')\n      .call(control.controlBox, state);\n\n  // Resize window\n  window.onresize = () =>\n    d3.select('#nw-frame').call(view.resize, state);\n\n  // Menubar\n  const menubar = d3.select('#menubar');\n  menubar.selectAll('div,span,a').remove();\n  // Network view control\n  const menu = menubar.append('div')\n      .call(button.dropdownMenuButton, null, 'View control', 'primary')\n      .select('.dropdown-menu');\n  menu.append('a')\n      .classed('communityd', true)\n      .call(communityDialog.menuLink);\n  menu.append('a')\n      .classed('renamed', true)\n      .call(renameDialog.menuLink);\n  menu.append('a')\n      .classed('saveview', true)\n      .call(button.dropdownMenuItem, null, 'Save to local storage')\n      .on('click', function () {\n        if (state.data.edges.storeID) {\n          return idb.updateItem(state.data.edges.storeID, item => {\n            item.id = misc.uuidv4();\n            item.name = state.data.edges.name;\n            item.snapshot = state.snapshot();\n          })\n          .then(() => console.info('Snapshot saved'));\n        } else {\n          const data = state.export();\n          return idb.putItem(data.nodes)\n            .then(storeID => {\n              data.edges.reference.nodes = storeID;\n              return idb.putItem(data.edges);\n            })\n            .then(storeID => {\n              window.location = `network.html?id=${storeID}`;\n            });\n        }\n      });\n  menu.append('a')\n      .call(button.dropdownMenuItem, null, 'Export to JSON')\n      .on('click', () => {\n        const data = state.export();\n        // Delete local store information\n        delete data.nodes.storeID;\n        delete data.edges.storeID;\n        delete data.edges.reference.nodes;\n        hfile.downloadJSON(data, data.edges.name);\n      });\n  if (state.data.nodes.storeID) {\n    // Node datagrid link\n    menubar.append('a')\n        .call(button.menuButtonLink, null, 'Node datagrid', 'outline-secondary')\n        .attr('href', `datagrid.html?id=${state.data.nodes.storeID}`)\n        .attr('target', '_blank');\n  }\n  // Control panel\n  menubar.append('a')\n      .call(button.menuButtonLink, null, 'Control panel', 'outline-secondary')\n      .attr('href', 'control.html')\n      .attr('target', '_blank');\n  // Fetch control\n  const ongoing = ['running', 'ready'].includes(state.data.edges.status);\n  if (ongoing) {\n    menubar.append('a')\n        .call(button.menuButtonLink, null, 'Refresh', 'outline-secondary')\n        .on('click', function () {\n          core.fetchProgress(state.data.edges.storeID)\n            .then(() => getGraph(state.data.edges.storeID))\n            .then(app);\n        });\n    menubar.append('a')\n        .call(button.menuButtonLink, null, 'Abort server job', 'warning')\n        .attr('data-toggle', 'modal')\n        .attr('data-target', '#abort-dialog');\n    menubar.append('span')\n        .classed('progress', true)\n      .append('progress')\n        .attr('max', 100)\n        .attr('value', state.data.edges.progress)\n        .text(`${state.data.edges.progress}%`);\n  }\n  menubar.append('span')\n    .classed('title', true)\n    .text(state.data.edges.name);\n  menubar.append('span')\n      .classed('status', true)\n      .text(`(${state.data.edges.status} - ${state.data.edges.records.length} connections created in ${state.data.edges.execTime} sec.)`);\n\n  // Dialogs\n  const dialogs = d3.select('#dialogs');\n  dialogs.selectAll('div').remove();  // Clean up\n  dialogs.append('div')\n      .classed('communityd', true)\n      .call(communityDialog.body);\n  dialogs.append('div')\n      .classed('renamed', true)\n      .call(renameDialog.body, state.data.edges.name);\n  dialogs.append('div')\n      .classed('abortd', true)\n      .call(\n        modal.confirmDialog, 'abort-dialog',\n        'Are you sure you want to abort this calculation job?'\n      );\n  updateApp(state);\n}\n\n\nfunction updateApp(state) {\n  // Title\n  d3.select('title').text(state.data.edges.name);\n  d3.select('#menubar').select('.title').text(state.data.edges.name);\n  // Dialogs\n  const dialogs = d3.select('#dialogs');\n  // Rename dialog\n  dialogs.select('.renamed')\n      .call(renameDialog.updateBody, state)\n      .on('submit', function () {\n        state.data.edges.name = renameDialog.value(d3.select(this));\n        updateApp(state);\n      });\n  // Abort dialog\n  dialogs.select('.abortd')\n      .on('submit', function () {\n        core.fetchProgress(state.data.edges.storeID, 'abort')\n          .then(() => getGraph(state.data.edges.storeID))\n          .then(app);\n      });\n  // Community dialog\n  dialogs.select('.communityd')\n      .on('submit', function () {\n        const value = communityDialog.value(d3.select(this));\n        const nodeIds = state.data.nodes.records.map(e => e.index);\n        const edges = state.data.edges.records\n          .filter(e => e.weight >= state.networkThreshold);\n        const comm = community.communityDetection(\n          nodeIds, edges, {nulliso: value.nulliso}\n        );\n        const mapping = {\n          key: 'index',\n          field: misc.defaultFieldProperties(\n            [{key: value.name, format: 'd3_format', d3_format: 'd'}]\n          )[0],\n          mapping: comm\n        };\n        mapper.apply(state.data.nodes, mapping);\n        state.nodeColor = {\n          field: value.name, scale: 'ordinal', domain: null,\n          range: scale.colorRangeTypes[3].range,\n          unknown: scale.colorRangeTypes[3].unknown\n        };\n        $('#community-dialog').modal('hide');  // TODO:\n        d3.select('#loading-icon').style('display', 'none');\n        app(state.export());\n      });\n}\n\n\nexport default {\n  getGraph, app, updateApp\n};\n","\n/** @module network */\n\nimport d3 from 'd3';\n\nimport {default as core} from './common/core.js';\nimport {default as hfile} from './common/file.js';\nimport {default as misc} from './common/misc.js';\n\nimport {default as button} from './component/button.js';\n\nimport NetworkState from './network/state.js';\nimport {default as view} from './network/view.js';\nimport {default as force} from './network/force.js';\nimport {default as interaction} from './network/interaction.js';\nimport {default as networkApp} from './network/networkApp.js';\n\n\nfunction run() {\n  // TODO: offline mode flags\n  const localFile = document.location.protocol !== \"file:\";  // TODO\n  const offLine = 'onLine' in navigator && !navigator.onLine;  // TODO\n  const storeID = misc.URLQuery().id || null;\n  const dataURL = misc.URLQuery().location || null;\n  if (storeID) {\n    // Load from IndexedDB store\n    return core.fetchProgress(storeID, 'update')\n      .then(() => networkApp.getGraph(storeID))\n      .then(networkApp.app);\n  } else if (dataURL) {\n    // Fetch via HTTP\n    return hfile.fetchJSON(dataURL)\n      .then(networkApp.app);\n  } else {\n    // New network\n    const menubar = d3.select('#menubar');\n    menubar.selectAll('div,a').remove();\n    const menu = menubar.append('div')\n        .call(button.dropdownMenuButton, null, '+ New network', 'primary')\n        .select('.dropdown-menu');\n    menu.append('a')\n        .call(button.dropdownMenuFile, 'import', 'Import view', '.gfc,.gfr,.json,.gz')\n        .on('change', function () {\n          const file = button.dropdownMenuFileValue(d3.select(this));\n          hfile.loadJSON(file).then(networkApp.app);\n        });\n    menubar.append('a')\n        .call(button.menuButton, null, 'Control panel', 'outline-secondary')\n        .attr('href', 'control.html')\n        .attr('target', '_blank');\n  }\n}\n\n\nexport default {\n  NetworkState, view, force, interaction, run\n};\n"],"names":["defaultFieldProperties","fields","map","e","hasOwnProperty","name","key","visible","format","sortType","fmt","includes","formatNum","value","d3format","Number","isNaN","parseFloat","d3","partialMatch","query","target","toString","toUpperCase","indexOf","URLQuery","pairs","window","location","search","substring","split","_","fromPairs","uuidv4","replace","c","r","Math","random","schema","items","idb","Dexie","version","stores","getAllItems","orderBy","reverse","toArray","getItemsByDataType","type","where","equals","sortBy","catch","err","console","error","getItemByID","storeID","first","deleteItem","delete","putItem","data","misc","put","updateItem","updateFunc","modify","reset","then","baseURL","get","url","q","Object","keys","length","JSON","stringify","fetch","credentials","res","status","Promise","reject","Error","statusText","resolve","json","response","text","blob","post","formdata","method","body","fetchProgress","command","id","reference","workflow","fetcher","item","progress","execTime","records","readFile","file","sizeLimit","reader","FileReader","truncated","slice","onload","event","result","onerror","readAsArrayBuffer","readAsText","parseJSON","compressed","pako","inflate","to","parse","downloadDataFile","URL","createObjectURL","Blob","a","document","createElement","download","href","dispatchEvent","MouseEvent","view","bubbles","cancelable","loadJSON","endsWith","fetchJSON","decoded","decodeURIComponent","arrayBuffer","downloadJSON","compress","str","gzip","buttonBox","selection","label","classed","append","attr","menuButton","menuButtonLink","menuModalLink","dropdownMenuButton","dropdownMenuItem","dropdownMenuModal","dropdownMenuFile","accept","on","select","this","node","click","style","dropdownMenuFileValue","files","statusConv","Queued","In progress","Aborting","Aborted","Completed","Failure","dataTypeConv","datatable","connection","v07_to_v08_nodes","columns","sort","dataType","schemaVersion","revision","taskCount","searchCount","doneCount","searchDoneCount","resultCount","recordCount","created","startDate","responseDate","v10_nodes","convertTable","forEach","i","index","structure","_structure","_index","v08_nodes","$schema","filter","convertNetwork","edges","nodes","nodeFields","snp","fieldTransform","snapshot","nodePositions","nodeColor","nodeSize","nodeLabel","edge","scale","field","find","column","domain","range","unknown","size","nodeContent","nodeTableId","networkThreshold","v07_to_v08_edges","nodesID","idx_converter","source","v08_graph","nodeContentVisible","schemeCategory20","nodeLabelColor","edgeVisible","edgeWidth","edgeLabel","threshold","coords","params","v10_edges","NetworkState","[object Object]","width","height","focusedViewThreshold","enableFocusedView","focusedView","overlookViewThreshold","enableOverlookView","overlookView","legacy","n","adjacency","num","push","networkThresholdCutoff","transform","x","y","k","zoomListener","dragListener","updateComponentNotifier","updateNodeNotifier","updateEdgeNotifier","updateNodeAttrNotifier","updateEdgeAttrNotifier","snapShotNotifier","fitNotifier","setForceNotifier","stickNotifier","relaxNotifier","restartNotifier","forceField","top","right","bottom","left","viewBox","focusArea","boundary","prevTransform","simulationOnLoad","setAllCoords","setFocusArea","setBoundary","xs","ys","min","apply","max","tx","ty","tk","coordsList","nbr","sx","sy","weight","types","func","scaleLinear","scaleLog","scaleQuantize","scaleOrdinal","colorRangeTypes","schemeCategory10","schemePaired","concat","schemeSet2","schemePastel2","schemeSet3","presets","colorPalettes","scaleFunction","sf","mid","clamp","d","undefined","svgWidth","svgHeight","updateNodes","showStruct","selectAll","exit","remove","entered","enter","call","updateNodeCoords","merged","merge","html","updateEdges","updateEdgeCoords","updateNodeAttrs","state","each","color","labelColor","d3_format","parseInt","updateEdgeAttrs","updateAttrs","moveNode","moveEdge","updateComponents","nodesToRender","numNodes","edgesToRender","move","datum","resizeViewBox","resize","area","setViewBox","offsetWidth","offsetHeight","component","networkViewFrame","networkView","transition","duration","drag","setCoords","zoom","t","p","xMoved","yMoved","zoomIn","setTransform","fit","getBBox","viewBoxRatio","boundaryHeight","boundaryWidth","zoomIdentity","translate","setInteraction","showTemperature","simulation","alpha","isStopped","alphaMin","end","stick","stop","fx","fy","interaction","unstick","active","relax","alphaTarget","forceDragListener","restart","setForce","forceEdges","force","links","forceSimulation","forceLink","distance","strength","forceManyBody","distanceMin","distanceMax","forceCollide","radius","forceCenter","forceX","forceY","activate","singleToMulti","mapping","newMapping","entries","m","mappingToTable","mp","keyField","entry","rcd","f","tableToMapping","table","ignore","Date","row","csvToMapping","csvString","lines","header","shift","now","headerIdx","h","line","values","Array","fd","uniqBy","dialogBase","confirmDialog","message","base","footer","dispatch","submitDialog","title","updateTextBox","property","updateTextareaBox","updateCheckBox","checked","updateNumberBox","textBox","textBoxValue","readonlyBox","textareaBox","rows","placeholder","textareaBoxValue","textareaBoxLines","checkBox","box","checkBoxValue","numberBox","step","numberBoxValue","fileInputBox","fileInputBoxValue","menuLink","button","dialog","modal","nulliso","updateBody","selectBoxItems","options","updateSelectBox","checklistBoxItems","listitems","form","updateChecklistBox","selectBox","selectBoxValue","checklistBox","checklistBoxValue","updateRangeBox","updateColorScaleBox","rangeArray","rangeBox","rangeBoxValue","colorScaleBox","stopPropagation","colorScaleBoxValue","arr","updateColorRangeGroup","lbox","scaledef","rbox","updateScaleBoxGroup","isLog","invalid","colorRangeGroup","palettes","rangeTypes","colorRangeGroupValue","scaleBoxGroup","scaleTypes","scaleBoxGroupValue","mainControlBox","viewModes","thldGroup","forceBox","updateMainControlBox","snapshotNotifier","numEdges","combinations","logD","log10","nodeColorControlBox","group","updateNodeColorControlBox","nodeSizeControlBox","updateNodeSizeControlBox","nodeLabelControlBox","labelGroup","updateNodeLabelControlBox","edgeControlBox","widthGroup","updateEdgeControlBox","controlBoxFrame","navID","contentID","controlBoxNav","controlBoxItem","updateControlBox","controlBox","tabs","content","communityDetection","option","community","clusters","jLouvain","b","cluster","getGraph","app","control","onresize","menubar","menu","communityDialog","renameDialog","info","export","hfile","core","dialogs","updateApp","nodeIds","comm","mapper","$","run","protocol","navigator","onLine","dataURL","networkApp"],"mappings":";skBA4DEA,uBArDF,SAAgCC,GAC9B,OAAOA,EAAOC,IAAIC,IACXA,EAAEC,eAAe,UAASD,EAAEE,KAAOF,EAAEG,KACrCH,EAAEC,eAAe,aAAYD,EAAEI,SAAU,GAC1CJ,EAAEC,eAAe,eAAcD,EAAEK,OAAS,aACzCL,EAAEC,eAAe,YAAWD,EAAEK,OAAS,OACrCL,KA+CeM,SA1C1B,SAAkBC,GAChB,OAAK,UAAW,aAAaC,SAASD,GAAa,WAC9C,OAAQ,cAAe,WAAY,QAAQC,SAASD,GAAa,OAC/D,QAuC2BE,UA9BpC,SAAmBC,EAAOC,GACxB,OAAID,MAAAA,GAAyCE,OAAOC,MAAMH,GAAe,GAClEA,GAASI,WAAWJ,GAASK,EAAGV,OAAOM,EAAVI,CAAoBL,GAASA,GA4BpBM,aAxB/C,SAAsBC,EAAOC,GAC3B,OAAIA,MAAAA,GAAsD,KAAXA,IAEC,IADzCA,EAAOC,WAAWC,cACtBC,QAAQJ,EAAME,WAAWC,gBAqB+BE,SAjB7D,WACE,MAAMC,EAAQC,OAAOC,SAASC,OAAOC,UAAU,GAAGC,MAAM,KACrD7B,IAAIC,GAAKA,EAAE4B,MAAM,MACpB,OAAOC,EAAEC,UAAUP,IAckDQ,OATvE,WACE,MAAO,uCAAuCC,QAAQ,QAAS,SAASC,GACtE,IAAIC,EAAoB,GAAhBC,KAAKC,SAAgB,EAC7B,OADyC,KAALH,EAAWC,EAAS,EAAJA,EAAU,GACrDf,SAAS,QC9CtB,MAAMkB,GACJC,MAAO,8BAGT,IAAIC,EAAM,IAAIC,EAAM,SACpBD,EAAIE,QAAQ,GAAGC,OAAOL,UAwGpBM,YAjGF,WACE,OAAOJ,EAAID,MACRM,QAAQ,WACRC,UACAC,WA6FUC,mBApFf,SAA4BC,GAC1B,OAAOT,EAAID,MACRW,MAAM,YACNC,OAAOF,GACPH,UACAM,OAAO,WACPC,MAAMC,IACLC,QAAQC,wCAAwCP,IAAQK,MA6E3BG,YAnEnC,SAAqBC,GACnB,OAAOlB,EAAID,MACRW,MAAM,WACNC,OAAOO,GACPC,QACAN,MAAMC,IACLC,QAAQC,wCAAwCE,IAAWJ,MA8D/DM,WApDF,SAAoBF,GAClB,OAAOlB,EAAID,MACRW,MAAM,WACNC,OAAOO,GACPG,UAgDSC,QAvCd,SAAiBC,GAIf,OAHKA,EAAKL,UACRK,EAAKL,QAAUM,EAAKhC,UAEfQ,EAAID,MAAM0B,IAAIF,IAmCAG,WAzBvB,SAAoBR,EAASS,GAC3B,OAAO3B,EAAID,MACRW,MAAM,WACNC,OAAOO,GACPU,OAAOD,GACPd,MAAMC,IACLC,QAAQC,MAAM,0BAA2BF,MAmBZe,MAVnC,WACE,OAAO7B,EAAIqB,SAASS,KAAK,MACvB9B,EAAM,IAAIC,EAAM,UACZC,QAAQ,GAAGC,OAAOL,OC3G1B,MAAMiC,EAAU,UAsDdC,IApDF,SAAaC,EAAKvD,MAChB,MACMwD,EADUC,OAAOC,KAAK1D,GAAO2D,iBACLC,KAAKC,UAAU7D,KAAW,GACxD,OAAO8D,SACFT,IAAUE,IAAMC,KAEjBO,YAAa,YAEfX,KAAKY,GACc,MAAfA,EAAIC,OACCC,QAAQC,OAAO,IAAIC,MAAMJ,EAAIK,aAE/BH,QAAQI,QAAQN,KAwCpBO,KApCP,SAAcC,GACZ,OAAOA,EAASD,QAmCLE,KAhCb,SAAcD,GACZ,OAAOA,EAASC,QA+BCC,KA5BnB,SAAcF,GACZ,OAAOA,EAASE,QA2BOC,KAxBzB,SAAcpB,EAAKqB,GACjB,OAAOd,SACFT,IAAUE,KAEXsB,OAAQ,OACRC,KAAMF,EACNb,YAAa,YAEfX,KAAKY,GACc,MAAfA,EAAIC,OACCC,QAAQC,OAAO,IAAIC,MAAMJ,EAAIK,aAE/BH,QAAQI,QAAQN,KAYI1B,MAP/B,SAAeF,GAEb,OADAC,QAAQC,MAAMF,GACP,cClBP2C,cA3BF,SAAuBvC,EAASwC,EAAQ,UACtC,OAAO1D,EAAIiB,YAAYC,GACpBY,KAAKP,IACJ,IAAKA,EAAM,OAAOqB,QAAQC,iBAAiB3B,sBAC3C,KAAM,QAAS,WAAWjD,SAASsD,EAAKoB,QAAS,OACjD,MAAMjE,GAASiF,GAAIpC,EAAKqC,UAAUC,SAAUH,QAASA,GACrD,OAAOI,EAAQ9B,IAAI,WAAYtD,GAC5BoD,KAAKgC,EAAQb,MACbnB,KAAKP,GACgB,YAAhBA,EAAKoB,OACA3C,EAAI0B,WAAWR,EAAS6C,IAC7BA,EAAKpB,OAAS,YAGX3C,EAAI0B,WAAWR,EAAS6C,IAC7BA,EAAKpB,OAASpB,EAAKoB,OACnBoB,EAAKC,SAAWzC,EAAKyC,SACrBD,EAAKE,SAAW1C,EAAK0C,SACrBF,EAAKxG,OAASiE,EAAKlE,uBAAuBiE,EAAKhE,QAC/CwG,EAAKG,QAAU3C,EAAK2C,eCrBhC,SAASC,EAASC,EAAMC,EAAWjB,GACjC,OAAO,IAAIR,QAAQ,CAACI,EAASH,KAC3B,MAAMyB,EAAS,IAAIC,WACbC,EAAYH,EAAYD,EAAKK,MAAM,EAAGJ,GAAaD,EACzDE,EAAOI,OAASC,CAAAA,GAAS3B,EAAQ2B,EAAMhG,OAAOiG,SAC9CN,EAAOO,QAAU7D,CAAAA,GAAS6B,EAAO7B,IAC7BoC,EACFkB,EAAOQ,kBAAkBN,GAEzBF,EAAOS,WAAWP,KAMxB,SAASQ,EAAUzD,EAAM0D,GACvB,MAAM9B,EAAO8B,EAAaC,EAAKC,QAAQ5D,GAAO6D,GAAI,WAAa7D,EAC/D,OAAOe,KAAK+C,MAAMlC,GAoBpB,SAASmC,EAAiB/D,EAAM5D,GAC9B,IAGE,MAAMsE,EAAMhD,OAAOsG,IAAIC,gBAAgB,IAAIC,MAAMlE,KAC3CmE,EAAIC,SAASC,cAAc,KACjCF,EAAEG,SAAWlI,EACb+H,EAAEI,KAAO7D,EAETyD,EAAEK,cAAc,IAAIC,WAAW,SAC7BC,KAAQhH,OACRiH,SAAW,EACXC,YAAc,KAGhB,MAAO1I,YAgBT0G,SAAAA,EAAUa,UAAAA,EAAWoB,SA/CvB,SAAkBhC,GAChB,MAAMa,EAAab,EAAKzG,KAAK0I,SAAS,MAAQjC,EAAKzG,KAAK0I,SAAS,OACjE,OAAOlC,EAASC,GAAM,EAAOa,GAC1BnD,KAAKP,GAAQyD,EAAUzD,EAAM0D,KA4CDqB,UAxCjC,SAAmBrE,GACjB,MAAMsE,EAAUC,mBAAmBvE,GAC7BgD,EAAasB,EAAQF,SAAS,MAAQE,EAAQF,SAAS,OAC7D,OAAO7D,MAAM+D,GACVzE,KAAKY,GAAOuC,EAAavC,EAAI+D,cAAgB/D,EAAIO,QACjDnB,KAAKP,GAAQyD,EAAUzD,EAAM0D,KAoChCK,iBAAAA,EAAkBoB,aAXpB,SAAsBzD,EAAMtF,EAAMgJ,GAAS,GACzC,MAAMC,EAAMtE,KAAKC,UAAUU,GAErBvD,EAAIiH,EAAW,IAAM,IAE3BrB,EAHaqB,EAAWzB,EAAK2B,KAAKD,GAAOA,KAGfjJ,IADdsF,EAAKvF,eAAe,eAAiBgC,UAAaA,gBC8C9DoH,UA5GF,SAAmBC,EAAWpD,EAAIqD,EAAOvG,GACvCsG,EACKE,QAAQ,cAAc,GACtBA,QAAQ,QAAQ,GAClBC,OAAO,UACLD,QAAQ,OAAO,GACfA,eAAexG,KAAQ,GACvBwG,QAAQ,UAAU,GAClBE,KAAK,KAAMxD,GACXR,KAAK6D,IAmGCI,WA/Fb,SAAoBL,EAAWpD,EAAIqD,EAAOvG,GACxCsG,EACKE,QAAQ,OAAO,GACfA,eAAexG,KAAQ,GACvBwG,QAAQ,UAAU,GAClBA,QAAQ,QAAQ,GAChBE,KAAK,KAAMxD,GACXR,KAAK6D,IAwFaK,eApFzB,SAAwBN,EAAWpD,EAAIqD,EAAOvG,GAC5CsG,EACKE,QAAQ,OAAO,GACfA,eAAexG,KAAQ,GACvBwG,QAAQ,UAAU,GAClBA,QAAQ,QAAQ,GAChBE,KAAK,OAAQ,UACbA,KAAK,OAAQ,KACbA,KAAK,KAAMxD,GACXR,KAAK6D,IA2E6BM,cAvEzC,SAAuBP,EAAWpD,EAAIqD,EAAOvG,EAAM9B,GACjDoI,EACKE,QAAQ,OAAO,GACfA,eAAexG,KAAQ,GACvBwG,QAAQ,UAAU,GAClBA,QAAQ,QAAQ,GAChBE,KAAK,KAAMxD,GACXwD,KAAK,OAAQ,KACbA,KAAK,OAAQ,UACbA,KAAK,cAAe,SACpBA,KAAK,kBAAmBxI,KACxBwE,KAAK6D,IA6DVO,mBAzDF,SAA4BR,EAAWpD,EAAIqD,EAAOvG,GAChDsG,EACKE,QAAQ,aAAa,GACrBA,QAAQ,QAAQ,GAChBE,KAAK,KAAMxD,GAChBoD,EAAUG,OAAO,UACZD,QAAQ,OAAO,GACfA,eAAexG,KAAQ,GACvBwG,QAAQ,UAAU,GAClBA,QAAQ,mBAAmB,GAC3BE,KAAK,cAAe,YACpBhE,KAAK6D,GACVD,EAAUG,OAAO,OACZD,QAAQ,iBAAiB,IA4CVO,iBAxCtB,SAA0BT,EAAWpD,EAAIqD,GACvCD,EAAUE,QAAQ,iBAAiB,GAC9BE,KAAK,KAAMxD,GACXwD,KAAK,OAAQ,KACbhE,KAAK6D,IAoC4BS,kBAjCxC,SAA2BV,EAAWpD,EAAIqD,EAAOrI,GAC/CoI,EAAUE,QAAQ,iBAAiB,GAC9BE,KAAK,KAAMxD,GACXwD,KAAK,OAAQ,KACbA,KAAK,cAAe,SACpBA,KAAK,kBAAmBxI,KACxBwE,KAAK6D,IA4BVU,iBAxBF,SAA0BX,EAAWpD,EAAIqD,EAAOW,GAC9CZ,EAAUE,QAAQ,iBAAiB,GAC9BE,KAAK,KAAMxD,GACXwD,KAAK,OAAQ,KACbhE,KAAK6D,GACLY,GAAG,QAAS,WACXpJ,EAAGqJ,OAAOC,MAAMD,OAAO,SAASE,OAAOC,UAE1Cd,OAAO,QACLe,MAAM,UAAW,QACnBf,OAAO,SACLC,KAAK,OAAQ,QACbA,KAAK,SAAUQ,IAYFO,sBARpB,SAA+BnB,GAC7B,OAAOA,EAAUc,OAAO,SAASE,OAAOI,MAAM,KCtGhD,MAAMC,GACJC,OAAQ,QACRC,cAAe,UACfC,SAAU,UACVC,QAAS,UACTC,UAAW,OACXC,QAAS,WAGLC,GACJC,UAAW,QACXC,WAAY,SAGd,SAASC,EAAiB7F,GACxB,MAAM1F,EAAS0F,EAAK8F,QAAQvL,IAAIC,IACf,YAAXA,EAAEuL,KACJvL,EAAEK,OAAS,UACS,SAAXL,EAAEuL,KACXvL,EAAEK,OAAS,OACS,SAAXL,EAAEuL,OACXvL,EAAEK,OAAS,OAENL,IAET,OACEkG,GAAIV,EAAKU,GACThG,KAAMsF,EAAKtF,KACXsL,SAAUN,EAAa1F,EAAKnF,QAC5BoL,cAAe,GACfC,SAAU,EACVxG,OAAQyF,EAAWnF,EAAKN,QACxBpF,OAAQA,EACR2G,QAASjB,EAAKiB,QACdxF,MAAOuE,EAAKvE,MACZ0K,UAAWnG,EAAKoG,YAChBC,UAAWrG,EAAKsG,gBAAkBtG,EAAKoG,YACvCG,YAAavG,EAAKwG,YAClBzF,SAA0B,IAAhBf,EAAKe,SACfC,SAAUhB,EAAKgB,SACfyF,QAASzG,EAAK0G,UAAY1G,EAAK2G,cAqInC,SAASC,EAAU5G,GACjB,OACEU,GAAIV,EAAKU,GACThG,KAAMsF,EAAKtF,KACXsL,SAAUhG,EAAKgG,SACfC,cAAe,OACfC,SAAUlG,EAAKkG,SACfxG,OAAQM,EAAKN,OACbpF,OAAQ0F,EAAK1F,OACb2G,QAASjB,EAAKiB,QACdxF,MAAOuE,EAAKvE,MACZsF,SAAUf,EAAKe,SACfC,SAAUhB,EAAKgB,SACfyF,QAASzG,EAAKyG,QACd9F,qBAqHFkG,aA7CF,SAAsB7G,GACpB,IAAI1B,EAAO0B,EAiBX,OAhBM1B,EAAK7D,eAAe,kBAAoB6D,EAAK7D,eAAe,aAChE6D,EAAOuH,EAAiBvH,IAEA,OAAtBA,EAAK2H,gBAEP3H,EAAOsI,EADPtI,EAzIJ,SAAmB0B,GAcjB,OAbAA,EAAKiB,QAAQ6F,QAAQ,CAACtM,EAAGuM,KACvBvM,EAAEwM,MAAQD,EACVvM,EAAEyM,UAAYzM,EAAE0M,kBACT1M,EAAE2M,cACF3M,EAAE0M,aAEXlH,EAAK1F,OAAOwM,QAAQtM,IACJ,WAAVA,EAAEG,MAAkBH,EAAEG,IAAM,SAClB,eAAVH,EAAEG,MAAsBH,EAAEG,IAAM,aACrB,YAAXH,EAAEuL,OAAoBvL,EAAEK,OAAS,WACtB,SAAXL,EAAEuL,OAAiBvL,EAAEK,OAAS,QACnB,SAAXL,EAAEuL,OAAiBvL,EAAEK,OAAS,SAE7BmF,EA2HEoH,CAAU9I,KAGdA,EAAK7D,eAAe,oBAChB6D,EAAK2H,qBACL3H,EAAK4H,SACZ5H,EAAK+I,QAAU,0EAEjB/I,EAAKhE,OAAOgN,OAAO9M,GAAe,cAAVA,EAAEG,KACvBmM,QAAQtM,IACPA,EAAEK,OAAS,QAERyD,GA2BOiJ,eAxBhB,SAAwBvH,GACtB,IAAI1B,EAAO0B,EAkBX,OAjBM1B,EAAKkJ,MAAM/M,eAAe,kBAAoB6D,EAAKkJ,MAAM/M,eAAe,aAC5E6D,EAAKmJ,MAAQ5B,EAAiBvH,EAAKmJ,OACnCnJ,EAAKkJ,MAhPT,SAA0BxH,EAAM0H,GAC9B,MAAMC,GACJC,eAAgB5H,EAAK6H,SAASD,eAC9BE,cAAe9H,EAAK6H,SAASC,cAC7BC,aACAC,YACAC,aACAC,SAgDF,OA9CIlI,EAAK6H,SAASpN,eAAe,cAC/BkN,EAAII,UAAUrH,GAAKV,EAAK6H,SAASE,UAAUrH,GAC3CiH,EAAII,UAAUI,MAAQnI,EAAK6H,SAASE,UAAUI,MAC9CR,EAAII,UAAUK,MAAQV,EAAWW,KAAK7N,GAAKA,EAAEG,MAAQqF,EAAK6H,SAASE,UAAUO,SAE7EX,EAAII,WACFrH,GAAI,QAAS0H,MAAOV,EAAW,GAC/BS,OAAQA,MAAO,SAAUI,QAAS,EAAG,GAAIC,OAAQ,QAAS,SAAUC,QAAS,SAG7EzI,EAAK6H,SAASpN,eAAe,aAC/BkN,EAAIK,SAAStH,GAAKV,EAAK6H,SAASG,SAAStH,GACzCiH,EAAIK,SAASG,MAAQnI,EAAK6H,SAASG,SAASG,MAC5CR,EAAIK,SAASI,MAAQV,EAAWW,KAAK7N,GAAKA,EAAEG,MAAQqF,EAAK6H,SAASG,SAASM,SAE3EX,EAAIK,UACFtH,GAAI,OAAQ0H,MAAOV,EAAW,GAC9BS,OAAQA,MAAO,SAAUI,QAAS,EAAG,GAAIC,OAAQ,GAAI,IAAKC,QAAS,KAGnEzI,EAAK6H,SAASpN,eAAe,cAC/BkN,EAAIM,UAAUvH,GAAKV,EAAK6H,SAASI,UAAUvH,GAC3CiH,EAAIM,UAAUS,KAAO1I,EAAK6H,SAASI,UAAUS,KAC7Cf,EAAIM,UAAU/H,KAAOF,EAAK6H,SAASI,UAAU/H,KAC7CyH,EAAIM,UAAUrN,QAAUoF,EAAK6H,SAASI,UAAUrN,QAChD+M,EAAIM,UAAUE,MAAQnI,EAAK6H,SAASI,UAAUE,MAC9CR,EAAIM,UAAUG,MAAQV,EAAWW,KAAK7N,GAAKA,EAAEG,MAAQqF,EAAK6H,SAASI,UAAUK,SAE7EX,EAAIM,WACFvH,GAAI,QAASgI,KAAM,GAAIxI,KAAM,QAAStF,SAAS,EAAOwN,MAAOV,EAAW,GACxES,OAAQA,MAAO,SAAUI,QAAS,EAAG,GAAIC,OAAQ,QAAS,SAAUC,QAAS,SAG7EzI,EAAK6H,SAASpN,eAAe,eAC/BkN,EAAIgB,YAAc3I,EAAK6H,SAASc,YAEhChB,EAAIgB,aAAe1B,WAAYrM,SAAS,IAEtCoF,EAAK6H,SAASpN,eAAe,QAC/BkN,EAAIO,KAAOlI,EAAK6H,SAASK,KAEzBP,EAAIO,MACFxH,GAAI,QAASqD,OAAQ2E,KAAM,GAAI9N,SAAS,GAAQA,SAAS,EACzDuN,OAAQA,MAAO,SAAUI,QAAS,EAAG,GAAIC,OAAQ,EAAG,GAAIC,QAAS,KAInE/H,GAAIV,EAAKU,GACThG,KAAMsF,EAAKtF,KACXsL,SAAUN,EAAa1F,EAAKnF,QAC5BoL,cAAe,GACfC,SAAU,EACVvF,WACE8G,MAAOzH,EAAK4I,aAEdlJ,OAAQyF,EAAWnF,EAAKN,QACxBpF,OAAQiE,EAAKlE,yBACVM,IAAO,WACPA,IAAO,WACPA,IAAO,YAEVsG,QAASjB,EAAKiB,QACdxF,MAAOuE,EAAKvE,MACZoN,iBAAkB7I,EAAK6I,iBACvB1C,UAAWnG,EAAKoG,YAChBC,UAAWrG,EAAKsG,gBAAkBtG,EAAKoG,YACvCG,YAAavG,EAAKwG,YAClBzF,SAA0B,IAAhBf,EAAKe,SACfC,SAAUhB,EAAKgB,SACfyF,QAASzG,EAAK0G,UAAY1G,EAAK2G,aAC/BkB,SAAUF,GAiKGmB,CAAiBxK,EAAKkJ,MAAOlJ,EAAKmJ,MAAMnN,SAEvB,OAA5BgE,EAAKkJ,MAAMvB,eAAuD,KAA7B3H,EAAKkJ,MAAMvB,iBAClD3H,EA9IJ,SAAmB0B,GAIjB,GAHKA,EAAKwH,MAAM/M,eAAe,eAC7BuF,EAAKwH,MAAM7G,WAAa8G,MAAOzH,EAAKwH,MAAMuB,UAExC/I,EAAKyH,MAAMnN,OAAO+N,KAAK7N,GAAe,WAAVA,EAAEG,KAAmB,CACnD,MAAMqO,KACNhJ,EAAKyH,MAAMxG,QAAQ6F,QAAQ,CAACtM,EAAGuM,KAC3BvM,EAAEwM,MAAQD,EACVvM,EAAEyM,UAAYzM,EAAE0M,WAChB8B,EAAcxO,EAAE2M,QAAU3M,EAAEwM,aACrBxM,EAAE2M,cACF3M,EAAE0M,aAEblH,EAAKwH,MAAMvG,QAAQ6F,QAAQtM,IACvBA,EAAEyO,OAASD,EAAcxO,EAAEyO,QAC3BzO,EAAEkB,OAASsN,EAAcxO,EAAEkB,UAE/BsE,EAAKyH,MAAMnN,OAAOwM,QAAQtM,IACV,WAAVA,EAAEG,MAAkBH,EAAEG,IAAM,SAClB,eAAVH,EAAEG,MAAsBH,EAAEG,IAAM,aACrB,YAAXH,EAAEuL,OAAoBvL,EAAEK,OAAS,WACtB,SAAXL,EAAEuL,OAAiBvL,EAAEK,OAAS,QACnB,SAAXL,EAAEuL,OAAiBvL,EAAEK,OAAS,SAGtC,OAAOmF,EAqHEkJ,CAAU5K,IACZmJ,MAAQb,EAAUtI,EAAKmJ,OAC5BnJ,EAAKkJ,MAjGT,SAAmBxH,GACjB,MAAM6H,GACJgB,iBAAkB7I,EAAK6I,kBA+CzB,OA7CAhB,EAASsB,mBAAqBnJ,EAAK6H,SAASc,YAAY1B,UAAUrM,QAClEiN,EAASE,UAAY/H,EAAK6H,SAASE,UAAUI,UACzCN,EAASE,UAAUK,QACrBP,EAASE,UAAUK,MAAQpI,EAAK6H,SAASE,UAAUK,MAAMzN,IACxB,WAA7BkN,EAASE,UAAUK,QACrBP,EAASE,UAAUK,MAAQ,UAGE,YAA7BP,EAASE,UAAUI,QACrBN,EAASE,UAAUS,MAAQjN,EAAG6N,kBAEhCvB,EAASG,SAAWhI,EAAK6H,SAASG,SAASG,UACvCnI,EAAK6H,SAASG,SAASI,QACzBP,EAASG,SAASI,MAAQpI,EAAK6H,SAASG,SAASI,MAAMzN,IACvB,WAA5BkN,EAASG,SAASI,QACpBP,EAASG,SAASI,MAAQ,UAG9BP,EAASI,aACLjI,EAAK6H,SAASI,UAAU/H,OAC1B2H,EAASI,UAAU/H,KAAOF,EAAK6H,SAASI,UAAU/H,KAAKvF,IACvB,WAA5BkN,EAASI,UAAU/H,OACrB2H,EAASI,UAAU/H,KAAO,UAG9B2H,EAASI,UAAUS,KAAO1I,EAAK6H,SAASI,UAAUS,KAClDb,EAASI,UAAUrN,QAAUoF,EAAK6H,SAASI,UAAUrN,QACrDiN,EAASwB,eAAiBrJ,EAAK6H,SAASI,UAAUE,UAC9CnI,EAAK6H,SAASI,UAAUG,QAC1BP,EAASwB,eAAejB,MAAQpI,EAAK6H,SAASI,UAAUG,MAAMzN,IACxB,WAAlCkN,EAASwB,eAAejB,QAC1BP,EAASwB,eAAejB,MAAQ,UAGE,YAAlCP,EAASwB,eAAelB,QAC1BN,EAASwB,eAAeb,MAAQjN,EAAG6N,kBAErCvB,EAASyB,YAActJ,EAAK6H,SAASK,KAAKtN,QAC1CiN,EAAS0B,UAAYvJ,EAAK6H,SAASK,KAAKC,UACxCN,EAAS2B,aACT3B,EAAS2B,UAAUd,KAAO1I,EAAK6H,SAASK,KAAKnE,MAAM2E,KACnDb,EAAS2B,UAAU5O,QAAUoF,EAAK6H,SAASK,KAAKnE,MAAMnJ,QACtDiN,EAASgB,iBAAmB7I,EAAK6I,kBAAoB7I,EAAKvE,MAAMgO,UAChE5B,EAAS6B,OAAS1J,EAAK6H,SAASC,eAG9BpH,GAAIV,EAAKU,GACThG,KAAMsF,EAAKtF,KACXsL,SAAUhG,EAAKgG,SACfC,cAAe,OACfC,SAAUlG,EAAKkG,SACfxG,OAAQM,EAAKN,OACbpF,OAAQ0F,EAAK1F,OACb2G,QAASjB,EAAKiB,QACdxF,OAAQkO,OAAQ3J,EAAKvE,OACrBsF,SAAUf,EAAKe,SACfC,SAAUhB,EAAKgB,SACfyF,QAASzG,EAAKyG,QACdoB,SAAUA,EACVlH,UAAWX,EAAKW,WAkCHiJ,CAAUtL,EAAKkJ,QAEzBlJ,EAAKkJ,MAAM/M,eAAe,oBACtB6D,EAAKmJ,MAAMxB,qBACX3H,EAAKkJ,MAAMvB,qBACX3H,EAAKmJ,MAAMvB,gBACX5H,EAAKkJ,MAAMtB,SAClB5H,EAAKmJ,MAAMJ,QAAU,yEACrB/I,EAAKkJ,MAAMH,QAAU,0EAEhB/I,UCzSYuL,EACnBC,YAAYxL,EAAMyL,EAAOC,GAMvBnF,KAAKoF,qBAAuB,IAC5BpF,KAAKqF,mBAAoB,EACzBrF,KAAKsF,aAAc,EAGnBtF,KAAKuF,sBAAwB,IAC7BvF,KAAKwF,oBAAqB,EAC1BxF,KAAKyF,cAAe,EAGpBzF,KAAKvG,KAAOiM,EAAOhD,eAAejJ,GAElCuG,KAAK4C,MAAQpI,KAAK+C,MAAM/C,KAAKC,UAAUuF,KAAKvG,KAAKmJ,MAAMxG,UACvD4D,KAAK2C,MAAQnI,KAAK+C,MAAM/C,KAAKC,UAAUuF,KAAKvG,KAAKkJ,MAAMvG,UAKvD4D,KAAK4C,MAAMX,QAAQ0D,IACjBA,EAAEC,eAEJ5F,KAAK2C,MAAMV,QAAQ,CAACtM,EAAGuM,KACrBvM,EAAEkQ,IAAM3D,EACRlC,KAAK4C,MAAMjN,EAAEyO,QAAQwB,UAAUE,MAAMnQ,EAAEkB,OAAQqL,IAC/ClC,KAAK4C,MAAMjN,EAAEkB,QAAQ+O,UAAUE,MAAMnQ,EAAEyO,OAAQlC,MAIjD,MAAMY,EAAM9C,KAAKvG,KAAKkJ,MAAMK,WAC1BE,aAAeC,YAAcC,aAAeoB,kBAC5CE,aAAeC,cAOjB3E,KAAKkD,aACLlD,KAAKkD,UAAUK,MAAQT,EAAII,UAAUK,OAAS,KAC9CvD,KAAKkD,UAAUI,MAAQR,EAAII,UAAUI,OAAS,SAC9CtD,KAAKkD,UAAUQ,OAASZ,EAAII,UAAUQ,SAAW,EAAG,GACpD1D,KAAKkD,UAAUS,MAAQb,EAAII,UAAUS,QAAU,UAAW,WAC1D3D,KAAKkD,UAAUU,QAAUd,EAAII,UAAUU,UAAY,WAGnD5D,KAAKmD,YACLnD,KAAKmD,SAASI,MAAQT,EAAIK,SAASI,OAAS,KAC5CvD,KAAKmD,SAASG,MAAQR,EAAIK,SAASG,OAAS,SAC5CtD,KAAKmD,SAASO,OAASZ,EAAIK,SAASO,SAAW,EAAG,GAClD1D,KAAKmD,SAASQ,MAAQb,EAAIK,SAASQ,QAAU,GAAI,IACjD3D,KAAKmD,SAASS,QAAUd,EAAIK,SAASS,SAAW,GAGhD5D,KAAKoD,aACLpD,KAAKoD,UAAU/H,KAAOyH,EAAIM,UAAU/H,MAAQ,KAC5C2E,KAAKoD,UAAUS,KAAOf,EAAIM,UAAUS,MAAQ,GAC5C7D,KAAKoD,UAAUrN,QAAU+M,EAAIM,UAAUrN,UAAW,EAGlDiK,KAAKwE,kBACLxE,KAAKwE,eAAejB,MAAQT,EAAI0B,eAAejB,OAAS,KACxDvD,KAAKwE,eAAelB,MAAQR,EAAI0B,eAAelB,OAAS,SACxDtD,KAAKwE,eAAed,OAASZ,EAAI0B,eAAed,SAAW,EAAG,GAC9D1D,KAAKwE,eAAeb,MAAQb,EAAI0B,eAAeb,QAAU,UAAW,WACpE3D,KAAKwE,eAAeZ,QAAUd,EAAI0B,eAAeZ,UAAY,WAI7D5D,KAAK+F,uBAAyBtM,EAAKkJ,MAAM/L,MAAMkO,OAAOF,UACtD5E,KAAKgE,iBAAmBlB,EAAIkB,kBAAoBvK,EAAKkJ,MAAM/L,MAAMkO,OAAOF,UAGxE5E,KAAK0E,aACL1E,KAAK0E,UAAUpB,MAAQR,EAAI4B,UAAUpB,OAAS,SAC9CtD,KAAK0E,UAAUhB,OAASZ,EAAI4B,UAAUhB,SAAW,GAAK,GACtD1D,KAAK0E,UAAUf,MAAQb,EAAI4B,UAAUf,QAAU,EAAG,GAClD3D,KAAK0E,UAAUd,QAAUd,EAAI4B,UAAUd,SAAW,EAGlD5D,KAAK2E,aACL3E,KAAK2E,UAAUd,KAAOf,EAAI6B,UAAUd,MAAQ,GAC5C7D,KAAK2E,UAAU5O,QAAU+M,EAAI6B,UAAU5O,UAAW,EAGlDiK,KAAKgG,UAAYlD,EAAIC,iBAAmBkD,EAAG,EAAGC,EAAG,EAAGC,EAAG,GAGvDnG,KAAKoG,aAAe,KACpBpG,KAAKqG,aAAe,KAGpBrG,KAAKsG,wBAA0B,KAC/BtG,KAAKuG,mBAAqB,KAC1BvG,KAAKwG,mBAAqB,KAC1BxG,KAAKyG,uBAAyB,KAC9BzG,KAAK0G,uBAAyB,KAE9B1G,KAAK2G,iBAAmB,KAExB3G,KAAK4G,YAAc,KAEnB5G,KAAK6G,iBAAmB,KACxB7G,KAAK8G,cAAgB,KACrB9G,KAAK+G,cAAgB,KACrB/G,KAAKgH,gBAAkB,KAGvBhH,KAAKiH,YAAcC,IAAK,EAAGC,MAAOjC,EAAOkC,OAAQjC,EAAQkC,KAAM,GAC/DrH,KAAKsH,SAAWJ,IAAK,EAAGC,MAAOjC,EAAOkC,OAAQjC,EAAQkC,KAAM,GAC5DrH,KAAKuH,aACLvH,KAAKwH,YACLxH,KAAKyH,eACHxB,EAAGjG,KAAKgG,UAAUC,EAAGC,EAAGlG,KAAKgG,UAAUE,EAAGC,EAAGnG,KAAKgG,UAAUG,GAG1DrD,EAAI+B,QACN7E,KAAK0H,kBAAmB,EAExB1H,KAAK2H,aAAa7E,EAAI+B,QACtB7E,KAAK4H,eACL5H,KAAK6H,eAEL7H,KAAK0H,kBAAmB,EAI5BzC,cACE,MAAM6C,EAAK9H,KAAK4C,MAAMlN,IAAIC,GAAKA,EAAEsQ,GAC3B8B,EAAK/H,KAAK4C,MAAMlN,IAAIC,GAAKA,EAAEuQ,GACjClG,KAAKwH,SAASN,IAAMpP,KAAKkQ,IAAIC,MAAM,KAAMF,GACzC/H,KAAKwH,SAASH,KAAOvP,KAAKkQ,IAAIC,MAAM,KAAMH,GAC1C9H,KAAKwH,SAASJ,OAAStP,KAAKoQ,IAAID,MAAM,KAAMF,GAC5C/H,KAAKwH,SAASL,MAAQrP,KAAKoQ,IAAID,MAAM,KAAMH,GAI7C7C,eACE,MAAMkD,EAAKnI,KAAKgG,UAAUC,EACpBmC,EAAKpI,KAAKgG,UAAUE,EACpBmC,EAAKrI,KAAKgG,UAAUG,EAE1BnG,KAAKuH,UAAUL,KAAOlH,KAAKsH,QAAQJ,IAAMkB,GAAMC,EADhC,GAEfrI,KAAKuH,UAAUF,MAAQrH,KAAKsH,QAAQD,KAAOc,GAAME,EAFlC,GAGfrI,KAAKuH,UAAUH,QAAUpH,KAAKsH,QAAQF,OAASgB,GAAMC,EAHtC,GAIfrI,KAAKuH,UAAUJ,OAASnH,KAAKsH,QAAQH,MAAQgB,GAAME,EAJpC,GAQjBpD,aAAakD,EAAIC,EAAIC,GACnBrI,KAAKgG,UAAUC,EAAIkC,EACnBnI,KAAKgG,UAAUE,EAAIkC,EACnBpI,KAAKgG,UAAUG,EAAIkC,EAEnBrI,KAAK4H,eAGP3C,WAAWC,EAAOC,GAChBnF,KAAKsH,QAAQH,MAAQjC,EACrBlF,KAAKsH,QAAQF,OAASjC,EAEtBnF,KAAK4H,eAGP3C,aAAaqD,GACXtI,KAAK4C,MAAMX,QAAQ0D,IACjBA,EAAEM,EAAIqC,EAAW3C,EAAExD,OAAO8D,EAC1BN,EAAEO,EAAIoC,EAAW3C,EAAExD,OAAO+D,EAE1BP,EAAEC,UAAU3D,QAAQtM,IAClB,MAAM4S,EAAM5S,EAAE,GACR0N,EAAO1N,EAAE,GACXgQ,EAAExD,MAAQoG,GACZvI,KAAK2C,MAAMU,GAAMmF,GAAKF,EAAW3C,EAAExD,OAAO8D,EAC1CjG,KAAK2C,MAAMU,GAAMoF,GAAKH,EAAW3C,EAAExD,OAAO+D,IAE1ClG,KAAK2C,MAAMU,GAAM8E,GAAKG,EAAW3C,EAAExD,OAAO8D,EAC1CjG,KAAK2C,MAAMU,GAAM+E,GAAKE,EAAW3C,EAAExD,OAAO+D,OAIhDlG,KAAK6H,cAGP5C,UAAUU,EAAGM,EAAGC,GACdlG,KAAK4C,MAAM+C,GAAGM,EAAIA,EAClBjG,KAAK4C,MAAM+C,GAAGO,EAAIA,EAClBlG,KAAK4C,MAAM+C,GAAGC,UAAU3D,QAAQtM,IAC9B,MAAM4S,EAAM5S,EAAE,GACR0N,EAAO1N,EAAE,GACXgQ,EAAI4C,GACNvI,KAAK2C,MAAMU,GAAMmF,GAAKvC,EACtBjG,KAAK2C,MAAMU,GAAMoF,GAAKvC,IAEtBlG,KAAK2C,MAAMU,GAAM8E,GAAKlC,EACtBjG,KAAK2C,MAAMU,GAAM+E,GAAKlC,KAG1BlG,KAAK6H,cAGP5C,gBACE,OAAOjF,KAAK4C,MAAMH,OAChB9M,GAAKA,EAAEuQ,EAAIlG,KAAKuH,UAAUL,KAAOvR,EAAEsQ,EAAIjG,KAAKuH,UAAUF,MACjD1R,EAAEuQ,EAAIlG,KAAKuH,UAAUH,QAAUzR,EAAEsQ,EAAIjG,KAAKuH,UAAUJ,OAI7DlC,gBACE,OAAOjF,KAAK2C,MAAMF,OAChB9M,GAAKA,EAAE+S,QAAU1I,KAAKgE,kBACjBhE,KAAKuH,UAAUL,IAAMpP,KAAKoQ,IAAIvS,EAAE8S,GAAI9S,EAAEyS,KACtCpI,KAAKuH,UAAUF,KAAOvP,KAAKoQ,IAAIvS,EAAE6S,GAAI7S,EAAEwS,KACvCnI,KAAKuH,UAAUH,OAAStP,KAAKkQ,IAAIrS,EAAE8S,GAAI9S,EAAEyS,KACzCpI,KAAKuH,UAAUJ,MAAQrP,KAAKkQ,IAAIrS,EAAE6S,GAAI7S,EAAEwS,KAIjDlD,WACE,OACE/B,UAAWlD,KAAKkD,UAChBC,SAAUnD,KAAKmD,SACfC,UAAWpD,KAAKoD,UAChBoB,eAAgBxE,KAAKwE,eACrBE,UAAW1E,KAAK0E,UAChBC,UAAW3E,KAAK2E,UAChBX,iBAAkBhE,KAAKgE,iBACvB+B,uBAAwB/F,KAAK+F,uBAC7BhD,eAAgB/C,KAAKgG,UACrBnB,OAAQ7E,KAAK4C,MAAMlN,IAAIC,KAAOsQ,EAAGtQ,EAAEsQ,EAAGC,EAAGvQ,EAAEuQ,MAI/CjB,SAGE,OAFAjF,KAAKvG,KAAKkJ,MAAM9G,GAAKnC,EAAKhC,SAC1BsI,KAAKvG,KAAKkJ,MAAMK,SAAWhD,KAAKgD,WACzBxI,KAAK+C,MAAM/C,KAAKC,UAAUuF,KAAKvG,OAGxCwL,gBACEvO,EAAGqJ,OAAO,oBACP1E,KAAKb,KAAKC,UAAUuF,KAAKgG,YAG9Bf,eACEvO,EAAGqJ,OAAO,mBACP1E,KAAKb,KAAKC,UAAUuF,KAAKwH,WAG9BvC,gBACEvO,EAAGqJ,OAAO,oBACP1E,KAAKb,KAAKC,UAAUuF,KAAKuH,YAG9BtC,cACEvO,EAAGqJ,OAAO,kBACP1E,KAAKb,KAAKC,UAAUuF,KAAKsH,WCzQhC,MASMqB,IACH7S,IAAK,SAAUD,KAAM,SAAU+S,KAAMlS,EAAGmS,gBACxC/S,IAAK,MAAOD,KAAM,MAAO+S,KAAMlS,EAAGoS,aAClChT,IAAK,WAAYD,KAAM,WAAY+S,KAAMlS,EAAGqS,kBAC5CjT,IAAK,UAAWD,KAAM,UAAW+S,KAAMlS,EAAGsS,iBAqBvCC,IACHnT,IAAK,aAAcD,KAAM,aAAcgO,KAAM,IAC7C/N,IAAK,YAAaD,KAAM,YAAagO,KAAM,IAC3C/N,IAAK,aAAcD,KAAM,cAAegO,KAAM,GAC9CF,MAAOjN,EAAGwS,iBAAkBtF,QAAS,YACrC9N,IAAK,aAAcD,KAAM,cAAegO,KAAM,GAC9CF,MAAOjN,EAAGyS,aAAaC,OAAO1S,EAAG2S,YAAazF,QAAS,YACvD9N,IAAK,aAAcD,KAAM,cAAegO,KAAM,GAC9CF,MAAOjN,EAAGyS,aAAaC,OAAO1S,EAAG4S,cAAe5S,EAAG2S,WAAY3S,EAAG6S,YAClE3F,QAAS,mBAsCV4F,UAhFC1T,IAAK,WAAYD,KAAM,WAAYyN,MAAO,MAAOI,QAAS,KAAM,QAChE5N,IAAK,UAAWD,KAAM,UAAWyN,MAAO,SAAUI,QAAS,EAAG,OAC9D5N,IAAK,KAAMD,KAAM,aAAcyN,MAAO,WAAYI,QAAS,EAAG,KAC9D5N,IAAK,KAAMD,KAAM,KAAMyN,MAAO,SAAUI,QAAS,IAAK,OACtD5N,IAAK,OAAQD,KAAM,OAAQyN,MAAO,SAAUI,SAAU,EAAG,KA4EjDiF,MAAAA,EAAOc,gBA/Df3T,IAAK,aAAcD,KAAM,aACzB8N,OAAQ,UAAW,WAAYC,QAAS,YACxC9N,IAAK,aAAcD,KAAM,aACzB8N,OAAQ,UAAW,WAAYC,QAAS,YACxC9N,IAAK,SAAUD,KAAM,SACrB8N,OAAQ,UAAW,WAAYC,QAAS,YACxC9N,IAAK,SAAUD,KAAM,SACrB8N,OAAQ,UAAW,WAAYC,QAAS,YACxC9N,IAAK,cAAeD,KAAM,cAC1B8N,OAAQ,UAAW,UAAW,WAAYC,QAAS,YACnD9N,IAAK,WAAYD,KAAM,WACvB8N,OAAQ,UAAW,UAAW,WAAYC,QAAS,YAoDrBqF,gBAAAA,EAC/BS,cAnCF,SAAuBrK,GACrB,IAAIsK,EAAKhB,EAAMnF,KAAK7N,GAAKA,EAAEG,KAAOuJ,EAAKiE,OAAOsF,KAC1ClF,EAASrE,EAAKqE,OAClB,GAAyB,GAArBrE,EAAKsE,MAAMpJ,OAAa,CAC1B,MAAMqP,GAAOnT,WAAW4I,EAAKqE,OAAO,IAAMjN,WAAW4I,EAAKqE,OAAO,KAAO,EACxEA,GAAUrE,EAAKqE,OAAO,GAAIkG,EAAKvK,EAAKqE,OAAO,IAS7C,MAPmB,YAAfrE,EAAKiE,QACPqG,EAAKA,EAAGjG,OAAOA,IAEjBiG,EAAKA,EAAGhG,MAAMtE,EAAKsE,QACd,SAAU,OAAOxN,SAASkJ,EAAKiE,SAClCqG,EAAKA,EAAGE,OAAM,IAETC,IACL,GAAU,KAANA,GAAAA,MAAmBA,EACrB,OAAOzK,EAAKuE,QAEd,GAAmB,YAAfvE,EAAKiE,OAAuB7M,WAAWqT,IAAMA,EAC/C,OAAOzK,EAAKuE,QAEd,GAAmB,QAAfvE,EAAKiE,OAAmBwG,GAAK,EAC/B,OAAOzK,EAAKuE,QAEd,MAAM9G,EAAS6M,EAAGG,GAClB,YAAeC,IAAXjN,EACKuC,EAAKuE,QAEP9G,KCxEX,MAAMkN,EAAW,IACXC,EAAY,IAGlB,SAASC,EAAYjL,EAAW7C,EAAS+N,GACvC,MAAMvH,EAAQ3D,EAAUmL,UAAU,SAC/B3Q,KAAK2C,EAAS0N,GAAKA,EAAE3H,OACxBS,EAAMyH,OAAOC,SACb,MAAMC,EAAU3H,EAAM4H,QACnBpL,OAAO,KACLC,KAAK,QAAS,QACdoL,KAAKC,GACVH,EAAQnL,OAAO,UACVC,KAAK,QAAS,eACnBkL,EAAQnL,OAAO,KACVC,KAAK,QAAS,gBACdA,KAAK,0BAA2B2K,EAAW,MAAMC,EAAY,MAClEM,EAAQnL,OAAO,QACVC,KAAK,QAAS,cACdA,KAAK,IAAK,GACVA,KAAK,cAAe,UACzB,MAAMsL,EAASJ,EAAQK,MAAMhI,GACzBuH,EACFQ,EAAO5K,OAAO,iBAAiB8K,KAAKf,GAAKA,EAAE1H,WAE3CuI,EAAO5K,OAAO,iBAAiBA,OAAO,OAAOuK,SAKjD,SAASQ,EAAY7L,EAAW7C,GAC9B,MAAMuG,EAAQ1D,EAAUmL,UAAU,SAC/B3Q,KAAK2C,EAAS0N,MAAQA,EAAE1F,UAAU0F,EAAEjT,UACvC8L,EAAM0H,OAAOC,SACb,MAAMC,EAAU5H,EAAM6H,QACnBpL,OAAO,KACLC,KAAK,QAAS,QACnBkL,EAAQnL,OAAO,QACVC,KAAK,QAAS,aACdc,MAAM,SAAU,QAChBA,MAAM,iBAAkB,IAC7BoK,EAAQnL,OAAO,QACVC,KAAK,QAAS,cACdA,KAAK,cAAe,UACpBhE,KAAKyO,GAAKA,EAAEpB,QAEjB6B,EAAQE,KAAKM,GAIf,SAASC,EAAgB/L,EAAWgM,GAClChM,EAAUmL,UAAU,SACjBc,KAAK,SAAUpB,GACd,MAAMqB,EAAQ7H,EAAMoG,cAAcuB,EAAM/H,UAA1BI,CAAqCwG,EAAEmB,EAAM/H,UAAUK,QAC/DM,EAAOP,EAAMoG,cAAcuB,EAAM9H,SAA1BG,CAAoCwG,EAAEmB,EAAM9H,SAASI,QAC5D6H,EAAa9H,EAAMoG,cAAcuB,EAAMzG,eAA1BlB,CAA0CwG,EAAEmB,EAAMzG,eAAejB,QACpF7M,EAAGqJ,OAAOC,MAAMD,OAAO,gBAClBV,KAAK,IAAKwE,GACV1D,MAAM,OAAQgL,GACnBzU,EAAGqJ,OAAOC,MAAMD,OAAO,eAClB1E,KAAKyO,IACJ,GAA6B,OAAzBmB,EAAM7H,UAAU/H,KAAe,MAAO,GAC1C,MAAMkI,EAAQ0H,EAAMxR,KAAKmJ,MAAMnN,OAAO+N,KAAK7N,GAAKA,EAAEG,MAAQmV,EAAM7H,UAAU/H,MAC1E,MAAqB,cAAjBkI,EAAMvN,OACD0D,EAAKtD,UAAU0T,EAAEmB,EAAM7H,UAAU/H,MAAOkI,EAAM8H,WAEhDvB,EAAEmB,EAAM7H,UAAU/H,QAE1BgE,KAAK,YAAa4L,EAAM7H,UAAUS,MAClCxE,KAAK,IAAK5I,WAAWoN,GAAQyH,SAASL,EAAM7H,UAAUS,OACtDxE,KAAK,aAAc4L,EAAM7H,UAAUrN,QAAU,UAAY,UACzDoK,MAAM,OAAQiL,KAKzB,SAASG,EAAgBtM,EAAWgM,GAClChM,EAAUmL,UAAU,SAASrK,OAAO,cACjCI,MAAM,eAAgB2J,GAAKxG,EAAMoG,cAAcuB,EAAMvG,UAA1BpB,CAAqCwG,EAAEpB,SACrEzJ,EAAUmL,UAAU,SAASrK,OAAO,eACjCV,KAAK,aAAc4L,EAAMtG,UAAU5O,QAAU,UAAY,UACzDsJ,KAAK,YAAa4L,EAAMtG,UAAUd,MAIvC,SAAS6G,EAAiBzL,GACxBA,EAAUI,KAAK,YAAayK,gBAAkBA,EAAE7D,MAAM6D,EAAE5D,MAI1D,SAAS6E,EAAiB9L,GACxBA,EAAUI,KAAK,YAAayK,gBAAkBA,EAAEtB,OAAOsB,EAAErB,OACzDxJ,EAAUc,OAAO,cACdV,KAAK,KAAM,GACXA,KAAK,KAAM,GACXA,KAAK,KAAMyK,GAAKA,EAAE3B,GAAK2B,EAAEtB,IACzBnJ,KAAK,KAAMyK,GAAKA,EAAE1B,GAAK0B,EAAErB,IAC5BxJ,EAAUc,OAAO,eACdV,KAAK,IAAKyK,IAAMA,EAAE3B,GAAK2B,EAAEtB,IAAM,GAC/BnJ,KAAK,IAAKyK,IAAMA,EAAE1B,GAAK0B,EAAErB,IAAM,GAIpC,SAAS+C,EAAYvM,EAAWgM,GAC9BhM,EAAUc,OAAO,aAAa0K,KAAKO,EAAiBC,GACpDhM,EAAUc,OAAO,aAAa0K,KAAKc,EAAiBN,GA8BtD,SAASQ,EAASxM,EAAWgH,EAAGC,GAC9BjH,EAAUI,KAAK,yBAA0B4G,MAAMC,MAIjD,SAASwF,EAASzM,EAAWuJ,EAAIC,EAAIN,EAAIC,GACvCnJ,EAAUI,KAAK,yBAA0BmJ,MAAOC,MAChDxJ,EAAUc,OAAO,cACdV,KAAK,KAAM,GACXA,KAAK,KAAM,GACXA,KAAK,KAAM8I,EAAKK,GAChBnJ,KAAK,KAAM+I,EAAKK,GACnBxJ,EAAUc,OAAO,eACdV,KAAK,KAAM8I,EAAKK,GAAM,GACtBnJ,KAAK,KAAM+I,EAAKK,GAAM,UAkCzByB,YAAAA,EAAaY,YAAAA,EAAaJ,iBAAAA,EAAkBK,iBAAAA,EAC5CC,gBAAAA,EAAiBO,gBAAAA,EAAiBC,YAAAA,EAAaG,iBA3EjD,SAA0B1M,EAAWgM,GACnC,MAAMW,EAAgBX,EAAMW,gBACtBC,EAAWD,EAAcrR,OAC3B0Q,EAAM5F,oBACR4F,EAAM3F,YAAcuG,EAAWZ,EAAM7F,sBAEnC6F,EAAMzF,qBACRyF,EAAMxF,aAAeoG,EAAWZ,EAAM1F,uBAExC,MAAMuG,EAAgBb,EAAMxF,gBAAoBwF,EAAMa,gBACtD7M,EAAUc,OAAO,aACd0K,KAAKP,EAAa0B,EAAeX,EAAM3F,aAC1CrG,EAAUc,OAAO,aACd0K,KAAKK,EAAagB,GACrB7M,EAAUwL,KAAKe,EAAaP,GAExBA,EAAM7E,cACRnH,EAAUwL,KAAKQ,EAAM7E,cAEnB6E,EAAM5E,cACRpH,EAAUc,OAAO,aAAaqK,UAAU,SACrCK,KAAKQ,EAAM5E,eAuDhB0F,KAhCF,SAAc9M,EAAWgB,EAAMgG,EAAGC,GAChC,MAAMP,EAAIjP,EAAGqJ,OAAOE,GAAMwK,KAAKgB,EAAUxF,EAAGC,GAAG8F,QAC/C/M,EAAUc,OAAO,aACdqK,UAAU,SACV3H,OAAOqH,GAAKnE,EAAEC,UAAUlQ,IAAIC,GAAKA,EAAE,IAAIQ,SAAS2T,EAAEjE,MAClDqF,KAAK,SAAUpB,GACVnE,EAAExD,QAAU2H,EAAE1F,OAAOjC,OAASwD,EAAExD,QAAU2H,EAAE1F,OAC9C1N,EAAGqJ,OAAOC,MAAMyK,KAAKiB,EAAUzF,EAAGC,EAAG4D,EAAE3B,GAAI2B,EAAE1B,IACpCzC,EAAExD,QAAU2H,EAAEjT,OAAOsL,OAASwD,EAAExD,QAAU2H,EAAEjT,QACrDH,EAAGqJ,OAAOC,MAAMyK,KAAKiB,EAAU5B,EAAEtB,GAAIsB,EAAErB,GAAIxC,EAAGC,MAuB9CF,UAjBR,SAAmB/G,EAAWkJ,EAAIC,EAAIC,GACpCpJ,EAAUc,OAAO,aACdV,KAAK,yBAA0B8I,MAAOC,YAAaC,OAerC4D,cAXnB,SAAuBhN,EAAWiG,EAAOC,GACvClG,EAAUI,KAAK,iBAAkB6F,KAASC,KAC1ClG,EAAUc,OAAO,qBACdV,KAAK,QAAS6F,GACd7F,KAAK,SAAU8F,KC1KpB,SAAS+G,EAAOjN,EAAWgM,GACzB,MAAMkB,EAAOlN,EAAUgB,OACvBgL,EAAMmB,WAAWD,EAAKE,YAAaF,EAAKG,cACxCrN,EAAUc,OAAO,YACd0K,KAAK8B,EAAUN,cAAeE,EAAKE,YAAaF,EAAKG,qBA0DxDE,iBAzEF,SAA0BvN,EAAWgM,GACnChM,EACGkB,MAAM,QAAS,QACfA,MAAM,SAAU,QACnBlB,EAAUc,OAAO,YAAYuK,SAC7BrL,EAAUG,OAAO,OACdD,QAAQ,WAAW,GACtBF,EAAUwL,KAAKyB,EAAQjB,IAkELiB,OAAAA,EAAQO,YAtD5B,SAAqBxN,EAAWgM,GAC9BhM,EACGI,KAAK,sBAAuB,iBAC5BA,KAAK,iBAAkB,OACvBA,KAAK,iBAAkB4L,EAAM3D,QAAQH,SAAS8D,EAAM3D,QAAQF,UAC5DjH,MAAM,QAAS,QACfA,MAAM,SAAU,QAGnBlB,EAAUc,OAAO,qBAAqBuK,SACtCrL,EAAUc,OAAO,aAAauK,SAG9BrL,EAAUG,OAAO,QACZD,QAAQ,oBAAoB,GAC5BE,KAAK,IAAK,GACVA,KAAK,IAAK,GACVA,KAAK,QAAS4L,EAAM3D,QAAQH,OAC5B9H,KAAK,SAAU4L,EAAM3D,QAAQF,QAC7B/H,KAAK,OAAQ,WACbA,KAAK,eAAgB,GACrBA,KAAK,SAAU,WACpB,MAAMkE,EAAQtE,EAAUG,OAAO,KAC1BD,QAAQ,YAAY,GACpBgB,MAAM,UAAW,MACtBoD,EAAMmJ,aACDC,SAAS,KACTxM,MAAM,UAAW,GACtB,MAAMwC,EAAQY,EAAMnE,OAAO,KAAKD,QAAQ,YAAY,GAC9CyD,EAAQW,EAAMnE,OAAO,KAAKD,QAAQ,YAAY,GAGpD8L,EAAM3E,wBAA0B,MAC9BrH,EAAUwL,KAAK8B,EAAUZ,iBAAkBV,KAE7CA,EAAM1E,mBAAqB,MACzB3D,EAAM6H,KAAK8B,EAAUrC,YAAae,EAAMW,mBAE1CX,EAAMzE,mBAAqB,MACzB7D,EAAM8H,KAAK8B,EAAUzB,YAAaG,EAAMa,mBAE1Cb,EAAMxE,uBAAyB,MAC7B7D,EAAM6H,KAAK8B,EAAUvB,gBAAiBC,KAExCA,EAAMvE,uBAAyB,MAC7B/D,EAAM8H,KAAK8B,EAAUhB,gBAAiBN,KAIxChM,EAAUwL,KAAK8B,EAAUZ,iBAAkBV,KClE7C,SAAS5E,EAAapH,EAAWgM,GAC/B,OAAOvU,EAAGkW,OACP9M,GAAG,OAAQ,WACVb,EAAUwL,KAAK8B,EAAUR,KAAM/L,KAAMtJ,EAAGmG,MAAMoJ,EAAGvP,EAAGmG,MAAMqJ,KAE3DpG,GAAG,MAAO,SAAUgK,GACnBmB,EAAM4B,UAAU/C,EAAE3H,MAAOzL,EAAGmG,MAAMoJ,EAAGvP,EAAGmG,MAAMqJ,KAKpD,SAASE,EAAanH,EAAWgM,GAC/B,OAAOvU,EAAGoW,OACPhN,GAAG,OAAQ,WACV,MAAMiN,EAAIrW,EAAGmG,MAAMmJ,UAGnB,GAFA/G,EAAUwL,KAAK8B,EAAUvG,UAAW+G,EAAE9G,EAAG8G,EAAE7G,EAAG6G,EAAE5G,IAE3C8E,EAAM3F,YAAa,CACtB,MAAM0H,EAAI/B,EAAMxD,cACVwF,EAASF,EAAE9G,EAAI+G,EAAE/G,EAAI,IAAM8G,EAAE9G,EAAI+G,EAAE/G,EAAI,GACvCiH,EAASH,EAAE7G,EAAI8G,EAAE9G,EAAI,IAAM6G,EAAE7G,EAAI8G,EAAE9G,EAAI,GACvCiH,EAASJ,EAAE5G,EAAI6G,EAAE7G,GACnB8G,GAAUC,IAAWC,KACvBlC,EAAMmC,aAAaL,EAAE9G,EAAG8G,EAAE7G,EAAG6G,EAAE5G,GAC/B8E,EAAMxD,eAAiBxB,EAAG8G,EAAE9G,EAAGC,EAAG6G,EAAE7G,EAAGC,EAAG4G,EAAE5G,GAC5ClH,EACGwL,KAAK8B,EAAUZ,iBAAkBV,OAIzCnL,GAAG,MAAO,WACT,MAAMiN,EAAIrW,EAAGmG,MAAMmJ,UACnBiF,EAAMmC,aAAaL,EAAE9G,EAAG8G,EAAE7G,EAAG6G,EAAE5G,GAC/B8E,EAAMxD,eAAiBxB,EAAG8G,EAAE9G,EAAGC,EAAG6G,EAAE7G,EAAGC,EAAG4G,EAAE5G,GAC5ClH,EACGwL,KAAK8B,EAAUZ,iBAAkBV,KA2B1C,SAASoC,EAAIpO,EAAWgM,GACtB,MAAM3D,EAAUrI,EAAUc,OAAO,qBAAqBE,OAAOqN,UACvDC,EAAejG,EAAQpC,MAAQoC,EAAQnC,OACvCqI,EAAiBvC,EAAMzD,SAASJ,OAAS6D,EAAMzD,SAASN,IACxDuG,EAAgBxC,EAAMzD,SAASL,MAAQ8D,EAAMzD,SAASH,KAEtD/D,EAAQiK,GADQE,EAAgBD,EAElClG,EAAQnC,OAASqI,EACjBlG,EAAQpC,MAAQuI,EACdtF,GAAM8C,EAAMzD,SAASH,KAAO/D,EAC5B8E,GAAM6C,EAAMzD,SAASN,IAAM5D,EACjC2H,EAAMmC,aAAajF,EAAIC,EAAI9E,GAC3BrE,EACKwL,KAAK8B,EAAUZ,iBAAkBV,GACjCR,KAAK8B,EAAUvG,UAAWmC,EAAIC,EAAI9E,GAClCmH,KACC/T,EAAGoW,OAAO9G,UACVtP,EAAGgX,aAAaC,UAAUxF,EAAIC,GAAI9E,MAAMA,WAM9C+C,aAAAA,EAAcD,aAAAA,EAAcwH,eA7C9B,SAAwB3O,EAAWgM,GACjCA,EAAM7E,aAAeA,EAAanH,EAAWgM,GAC7CA,EAAM5E,aAAeA,EAAapH,EAAWgM,GAC7ChM,EAAUwL,KAAKQ,EAAM7E,cACrBnH,EAAUc,OAAO,aACdqK,UAAU,SACRK,KAAKQ,EAAM5E,cAChB4E,EAAMrE,YAAc,MAClB3H,EAAUwL,KAAK4C,EAAKpC,KAGtB,MAAM8B,EAAI9B,EAAMjF,UAChB/G,EACKwL,KAAK8B,EAAUvG,UAAW+G,EAAE9G,EAAG8G,EAAE7G,EAAG6G,EAAE5G,GACtCsE,KACC/T,EAAGoW,OAAO9G,UACVtP,EAAGgX,aAAaC,UAAUZ,EAAE9G,EAAG8G,EAAE7G,GAAG5C,MAAMyJ,EAAE5G,KA6BNkH,IAAAA,GC1D9C,SAASQ,EAAgBC,GACvB,MAAMC,EAAQD,EAAWC,QACnBC,EAAYD,GAASD,EAAWG,WAEhC/R,EAAWoP,SAAS0C,EAAY,EAAY,IAARD,GAC1CrX,EAAGqJ,OAAO,gBACPZ,QAAQ,aAAc6O,GACtB7O,QAAQ,cAAe6O,GACvB7N,MAAM,WAAYjE,MAClBmD,KAAK,gBAAiBnD,GAqB3B,SAASgS,EAAIjP,EAAW6O,EAAY7C,GAClC,MAAMpG,EAASoG,EAAMrI,MAAMlN,IAAIC,KAAOsQ,EAAGtQ,EAAEsQ,EAAGC,EAAGvQ,EAAEuQ,KACnD+E,EAAMtD,aAAa9C,GACnB5F,EACGwL,KAAK8B,EAAUZ,iBAAkBV,GACpC4C,EAAgBC,GAIlB,SAASK,EAAMlP,EAAW6O,EAAY7C,GACpC6C,EAAWC,MAAM,GAAGK,OACpBnP,EAAUc,OAAO,aAAaqK,UAAU,SACrCc,KAAKpB,IACJA,EAAEuE,GAAKvE,EAAE7D,EACT6D,EAAEwE,GAAKxE,EAAE5D,IAEb+E,EAAM5E,aAAekI,EAAYlI,aAAapH,EAAWgM,GACzDhM,EAAUwL,KAAKyD,EAAKJ,EAAY7C,GAIlC,SAASuD,EAAQvP,EAAW6O,EAAY7C,GACtChM,EAAUc,OAAO,aAAaqK,UAAU,SACrCc,KAAKpB,IACJA,EAAEuE,GAAK,KACPvE,EAAEwE,GAAK,OAEXrD,EAAM5E,aA5CR,SAA2BpH,EAAW6O,EAAY7C,GAChD,OAAOvU,EAAGkW,OACP9M,GAAG,QAAS,KACNpJ,EAAGmG,MAAM4R,QAAQxP,EAAUwL,KAAKiE,EAAOZ,EAAY7C,KAEzDnL,GAAG,OAAQgK,IACVA,EAAEuE,GAAK3X,EAAGmG,MAAMoJ,EAChB6D,EAAEwE,GAAK5X,EAAGmG,MAAMqJ,IAEjBpG,GAAG,MAAOgK,IACJpT,EAAGmG,MAAM4R,QAAQX,EAAWa,YAAY,GAC7C7E,EAAEuE,GAAK,KACPvE,EAAEwE,GAAK,OAgCUM,CAAkB3P,EAAW6O,EAAY7C,GAG9D,MAAMpG,EAASoG,EAAMrI,MAAMlN,IAAIC,KAAOsQ,EAAGtQ,EAAEsQ,EAAGC,EAAGvQ,EAAEuQ,KACnD+E,EAAMtD,aAAa9C,GACnB5F,EACGwL,KAAK8B,EAAUZ,iBAAkBV,GAItC,SAASyD,EAAMzP,EAAW6O,EAAY7C,GACpChM,EAAUwL,KAAK+D,EAASV,EAAY7C,GACpC6C,EAAWC,MAAM,IAAKc,UAIxB,SAASA,EAAQ5P,EAAW6O,EAAY7C,GACtChM,EAAUwL,KAAK+D,EAASV,EAAY7C,GACpC6C,EAAWC,MAAM,GAAGc,UAItB,SAASC,EAAS7P,EAAW6O,EAAY7C,GACvC,MAAM8D,EAAa9D,EAAMtI,MACtBF,OAAO9M,GAAKA,EAAE+S,QAAUuC,EAAMjH,kBACjC8J,EAAWlL,MAAMqI,EAAMrI,OACpBoM,MAAM,QAAQC,MAAMF,UAqCvBG,gBAlJF,SAAyBhK,EAAOC,GAC9B,OAAOzO,EAAGwY,kBACPF,MAAM,OACLtY,EAAGyY,YAAYtT,GAAGiO,GAAKA,EAAE3H,OACtBiN,SAAS,IACTC,SAAS,IACbL,MAAM,SACLtY,EAAG4Y,gBACAD,UAAU,KACVE,YAAY,IACZC,YAAY,MAChBR,MAAM,UACLtY,EAAG+Y,eACAC,OAAO,KACXV,MAAM,SACLtY,EAAGiZ,YAAYzK,EAAQ,EAAGC,EAAS,IACpC6J,MAAM,IACLtY,EAAGkZ,SACAP,SAAS,OACbL,MAAM,IACLtY,EAAGmZ,SACAR,SAAS,OACbjB,QA4Hc0B,SAlCnB,SAAkB7Q,EAAW6O,EAAY7C,GACvChM,EAAUwL,KAAKqE,EAAUhB,EAAY7C,GACrC6C,EACGhO,GAAG,OAAQ,KACVb,EAAUc,OAAO,aAAaqK,UAAU,SACrCK,KAAK8B,EAAU7B,kBAClB,MAAM7F,EAASoG,EAAMrI,MAAMlN,IAAIC,KAAOsQ,EAAGtQ,EAAEsQ,EAAGC,EAAGvQ,EAAEuQ,KACnD+E,EAAMtD,aAAa9C,GACnB5F,EAAUc,OAAO,aAAaqK,UAAU,SACrCK,KAAK8B,EAAUxB,kBAClB8C,EAAgBC,KAEjBhO,GAAG,MAAO,IAAMb,EAAUwL,KAAKyD,EAAKJ,EAAY7C,IACnDA,EAAMpE,iBAAmB,MACvB5H,EAAUwL,KAAKqE,EAAUhB,EAAY7C,KAEvCA,EAAMnE,cAAgB,MACpB7H,EAAUwL,KAAK0D,EAAOL,EAAY7C,KAEpCA,EAAMlE,cAAgB,MACpB9H,EAAUwL,KAAKiE,EAAOZ,EAAY7C,KAEpCA,EAAMjE,gBAAkB,MACtB/H,EAAUwL,KAAKoE,EAASf,EAAY7C,KAElCA,EAAMvD,iBACRzI,EAAUwL,KAAKoE,EAASf,EAAY7C,GAEpChM,EAAUwL,KAAK0D,EAAOL,EAAY7C,IAMTkD,MAAAA,EAAOO,MAAAA,EAAOG,QAAAA,GC9I3C,SAASkB,EAAcC,GACrB,MAAMC,KAIN,OAHA5V,OAAO6V,QAAQF,EAAQA,SAAS/N,QAAQkO,IACtCF,EAAWE,EAAE,KAAOA,EAAE,OAGtBvO,QAASoO,EAAQpO,QACjBnM,QAASua,EAAQzM,OACjBzN,IAAKka,EAAQla,IACbka,QAASC,WA4GXF,cAAAA,EAAeK,eAlGjB,SAAwBJ,GACtB,MAAMK,EAAKL,EAAQpa,eAAe,SAAWma,EAAcC,GAAWA,EAChEM,GAAYxa,IAAKua,EAAGva,IAAKE,OAAQ,QAYvC,OAVEP,OAAQiE,EAAKlE,wBAAwB8a,GAAUlH,OAAOiH,EAAG5a,SACzD2G,QAAS/B,OAAO6V,QAAQG,EAAGL,SAASta,IAAI6a,IACtC,MAAMC,KAKN,OAJAA,EAAIH,EAAGva,KAAOya,EAAM,GACpBF,EAAG5a,OAAOwM,QAAQ,CAACwO,EAAGvO,KACpBsO,EAAIC,EAAE3a,KAAOya,EAAM,GAAGrO,KAEjBsO,MAuFoBE,eA1EjC,SAAwBC,EAAO7a,EAAK8a,GAAQ,UAC1C,MACMZ,GACJpO,SAFU,IAAIiP,MAED/Z,WACbrB,OAAQiE,EAAKlE,uBAAuBmb,EAAMlb,OACvCgN,OAAO9M,GAAKA,EAAEG,MAAQA,GACtB2M,OAAO9M,IAAMib,EAAOza,SAASR,EAAEG,OAClCA,IAAKA,EACLka,YAKF,OAHAW,EAAMvU,QAAQ6F,QAAQ6O,IACpBd,EAAQA,QAAQc,EAAIhb,IAAQka,EAAQva,OAAOC,IAAIC,GAAKmb,EAAInb,EAAEG,QAErDka,GA6DwCe,aApDjD,SAAsBC,GACpB,MAAMC,EAAQD,EAAUzZ,MAAM,cACxB2Z,EAASD,EAAME,QAAQ5Z,MAAM,KAC7BzB,EAAMob,EAAOC,QACbC,EAAM,IAAIP,KACVQ,KACA5b,KACNyb,EAAOjP,QAAQ,CAACqP,EAAGpP,KACP,KAANoP,IACJD,EAAUvL,KAAK5D,GACfzM,EAAOqQ,MAAMhQ,IAAKwb,EAAGtb,OAAQ,YAE/B,MAAMga,GACJpO,QAASwP,EAAIta,WACbrB,OAAQiE,EAAKlE,uBAAuBC,GACpCK,IAAKA,EACLka,YAUF,OARAiB,EAAMhP,QAAQsP,IACZ,MAAMC,EAASD,EAAKha,MAAM,KACpB4O,EAAIqL,EAAOL,QACjBnB,EAAQA,QAAQ7J,GAAKsL,MAAMJ,EAAU9W,QACrC8W,EAAUpP,QAAQC,IAChB8N,EAAQA,QAAQ7J,GAAGjE,GAAKsP,EAAOtP,OAG5B8N,GA0BsD/H,MAhB/D,SAAexO,EAAMuW,GACnB,MAAMK,EAAKL,EAAQpa,eAAe,SAAWma,EAAcC,GAAWA,EACtEvW,EAAK2C,QACFqG,OAAO+N,GAAOH,EAAGL,QAAQpa,eAAe4a,EAAIH,EAAGva,OAC/CmM,QAAQuO,IACPH,EAAG5a,OAAOwM,QAAQ,CAACyP,EAAIxP,KACrBsO,EAAIkB,EAAG5b,KAAOua,EAAGL,QAAQQ,EAAIH,EAAGva,MAAMoM,OAG5CzI,EAAKhE,OAAU+B,EAAEiC,EAAKhE,QACnB2T,OAAO1P,EAAKlE,uBAAuB6a,EAAG5a,SACtCkc,OAAO,OACPtb,UCxHL,SAASub,GAAW3S,EAAWpD,GAC7BoD,EACKE,QAAQ,SAAS,GACjBE,KAAK,YAAa,GAClBA,KAAK,OAAQ,UACbA,KAAK,kBAAmB,IACxBA,KAAK,eAAe,GACpBA,KAAK,KAAMxD,GAChBoD,EAAUc,OAAO,iBAAiBuK,SAClCrL,EAAUG,OAAO,OACZD,QAAQ,gBAAgB,GACxBE,KAAK,OAAQ,YACfD,OAAO,OACLD,QAAQ,iBAAiB,WA6E9B0S,cAzEF,SAAuB5S,EAAWpD,EAAIiW,GACpC,MAAMC,EAAO9S,EAAUwL,KAAKmH,GAAY/V,GACnCkE,OAAO,kBAEZgS,EAAK3S,OAAO,OACPD,QAAQ,cAAc,GACxBC,OAAO,OACLD,QAAQ,WAAW,GACnB9D,KAAKyW,GAEV,MAAME,EAASD,EAAK3S,OAAO,OACtBD,QAAQ,gBAAgB,GAC7B6S,EAAO5S,OAAO,UACTD,QAAQ,OAAO,GACfA,QAAQ,yBAAyB,GACjCA,QAAQ,UAAU,GAClBE,KAAK,OAAQ,UACbA,KAAK,eAAgB,SACrBhE,KAAK,UACV2W,EAAO5S,OAAO,UACTD,QAAQ,OAAO,GACfA,QAAQ,eAAe,GACvBA,QAAQ,MAAM,GACdE,KAAK,OAAQ,UACbA,KAAK,eAAgB,SACrBA,KAAK,iBAAkBxD,YACvBR,KAAK,MACLyE,GAAG,QAAS,KACXpJ,EAAGqJ,OAAO,iBAAiBI,MAAM,UAAW,UAC5ClB,EAAUgT,SAAS,aA4CVC,aAvCjB,SAAsBjT,EAAWpD,EAAIsW,GACnC,MAAMJ,EAAO9S,EAAUwL,KAAKmH,GAAY/V,GACnCkE,OAAO,kBAENmR,EAASa,EAAK3S,OAAO,OACtBD,QAAQ,gBAAgB,GAC7B+R,EAAO9R,OAAO,MACTD,QAAQ,eAAe,GACvB9D,KAAK8W,GACVjB,EAAO9R,OAAO,UACTC,KAAK,OAAQ,UACbA,KAAK,eAAgB,SACrBA,KAAK,aAAc,SACnBF,QAAQ,SAAS,GACnBC,OAAO,QACLC,KAAK,eAAe,GACpBwL,KAAK,WAEVkH,EAAK3S,OAAO,OACPD,QAAQ,cAAc,GAE3B4S,EAAK3S,OAAO,OACPD,QAAQ,gBAAgB,GAC1BC,OAAO,UACLD,QAAQ,OAAO,GACfA,QAAQ,eAAe,GACvBA,QAAQ,UAAU,GAClBE,KAAK,OAAQ,UACbA,KAAK,eAAgB,SACrBA,KAAK,iBAAkBxD,YACvBR,KAAK,UACLyE,GAAG,QAAS,KACXpJ,EAAGqJ,OAAO,iBAAiBI,MAAM,UAAW,UAC5ClB,EAAUgT,SAAS,cCjE3B,SAASG,GAAcnT,EAAW5I,GAChC4I,EAAUc,OAAO,SAASsS,SAAS,QAAShc,GAkD9C,SAASic,GAAkBrT,EAAW5I,GACpC4I,EAAUc,OAAO,YAAYsS,SAAS,QAAShc,GAqCjD,SAASkc,GAAetT,EAAWuT,GACjCvT,EAAUc,OAAO,SAASsS,SAAS,UAAWG,GA+BhD,SAASC,GAAgBxT,EAAW5I,GAClC4I,EAAUc,OAAO,SAASsS,SAAS,QAAShc,WAkC5Cqc,QAjLF,SAAiBzT,EAAWpD,EAAIqD,EAAO2E,EAAMxN,GAC3C4I,EACKE,QAAQ,cAAc,GACtBA,QAAQ,YAAY,GACpBA,QAAQ,sBAAsB,GACnCF,EAAUG,OAAO,SACZD,QAAQ,kBAAkB,GAC1BA,QAAQ,qBAAqB,GAC7BA,QAAQ,SAAS,GACjBE,KAAK,MAAOxD,GACZR,KAAK6D,GACVD,EAAUG,OAAO,SACZD,QAAQ,gBAAgB,GACxBA,QAAQ,mBAAmB,GAC3BA,QAAQ,SAAS,GACjBE,KAAK,KAAMxD,GACXwD,KAAK,OAAQ,QACbA,KAAK,OAAQwE,GAClB5E,EAAUwL,KAAK2H,GAAe/b,IA+JrB+b,cAAAA,GAAeO,aAxJ1B,SAAsB1T,GACpB,OAAOA,EAAUc,OAAO,SAASsS,SAAS,UAuJJO,YAnJxC,SAAqB3T,EAAWpD,EAAIqD,EAAO7I,GACzC4I,EACKE,QAAQ,cAAc,GACtBA,QAAQ,YAAY,GACpBA,QAAQ,sBAAsB,GACnCF,EAAUG,OAAO,SACZD,QAAQ,kBAAkB,GAC1BA,QAAQ,qBAAqB,GAC7BA,QAAQ,SAAS,GACjBE,KAAK,MAAOxD,GACZR,KAAK6D,GACVD,EAAUG,OAAO,SACZD,QAAQ,0BAA0B,GAClCA,QAAQ,mBAAmB,GAC3BA,QAAQ,SAAS,GACjBE,KAAK,KAAMxD,GACXwD,KAAK,OAAQ,QACbgT,SAAS,YAAY,GAC1BpT,EAAUwL,KAAK2H,GAAe/b,IAkI9Bwc,YA9HF,SAAqB5T,EAAWpD,EAAIqD,EAAO4T,EAAMC,EAAa1c,GAC5D4I,EACKE,QAAQ,cAAc,GACtBA,QAAQ,YAAY,GACzBF,EAAUG,OAAO,SACZD,QAAQ,kBAAkB,GAC1BA,QAAQ,qBAAqB,GAC7BA,QAAQ,SAAS,GACjBE,KAAK,MAAOxD,GACZR,KAAK6D,GACVD,EAAUG,OAAO,YACZD,QAAQ,gBAAgB,GACxBA,QAAQ,mBAAmB,GAC3BA,QAAQ,SAAS,GACjBE,KAAK,OAAQyT,GACbzT,KAAK,cAAe0T,GACpB1T,KAAK,KAAMxD,GAChBoD,EAAUwL,KAAK6H,GAAmBjc,IA6GrBic,kBAAAA,GAAmBU,iBAtGlC,SAA0B/T,GACxB,MAAM5I,EAAQ4I,EAAUc,OAAO,YAAYsS,SAAS,SACpD,GAAIhc,EAAO,OAAOA,EAClB,MAAM0c,EAAc9T,EAAUc,OAAO,YAAYV,KAAK,eACtD,OAAI0T,GACG,IAiG2CE,iBA9FpD,SAA0BhU,GACxB,MAAM5I,EAAQ4I,EAAUc,OAAO,YAAYsS,SAAS,SACpD,GAAIhc,EAAO,OAAOA,EAAMkB,MAAM,MAAMkL,OAAO9M,GAAKA,EAAE4E,OAAS,GAC3D,MAAMwY,EAAc9T,EAAUc,OAAO,YAAYV,KAAK,eACtD,OAAI0T,EAAoBA,EAAYxb,MAAM,MAAMkL,OAAO9M,GAAKA,EAAE4E,OAAS,OA2FvE2Y,SAtFF,SAAkBjU,EAAWpD,EAAIqD,EAAOsT,GACtC,MAAMW,EAAMlU,EACPE,QAAQ,cAAc,GACtBA,QAAQ,YAAY,GACpBA,QAAQ,cAAc,GACxBC,OAAO,SACLD,QAAQ,oBAAoB,GAC5BA,QAAQ,qBAAqB,GAClCgU,EAAI/T,OAAO,SACND,QAAQ,oBAAoB,GAC5BE,KAAK,OAAQ,YACbA,KAAK,KAAMxD,GAChBsX,EAAI/T,OAAO,QACN/D,KAAK6D,GACVD,EAAUwL,KAAK8H,GAAgBC,IAwErBD,eAAAA,GAAgBa,cAjE5B,SAAuBnU,GACrB,OAAOA,EAAUc,OAAO,SAASsS,SAAS,YAiE1CgB,UA7DF,SAAmBpU,EAAWpD,EAAIqD,EAAO8I,EAAKE,EAAKoL,EAAMjd,GACvD4I,EACKE,QAAQ,cAAc,GACtBA,QAAQ,YAAY,GACpBA,QAAQ,sBAAsB,GACnCF,EAAUG,OAAO,SACZD,QAAQ,kBAAkB,GAC1BA,QAAQ,qBAAqB,GAC7BA,QAAQ,SAAS,GACjBE,KAAK,MAAOxD,GACZR,KAAK6D,GACVD,EAAUG,OAAO,SACZD,QAAQ,gBAAgB,GACxBA,QAAQ,mBAAmB,GAC3BA,QAAQ,SAAS,GACjBE,KAAK,KAAMxD,GACXwD,KAAK,OAAQ,UACbA,KAAK,MAAO2I,GACZ3I,KAAK,MAAO6I,GACZ7I,KAAK,OAAQiU,GAClBrU,EAAUwL,KAAKgI,GAAiBpc,IAyCrBoc,gBAAAA,GAAiBc,eAlC9B,SAAwBtU,GACtB,OAAOA,EAAUc,OAAO,SAASsS,SAAS,UAkC1CmB,aA9BF,SAAsBvU,EAAWpD,EAAIqD,EAAOW,GAC5CZ,EACKE,QAAQ,cAAc,GACtBA,QAAQ,YAAY,GACzBF,EAAUG,OAAO,SACZD,QAAQ,kBAAkB,GAC1BA,QAAQ,qBAAqB,GAC7BA,QAAQ,SAAS,GACjBE,KAAK,MAAOxD,GACZR,KAAK6D,GACVD,EAAUG,OAAO,SACZD,QAAQ,gBAAgB,GACxBA,QAAQ,mBAAmB,GAC3BA,QAAQ,qBAAqB,GAC7BA,QAAQ,SAAS,GACjBE,KAAK,OAAQ,QACbA,KAAK,SAAUQ,GACfR,KAAK,KAAMxD,IAaA4X,kBAVhB,SAA2BxU,GACzB,OAAOA,EAAUc,OAAO,SAASsS,SAAS,SAAS,KCvKrD,MAAMxW,GAAK,mBACLsW,GAAQ,6BA8BZuB,SA3BF,SAAkBzU,GAChBA,EAAUwL,KAAKkJ,EAAOhU,kBAAmB,YAAawS,GAAOtW,KA0BnDH,KAtBZ,SAAcuD,GACZ,MAAM2U,EAAS3U,EAAUwL,KAAKoJ,GAAM3B,aAAcrW,GAAIsW,IAEtDyB,EAAO7T,OAAO,eAAeX,OAAO,OAC/BD,QAAQ,QAAQ,GAChBsL,KAAK0I,GAAIT,QAAS,YAAa,WAAY,GAAI,SAEpDkB,EAAO7T,OAAO,eAAeX,OAAO,OAC/BD,QAAQ,WAAW,GACnBsL,KAAK0I,GAAID,SAAU,eAAgB,iCAAiC,IAazD7c,MATlB,SAAe4I,GACb,OACEpJ,KAAMsd,GAAIR,aAAa1T,EAAUc,OAAO,UACxC+T,QAASX,GAAIC,cAAcnU,EAAUc,OAAO,gBCzBhD,MAAMlE,GAAK,gBACLsW,GAAQ,0BAGd,SAAkBlT,GAChBA,EAAUwL,KAAKkJ,EAAOhU,kBAAmB,SAAUwS,GAAOtW,UAI5D,SAAcoD,EAAWpJ,GACvBoJ,EAAUwL,KAAKoJ,GAAM3B,aAAcrW,GAAIsW,IACpCpS,OAAO,eAAeX,OAAO,OAC3BD,QAAQ,UAAU,GAClBsL,KAAK0I,GAAIT,QAAS,SAAU,WAAY,GAAI7c,IAgBjCke,WAZlB,SAAoB9U,EAAWgM,GAC7BhM,EAAUc,OAAO,WACZ0K,KAAK0I,GAAIf,cAAenH,EAAMxR,KAAK5D,aAI1C,SAAeoJ,GACb,OAAOkU,GAAIR,aAAa1T,EAAUc,OAAO,cCD3C,SAASiU,GAAe/U,EAAWhH,GACjC,MAAMgc,EAAUhV,EAAUc,OAAO,UAC9BqK,UAAU,UACR3Q,KAAKxB,EAAO6R,GAAKA,EAAEhU,KACxBme,EAAQ5J,OAAOC,SACf2J,EAAQzJ,QACLpL,OAAO,UACLC,KAAK,QAASyK,GAAKA,EAAEhU,KACrBuF,KAAKyO,GAAKA,EAAEjU,MAGnB,SAASqe,GAAgBjV,EAAW5I,GAClC4I,EAAUc,OAAO,UAAUsS,SAAS,QAAShc,GAkC/C,SAAS8d,GAAkBlV,EAAWhH,GACpC,MAAMmc,EAAYnV,EAAUc,OAAO,MAChCqK,UAAU,MACR3Q,KAAKxB,EAAO6R,GAAKA,EAAEhU,KACxBse,EAAU/J,OAAOC,SACjB,MAAM+J,EAAOD,EAAU5J,QACpBpL,OAAO,MACLC,KAAK,QAAS,cAChBD,OAAO,SACLC,KAAK,QAAS,oBACnBgV,EAAKjV,OAAO,SACPC,KAAK,OAAQ,YACbA,KAAK,QAAS,oBACdgT,SAAS,QAASvI,GAAKA,EAAEhU,KAC9Bue,EAAKjV,OAAO,QACP/D,KAAKyO,GAAKA,EAAEjU,MAGnB,SAASye,GAAmBrV,EAAWuS,GAChCA,GACLvS,EAAUmL,UAAU,SACjBc,KAAK,SAAUpB,GACdpT,EAAGqJ,OAAOC,MAAMqS,SAAS,UAAWb,EAAOrb,SAAS2T,EAAEhU,gBAU1Dye,UApGF,SAAmBtV,EAAWpD,EAAIqD,EAAOzJ,EAAQY,GAC/C4I,EACKE,QAAQ,cAAc,GACtBA,QAAQ,YAAY,GACpBA,QAAQ,sBAAsB,GACnCF,EAAUG,OAAO,SACZD,QAAQ,kBAAkB,GAC1BA,QAAQ,qBAAqB,GAC7BA,QAAQ,SAAS,GACjBE,KAAK,MAAOxD,GACZR,KAAK6D,GACVD,EAAUG,OAAO,UACZD,QAAQ,gBAAgB,GACxBA,QAAQ,mBAAmB,GAC3BA,QAAQ,SAAS,GACjBE,KAAK,KAAMxD,GACZpG,IACFwJ,EAAUwL,KAAKuJ,GAAgBve,GAC/BwJ,EAAUwL,KAAKyJ,GAAiB7d,KAkFvB2d,eAAAA,GAAgBE,gBAAAA,GAAiBM,eA/D9C,SAAwBvV,GACtB,OAAOA,EAAUc,OAAO,UAAUsS,SAAS,UA+D3CoC,aAvDF,SAAsBxV,EAAWpD,EAAIqD,EAAOzJ,EAAQ+b,GAElDvS,EACKE,QAAQ,cAAc,GACtBA,QAAQ,YAAY,GACpBA,QAAQ,sBAAsB,GACnCF,EAAUG,OAAO,SACZD,QAAQ,kBAAkB,GAC1BA,QAAQ,qBAAqB,GAC7BA,QAAQ,SAAS,GACjB9D,KAAK6D,GACVD,EAAUG,OAAO,MACZD,QAAQ,gBAAgB,GACxBA,QAAQ,mBAAmB,GAC3BA,QAAQ,SAAS,GACjBE,KAAK,KAAMxD,GACZpG,IACFwJ,EAAUwL,KAAK0J,GAAmB1e,GAClCwJ,EAAUwL,KAAK6J,GAAoB9C,KAqCvB2C,kBAAAA,GAAmBG,mBAAAA,GAAoBI,kBAPvD,SAA2BzV,GACzB,OAAOA,EAAUmL,UAAU,iBAAiB3Q,OAAO/D,IAAIoU,GAAKA,EAAEhU,OC1ChE,SAAS6e,GAAe1V,EAAW0E,GAIjC1E,EAAUc,OAAO,QAAQsS,SAAS,QAAS1O,EAAM,IACjD1E,EAAUc,OAAO,QAAQsS,SAAS,QAAS1O,EAAM,IA2FnD,SAASiR,GAAoB3V,EAAW0E,GACtC,IAAIkR,EAEFA,EADkB,GAAhBlR,EAAMpJ,QACMoJ,EAAM,GAAI,KAAMA,EAAM,IACX,GAAhBA,EAAMpJ,QACDoJ,EAAM,GAAIA,EAAM,GAAIA,EAAM,KAE1B,KAAM,KAAM,MAE5B1E,EAAUc,OAAO,QACZsS,SAAS,QAASwC,EAAW,IAC7BxC,SAAS,WAA8B,OAAlBwC,EAAW,IAChC1U,MAAM,UAA6B,OAAlB0U,EAAW,GAAc,GAAM,MACrD5V,EAAUc,OAAO,QACZV,KAAK,QAASwV,EAAW,IACzBxC,SAAS,WAA8B,OAAlBwC,EAAW,IAChC1U,MAAM,UAA6B,OAAlB0U,EAAW,GAAc,GAAM,MACrD5V,EAAUc,OAAO,QACZsS,SAAS,QAASwC,EAAW,IAC7BxC,SAAS,WAA8B,OAAlBwC,EAAW,IAChC1U,MAAM,UAA6B,OAAlB0U,EAAW,GAAc,GAAM,cAoBrDC,SA7LF,SAAkB7V,EAAWpD,EAAIqD,EAAOyE,GACtC1E,EACKE,QAAQ,YAAY,GACpBA,QAAQ,sBAAsB,GAC9BE,KAAK,KAAMxD,GAChBoD,EAAUG,OAAO,OACZD,QAAQ,cAAc,GACtBA,QAAQ,kBAAkB,GAC1BA,QAAQ,qBAAqB,GAC7BA,QAAQ,SAAS,GACjBA,QAAQ,QAAQ,GAChB9D,KAAK6D,GACV,MAAMuR,EAAIxR,EAAUG,OAAO,OACtBD,QAAQ,cAAc,GACtBA,QAAQ,kBAAkB,GAC1BA,QAAQ,qBAAqB,GAC7BA,QAAQ,SAAS,GACjBA,QAAQ,QAAQ,GACrBsR,EAAErR,OAAO,SACJD,QAAQ,kBAAkB,GAC1BA,QAAQ,qBAAqB,GAC7BA,QAAQ,QAAQ,GAChBE,KAAK,SAAUxD,UACfR,KAAK,OACVoV,EAAErR,OAAO,SACJD,QAAQ,gBAAgB,GACxBA,QAAQ,mBAAmB,GAC3BA,QAAQ,OAAO,GACfE,KAAK,OAAQ,QACbA,KAAK,QAASxD,UACnB,MAAMkR,EAAI9N,EAAUG,OAAO,OACtBD,QAAQ,cAAc,GACtBA,QAAQ,SAAS,GACjBA,QAAQ,QAAQ,GACrB4N,EAAE3N,OAAO,SACJD,QAAQ,kBAAkB,GAC1BA,QAAQ,qBAAqB,GAC7BA,QAAQ,QAAQ,GAChBE,KAAK,SAAUxD,QACfR,KAAK,OACV0R,EAAE3N,OAAO,SACJD,QAAQ,gBAAgB,GACxBA,QAAQ,mBAAmB,GAC3BA,QAAQ,OAAO,GACfE,KAAK,OAAQ,QACbA,KAAK,QAASxD,QAInBoD,EAAUwL,KAAKkK,GAAgBhR,IA4IrBgR,eAAAA,GAAgBI,cA/H5B,SAAuB9V,GACrB,OACExI,WAAWwI,EAAUc,OAAO,QAAQsS,SAAS,UAC7C5b,WAAWwI,EAAUc,OAAO,QAAQsS,SAAS,YA6H/C2C,cApHF,SAAuB/V,EAAWpD,EAAIqD,EAAOyE,GAC3C1E,EACKE,QAAQ,YAAY,GACpBA,QAAQ,sBAAsB,GAC9BE,KAAK,KAAMxD,GAChBoD,EAAUG,OAAO,OACZD,QAAQ,cAAc,GACtBA,QAAQ,kBAAkB,GAC1BA,QAAQ,qBAAqB,GAC7BA,QAAQ,SAAS,GACjBA,QAAQ,QAAQ,GAChB9D,KAAK6D,GACV,MAAMuR,EAAIxR,EAAUG,OAAO,OACtBD,QAAQ,cAAc,GACtBA,QAAQ,kBAAkB,GAC1BA,QAAQ,qBAAqB,GAC7BA,QAAQ,SAAS,GACjBA,QAAQ,QAAQ,GACrBsR,EAAErR,OAAO,SACJD,QAAQ,kBAAkB,GAC1BA,QAAQ,qBAAqB,GAC7BA,QAAQ,QAAQ,GAChBE,KAAK,SAAUxD,UACfR,KAAK,OACVoV,EAAErR,OAAO,SACJD,QAAQ,gBAAgB,GACxBA,QAAQ,mBAAmB,GAC3BA,QAAQ,OAAO,GACfE,KAAK,OAAQ,SACbA,KAAK,QAASxD,UACnB,MAAMsU,EAAIlR,EAAUG,OAAO,OACtBD,QAAQ,cAAc,GACtBA,QAAQ,kBAAkB,GAC1BA,QAAQ,qBAAqB,GAC7BA,QAAQ,SAAS,GACjBA,QAAQ,QAAQ,GACrBgR,EAAE/Q,OAAO,SACJD,QAAQ,kBAAkB,GAC1BA,QAAQ,qBAAqB,GAC7BA,QAAQ,QAAQ,GAChBE,KAAK,SAAUxD,SACfR,KAAK,OACV8U,EAAE/Q,OAAO,SACJD,QAAQ,gBAAgB,GACxBA,QAAQ,mBAAmB,GAC3BA,QAAQ,OAAO,GACfE,KAAK,OAAQ,SACbA,KAAK,QAASxD,SACnB,MAAMkR,EAAI9N,EAAUG,OAAO,OACtBD,QAAQ,cAAc,GACtBA,QAAQ,kBAAkB,GAC1BA,QAAQ,qBAAqB,GAC7BA,QAAQ,SAAS,GACjBA,QAAQ,QAAQ,GACrB4N,EAAE3N,OAAO,SACJD,QAAQ,kBAAkB,GAC1BA,QAAQ,qBAAqB,GAC7BA,QAAQ,QAAQ,GAChBE,KAAK,SAAUxD,QACfR,KAAK,OACV0R,EAAE3N,OAAO,SACJD,QAAQ,gBAAgB,GACxBA,QAAQ,mBAAmB,GAC3BA,QAAQ,OAAO,GACfE,KAAK,OAAQ,SACbA,KAAK,QAASxD,QACnBoD,EACKwL,KAAKmK,GAAqBjR,GAC1B7D,GAAG,SAAU,KAEZpJ,EAAGmG,MAAMoY,qBA8CAL,oBAAAA,GAAqBM,mBAjBtC,SAA4BjW,GAC1B,MAAMkW,KAUN,OATKlW,EAAUc,OAAO,QAAQsS,SAAS,aACrC8C,EAAIrP,KAAK7G,EAAUc,OAAO,QAAQsS,SAAS,UAExCpT,EAAUc,OAAO,QAAQsS,SAAS,aACrC8C,EAAIrP,KAAK7G,EAAUc,OAAO,QAAQsS,SAAS,UAExCpT,EAAUc,OAAO,QAAQsS,SAAS,aACrC8C,EAAIrP,KAAK7G,EAAUc,OAAO,QAAQsS,SAAS,UAEtC8C,IC9JT,SAASC,GAAsBnW,EAAW0E,GACxC1E,EAAUc,OAAO,YACZ0K,KACC4K,GAAKnB,gBACLoB,EAASrM,gBAAgBzF,KAAK7N,GAAKA,EAAEkO,OAASF,EAAMpJ,QAAQzE,KAE7DgK,GAAG,SAAU,WACZ,MAAMzJ,EAAQgf,GAAKb,eAAe9d,EAAGqJ,OAAOC,OACtCgN,EAAIsI,EAAS7L,cAAcjG,KAAK7N,GAAKA,EAAEG,MAAQO,GAC/C0W,EAAIuI,EAASrM,gBAAgBzF,KAAK7N,GAAKA,EAAEkO,OAASmJ,EAAErJ,MAAMpJ,QAChE0E,EAAUc,OAAO,cAAc0K,KAAK4K,GAAKnB,gBAAiBnH,EAAEjX,KAC5DmJ,EAAUc,OAAO,UAAU0K,KAAK8K,GAAKX,oBAAqB5H,EAAErJ,SAElE1E,EAAUc,OAAO,cACZD,GAAG,SAAU,WACZ,MAAMzJ,EAAQgf,GAAKb,eAAe9d,EAAGqJ,OAAOC,OACtC6D,EAAOyR,EAASrM,gBAAgBzF,KAAK7N,GAAKA,EAAEG,MAAQO,GAAOwN,KACjE5E,EAAUc,OAAO,UAAUA,OAAO,QAC7BsS,SAAS,WAAYxO,EAAO,GAC5B1D,MAAM,UAAW0D,GAAQ,EAAI,KAAO,IACzC5E,EAAUc,OAAO,UAAUA,OAAO,QAC7BsS,SAAS,WAAqB,IAATxO,GACrB1D,MAAM,UAAoB,IAAT0D,EAAa,KAAO,IAC1C5E,EAAUc,OAAO,UAAUA,OAAO,QAC7BsS,SAAS,WAAYxO,EAAO,GAC5B1D,MAAM,UAAW0D,GAAQ,EAAI,KAAO,MAE/C5E,EAAUc,OAAO,UACZ0K,KAAK8K,GAAKX,oBAAqBjR,GAC/B7D,GAAG,UAAW,KACbb,EAAUgT,SAAS,YAuC3B,SAASuD,GAAoBvW,EAAWqE,EAAOI,GAC7CzE,EAAUc,OAAO,WACdD,GAAG,SAAU,WACZ,MAAMzJ,EAAQgf,GAAKb,eAAe9d,EAAGqJ,OAAOC,OACtCgN,EAAIsI,EAAS9L,QAAQhG,KAAK7N,GAAKA,EAAEG,KAAOO,GAC9C4I,EAAUc,OAAO,UAAU0K,KAAK4K,GAAKnB,gBAAiBlH,EAAE1J,OACxDrE,EAAUc,OAAO,WAAW0K,KAAK8K,GAAKZ,eAAgB3H,EAAEtJ,UAE5DzE,EAAUc,OAAO,UACZ0K,KAAK4K,GAAKnB,gBAAiB5Q,GAC3BxD,GAAG,SAAU,KACZb,EAAUc,OAAO,WAAWkS,SAAS,YAE3ChT,EAAUc,OAAO,WACZ0K,KAAK8K,GAAKZ,eAAgBjR,GAC1B5D,GAAG,SAAU,WACZ,MAAM2V,EAA4D,QAApDJ,GAAKb,eAAevV,EAAUc,OAAO,WAC7C2D,EAAS6R,GAAKR,cAAcre,EAAGqJ,OAAOC,OACtC0V,EAAU5L,GAAKtT,MAAMsT,IAAO2L,GAAS3L,GAAK,EAChDpT,EAAGqJ,OAAOC,MAAMD,OAAO,QAClBI,MAAM,mBAAoBuV,EAAQhS,EAAO,IAAM,UAAY,WAChEhN,EAAGqJ,OAAOC,MAAMD,OAAO,QAClBI,MAAM,mBAAoBuV,EAAQhS,EAAO,IAAM,UAAY,qBAatEiS,gBA9HF,SAAyB1W,EAAWpD,EAAI+Z,EAAUC,EAAYlS,GAC5D1E,EACKE,QAAQ,QAAQ,GACrBF,EAAUG,OAAO,OACZD,QAAQ,WAAW,GACnBA,QAAQ,QAAQ,GAChBsL,KAAK4K,GAAKd,aAAc1Y,YAAc,gBAAiB+Z,EAAU,QACtE3W,EAAUG,OAAO,OACZD,QAAQ,aAAa,GACrBA,QAAQ,QAAQ,GAChBsL,KACC4K,GAAKd,aAAc1Y,cAAgB,aAAcga,EACjDP,EAASrM,gBAAgBzF,KAAK7N,GAAKA,EAAEkO,OAASF,EAAMpJ,QAAQzE,KAElEmJ,EAAUG,OAAO,OACZD,QAAQ,SAAS,GACjBA,QAAQ,QAAQ,GAChBsL,KAAK8K,GAAKP,iBAAkBnZ,UAAY,QAAS8H,GACtD1E,EAAUwL,KAAK2K,GAAuBzR,IA4GrByR,sBAAAA,GAAuBU,qBArE1C,SAA8B7W,GAC5B,MAAMtG,EAAO0c,GAAKb,eAAevV,EAAUc,OAAO,eAC5CyR,EAAS+D,GAAKL,mBAAmBjW,EAAUc,OAAO,WACxD,OAAKyR,EAAOjX,OAGHiX,EAFA8D,EAASrM,gBAAgBzF,KAAK7N,GAAKA,EAAEG,MAAQ6C,GAAMgL,OAkE5DoS,cAvDF,SAAuB9W,EAAWpD,EAAI2N,EAASwM,EAAY1S,EAAOI,GAChEzE,EACKE,QAAQ,QAAQ,GACrBF,EAAUG,OAAO,OACZD,QAAQ,UAAU,GAClBA,QAAQ,QAAQ,GAChBsL,KAAK4K,GAAKd,aAAc1Y,WAAa,eAAgB2N,EAAS,IACnEvK,EAAUG,OAAO,OACZD,QAAQ,SAAS,GACjBA,QAAQ,QAAQ,GAChBsL,KAAK4K,GAAKd,aAAc1Y,UAAY,aAAcma,EAAY1S,GACnErE,EAAUG,OAAO,OACZD,QAAQ,UAAU,GAClBA,QAAQ,QAAQ,GAChBsL,KAAK8K,GAAKT,YAAajZ,WAAa,SAAU6H,GACnDzE,EAAUwL,KAAK+K,GAAqBlS,EAAOI,IAwC5B8R,oBAAAA,GAAqBS,mBATtC,SAA4BhX,GAG1B,OAAQqE,MAFM+R,GAAKb,eAAevV,EAAUc,OAAO,WAE7B2D,OADP6R,GAAKR,cAAc9V,EAAUc,OAAO,eCvHrD,SAASmW,GAAejX,EAAWgM,GAEjChM,EAAUG,OAAO,OACZD,QAAQ,QAAQ,GAClBC,OAAO,OACLD,QAAQ,OAAO,GACfsL,KAAKkJ,EAAO3U,UAAW,gBAAiB,gBAAiB,WAE9D,MAAMmX,EAAYlX,EAAUG,OAAO,OAC9BD,QAAQ,QAAQ,GACnBgX,EAAU/W,OAAO,OACdD,QAAQ,WAAW,GACnBA,QAAQ,QAAQ,GAChBsL,KAAK0I,GAAID,SAAU,UAAW,sBAAuBjI,EAAM5F,mBAC9D8Q,EAAU/W,OAAO,OACdD,QAAQ,YAAY,GACpBA,QAAQ,QAAQ,GAChBsL,KAAK0I,GAAID,SAAU,WAAY,uBAAwBjI,EAAMzF,oBAElE,MAAM4Q,EAAYnX,EAAUG,OAAO,OAC9BD,QAAQ,QAAQ,GACrBiX,EAAUhX,OAAO,OACZD,QAAQ,QAAQ,GAChBA,QAAQ,QAAQ,GAChBsL,KAAK0I,GAAIE,UAAW,OAAQ,oBACvBpI,EAAMlF,uBAAwB,EAAO,IAAMkF,EAAMjH,kBAC3DoS,EAAUhX,OAAO,OACZD,QAAQ,QAAQ,GAChBA,QAAQ,QAAQ,GAChBsL,KAAK0I,GAAIP,YAAa,OAAQ,OAAQ,MAE3C,MAAMyD,EAAWpX,EAAUG,OAAO,OAC7BD,QAAQ,cAAc,GACtBA,QAAQ,YAAY,GACzBkX,EAASjX,OAAO,OACXD,QAAQ,SAAS,GACnBC,OAAO,QACLD,QAAQ,kBAAkB,GAC1BA,QAAQ,qBAAqB,GAC7BA,QAAQ,QAAQ,GAChB9D,KAAK,eACVgb,EAASjX,OAAO,OACXD,QAAQ,UAAU,GACpBC,OAAO,OACLD,QAAQ,YAAY,GACtBC,OAAO,OACLD,QAAQ,gBAAgB,GACxBA,QAAQ,QAAQ,GAChBE,KAAK,KAAM,eACXA,KAAK,OAAQ,eACbA,KAAK,gBAAiB,GACtBA,KAAK,gBAAiB,KAC3BgX,EAASjX,OAAO,OACXD,QAAQ,UAAU,GACpBC,OAAO,OACLD,QAAQ,SAAS,GACjBA,QAAQ,QAAQ,GAChBsL,KAAK0I,GAAID,SAAU,cAAe,eAAgBjI,EAAMvD,kBAC7D2O,EAASjX,OAAO,OACXD,QAAQ,UAAU,GACpBC,OAAO,OACLD,QAAQ,WAAW,GACnBA,QAAQ,QAAQ,GAChBsL,KAAKkJ,EAAO3U,UAAW,gBAAiB,WAAY,WAEzDC,EAAUwL,KAAK6L,GAAsBrL,GAIvC,SAASqL,GAAqBrX,EAAWgM,GAEvChM,EAAUc,OAAO,aACZD,GAAG,QAAS,WAAcmL,EAAMsL,qBAErCtX,EAAUc,OAAO,QACZD,GAAG,QAAS,WAAcmL,EAAMrE,gBAErC3H,EAAUc,OAAO,YACZ0K,KAAK0I,GAAIZ,eAAgBtH,EAAM5F,mBAC/BvF,GAAG,SAAU,WACZmL,EAAM5F,kBAAoB8N,GAAIC,cAAc1c,EAAGqJ,OAAOC,OACtDiL,EAAM3F,YAAc6N,GAAIC,cAAc1c,EAAGqJ,OAAOC,OAChDiL,EAAM3E,4BAGZrH,EAAUc,OAAO,aACZ0K,KAAK0I,GAAIZ,eAAgBtH,EAAMzF,oBAC/B1F,GAAG,SAAU,WACZmL,EAAMzF,mBAAqB2N,GAAIC,cAAc1c,EAAGqJ,OAAOC,OACvDiL,EAAMxF,aAAe0N,GAAIC,cAAc1c,EAAGqJ,OAAOC,OACjDiL,EAAM3E,4BAGZrH,EAAUc,OAAO,SACZ0K,KAAK0I,GAAIV,gBAAiBxH,EAAMjH,kBAChClE,GAAG,SAAU,WACZ,MAAMzJ,EAAQ8c,GAAII,eAAe7c,EAAGqJ,OAAOC,OAC3CiL,EAAMjH,iBAAmB3N,EACzB4U,EAAM3E,0BACN2E,EAAMpE,mBACN,MAAM2P,EAAWvL,EAAMtI,MAAMF,OAAO9M,GAAKA,EAAE+S,QAAUrS,GAAOkE,OACtDoL,EAAIsF,EAAMrI,MAAMrI,OAChBkc,EAAe9Q,GAAKA,EAAI,GAAK,EAC7B+Q,EAAOhgB,EAAGV,OAAO,MAAVU,CAAiBoB,KAAK6e,MAAMH,EAAWC,IACpDxX,EAAUc,OAAO,SAAS0K,KAAK0I,GAAIf,cAAesE,KAEnDzE,SAAS,UAEdhT,EAAUc,OAAO,UACZ0K,KAAK0I,GAAIZ,gBAAiBtH,EAAMvD,kBAChC5H,GAAG,SAAU,WACEqT,GAAIC,cAAc1c,EAAGqJ,OAAOC,QAExCiL,EAAMnE,gBACN7H,EAAUc,OAAO,aACdI,MAAM,mBAAoB,aAE7B8K,EAAMlE,gBACN9H,EAAUc,OAAO,aACdI,MAAM,mBAAoB,cAGrClB,EAAUc,OAAO,YACZD,GAAG,QAAS,WAAcmL,EAAMjE,oBAKvC,SAAS4P,GAAoB3X,EAAWgM,GACtChM,EAAUG,OAAO,OACZD,QAAQ,SAAS,GACjBsL,KACC4K,GAAKd,UAAW,cAAe,QAC/BtJ,EAAMxR,KAAKmJ,MAAMnN,OAAOgN,OAAO9M,GAAiC,SAA5B+D,EAAKzD,SAASN,EAAEK,SACpDiV,EAAM/H,UAAUK,OAAS,IAE/BtE,EAAUG,OAAO,OACZD,QAAQ,SAAS,GACjBsL,KACCoM,GAAMlB,gBAAiB,QAASL,EAAS7L,cACzC6L,EAASrM,gBAAiBgC,EAAM/H,UAAUS,OAEhD1E,EAAUG,OAAO,OACZD,QAAQ,SAAS,GACjBsL,KACCoM,GAAMd,cAAe,QAAST,EAAS9L,QACvC8L,EAAS3M,MAAMlG,OAAO9M,GAAe,YAAVA,EAAEG,KAC7BmV,EAAM/H,UAAUI,MAAO2H,EAAM/H,UAAUQ,QAG7CzE,EAAUwL,KAAKqM,GAA2B7L,GAI5C,SAAS6L,GAA0B7X,EAAWgM,GAC5ChM,EAAUc,OAAO,UACd0K,KAAK4K,GAAKnB,gBAAiBjJ,EAAM/H,UAAUK,OAC3CzD,GAAG,SAAU,WACZmL,EAAM/H,UAAUK,MAAQ8R,GAAKb,eAAe9d,EAAGqJ,OAAOC,OACtDiL,EAAMxE,2BAEVxH,EAAUc,OAAO,UACd0K,KAAKoM,GAAMzB,sBAAuBnK,EAAM/H,UAAUS,OAClD7D,GAAG,SAAU,WACZ,MAAM0R,EAASqF,GAAMf,qBAAqBpf,EAAGqJ,OAAOC,OACpDiL,EAAM/H,UAAUS,MAAQ6N,EACpBA,EAAOjX,OAAS,GAClB0Q,EAAM/H,UAAUI,MAAQ,UACxBrE,EAAUc,OAAO,UAAUqK,UAAU,gBAClCiI,SAAS,YAAY,GACrBlS,MAAM,UAAW,KAEpBlB,EAAUc,OAAO,UAAUqK,UAAU,gBAClCiI,SAAS,YAAY,GACrBlS,MAAM,UAAW,MAEtB8K,EAAMxE,2BAGVxH,EAAUc,OAAO,UACd0K,KAAKoM,GAAMrB,oBAAqBvK,EAAM/H,UAAUI,MAAO2H,EAAM/H,UAAUQ,QACvE5D,GAAG,SAAU,WACZ,MAAM0R,EAASqF,GAAMZ,mBAAmBvf,EAAGqJ,OAAOC,OAClDiL,EAAM/H,UAAUI,MAAQkO,EAAOlO,MAC/B2H,EAAM/H,UAAUQ,OAAS8N,EAAO9N,OAChCuH,EAAMxE,2BAMZ,SAASsQ,GAAmB9X,EAAWgM,GACrChM,EAAUG,OAAO,OACdD,QAAQ,SAAS,GACjBsL,KACC4K,GAAKd,UAAW,aAAc,QAC9BtJ,EAAMxR,KAAKmJ,MAAMnN,OAAOgN,OAAO9M,GAAiC,YAA5B+D,EAAKzD,SAASN,EAAEK,SACpDiV,EAAM9H,SAASI,OAAS,IAE5BtE,EAAUG,OAAO,OACdD,QAAQ,SAAS,GACjBA,QAAQ,QAAQ,GAChBsL,KAAK8K,GAAKT,SAAU,aAAc,QAAS7J,EAAM9H,SAASQ,OAC7D1E,EAAUG,OAAO,OACdD,QAAQ,SAAS,GACjBsL,KACCoM,GAAMd,cAAe,OACrBT,EAAS9L,QAAQ/G,OAAO9M,GAAiB,YAAZA,EAAE2N,OAC/BgS,EAAS3M,MAAMlG,OAAO9M,GAAe,YAAVA,EAAEG,KAC7BmV,EAAM9H,SAASG,MAAO2H,EAAM9H,SAASO,QAEzCzE,EAAUwL,KAAKuM,GAA0B/L,GAI3C,SAAS+L,GAAyB/X,EAAWgM,GAC3ChM,EAAUc,OAAO,UACd0K,KAAK4K,GAAKnB,gBAAiBjJ,EAAM9H,SAASI,OAC1CzD,GAAG,SAAU,WACZmL,EAAM9H,SAASI,MAAQ8R,GAAKb,eAAe9d,EAAGqJ,OAAOC,OACrDiL,EAAMxE,2BAEVxH,EAAUc,OAAO,UACd0K,KAAK8K,GAAKZ,eAAgB1J,EAAM9H,SAASQ,OACzC7D,GAAG,SAAU,WACZmL,EAAM9H,SAASQ,MAAQ4R,GAAKR,cAAcre,EAAGqJ,OAAOC,OACpDiL,EAAMxE,2BAEVxH,EAAUc,OAAO,UACd0K,KAAKoM,GAAMrB,oBAAqBvK,EAAM9H,SAASG,MAAO2H,EAAM9H,SAASO,QACrE5D,GAAG,SAAU,WACZ,MAAM0R,EAASqF,GAAMZ,mBAAmBvf,EAAGqJ,OAAOC,OAClDiL,EAAM9H,SAASG,MAAQkO,EAAOlO,MAC9B2H,EAAM9H,SAASO,OAAS8N,EAAO9N,OAC/BuH,EAAMxE,2BAMZ,SAASwQ,GAAoBhY,EAAWgM,GAEtChM,EAAUG,OAAO,OACdA,OAAO,OACLD,QAAQ,WAAW,GACnBsL,KAAK0I,GAAID,SAAU,gBAAiB,mBAAoBjI,EAAM7H,UAAUrN,SAE7E,MAAMmhB,EAAajY,EAAUG,OAAO,OAC/BD,QAAQ,QAAQ,GACrB+X,EAAW9X,OAAO,OACbD,QAAQ,QAAQ,GAChBA,QAAQ,QAAQ,GAChBsL,KACC4K,GAAKd,UAAW,aAAc,aAC9BtJ,EAAMxR,KAAKmJ,MAAMnN,OAAOgN,OAAO9M,GAAiC,SAA5B+D,EAAKzD,SAASN,EAAEK,SACpDiV,EAAM7H,UAAU/H,MAAQ,IAE9B6b,EAAW9X,OAAO,OACbD,QAAQ,QAAQ,GAChBA,QAAQ,QAAQ,GAChBsL,KACC0I,GAAIE,UAAW,aAAc,YAAa,EAAG,IAAK,EAAGpI,EAAM7H,UAAUS,MAG3E5E,EAAUG,OAAO,OACZD,QAAQ,SAAS,GACjBsL,KACC4K,GAAKd,UAAW,cAAe,cAC/BtJ,EAAMxR,KAAKmJ,MAAMnN,OAAOgN,OAAO9M,GAAiC,SAA5B+D,EAAKzD,SAASN,EAAEK,SACpDiV,EAAMzG,eAAejB,OAAS,IAEpCtE,EAAUG,OAAO,OACZD,QAAQ,SAAS,GACjBsL,KACCoM,GAAMlB,gBAAiB,QAASL,EAAS7L,cACzC6L,EAASrM,gBAAiBgC,EAAMzG,eAAeb,OAErD1E,EAAUG,OAAO,OACZD,QAAQ,SAAS,GACjBsL,KACCoM,GAAMd,cAAe,QAAST,EAAS9L,QACvC8L,EAAS3M,MAAMlG,OAAO9M,GAAe,YAAVA,EAAEG,KAC7BmV,EAAMzG,eAAelB,MAAO2H,EAAMzG,eAAed,QAEvDzE,EAAUwL,KAAK0M,GAA2BlM,GAI5C,SAASkM,GAA0BlY,EAAWgM,GAE5ChM,EAAUc,OAAO,YACZ0K,KAAK0I,GAAIZ,eAAgBtH,EAAM7H,UAAUrN,SACzC+J,GAAG,SAAU,WACZmL,EAAM7H,UAAUrN,QAAUod,GAAIC,cAAc1c,EAAGqJ,OAAOC,OACtDiL,EAAMxE,2BAGZxH,EAAUc,OAAO,SACZ0K,KAAK4K,GAAKnB,gBAAiBjJ,EAAM7H,UAAU/H,MAC3CyE,GAAG,SAAU,WACZmL,EAAM7H,UAAU/H,KAAOga,GAAKb,eAAe9d,EAAGqJ,OAAOC,OACrDiL,EAAMxE,2BAEZxH,EAAUc,OAAO,SACZ0K,KAAK0I,GAAIV,gBAAiBxH,EAAM7H,UAAUS,MAC1C/D,GAAG,SAAU,WACZmL,EAAM7H,UAAUS,KAAOsP,GAAII,eAAe7c,EAAGqJ,OAAOC,OACpDiL,EAAMxE,2BAGZxH,EAAUc,OAAO,UACZ0K,KAAK4K,GAAKnB,gBAAiBjJ,EAAMzG,eAAejB,OAChDzD,GAAG,SAAU,WACZmL,EAAMzG,eAAejB,MAAQ8R,GAAKb,eAAe9d,EAAGqJ,OAAOC,OAC3DiL,EAAMxE,2BAEZxH,EAAUc,OAAO,UACZ0K,KAAKoM,GAAMzB,sBAAuBnK,EAAMzG,eAAeb,OACvD7D,GAAG,SAAU,WACZ,MAAM0R,EAASqF,GAAMf,qBAAqBpf,EAAGqJ,OAAOC,OACpDiL,EAAMzG,eAAeb,MAAQ6N,EACzBA,EAAOjX,OAAS,GAClB0Q,EAAMzG,eAAelB,MAAQ,UAC7BrE,EAAUc,OAAO,UAAUqK,UAAU,gBAClCiI,SAAS,YAAY,GACrBlS,MAAM,UAAW,MAEpB8K,EAAMzG,eAAelB,MAAQ+R,GAAKb,eAAevV,EAAUc,OAAO,WAClEd,EAAUc,OAAO,UAAUqK,UAAU,gBAClCiI,SAAS,YAAY,GACrBlS,MAAM,UAAW,OAEtB8K,EAAMxE,2BAEZxH,EAAUc,OAAO,UACZ0K,KACCoM,GAAMrB,oBAAqBvK,EAAMzG,eAAelB,MAChD2H,EAAMzG,eAAed,QAEtB5D,GAAG,SAAU,WACZ,MAAM0R,EAASqF,GAAMZ,mBAAmBvf,EAAGqJ,OAAOC,OAClDiL,EAAMzG,eAAelB,MAAQkO,EAAOlO,MACpC2H,EAAMzG,eAAed,OAAS8N,EAAO9N,OACrCuH,EAAMxE,2BAMd,SAAS2Q,GAAenY,EAAWgM,GAEjC,MAAMiM,EAAajY,EAAUG,OAAO,OAC/BD,QAAQ,QAAQ,GACrB+X,EAAW9X,OAAO,OACbD,QAAQ,SAAS,GACjBA,QAAQ,QAAQ,GAChBsL,KACC0I,GAAID,SAAU,qBAAsB,yBACpCjI,EAAMtG,UAAU5O,SAEtBmhB,EAAW9X,OAAO,OACbD,QAAQ,QAAQ,GAChBA,QAAQ,QAAQ,GAChBsL,KACC0I,GAAIE,UAAW,kBAAmB,yBAClC,EAAG,IAAK,EAAGpI,EAAMtG,UAAUd,MAGjC,MAAMwT,EAAapY,EAAUG,OAAO,OAC/BD,QAAQ,QAAQ,GACrBkY,EAAWjY,OAAO,OACbD,QAAQ,SAAS,GACjBA,QAAQ,QAAQ,GAChBsL,KAAK8K,GAAKT,SAAU,mBAAoB,QAAS7J,EAAMvG,UAAUf,OACtE0T,EAAWjY,OAAO,OACbD,QAAQ,SAAS,GACjBA,QAAQ,QAAQ,GAChBsL,KACC4K,GAAKd,UAAW,mBAAoB,aACpCe,EAAS3M,MAAMlG,OAAO9M,GAAe,YAAVA,EAAEG,KAAoBmV,EAAMvG,UAAUpB,OAEvE+T,EAAWjY,OAAO,OACbD,QAAQ,UAAU,GAClBA,QAAQ,QAAQ,GAChBsL,KAAK8K,GAAKT,SAAU,oBAAqB,SAAU7J,EAAMvG,UAAUhB,QAG1E,SAAS4T,GAAqBrY,EAAWgM,GAEvChM,EAAUc,OAAO,UACZ0K,KAAK0I,GAAIZ,eAAgBtH,EAAMtG,UAAU5O,SACzC+J,GAAG,SAAU,WACZmL,EAAMtG,UAAU5O,QAAUod,GAAIC,cAAc1c,EAAGqJ,OAAOC,OACtDiL,EAAMvE,2BAEZzH,EAAUc,OAAO,SACZ0K,KAAK0I,GAAIV,gBAAiBxH,EAAMtG,UAAUd,MAC1C/D,GAAG,SAAU,WACZmL,EAAMtG,UAAUd,KAAOsP,GAAII,eAAe7c,EAAGqJ,OAAOC,OACpDiL,EAAMvE,2BAGZzH,EAAUc,OAAO,UACZ0K,KAAK8K,GAAKZ,eAAgB1J,EAAMvG,UAAUf,OAC1C7D,GAAG,SAAU,WACZmL,EAAMvG,UAAUf,MAAQ4R,GAAKR,cAAcre,EAAGqJ,OAAOC,OACrDiL,EAAMvE,2BAEZzH,EAAUc,OAAO,UACZ0K,KAAK4K,GAAKnB,gBAAiBjJ,EAAMvG,UAAUpB,OAC3CxD,GAAG,SAAU,WACZmL,EAAMvG,UAAUpB,MAAQ+R,GAAKb,eAAe9d,EAAGqJ,OAAOC,OACtDiL,EAAMvE,2BAEZzH,EAAUc,OAAO,WACZ0K,KAAK8K,GAAKZ,eAAgB1J,EAAMvG,UAAUhB,QAC1C5D,GAAG,SAAU,WACZmL,EAAMvG,UAAUhB,OAAS6R,GAAKR,cAAcre,EAAGqJ,OAAOC,OACtDiL,EAAMvE,2BAKd,SAAS6Q,GAAgBtY,EAAWuY,EAAOC,GACzCxY,EAAUG,OAAO,OACdA,OAAO,OACLD,QAAQ,OAAO,GACfA,QAAQ,YAAY,GACpBE,KAAK,KAAMmY,GACXnY,KAAK,OAAQ,WAClBJ,EAAUG,OAAO,OACZD,QAAQ,eAAe,GACvBA,QAAQ,OAAO,GACfE,KAAK,KAAMoY,GAIlB,SAASC,GAAczY,EAAWpD,EAAIqD,GACpCD,EACKE,QAAQ,YAAY,GACpBA,QAAQ,YAAY,GACpBA,QAAQ,QAAQ,GAChBE,KAAK,QAASxD,SACdwD,KAAK,cAAe,OACpBA,KAAK,WAAYxD,KACjBwD,KAAK,OAAQ,OACbA,KAAK,gBAAiBxD,GACtBwD,KAAK,gBAAiB,SACtBhE,KAAK6D,GAIZ,SAASyY,GAAe1Y,EAAWpD,GACjCoD,EACKE,QAAQ,YAAY,GACpBA,QAAQ,QAAQ,GAChBA,QAAQ,aAAa,GACrBA,QAAQ,QAAQ,GAChBE,KAAK,KAAMxD,GACXwD,KAAK,OAAQ,YACbA,KAAK,qBAAsBxD,SA8DlC,SAAS+b,GAAiB3Y,EAAWgM,GACnChM,EAAUc,OAAO,iBACZ0K,KAAK6L,GAAsBrL,GAChChM,EAAUc,OAAO,kBACZ0K,KAAKqM,GAA2B7L,GACrChM,EAAUc,OAAO,iBACZ0K,KAAKuM,GAA0B/L,GACpChM,EAAUc,OAAO,kBACZ0K,KAAK0M,GAA2BlM,GACrChM,EAAUc,OAAO,iBACZ0K,KAAK6M,GAAsBrM,WAKhC4M,WAzEF,SAAoB5Y,EAAWgM,GAE7BhM,EAAUc,OAAO,OAAOuK,SACxBrL,EAAUc,OAAO,gBAAgBuK,SAEjCrL,EAAUwL,KACR8M,GAAiB,oBAAqB,yBACxC,MAAMO,EAAO7Y,EAAUc,OAAO,aACxBgY,EAAU9Y,EAAUc,OAAO,gBAGjC+X,EAAK1Y,OAAO,KACPD,QAAQ,UAAU,GAClBE,KAAK,gBAAiB,QACtBoL,KAAKiN,GAAe,eAAgB,QACzCK,EAAQ3Y,OAAO,OACVD,QAAQ,QAAQ,GAChBA,QAAQ,UAAU,GAClBA,QAAQ,gBAAgB,GACxBsL,KAAKkN,GAAgB,gBACrBlN,KAAKyL,GAAgBjL,GAG1B6M,EAAK1Y,OAAO,KACPqL,KAAKiN,GAAe,gBAAiB,SAC1CK,EAAQ3Y,OAAO,OACVD,QAAQ,iBAAiB,GACzBsL,KAAKkN,GAAgB,iBACrBlN,KAAKmM,GAAqB3L,GAG/B6M,EAAK1Y,OAAO,KACPqL,KAAKiN,GAAe,eAAgB,QACzCK,EAAQ3Y,OAAO,OACVD,QAAQ,gBAAgB,GACxBsL,KAAKkN,GAAgB,gBACrBlN,KAAKsM,GAAoB9L,GAG9B6M,EAAK1Y,OAAO,KACPqL,KAAKiN,GAAe,gBAAiB,SAC1CK,EAAQ3Y,OAAO,OACVD,QAAQ,iBAAiB,GACzBsL,KAAKkN,GAAgB,iBACrBlN,KAAKwM,GAAqBhM,GAG/B6M,EAAK1Y,OAAO,KACPqL,KAAKiN,GAAe,eAAgB,QACzCK,EAAQ3Y,OAAO,OACVD,QAAQ,gBAAgB,GACxBsL,KAAKkN,GAAgB,gBACrBlN,KAAK2M,GAAgBnM,GAE1BhM,EAAUwL,KAAKmN,GAAkB3M,IAmBrB2M,iBAAAA,YCjgBZI,mBAjCK,SAA4BpV,EAAOD,EAAOsV,GAG/C,IAAKtV,EAAMpI,OAAQ,CACjB,MAAM2d,KAEN,OADAtV,EAAMX,QAAQtM,IAAOuiB,EAAUviB,GAAKsiB,EAAOnE,QAAU,KAAOne,IACrDuiB,EAET,MAAMC,KACAD,EAAYE,IAAWxV,MAAMA,GAAOD,MAAMA,EAA9ByV,GAmBlB,OAlBA/d,OAAO6V,QAAQgI,GAAWjW,QAAQtM,IAC3BwiB,EAASviB,eAAeD,EAAE,MAC7BwiB,EAASxiB,EAAE,QAEbwiB,EAASxiB,EAAE,IAAImQ,KAAKnQ,EAAE,MAGxB0E,OAAO6V,QAAQiI,GACZjX,KAAK,CAACtD,EAAGya,IAAMza,EAAE,GAAGrD,OAAS8d,EAAE,GAAG9d,QAClC0H,QAAQ,CAACqW,EAASpW,KACS,IAAtBoW,EAAQ,GAAG/d,OACb2d,EAAUI,EAAQ,GAAG,IAAML,EAAOnE,QAAU,KAAO5R,EAEnDoW,EAAQ,GAAGrW,QAAQtM,IACjBuiB,EAAUviB,GAAKuM,MAIhBgW,ICRT,SAASK,GAASnf,GAChB,OAAOlB,EAAIiB,YAAYC,GACpBY,KAAK2I,GACGzK,EAAIiB,YAAYwJ,EAAM7G,UAAU8G,OACpC5I,KAAK4I,KACID,MAAOA,EAAOC,MAAOA,MAMvC,SAAS4V,GAAI/e,GAEX,MAEMwR,EAAQ,IAAIjG,EAAavL,EAFjB,KACC,MAETqU,EAAakB,EAAME,gBAHX,KACC,MAGDxY,EAAGqJ,OAAO,aACnB0K,KAAKtM,EAAKqO,iBAAkBvB,GAC3BlL,OAAO,YACR0K,KAAKtM,EAAKsO,YAAaxB,GACvBR,KAAK8D,EAAYX,eAAgB3C,GACjCR,KAAKuE,EAAMc,SAAUhC,EAAY7C,GACtCvU,EAAGqJ,OAAO,eACL0K,KAAKgO,GAAQZ,WAAY5M,GAG9B9T,OAAOuhB,SAAW,KAChBhiB,EAAGqJ,OAAO,aAAa0K,KAAKtM,EAAK+N,OAAQjB,IAG3C,MAAM0N,EAAUjiB,EAAGqJ,OAAO,YAC1B4Y,EAAQvO,UAAU,cAAcE,SAEhC,MAAMsO,EAAOD,EAAQvZ,OAAO,OACvBqL,KAAKkJ,EAAOlU,mBAAoB,KAAM,eAAgB,WACtDM,OAAO,kBACZ6Y,EAAKxZ,OAAO,KACPD,QAAQ,cAAc,GACtBsL,KAAKoO,GAAgBnF,UAC1BkF,EAAKxZ,OAAO,KACPD,QAAQ,WAAW,GACnBsL,KAAKqO,GAAapF,UACvBkF,EAAKxZ,OAAO,KACPD,QAAQ,YAAY,GACpBsL,KAAKkJ,EAAOjU,iBAAkB,KAAM,yBACpCI,GAAG,QAAS,WACX,GAAImL,EAAMxR,KAAKkJ,MAAMvJ,QACnB,OAAOlB,EAAI0B,WAAWqR,EAAMxR,KAAKkJ,MAAMvJ,QAAS6C,IAC9CA,EAAKJ,GAAKnC,EAAKhC,SACfuE,EAAKpG,KAAOoV,EAAMxR,KAAKkJ,MAAM9M,KAC7BoG,EAAK+G,SAAWiI,EAAMjI,aAEvBhJ,KAAK,IAAMf,QAAQ8f,KAAK,mBACpB,CACL,MAAMtf,EAAOwR,EAAM+N,SACnB,OAAO9gB,EAAIsB,QAAQC,EAAKmJ,OACrB5I,KAAKZ,IACJK,EAAKkJ,MAAM7G,UAAU8G,MAAQxJ,EACtBlB,EAAIsB,QAAQC,EAAKkJ,SAEzB3I,KAAKZ,IACJjC,OAAOC,4BAA8BgC,SAIjDwf,EAAKxZ,OAAO,KACPqL,KAAKkJ,EAAOjU,iBAAkB,KAAM,kBACpCI,GAAG,QAAS,KACX,MAAMrG,EAAOwR,EAAM+N,gBAEZvf,EAAKmJ,MAAMxJ,eACXK,EAAKkJ,MAAMvJ,eACXK,EAAKkJ,MAAM7G,UAAU8G,MAC5BqW,EAAMra,aAAanF,EAAMA,EAAKkJ,MAAM9M,QAEtCoV,EAAMxR,KAAKmJ,MAAMxJ,SAEnBuf,EAAQvZ,OAAO,KACVqL,KAAKkJ,EAAOpU,eAAgB,KAAM,gBAAiB,qBACnDF,KAAK,2BAA4B4L,EAAMxR,KAAKmJ,MAAMxJ,WAClDiG,KAAK,SAAU,UAGtBsZ,EAAQvZ,OAAO,KACVqL,KAAKkJ,EAAOpU,eAAgB,KAAM,gBAAiB,qBACnDF,KAAK,OAAQ,gBACbA,KAAK,SAAU,WAEH,UAAW,SAASlJ,SAAS8U,EAAMxR,KAAKkJ,MAAM9H,UAE7D8d,EAAQvZ,OAAO,KACVqL,KAAKkJ,EAAOpU,eAAgB,KAAM,UAAW,qBAC7CO,GAAG,QAAS,WACXoZ,EAAKvd,cAAcsP,EAAMxR,KAAKkJ,MAAMvJ,SACjCY,KAAK,IAAMue,GAAStN,EAAMxR,KAAKkJ,MAAMvJ,UACrCY,KAAKwe,MAEdG,EAAQvZ,OAAO,KACVqL,KAAKkJ,EAAOpU,eAAgB,KAAM,mBAAoB,WACtDF,KAAK,cAAe,SACpBA,KAAK,cAAe,iBACzBsZ,EAAQvZ,OAAO,QACVD,QAAQ,YAAY,GACtBC,OAAO,YACLC,KAAK,MAAO,KACZA,KAAK,QAAS4L,EAAMxR,KAAKkJ,MAAMzG,UAC/Bb,QAAQ4P,EAAMxR,KAAKkJ,MAAMzG,cAEhCyc,EAAQvZ,OAAO,QACZD,QAAQ,SAAS,GACjB9D,KAAK4P,EAAMxR,KAAKkJ,MAAM9M,MACzB8iB,EAAQvZ,OAAO,QACVD,QAAQ,UAAU,GAClB9D,SAAS4P,EAAMxR,KAAKkJ,MAAM9H,YAAYoQ,EAAMxR,KAAKkJ,MAAMvG,QAAQ7B,iCAAiC0Q,EAAMxR,KAAKkJ,MAAMxG,kBAGtH,MAAMgd,EAAUziB,EAAGqJ,OAAO,YAC1BoZ,EAAQ/O,UAAU,OAAOE,SACzB6O,EAAQ/Z,OAAO,OACVD,QAAQ,cAAc,GACtBsL,KAAKoO,GAAgBnd,MAC1Byd,EAAQ/Z,OAAO,OACVD,QAAQ,WAAW,GACnBsL,KAAKqO,GAAapd,KAAMuP,EAAMxR,KAAKkJ,MAAM9M,MAC9CsjB,EAAQ/Z,OAAO,OACVD,QAAQ,UAAU,GAClBsL,KACCoJ,GAAMhC,cAAe,eACrB,wDAENuH,GAAUnO,GAIZ,SAASmO,GAAUnO,GAEjBvU,EAAGqJ,OAAO,SAAS1E,KAAK4P,EAAMxR,KAAKkJ,MAAM9M,MACzCa,EAAGqJ,OAAO,YAAYA,OAAO,UAAU1E,KAAK4P,EAAMxR,KAAKkJ,MAAM9M,MAE7D,MAAMsjB,EAAUziB,EAAGqJ,OAAO,YAE1BoZ,EAAQpZ,OAAO,YACV0K,KAAKqO,GAAa/E,WAAY9I,GAC9BnL,GAAG,SAAU,WACZmL,EAAMxR,KAAKkJ,MAAM9M,KAAOijB,GAAaziB,MAAMK,EAAGqJ,OAAOC,OACrDoZ,GAAUnO,KAGhBkO,EAAQpZ,OAAO,WACVD,GAAG,SAAU,WACZoZ,EAAKvd,cAAcsP,EAAMxR,KAAKkJ,MAAMvJ,QAAS,SAC1CY,KAAK,IAAMue,GAAStN,EAAMxR,KAAKkJ,MAAMvJ,UACrCY,KAAKwe,MAGdW,EAAQpZ,OAAO,eACVD,GAAG,SAAU,WACZ,MAAMzJ,EAAQwiB,GAAgBxiB,MAAMK,EAAGqJ,OAAOC,OACxCqZ,EAAUpO,EAAMxR,KAAKmJ,MAAMxG,QAAQ1G,IAAIC,GAAKA,EAAEwM,OAC9CQ,EAAQsI,EAAMxR,KAAKkJ,MAAMvG,QAC5BqG,OAAO9M,GAAKA,EAAE+S,QAAUuC,EAAMjH,kBAC3BsV,EAAOpB,GAAUF,mBACrBqB,EAAS1W,GAAQmR,QAASzd,EAAMyd,UAE5B9D,GACJla,IAAK,QACLyN,MAAO7J,EAAKlE,yBACRM,IAAKO,EAAMR,KAAMG,OAAQ,YAAaqV,UAAW,OACnD,GACF2E,QAASsJ,GAEXC,GAAOtR,MAAMgD,EAAMxR,KAAKmJ,MAAOoN,GAC/B/E,EAAM/H,WACJK,MAAOlN,EAAMR,KAAMyN,MAAO,UAAWI,OAAQ,KAC7CC,MAAOL,EAAM2F,gBAAgB,GAAGtF,MAChCC,QAASN,EAAM2F,gBAAgB,GAAGrF,SAEpC4V,EAAE,qBAAqB3F,MAAM,QAC7Bnd,EAAGqJ,OAAO,iBAAiBI,MAAM,UAAW,QAC5CqY,GAAIvN,EAAM+N,oBAMhBT,SAAAA,GAAUC,IAAAA,GAAKY,UAAAA,WC7JfpU,aAAAA,EAAc7G,KAAAA,EAAM6Q,MAAAA,EAAOT,YAAAA,EAAakL,IArC1C,WAEoB5b,SAASzG,SAASsiB,SACpB,WAAYC,WAAcA,UAAUC,OADpD,MAEMxgB,EAAUM,EAAKzC,WAAW4E,IAAM,KAChCge,EAAUngB,EAAKzC,WAAWG,UAAY,KAC5C,GAAIgC,EAEF,OAAO8f,EAAKvd,cAAcvC,EAAS,UAChCY,KAAK,IAAM8f,GAAWvB,SAASnf,IAC/BY,KAAK8f,GAAWtB,KACd,GAAIqB,EAET,OAAOZ,EAAMza,UAAUqb,GACpB7f,KAAK8f,GAAWtB,KACd,CAEL,MAAMG,EAAUjiB,EAAGqJ,OAAO,YAC1B4Y,EAAQvO,UAAU,SAASE,SACdqO,EAAQvZ,OAAO,OACvBqL,KAAKkJ,EAAOlU,mBAAoB,KAAM,gBAAiB,WACvDM,OAAO,kBACPX,OAAO,KACPqL,KAAKkJ,EAAO/T,iBAAkB,SAAU,cAAe,uBACvDE,GAAG,SAAU,WACZ,MAAMxD,EAAOqX,EAAOvT,sBAAsB1J,EAAGqJ,OAAOC,OACpDiZ,EAAM3a,SAAShC,GAAMtC,KAAK8f,GAAWtB,OAE3CG,EAAQvZ,OAAO,KACVqL,KAAKkJ,EAAOrU,WAAY,KAAM,gBAAiB,qBAC/CD,KAAK,OAAQ,gBACbA,KAAK,SAAU"}