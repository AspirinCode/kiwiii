{"version":3,"file":"kwnetwork.js","sources":["../src/common/misc.js","../src/common/idb.js","../src/common/fetcher.js","../src/common/core.js","../src/common/file.js","../src/component/button.js","../src/common/legacySchema.js","../src/network/state.js","../src/common/scale.js","../src/network/component.js","../src/network/view.js","../src/network/interaction.js","../src/network/force.js","../src/common/mapper.js","../src/component/modal.js","../src/component/formBox.js","../src/dialog/community.js","../src/dialog/rename.js","../src/component/formListBox.js","../src/component/formRangeBox.js","../src/component/formBoxGroup.js","../src/network/controlBox.js","../src/network/communityDetection.js","../src/network/networkApp.js","../src/network.js"],"sourcesContent":["\n/** @module common/misc */\n\nimport d3 from 'd3';\nimport _ from 'lodash';\n\n\nfunction defaultFieldProperties(fields) {\n  return fields.map(e => {\n    if (!e.hasOwnProperty('name')) e.name = e.key;\n    if (!e.hasOwnProperty('visible')) e.visible = true;\n    if (e.hasOwnProperty('d3_format')) e.format = 'd3_format';\n    if (!e.hasOwnProperty('format')) e.format = 'raw';\n    return e;\n  });\n}\n\n\nfunction sortType(fmt) {\n  if (['numeric', 'd3_format'].includes(fmt)) return 'numeric';\n  if (['text', 'compound_id', 'assay_id', 'list'].includes(fmt)) return 'text';\n  return 'none';\n}\n\n\n/**\n * Format number\n * @param {object} value - value\n * @param {string} type - si | scientific | rounded | raw\n */\nfunction formatNum(value, d3format) {\n  if (value === undefined || value === null || Number.isNaN(value)) return '';\n  return value == parseFloat(value) ? d3.format(d3format)(value) : value;\n}\n\n\nfunction partialMatch(query, target) {\n  if (target === undefined || target === null || target === '') return false;\n  return target.toString().toUpperCase()\n    .indexOf(query.toString().toUpperCase()) !== -1;\n}\n\n\nfunction URLQuery() {\n  const pairs = window.location.search.substring(1).split(\"&\")\n    .map(e => e.split('='));\n  return _.fromPairs(pairs);\n}\n\n\n// Ref. https://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript\nfunction uuidv4() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n    var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\n    return v.toString(16);\n  });\n}\n\n\nexport default {\n  defaultFieldProperties, sortType, formatNum, partialMatch, URLQuery, uuidv4\n};\n","\n/** @module common/idb */\n\nimport Dexie from 'Dexie';\n\nimport {default as misc} from './misc.js';\n\n\nconst schema = {\n  items: 'storeID, dataType, created'\n};\n\nlet idb = new Dexie('Store');\nidb.version(1).stores(schema);\n\n\n/**\n * Returns all data store items\n * @return {array} data store objects\n */\nfunction getAllItems() {\n  return idb.items\n    .orderBy('created')\n    .reverse()\n    .toArray();\n}\n\n\n/**\n * Get data store items by data type\n * @param {string} type - 'nodes' or 'edges'\n * @return {array} data store objects\n */\nfunction getItemsByDataType(type) {\n  return idb.items\n    .where('dataType')\n    .equals(type)\n    .reverse()\n    .sortBy('created')\n    .catch(err => {\n      console.error(`IDBError: Unexpected dataType: ${type}`, err);\n    });\n}\n\n\n/**\n * Get data store items by store ID\n * @param {string} storeID - store ID\n * @return {array} data store object\n */\nfunction getItemByID(storeID) {\n  return idb.items\n    .where('storeID')\n    .equals(storeID)\n    .first()\n    .catch(err => {\n      console.error(`IDBError: Unexpected table ID: ${storeID}`, err);\n    });\n}\n\n\n/**\n * Delete a data object from the store\n * @param {string} storeID - store ID\n * @return {integer} - number of deleted items\n */\nfunction deleteItem(storeID) {\n  return idb.items\n    .where('storeID')\n    .equals(storeID)\n    .delete();\n}\n\n\n/**\n * Insert a data object to the store\n * @param {object} data - data\n * @return {string} - storeID if sucessfully added\n */\nfunction putItem(data) {\n  if (!data.storeID) {\n    data.storeID = misc.uuidv4();\n  }\n  return idb.items.put(data);\n}\n\n\n/**\n * Update data object in the store\n * @param {string} storeID - store ID\n * @param {function} updateFunc - update function\n * @return {integer} - number of updated items\n */\nfunction updateItem(storeID, updateFunc) {\n  return idb.items\n    .where('storeID')\n    .equals(storeID)\n    .modify(updateFunc)\n    .catch(err => {\n      console.error('IDBError: Update failed', err);\n    });\n}\n\n\n/**\n * Delete all data store\n * Try this before dealing with local db issues\n */\nfunction reset() {\n  return idb.delete().then(() => {\n    idb = new Dexie('Store');\n    idb.version(1).stores(schema);\n  });\n}\n\n\nexport default {\n  getAllItems, getItemsByDataType, getItemByID,\n  deleteItem, putItem, updateItem, reset\n};\n","\n/** @module common/fetcher */\n\n\nconst baseURL = '';\n\nfunction get(url, query={}) {\n  const isEmpty = Object.keys(query).length;\n  const q = isEmpty ? `?query=${JSON.stringify(query)}` : '';\n  return fetch(\n    `${baseURL}${url}${q}`,\n    {\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\nfunction json(response) {\n  return response.json();\n}\n\nfunction text(response) {\n  return response.text();\n}\n\nfunction blob(response) {\n  return response.blob();\n}\n\nfunction post(url, formdata) {\n  return fetch(\n    `${baseURL}${url}`,\n    {\n      method: 'POST',\n      body: formdata,\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\n\nfunction error(err) {\n  console.error(err);\n  return null;\n}\n\n\nexport default {\n  get, json, text, blob, post, error\n};\n","\n/** @module common/core */\n\nimport {default as idb} from './idb.js';\nimport {default as fetcher} from './fetcher.js';\nimport {default as misc} from './misc.js';\n\n\nfunction fetchProgress(storeID, command='update') {\n  return idb.getItemByID(storeID)\n    .then(data => {\n      if (!data) return Promise.reject(`Store: ${storeID} is not available`);\n      if (!['ready', 'running'].includes(data.status)) return;\n      const query = {id: data.reference.workflow, command: command};\n      return fetcher.get('progress', query)\n        .then(fetcher.json)\n        .then(data => {\n          if (data.status === 'failure') {  // No data found on server\n            return idb.updateItem(storeID, item => {\n              item.status = 'failure';\n            });\n          }\n          return idb.updateItem(storeID, item => {\n            item.status = data.status;\n            item.progress = data.progress;\n            item.execTime = data.execTime;\n            item.fields = misc.defaultFieldProperties(data.fields);\n            item.records = data.records;\n          });\n        });\n    });\n}\n\n\nexport default {\n  fetchProgress\n};\n","\n/** @module common/file */\n\nimport pako from 'pako';\n\n\nfunction readFile(file, sizeLimit, blob) {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    const truncated = sizeLimit ? file.slice(0, sizeLimit) : file;\n    reader.onload = event => resolve(event.target.result);\n    reader.onerror = error => reject(error);\n    if (blob) {\n      reader.readAsArrayBuffer(truncated);\n    } else {\n      reader.readAsText(truncated);\n    }\n  });\n}\n\n\nfunction parseJSON(data, compressed) {\n  const text = compressed ? pako.inflate(data, {to: 'string'}) : data;\n  return JSON.parse(text);\n}\n\n\nfunction loadJSON(file) {\n  const compressed = file.name.endsWith('c') || file.name.endsWith('.gz');\n  return readFile(file, false, compressed)\n    .then(data => parseJSON(data, compressed));\n}\n\n\nfunction fetchJSON(url) {\n  const decoded = decodeURIComponent(url);\n  const compressed = decoded.endsWith('c') || decoded.endsWith('.gz');\n  return fetch(decoded)\n    .then(res => compressed ? res.arrayBuffer() : res.json())\n    .then(data => parseJSON(data, compressed));\n}\n\n\nfunction downloadDataFile(data, name) {\n  try {\n    // cannot hundle large file with dataURI scheme\n    // url = 'data:application/json,' + encodeURIComponent(JSON.stringify(json))\n    const url = window.URL.createObjectURL(new Blob([data]));\n    const a = document.createElement('a');\n    a.download = name;\n    a.href = url;\n    // a.click() does not work on firefox\n    a.dispatchEvent(new MouseEvent('click', {\n      'view': window,\n      'bubbles': true,\n      'cancelable': false\n    }));\n    // window.URL.revokeObjectURL(url) does not work on firefox\n  } catch (e) {\n    // no DOM (unit testing)\n  }\n}\n\n\nfunction downloadJSON(json, name, compress=true) {\n  const str = JSON.stringify(json);\n  const data = compress ? pako.gzip(str) : str;\n  const c = compress ? 'c' : 'r';\n  const ext = json.hasOwnProperty('edges') ? `.gf${c}` :  `.nd${c}`;\n  downloadDataFile(data, `${name}${ext}`);\n}\n\n\nexport default {\n  readFile, parseJSON, loadJSON, fetchJSON,\n  downloadDataFile, downloadJSON\n};\n","\n/** @module component/button */\n\nimport d3 from 'd3';\n\n\nfunction buttonBox(selection, id, label, type) {\n  selection\n      .classed('form-group', true)\n      .classed('mb-1', true)\n    .append('button')\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed('btn-sm', true)\n      .attr('id', id)\n      .text(label);\n}\n\n\nfunction menuButton(selection, id, label, type) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .attr('id', id)\n      .text(label);\n}\n\n\nfunction menuButtonLink(selection, id, label, type) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .attr('role', 'button')\n      .attr('href', '#')\n      .attr('id', id)\n      .text(label);\n}\n\n\nfunction menuModalLink(selection, id, label, type, target) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .attr('id', id)\n      .attr('href', '#')\n      .attr('role', 'button')\n      .attr('data-toggle', 'modal')\n      .attr('data-target', `#${target}`)\n      .text(label);\n}\n\n\nfunction dropdownMenuButton(selection, id, label, type) {\n  selection\n      .classed('btn-group', true)\n      .classed('mr-1', true)\n      .attr('id', id);\n  selection.append('button')\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed('btn-sm', true)\n      .classed('dropdown-toggle', true)\n      .attr('data-toggle', 'dropdown')\n      .text(label);\n  selection.append('div')\n      .classed('dropdown-menu', true);\n}\n\n\nfunction dropdownMenuItem(selection, id, label) {\n  selection.classed('dropdown-item', true)\n      .attr('id', id)\n      .attr('href', '#')\n      .text(label);\n}\n\nfunction dropdownMenuModal(selection, id, label, target) {\n  selection.classed('dropdown-item', true)\n      .attr('id', id)\n      .attr('href', '#')\n      .attr('data-toggle', 'modal')\n      .attr('data-target', `#${target}`)\n      .text(label);\n}\n\n\nfunction dropdownMenuFile(selection, id, label, accept) {\n  selection.classed('dropdown-item', true)\n      .attr('id', id)\n      .attr('href', '#')\n      .text(label)\n      .on('click', function () {\n        d3.select(this).select('input').node().click();\n      })\n    .append('form')\n      .style('display', 'none')\n    .append('input')\n      .attr('type', 'file')\n      .attr('accept', accept);\n}\n\n\nfunction dropdownMenuFileValue(selection) {\n  return selection.select('input').node().files[0];\n}\n\n\nexport default {\n  buttonBox, menuButton, menuButtonLink, menuModalLink,\n  dropdownMenuButton, dropdownMenuItem, dropdownMenuModal,\n  dropdownMenuFile, dropdownMenuFileValue\n};\n","\n/** @module common/legacySchema */\n\nimport d3 from 'd3';\nimport {default as misc} from './misc.js';\n\n\nconst statusConv = {\n  Queued: 'ready',\n  'In progress': 'running',\n  Aborting: 'running',\n  Aborted: 'aborted',\n  Completed: 'done',\n  Failure: 'failure'\n};\n\nconst dataTypeConv = {\n  datatable: 'nodes',\n  connection: 'edges'\n};\n\nfunction v07_to_v08_nodes(json) {\n  const fields = json.columns.map(e => {\n    if (e.sort === 'numeric') {\n      e.format = 'numeric';\n    } else if (e.sort === 'text') {\n      e.format = 'text';\n    } else if (e.sort === 'none') {\n      e.format = 'raw';\n    }\n    return e;\n  });\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    status: statusConv[json.status],\n    fields: fields,\n    records: json.records,\n    query: json.query,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n  };\n}\n\nfunction v07_to_v08_edges(json, nodeFields) {\n  const snp = {\n    fieldTransform: json.snapshot.fieldTransform,\n    nodePositions: json.snapshot.nodePositions,\n    nodeColor: {},\n    nodeSize: {},\n    nodeLabel: {},\n    edge: {}\n  };\n  if (json.snapshot.hasOwnProperty('nodeColor')) {\n    snp.nodeColor.id = json.snapshot.nodeColor.id;\n    snp.nodeColor.scale = json.snapshot.nodeColor.scale;\n    snp.nodeColor.field = nodeFields.find(e => e.key === json.snapshot.nodeColor.column);\n  } else {\n    snp.nodeColor = {\n      id: 'color', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeSize')) {\n    snp.nodeSize.id = json.snapshot.nodeSize.id;\n    snp.nodeSize.scale = json.snapshot.nodeSize.scale;\n    snp.nodeSize.field = nodeFields.find(e => e.key === json.snapshot.nodeSize.column);\n  } else {\n    snp.nodeSize = {\n      id: 'size', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: [20, 20], unknown: 20}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeLabel')) {\n    snp.nodeLabel.id = json.snapshot.nodeLabel.id;\n    snp.nodeLabel.size = json.snapshot.nodeLabel.size;\n    snp.nodeLabel.text = json.snapshot.nodeLabel.text;\n    snp.nodeLabel.visible = json.snapshot.nodeLabel.visible;\n    snp.nodeLabel.scale = json.snapshot.nodeLabel.scale;\n    snp.nodeLabel.field = nodeFields.find(e => e.key === json.snapshot.nodeLabel.column);\n  } else {\n    snp.nodeLabel = {\n      id: 'label', size: 12, text: 'index', visible: false, field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeContent')) {\n    snp.nodeContent = json.snapshot.nodeContent;\n  } else {\n    snp.nodeContent = {structure: {visible: false}};\n  }\n  if (json.snapshot.hasOwnProperty('edge')) {\n    snp.edge = json.snapshot.edge;\n  } else {\n    snp.edge = {\n      id: 'label', label: {size: 10, visible: false}, visible: true,\n      scale: {scale: 'linear', domain: [0, 1], range: [5, 5], unknown: 5}\n    };\n  }\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    reference: {\n      nodes: json.nodeTableId\n    },\n    status: statusConv[json.status],\n    fields: misc.defaultFieldProperties([\n      {'key': 'source'},\n      {'key': 'target'},\n      {'key': 'weight'}\n    ]),\n    records: json.records,\n    query: json.query,\n    networkThreshold: json.networkThreshold,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n    snapshot: snp\n  };\n}\n\n\nfunction v08_nodes(json) {\n  json.records.forEach((e, i) => {\n    e.index = i;\n    e.structure = e._structure;\n    delete e._index;\n    delete e._structure;\n  });\n  json.fields.forEach(e => {\n    if (e.key === '_index') e.key = 'index';\n    if (e.key === '_structure') e.key = 'structure';\n    if (e.sort === 'numeric') e.format = 'numeric';\n    if (e.sort === 'text') e.format = 'text';\n    if (e.sort === 'none') e.format = 'raw';\n  });\n  return json;\n}\n\nfunction v08_graph(json) {\n  if (!json.edges.hasOwnProperty('reference')) { // ver0.8.0-0.8.1\n    json.edges.reference = {nodes: json.edges.nodesID};\n  }\n  if (json.nodes.fields.find(e => e.key === '_index')) {\n    const idx_converter = {};\n    json.nodes.records.forEach((e, i) => {\n        e.index = i;\n        e.structure = e._structure;\n        idx_converter[e._index] = e.index;\n        delete e._index;\n        delete e._structure;\n    });\n    json.edges.records.forEach(e => {\n        e.source = idx_converter[e.source];\n        e.target = idx_converter[e.target];\n    });\n    json.nodes.fields.forEach(e => {\n      if (e.key === '_index') e.key = 'index';\n      if (e.key === '_structure') e.key = 'structure';\n      if (e.sort === 'numeric') e.format = 'numeric';\n      if (e.sort === 'text') e.format = 'text';\n      if (e.sort === 'none') e.format = 'raw';\n    });\n  }\n  return json;\n}\n\nfunction v10_nodes(json) {\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: json.dataType,\n    schemaVersion: '0.10',\n    revision: json.revision,\n    status: json.status,\n    fields: json.fields,\n    records: json.records,\n    query: json.query,\n    progress: json.progress,\n    execTime: json.execTime,\n    created: json.created,\n    reference: {}\n  };\n}\n\n\nfunction v10_edges(json) {\n  const snapshot = {\n    networkThreshold: json.networkThreshold\n  };\n  snapshot.nodeContentVisible = json.snapshot.nodeContent.structure.visible;\n  snapshot.nodeColor = json.snapshot.nodeColor.scale || {};\n  if (snapshot.nodeColor.field) {\n    snapshot.nodeColor.field = json.snapshot.nodeColor.field.key;\n    if (snapshot.nodeColor.field === '_index') {\n      snapshot.nodeColor.field = 'index';\n    }\n  }\n  if (snapshot.nodeColor.scale === 'ordinal') {\n    snapshot.nodeColor.range = d3.schemeCategory20;\n  }\n  snapshot.nodeSize = json.snapshot.nodeSize.scale || {};\n  if (json.snapshot.nodeSize.field) {\n    snapshot.nodeSize.field = json.snapshot.nodeSize.field.key;\n    if (snapshot.nodeSize.field === '_index') {\n      snapshot.nodeSize.field = 'index';\n    }\n  }\n  snapshot.nodeLabel = {};\n  if (json.snapshot.nodeLabel.text) {\n    snapshot.nodeLabel.text = json.snapshot.nodeLabel.text.key;\n    if (snapshot.nodeLabel.text === '_index') {\n      snapshot.nodeLabel.text = 'index';\n    }\n  }\n  snapshot.nodeLabel.size = json.snapshot.nodeLabel.size;\n  snapshot.nodeLabel.visible = json.snapshot.nodeLabel.visible;\n  snapshot.nodeLabelColor = json.snapshot.nodeLabel.scale || {};\n  if (json.snapshot.nodeLabel.field) {\n    snapshot.nodeLabelColor.field = json.snapshot.nodeLabel.field.key;\n    if (snapshot.nodeLabelColor.field === '_index') {\n      snapshot.nodeLabelColor.field = 'index';\n    }\n  }\n  if (snapshot.nodeLabelColor.scale === 'ordinal') {\n    snapshot.nodeLabelColor.range = d3.schemeCategory20;\n  }\n  snapshot.edgeVisible = json.snapshot.edge.visible;\n  snapshot.edgeWidth = json.snapshot.edge.scale || {};\n  snapshot.edgeLabel = {};\n  snapshot.edgeLabel.size = json.snapshot.edge.label.size;\n  snapshot.edgeLabel.visible = json.snapshot.edge.label.visible;\n  snapshot.networkThreshold = json.networkThreshold || json.query.threshold;\n  snapshot.coords = json.snapshot.nodePositions;\n  // TODO: when created date is lost\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: json.dataType,\n    schemaVersion: '0.10',\n    revision: json.revision,\n    status: json.status,\n    fields: json.fields,\n    records: json.records,\n    query: {params: json.query},\n    progress: json.progress,\n    execTime: json.execTime,\n    created: json.created,\n    snapshot: snapshot,\n    reference: json.reference\n  };\n}\n\nfunction convertTable(json) {\n  let data = json;\n  if (!(data.hasOwnProperty('schemaVersion') || data.hasOwnProperty('$schema'))) { // v0.7\n    data = v07_to_v08_nodes(data);\n  }\n  if (data.schemaVersion == '0.8') {\n    data = v08_nodes(data);\n    data = v10_nodes(data);\n  }\n  if (!data.hasOwnProperty('$schema')) {\n    delete data.schemaVersion;\n    delete data.revision;\n    data.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n  }\n  data.fields.forEach(e => {\n    if (e.key === 'structure') {\n      e.format = 'svg';\n    }\n    delete e.width;\n    delete e.height;\n  });\n  return data;\n}\n\nfunction convertNetwork(json) {\n  let data = json;\n  if (!(data.edges.hasOwnProperty('schemaVersion') || data.edges.hasOwnProperty('$schema'))) { // v0.7\n    data.nodes = v07_to_v08_nodes(data.nodes);\n    data.edges = v07_to_v08_edges(data.edges, data.nodes.fields);\n  }\n  if (data.edges.schemaVersion == '0.8' || data.edges.schemaVersion === 0.1) {  // wrong conversion of '0.10'\n    data = v08_graph(data);\n    data.nodes = v10_nodes(data.nodes);\n    data.edges = v10_edges(data.edges);\n  }\n  if (!data.edges.hasOwnProperty('$schema')) {\n    delete data.nodes.schemaVersion;\n    delete data.edges.schemaVersion;\n    delete data.nodes.revision;\n    delete data.edges.revision;\n    data.nodes.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n    data.edges.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n  }\n  return data;\n}\n\n\nexport default {\n  convertTable, convertNetwork\n};\n","\n/** @module network/state */\n\nimport d3 from 'd3';\n\nimport {default as legacy} from '../common/legacySchema.js';\nimport {default as misc} from '../common/misc.js';\n\n\nexport default class NetworkState {\n  constructor(data, width, height) {\n    // View modes\n\n    // Focused view mode (num of nodes displayed are less than the thld)\n    // Show node contents\n    // Disable smooth transition\n    this.focusedViewThreshold = 100;\n    this.enableFocusedView = true;\n    this.focusedView = false;\n    // Overlook view mode (num of nodes displayed are less than the thld)\n    // Hide edges\n    this.overlookViewThreshold = 500;\n    this.enableOverlookView = true;\n    this.overlookView = false;\n\n    // Import from legacy format data\n    this.data = legacy.convertNetwork(data);\n\n    this.nodes = JSON.parse(JSON.stringify(this.data.nodes.records));  // Working copy\n    this.edges = JSON.parse(JSON.stringify(this.data.edges.records));  // Working copy\n\n    // Adjacency\n    // Assuming that the network is undirected graph and\n    // source index < target index\n    this.nodes.forEach(n => {\n      n.adjacency = [];\n    });\n    this.edges.forEach((e, i) => {\n      e.num = i;  // e.index will be overwritten by d3-force\n      this.nodes[e.source].adjacency.push([e.target, i]);\n      this.nodes[e.target].adjacency.push([e.source, i]);\n    });\n\n    // Snapshot\n    const snp = this.data.edges.snapshot || {\n      nodeColor: {}, nodeSize: {}, nodeLabel: {}, nodeLabelColor: {},\n      edgeWidth: {}, edgeLabel: {}\n    };\n\n    // Node attributes\n    // this.nodeContentVisible = snp.nodeContentVisible || true;\n\n    // nodeColor\n    this.nodeColor = {};\n    this.nodeColor.field = snp.nodeColor.field || null;\n    this.nodeColor.scale = snp.nodeColor.scale || 'linear';\n    this.nodeColor.domain = snp.nodeColor.domain || [0, 1];\n    this.nodeColor.range = snp.nodeColor.range || ['#7fffd4', '#7fffd4'];\n    this.nodeColor.unknown = snp.nodeColor.unknown || ['#7fffd4'];\n\n    // nodeSize\n    this.nodeSize = {};\n    this.nodeSize.field = snp.nodeSize.field || null;\n    this.nodeSize.scale = snp.nodeSize.scale || 'linear';\n    this.nodeSize.domain = snp.nodeSize.domain || [1, 1];\n    this.nodeSize.range = snp.nodeSize.range || [40, 40];\n    this.nodeSize.unknown = snp.nodeSize.unknown || 40;\n\n    // nodeLabel\n    this.nodeLabel = {};\n    this.nodeLabel.text = snp.nodeLabel.text || null;\n    this.nodeLabel.size = snp.nodeLabel.size || 12;\n    this.nodeLabel.visible = snp.nodeLabel.visible || false;\n\n    // nodeLabelColor\n    this.nodeLabelColor = {};\n    this.nodeLabelColor.field = snp.nodeLabelColor.field || null;\n    this.nodeLabelColor.scale = snp.nodeLabelColor.scale || 'linear';\n    this.nodeLabelColor.domain = snp.nodeLabelColor.domain || [1, 1];\n    this.nodeLabelColor.range = snp.nodeLabelColor.range || ['#7fffd4', '#7fffd4'];\n    this.nodeLabelColor.unknown = snp.nodeLabelColor.unknown || ['#333333'];\n\n    // Edge attributes\n    // this.edgeVisible = snp.edgeVisible || true;\n    this.networkThresholdCutoff = data.edges.query.params.threshold;\n    this.networkThreshold = snp.networkThreshold || data.edges.query.params.threshold;\n\n    // edgeWidth\n    this.edgeWidth = {};\n    this.edgeWidth.scale = snp.edgeWidth.scale || 'linear';\n    this.edgeWidth.domain = snp.edgeWidth.domain || [0.5, 1];\n    this.edgeWidth.range = snp.edgeWidth.range || [1, 5];\n    this.edgeWidth.unknown = snp.edgeWidth.unknown || 1;\n\n    // edgeLabel\n    this.edgeLabel = {};\n    this.edgeLabel.size = snp.edgeLabel.size || 12;\n    this.edgeLabel.visible = snp.edgeLabel.visible || false;\n\n    // Transform\n    this.transform = snp.fieldTransform || {x: 0, y: 0, k: 1};\n\n    // Event listener\n    this.zoomListener = null;\n    this.dragListener = null;\n\n    // Update notifier\n    this.updateComponentNotifier = null;\n    this.updateNodeNotifier = null;\n    this.updateEdgeNotifier = null;\n    this.updateNodeAttrNotifier = null;\n    this.updateEdgeAttrNotifier = null;\n    // Snapshot\n    this.snapShotNotifier = null;\n    // Zoom control\n    this.fitNotifier = null;\n    // Force control\n    this.setForceNotifier = null;\n    this.stickNotifier = null;\n    this.relaxNotifier = null;\n    this.restartNotifier = null;\n    this.tickCallback = () => {};\n\n    // Working memory\n    this.forceField = {top: 0, right: width, bottom: height, left: 0};\n    this.viewBox = {top: 0, right: width, bottom: height, left: 0};\n    this.focusArea = {};\n    this.boundary = {};\n    this.prevTransform = {\n      x: this.transform.x, y: this.transform.y, k: this.transform.k\n    };\n\n    if (snp.coords) {\n      this.simulationOnLoad = false;\n      // Set default state\n      this.setAllCoords(snp.coords);\n      this.setFocusArea();\n      this.setBoundary();\n    } else {\n      this.simulationOnLoad = true;\n    }\n  }\n\n  setBoundary() {\n    const xs = this.nodes.map(e => e.x);\n    const ys = this.nodes.map(e => e.y);\n    this.boundary.top = Math.min.apply(null, ys);\n    this.boundary.left = Math.min.apply(null, xs);\n    this.boundary.bottom = Math.max.apply(null, ys);\n    this.boundary.right = Math.max.apply(null, xs);\n    // this.showBoundary(); // debug\n  }\n\n  setFocusArea() {\n    const tx = this.transform.x;\n    const ty = this.transform.y;\n    const tk = this.transform.k;\n    const margin = 50;\n    this.focusArea.top = (this.viewBox.top - ty) / tk - margin;\n    this.focusArea.left = (this.viewBox.left - tx) / tk - margin;\n    this.focusArea.bottom = (this.viewBox.bottom - ty) / tk + margin;\n    this.focusArea.right = (this.viewBox.right - tx) / tk + margin;\n    // this.showFocusArea();  // debug\n  }\n\n  setTransform(tx, ty, tk) {\n    this.transform.x = tx;\n    this.transform.y = ty;\n    this.transform.k = tk;\n    // this.showTransform(); // debug\n    this.setFocusArea();\n  }\n\n  setViewBox(width, height) {\n    this.viewBox.right = width;\n    this.viewBox.bottom = height;\n    // this.showViewBox();  // debug\n    this.setFocusArea();\n  }\n\n  setAllCoords(coordsList) {\n    this.nodes.forEach(n => {\n      n.x = coordsList[n.index].x;\n      n.y = coordsList[n.index].y;\n      // this.edges can be changed by forceSimulation so use adjacency\n      n.adjacency.forEach(e => {\n        const nbr = e[0];\n        const edge = e[1];\n        if (n.index < nbr) {\n          this.edges[edge].sx = coordsList[n.index].x;\n          this.edges[edge].sy = coordsList[n.index].y;\n        } else {\n          this.edges[edge].tx = coordsList[n.index].x;\n          this.edges[edge].ty = coordsList[n.index].y;\n        }\n      });\n    });\n    this.setBoundary();\n  }\n\n  setCoords(n, x, y) {\n    this.nodes[n].x = x;\n    this.nodes[n].y = y;\n    this.nodes[n].adjacency.forEach(e => {\n      const nbr = e[0];\n      const edge = e[1];\n      if (n < nbr) {\n        this.edges[edge].sx = x;\n        this.edges[edge].sy = y;\n      } else {\n        this.edges[edge].tx = x;\n        this.edges[edge].ty = y;\n      }\n    });\n    this.setBoundary();\n  }\n\n  nodesToRender() {\n    return this.nodes.filter(\n      e => e.y > this.focusArea.top && e.x > this.focusArea.left\n        && e.y < this.focusArea.bottom && e.x < this.focusArea.right\n    );\n  }\n\n  edgesToRender() {\n    return this.edges.filter(\n      e => e.weight >= this.networkThreshold\n        && this.focusArea.top < Math.max(e.sy, e.ty)\n        && this.focusArea.left < Math.max(e.sx, e.tx)\n        && this.focusArea.bottom > Math.min(e.sy, e.ty)\n        && this.focusArea.right > Math.min(e.sx, e.tx)\n    );\n  }\n\n  snapshot() {\n    return {\n      nodeColor: this.nodeColor,\n      nodeSize: this.nodeSize,\n      nodeLabel: this.nodeLabel,\n      nodeLabelColor: this.nodeLabelColor,\n      edgeWidth: this.edgeWidth,\n      edgeLabel: this.edgeLabel,\n      networkThreshold: this.networkThreshold,\n      networkThresholdCutoff: this.networkThresholdCutoff,\n      fieldTransform: this.transform,\n      coords: this.nodes.map(e => ({x: e.x, y: e.y}))\n    };\n  }\n\n  export() {\n    this.data.edges.id = misc.uuidv4();\n    this.data.edges.snapshot = this.snapshot();\n    return JSON.parse(JSON.stringify(this.data));\n  }\n\n  showTransform() {\n    d3.select('#debug-transform')\n      .text(JSON.stringify(this.transform));\n  }\n\n  showBoundary() {\n    d3.select('#debug-boundary')\n      .text(JSON.stringify(this.boundary));\n  }\n\n  showFocusArea() {\n    d3.select('#debug-focusarea')\n      .text(JSON.stringify(this.focusArea));\n  }\n\n  showViewBox() {\n    d3.select('#debug-viewbox')\n      .text(JSON.stringify(this.viewBox));\n  }\n}\n","\n/** @module common/scale */\n\nimport d3 from 'd3';\n\n\nconst presets = [\n  {key: 'activity', name: 'Activity', scale: 'log', domain: [1e-4, 1e-6]},\n  {key: 'percent', name: 'Percent', scale: 'linear', domain: [0, 100]},\n  {key: 'tf', name: 'True/False', scale: 'quantize', domain: [1, 0]},\n  {key: 'mw', name: 'MW', scale: 'linear', domain: [200, 600]},\n  {key: 'logp', name: 'LogP', scale: 'linear', domain: [-2, 8]}\n];\n\n\nconst types = [\n  {key: 'linear', name: 'Linear', func: d3.scaleLinear()},\n  {key: 'log', name: 'Log', func: d3.scaleLog()},\n  {key: 'quantize', name: 'Quantize', func: d3.scaleQuantize()},\n  {key: 'ordinal', name: 'Ordinal', func: d3.scaleOrdinal()}  // not for sizeScale\n];\n\n\nconst colorPalettes = [\n  {key: 'aquamarine', name: 'Aquamarine',\n   range: ['#778899', '#7fffd4'], unknown: '#f0f0f0'},\n  {key: 'chartreuse', name: 'Chartreuse',\n   range: ['#778899', '#7fff00'], unknown: '#f0f0f0'},\n  {key: 'salmon', name: 'Salmon',\n   range: ['#778899', '#fa8072'], unknown: '#f0f0f0'},\n  {key: 'violet', name: 'Violet',\n   range: ['#778899', '#ee82ee'], unknown: '#f0f0f0'},\n  {key: 'temperature', name: 'Temperature',\n   range: ['#87ceeb', '#fff5ee', '#fa8072'], unknown: '#f0f0f0'},\n  {key: 'spectrum', name: 'Spectrum',\n   range: ['#6495ed', '#ccff66', '#ffa500'], unknown: '#f0f0f0'}\n];\n\n\n// TODO: Remove gray (for unknown) from categorical 20 and 40\nconst colorRangeTypes = [\n  {key: 'continuous', name: 'Continuous', size: 2},\n  {key: 'two-piece', name: 'Two-piece', size: 3},\n  {key: 'category10', name: 'Category 10', size: 10,\n   range: d3.schemeCategory10, unknown: '#f0f0f0'},\n  {key: 'category20', name: 'Category 20', size: 20,\n   range: d3.schemePaired.concat(d3.schemeSet2), unknown: '#f0f0f0'},\n  {key: 'category40', name: 'Category 40', size: 40,\n   range: d3.schemePaired.concat(d3.schemePastel2, d3.schemeSet2, d3.schemeSet3),\n   unknown: '#f0f0f0'}\n];\n\n\nfunction scaleFunction(attr) {\n  let sf = types.find(e => e.key == attr.scale).func;\n  let domain = attr.domain;\n  if (attr.range.length == 3) {\n    const mid = (parseFloat(attr.domain[0]) + parseFloat(attr.domain[1])) / 2;\n    domain = [attr.domain[0], mid, attr.domain[1]];\n  }\n  if (attr.scale !== 'ordinal') {\n    sf = sf.domain(domain);\n  }\n  sf = sf.range(attr.range);\n  if (['linear', 'log'].includes(attr.scale)) {\n    sf = sf.clamp(true);\n  }\n  return d => {\n    if (d === '' || typeof d === 'undefined' || d === null) {\n      return attr.unknown;  // invalid values\n    }\n    if (attr.scale !== 'ordinal' && parseFloat(d) != d) {\n      return attr.unknown;  // texts\n    }\n    if (attr.scale === 'log' && d <= 0) {\n      return attr.unknown;  // negative values in log scale\n    }\n    const result = sf(d);\n    if (result === undefined) {\n      return attr.unknown;  // TODO: specify unexpected behavior\n    }\n    return result;\n  };\n}\n\n\nexport default {\n  presets, types, colorPalettes, colorRangeTypes,\n  scaleFunction\n};\n","\n/** @module network/component */\n\nimport d3 from 'd3';\n\nimport {default as scale} from '../common/scale.js';\nimport {default as misc} from '../common/misc.js';\n\n\nconst svgWidth = 180;  //TODO\nconst svgHeight = 180;  //TODO\n\n\nfunction updateNodes(selection, records, showStruct) {\n  const nodes = selection.selectAll('.node')\n    .data(records, d => d.index);\n  nodes.exit().remove();\n  const entered = nodes.enter()\n    .append('g')\n      .attr('class', 'node')\n      .call(updateNodeCoords);\n  entered.append('circle')\n      .attr('class', 'node-symbol');\n  entered.append('g')\n      .attr('class', 'node-content')\n      .attr('transform', `translate(${-svgWidth / 2},${-svgHeight / 2})`);\n  entered.append('text')\n      .attr('class', 'node-label')\n      .attr('x', 0)\n      .attr('text-anchor', 'middle');\n  const merged = entered.merge(nodes);\n  if (showStruct) {\n    merged.select('.node-content').html(d => d.structure);\n  } else {\n    merged.select('.node-content').select('svg').remove();\n  }\n}\n\n\nfunction updateEdges(selection, records) {\n  const edges = selection.selectAll('.link')\n    .data(records, d => `${d.source}_${d.target}`);\n  edges.exit().remove();\n  const entered = edges.enter()\n    .append('g')\n      .attr('class', 'link');\n  entered.append('line')\n      .attr('class', 'edge-line')\n      .style('stroke', '#999')\n      .style('stroke-opacity', 0.6);\n  entered.append('text')\n      .attr('class', 'edge-label')\n      .attr('text-anchor', 'middle')\n      .text(d => d.weight);\n  // draw all components and then\n  entered.call(updateEdgeCoords);\n}\n\n\nfunction updateNodeAttrs(selection, state) {\n  selection.selectAll('.node')\n    .each(function (d) {\n      const color = scale.scaleFunction(state.nodeColor)(d[state.nodeColor.field]);\n      const size = scale.scaleFunction(state.nodeSize)(d[state.nodeSize.field]);\n      const labelColor = scale.scaleFunction(state.nodeLabelColor)(d[state.nodeLabelColor.field]);\n      d3.select(this).select('.node-symbol')\n          .attr('r', size)\n          .style('fill', color);\n      d3.select(this).select('.node-label')\n          .text(d => {\n            if (state.nodeLabel.text === null) return '';\n            const field = state.data.nodes.fields.find(e => e.key === state.nodeLabel.text);\n            if (field.format === 'd3_format') {\n              return misc.formatNum(d[state.nodeLabel.text], field.d3_format);\n            }\n            return d[state.nodeLabel.text];\n          })\n          .attr('font-size', state.nodeLabel.size)\n          .attr('y', parseFloat(size) + parseInt(state.nodeLabel.size))\n          .attr('visibility', state.nodeLabel.visible ? 'inherit' : 'hidden')\n          .style('fill', labelColor);\n    });\n}\n\n\nfunction updateEdgeAttrs(selection, state) {\n  selection.selectAll('.link').select('.edge-line')\n    .style('stroke-width', d => scale.scaleFunction(state.edgeWidth)(d.weight));\n  selection.selectAll('.link').select('.edge-label')\n    .attr('visibility', state.edgeLabel.visible ? 'inherit' : 'hidden')\n    .attr('font-size', state.edgeLabel.size);\n}\n\n\nfunction updateNodeCoords(selection) {\n  selection.attr('transform', d => `translate(${d.x}, ${d.y})`);\n}\n\n\nfunction updateEdgeCoords(selection) {\n  selection.attr('transform', d => `translate(${d.sx}, ${d.sy})`);\n  selection.select('.edge-line')\n    .attr('x1', 0)\n    .attr('y1', 0)\n    .attr('x2', d => d.tx - d.sx)\n    .attr('y2', d => d.ty - d.sy);\n  selection.select('.edge-label')\n    .attr('x', d => (d.tx - d.sx) / 2)\n    .attr('y', d => (d.ty - d.sy) / 2);\n}\n\n\nfunction updateAttrs(selection, state) {\n  selection.select('.nw-nodes').call(updateNodeAttrs, state);\n  selection.select('.nw-edges').call(updateEdgeAttrs, state);\n}\n\n\nfunction updateComponents(selection, state) {\n  const nodesToRender = state.nodesToRender();\n  const numNodes = nodesToRender.length;\n  if (state.enableFocusedView) {\n    state.focusedView = numNodes < state.focusedViewThreshold;\n  }\n  if (state.enableOverlookView) {\n    state.overlookView = numNodes > state.overlookViewThreshold;\n  }\n  const edgesToRender = state.overlookView ? [] : state.edgesToRender();\n  selection.select('.nw-nodes')\n    .call(updateNodes, nodesToRender, state.focusedView);\n  selection.select('.nw-edges')\n    .call(updateEdges, edgesToRender);\n  selection.call(updateAttrs, state);\n  // Rebind event listeners\n  if (state.zoomListener) {\n    selection.call(state.zoomListener);\n  }\n  if (state.dragListener) {\n    selection.select('.nw-nodes').selectAll('.node')\n      .call(state.dragListener);\n  }\n}\n\n\nfunction moveNode(selection, x, y) {\n  selection.attr('transform', `translate(${x}, ${y})`);\n}\n\n\nfunction moveEdge(selection, sx, sy, tx, ty) {\n  selection.attr('transform', `translate(${sx}, ${sy})`);\n  selection.select('.edge-line')\n    .attr('x1', 0)\n    .attr('y1', 0)\n    .attr('x2', tx - sx)\n    .attr('y2', ty - sy);\n  selection.select('.edge-label')\n    .attr('x', (tx - sx) / 2)\n    .attr('y', (ty - sy) / 2);\n}\n\n\nfunction move(selection, node, x, y) {\n  const n = d3.select(node).call(moveNode, x, y).datum();\n  selection.select('.nw-edges')\n    .selectAll(\".link\")\n    .filter(d => n.adjacency.map(e => e[1]).includes(d.num))\n    .each(function (d) {\n      if (n.index === d.source.index || n.index === d.source) {\n        d3.select(this).call(moveEdge, x, y, d.tx, d.ty);\n      } else if (n.index === d.target.index || n.index === d.target) {\n        d3.select(this).call(moveEdge, d.sx, d.sy, x, y);\n      }\n    });\n}\n\n\nfunction transform(selection, tx, ty, tk) {\n  selection.select('.nw-field')\n    .attr('transform', `translate(${tx}, ${ty}) scale(${tk})`);\n}\n\n\nfunction resizeViewBox(selection, width, height) {\n  selection.attr('viewBox', `0 0 ${width} ${height}`);\n  selection.select('.nw-view-boundary')\n    .attr('width', width)\n    .attr('height', height);\n}\n\n\nexport default {\n  updateNodes, updateEdges, updateNodeCoords, updateEdgeCoords,\n  updateNodeAttrs, updateEdgeAttrs, updateAttrs, updateComponents,\n  move, transform, resizeViewBox\n};\n","\n/** @module network/view */\n\nimport {default as component} from './component.js';\n\n\nfunction networkViewFrame(selection, state) {\n  selection\n    .style('width', '100%')\n    .style('height', '100%');\n  selection.select('.nw-view').remove(); // Clean up\n  selection.append('svg')\n    .classed('nw-view', true);\n  selection.call(resize, state);\n}\n\n\nfunction resize(selection, state) {\n  const area = selection.node();\n  state.setViewBox(area.offsetWidth, area.offsetHeight);\n  selection.select('.nw-view')\n    .call(component.resizeViewBox, area.offsetWidth, area.offsetHeight);\n}\n\n\nfunction networkView(selection, state) {\n  selection\n    .attr('preserveAspectRatio', 'xMinYMin meet')\n    .attr('pointer-events', 'all')\n    .attr('viewBox', `0 0 ${state.viewBox.right} ${state.viewBox.bottom}`)\n    .style('width', '100%')\n    .style('height', '100%');\n\n  // Clean up\n  selection.select('.nw-view-boundary').remove();\n  selection.select('.nw-field').remove();\n\n  // Render\n  selection.append('rect')\n      .classed('nw-view-boundary', true)\n      .attr('x', 0)\n      .attr('y', 0)\n      .attr('width', state.viewBox.right)\n      .attr('height', state.viewBox.bottom)\n      .attr('fill', '#ffffff')\n      .attr('stroke-width', 1)\n      .attr('stroke', '#cccccc');\n  const field = selection.append('g')\n      .classed('nw-field', true)\n      .style('opacity', 1e-6);\n  field.transition()\n      .duration(1000)\n      .style('opacity', 1);\n  const edges = field.append('g').classed('nw-edges', true);\n  const nodes = field.append('g').classed('nw-nodes', true);\n\n  // Set notifiers\n  state.updateComponentNotifier = () => {\n    selection.call(component.updateComponents, state);\n  };\n  state.updateNodeNotifier = () => {\n    nodes.call(component.updateNodes, state.nodesToRender());\n  };\n  state.updateEdgeNotifier = () => {\n    edges.call(component.updateEdges, state.edgesToRender());\n  };\n  state.updateNodeAttrNotifier = () => {\n    nodes.call(component.updateNodeAttrs, state);\n  };\n  state.updateEdgeAttrNotifier = () => {\n    edges.call(component.updateEdgeAttrs, state);\n  };\n\n  // Update graph components\n  selection.call(component.updateComponents, state);\n}\n\n\nexport default {\n  networkViewFrame, resize, networkView\n};\n","\n/** @module network/interaction */\n\nimport d3 from 'd3';\n\nimport {default as component} from './component.js';\n\n\nfunction dragListener(selection, state) {\n  return d3.drag()\n    .on('drag', function () {\n      selection.call(component.move, this, d3.event.x, d3.event.y);\n    })\n    .on('end', function (d) {\n      state.setCoords(d.index, d3.event.x, d3.event.y);\n    });\n}\n\n\nfunction zoomListener(selection, state) {\n  return d3.zoom()\n    .on('zoom', function() {\n      const t = d3.event.transform;\n      selection.call(component.transform, t.x, t.y, t.k);\n      // Smooth transition\n      if (!state.focusedView) {\n        const p = state.prevTransform;\n        const xMoved = t.x > p.x + 20 || t.x < p.x - 20;\n        const yMoved = t.y > p.y + 20 || t.y < p.y - 20;\n        const zoomIn = t.k > p.k;\n        if (xMoved || yMoved && !zoomIn) {\n          state.setTransform(t.x, t.y, t.k);\n          state.prevTransform = {x: t.x, y: t.y, k: t.k};\n          selection\n            .call(component.updateComponents, state);\n        }\n      }\n    })\n    .on('end', function() {\n      const t = d3.event.transform;\n      state.setTransform(t.x, t.y, t.k);\n      state.prevTransform = {x: t.x, y: t.y, k: t.k};\n      selection\n        .call(component.updateComponents, state);\n    });\n}\n\n\nfunction setInteraction(selection, state) {\n  state.zoomListener = zoomListener(selection, state);\n  state.dragListener = dragListener(selection, state);\n  selection.call(state.zoomListener);\n  selection.select('.nw-nodes')\n    .selectAll('.node')\n      .call(state.dragListener);\n  state.fitNotifier = () => {\n    selection.call(fit, state);\n  };\n  // Resume zoom event\n  const t = state.transform;\n  selection\n      .call(component.transform, t.x, t.y, t.k)\n      .call(\n        d3.zoom().transform,\n        d3.zoomIdentity.translate(t.x, t.y).scale(t.k)\n      );\n\n}\n\n\nfunction fit(selection, state) {\n  const viewBox = selection.select('.nw-view-boundary').node().getBBox();\n  const viewBoxRatio = viewBox.width / viewBox.height;\n  const boundaryHeight = state.boundary.bottom - state.boundary.top;\n  const boundaryWidth = state.boundary.right - state.boundary.left;\n  const boundaryRatio = boundaryWidth / boundaryHeight;\n  const scale = viewBoxRatio >= boundaryRatio\n    ? viewBox.height / boundaryHeight\n    : viewBox.width / boundaryWidth;\n  const tx = -state.boundary.left * scale;\n  const ty = -state.boundary.top * scale;\n  state.setTransform(tx, ty, scale);\n  selection\n      .call(component.updateComponents, state)\n      .call(component.transform, tx, ty, scale)\n      .call(\n        d3.zoom().transform,\n        d3.zoomIdentity.translate(tx, ty).scale(scale)\n      );\n}\n\n\nexport default {\n  dragListener, zoomListener, setInteraction, fit\n};\n","\n/** @module network/force */\n\nimport d3 from 'd3';\n\nimport {default as component} from './component.js';\nimport {default as interaction} from './interaction.js';\n\n\nfunction forceSimulation(width, height) {\n  return d3.forceSimulation()\n    .force('link',\n      d3.forceLink().id(d => d.index)\n        .distance(60)\n        .strength(1))\n    .force('charge',\n      d3.forceManyBody()\n        .strength(-600)\n        .distanceMin(15)\n        .distanceMax(720))\n    .force('collide',\n      d3.forceCollide()\n        .radius(90))\n    .force('center',\n      d3.forceCenter(width / 2, height / 2))\n    .force('x',\n      d3.forceX()\n        .strength(0.002))\n    .force('y',\n      d3.forceY()\n        .strength(0.002))\n    .stop();\n}\n\n\nfunction forceDragListener(selection, simulation, state) {\n  return d3.drag()\n    .on('start', () => {\n      if (!d3.event.active) selection.call(relax, simulation, state);\n    })\n    .on('drag', d => {\n      d.fx = d3.event.x;\n      d.fy = d3.event.y;\n    })\n    .on('end', d => {\n      if (!d3.event.active) simulation.alphaTarget(0);\n      d.fx = null;\n      d.fy = null;\n    });\n}\n\n\nfunction end(selection, simulation, state) {\n  const coords = state.nodes.map(e => ({x: e.x, y: e.y}));\n  state.setAllCoords(coords);\n  selection\n    .call(component.updateComponents, state);\n}\n\n\nfunction stick(selection, simulation, state) {\n  simulation.alpha(0).stop();\n  selection.select('.nw-nodes').selectAll('.node')\n    .each(d => {\n      d.fx = d.x;\n      d.fy = d.y;\n    });\n  state.dragListener = interaction.dragListener(selection, state);\n  selection.call(end, simulation, state);\n}\n\n\nfunction unstick(selection, simulation, state) {\n  selection.select('.nw-nodes').selectAll('.node')\n    .each(d => {\n      d.fx = null;\n      d.fy = null;\n    });\n  state.dragListener = forceDragListener(selection, simulation, state);\n  // Render all nodes and do not render edges\n  // TODO: edge rendering behavior should be changed by data size or setting\n  const coords = state.nodes.map(e => ({x: e.x, y: e.y}));\n  state.setAllCoords(coords);\n  selection\n    .call(component.updateComponents, state);\n}\n\n\nfunction relax(selection, simulation, state) {\n  selection.call(unstick, simulation, state);\n  simulation.alpha(0.1).restart();\n}\n\n\nfunction restart(selection, simulation, state) {\n  selection.call(unstick, simulation, state);\n  simulation.alpha(1).restart();\n}\n\n\nfunction setForce(selection, simulation, state) {\n  const forceEdges = state.edges\n    .filter(e => e.weight >= state.networkThreshold);\n  simulation.nodes(state.nodes)\n    .force('link').links(forceEdges);\n}\n\n\nfunction activate(selection, simulation, state) {\n  simulation\n    .on('tick', () => {\n      selection.select('.nw-nodes').selectAll(\".node\")\n        .call(component.updateNodeCoords);\n      const coords = state.nodes.map(e => ({x: e.x, y: e.y}));\n      state.setAllCoords(coords);\n      selection.select('.nw-edges').selectAll(\".link\")\n        .call(component.updateEdgeCoords);\n      state.tickCallback(simulation);\n    })\n    .on('end', () => {\n      selection.call(end, simulation, state);\n      state.tickCallback(simulation);\n    });\n  state.setForceNotifier = () => {\n    selection.call(setForce, simulation, state);\n  };\n  state.stickNotifier = () => {\n    selection.call(stick, simulation, state);\n  };\n  state.relaxNotifier = () => {\n    selection.call(relax, simulation, state);\n  };\n  state.restartNotifier = () => {\n    selection.call(restart, simulation, state);\n  };\n  state.setForceNotifier();\n  if (state.simulationOnLoad) {\n    selection.call(restart, simulation, state);\n  } else {\n    selection.call(stick, simulation, state);\n  }\n}\n\n\nexport default {\n  forceSimulation, activate, stick, relax, restart\n};\n","\n/** @module common/mapper */\n\nimport _ from 'lodash';\n\nimport {default as misc} from './misc.js';\n\n\n/**\n * Convert single field mapping to multi field mapping\n * @param {object} mapping - single field mapping\n * @return {object} multi field mapping\n */\nfunction singleToMulti(mapping) {\n  const newMapping = {};\n  Object.entries(mapping.mapping).forEach(m => {\n    newMapping[m[0]] = [m[1]];\n  });\n  return {\n    created: mapping.created,\n    fields: [mapping.field],\n    key: mapping.key,\n    mapping: newMapping\n  };\n}\n\n\n/**\n * Convert field mapping to table\n * @param {object} mapping - field mapping\n * @return {object} table object\n */\nfunction mappingToTable(mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  const keyField = {key: mp.key, format: 'text'};\n  const data = {\n    fields: misc.defaultFieldProperties([keyField].concat(mp.fields)),\n    records: Object.entries(mp.mapping).map(entry => {\n      const rcd = {};\n      rcd[mp.key] = entry[0];\n      mp.fields.forEach((f, i) => {\n        rcd[f.key] = entry[1][i];\n      });\n      return rcd;\n    })\n  };\n  return data;\n}\n\n\n/**\n * Convert table to field mapping\n * @param {object} table - table\n * @param {object} key - key\n * @return {object} field mapping\n */\nfunction tableToMapping(table, key, ignore=['index']) {\n  const now = new Date();\n  const mapping = {\n    created: now.toString(),\n    fields: misc.defaultFieldProperties(table.fields\n      .filter(e => e.key !== key)\n      .filter(e => !ignore.includes(e.key))),\n    key: key,\n    mapping: {}\n  };\n  table.records.forEach(row => {\n    mapping.mapping[row[key]] = mapping.fields.map(e => row[e.key]);\n  });\n  return mapping;\n}\n\n\n/**\n * Convert csv text to field mapping\n * @param {string} csvString - csv data text\n * @return {object} field mapping\n */\nfunction csvToMapping(csvString) {\n  const lines = csvString.split(/\\n|\\r|\\r\\n/);\n  const header = lines.shift().split(',');\n  const key = header.shift();\n  const now = new Date();\n  const headerIdx = [];\n  const fields = [];\n  header.forEach((h, i) => {\n    if (h === '') return;\n    headerIdx.push(i);\n    fields.push({key: h, format: 'text'});\n  });\n  const mapping = {\n    created: now.toString(),\n    fields: misc.defaultFieldProperties(fields),\n    key: key,\n    mapping: {}\n  };\n  lines.forEach(line => {\n    const values = line.split(',');\n    const k = values.shift();\n    mapping.mapping[k] = Array(headerIdx.length);\n    headerIdx.forEach(i => {\n      mapping.mapping[k][i] = values[i];\n    });\n  });\n  return mapping;\n}\n\n\n/**\n * Apply mapping to the data (in-place)\n * @param {object} data - datatable JSON\n * @param {object} mapping - mapping JSON\n * @return {undefined} undefined\n */\nfunction apply(data, mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  data.records\n    .filter(rcd => mp.mapping.hasOwnProperty(rcd[mp.key]))\n    .forEach(rcd => {\n      mp.fields.forEach((fd, i) => {\n        rcd[fd.key] = mp.mapping[rcd[mp.key]][i];\n      });\n    });\n  data.fields =  _(data.fields)\n    .concat(misc.defaultFieldProperties(mp.fields))\n    .uniqBy('key')\n    .value();\n}\n\nexport default {\n  singleToMulti, mappingToTable, tableToMapping, csvToMapping, apply\n};\n","\n/** @module component/modal */\n\nimport d3 from 'd3';\n\n\nfunction dialogBase(selection, id) {\n  selection\n      .classed('modal', true)\n      .attr('tabindex', -1)\n      .attr('role', 'dialog')\n      .attr('aria-labelledby', '')\n      .attr('aria-hidden', true)\n      .attr('id', id);\n  selection.select('.modal-dialog').remove();  // Clean up\n  selection.append('div')\n      .classed('modal-dialog', true)\n      .attr('role', 'document')\n    .append('div')\n      .classed('modal-content', true);\n}\n\n\nfunction confirmDialog(selection, id, message) {\n  const base = selection.call(dialogBase, id)\n      .select('.modal-content');\n  // body\n  base.append('div')\n      .classed('modal-body', true)\n    .append('div')\n      .classed('message', true)\n      .text(message);\n  // footer\n  const footer = base.append('div')\n      .classed('modal-footer', true);\n  footer.append('button')\n      .classed('btn', true)\n      .classed('btn-outline-secondary', true)\n      .classed('cancel', true)\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .text('Cancel');\n  footer.append('button')\n      .classed('btn', true)\n      .classed('btn-warning', true)\n      .classed('ok', true)\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .attr('data-target', `${id}-submit`)\n      .text('OK')\n      .on('click', () => {\n        d3.select('#loading-icon').style('display', 'inline');\n        selection.dispatch('submit');\n      });\n}\n\n\nfunction submitDialog(selection, id, title) {\n  const base = selection.call(dialogBase, id)\n      .select('.modal-content');\n  // header\n  const header = base.append('div')\n      .classed('modal-header', true);\n  header.append('h4')\n      .classed('modal-title', true)\n      .text(title);\n  header.append('button')\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .attr('aria-label', 'Close')\n      .classed('close', true)\n    .append('span')\n      .attr('aria-hidden', true)\n      .html('&times;');\n  // body\n  base.append('div')\n      .classed('modal-body', true);\n  // footer\n  base.append('div')\n      .classed('modal-footer', true)\n    .append('button')\n      .classed('btn', true)\n      .classed('btn-primary', true)\n      .classed('submit', true)\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .attr('data-target', `${id}-submit`)\n      .text('Submit')\n      .on('click', () => {\n        d3.select('#loading-icon').style('display', 'inline');\n        selection.dispatch('submit');\n      });\n}\n\n\nexport default {\n  confirmDialog, submitDialog\n};\n","\n/** @module component/formBox */\n\n\nfunction textBox(selection, id, label, size, value) {  // TODO: remove size\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .attr('for', id)\n      .text(label);\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('id', id)\n      .attr('type', 'text')\n      .attr('size', size);\n  selection.call(updateTextBox, value);\n}\n\nfunction updateTextBox(selection, value) {\n  selection.select('input').property('value', value);\n}\n\nfunction textBoxValue(selection) {\n  return selection.select('input').property('value');\n}\n\n\nfunction readonlyBox(selection, id, label, value) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .attr('for', id)\n      .text(label);\n  selection.append('input')\n      .classed('form-control-plaintext', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('id', id)\n      .attr('type', 'text')\n      .property('readonly', true);\n  selection.call(updateTextBox, value);\n}\n\n\nfunction textareaBox(selection, id, label, rows, placeholder, value) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .attr('for', id)\n      .text(label);\n  selection.append('textarea')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('rows', rows)\n      .attr('placeholder', placeholder)\n      .attr('id', id);\n  selection.call(updateTextareaBox, value);\n}\n\nfunction updateTextareaBox(selection, value) {\n  selection.select('textarea').property('value', value);\n}\n\nfunction textareaBoxValue(selection) {\n  const value = selection.select('textarea').property('value');\n  if (value) return value;  // TODO: 0 is falsy\n  const placeholder = selection.select('textarea').attr('placeholder');\n  if (placeholder) return placeholder;\n  return '';\n}\n\nfunction textareaBoxLines(selection) {\n  const value = selection.select('textarea').property('value');\n  if (value) return value.split('\\n').filter(e => e.length > 0);\n  const placeholder = selection.select('textarea').attr('placeholder');\n  if (placeholder) return placeholder.split('\\n').filter(e => e.length > 0);\n  return [];\n}\n\n\nfunction checkBox(selection, id, label, checked) {\n  const box = selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('form-check', true)\n    .append('label')\n      .classed('form-check-label', true)\n      .classed('col-form-label-sm', true);\n  box.append('input')\n      .classed('form-check-input', true)\n      .attr('type', 'checkbox')\n      .attr('id', id);\n  box.append('span')\n      .text(label);\n  selection.call(updateCheckBox, checked);\n}\n\nfunction updateCheckBox(selection, checked) {\n  selection.select('input').property('checked', checked);\n}\n\nfunction checkBoxValue(selection) {\n  return selection.select('input').property('checked');\n}\n\n\nfunction numberBox(selection, id, label, min, max, step, value) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .attr('for', id)\n      .text(label);\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('id', id)\n      .attr('type', 'number')\n      .attr('min', min)\n      .attr('max', max)\n      .attr('step', step);\n  selection.call(updateNumberBox, value);\n}\n\nfunction updateNumberBox(selection, value) {\n  selection.select('input').property('value', value);\n}\n\nfunction numberBoxValue(selection) {\n  return selection.select('input').property('value');\n}\n\n\nfunction fileInputBox(selection, id, label, accept) {\nselection\n    .classed('form-group', true)\n    .classed('form-row', true);\nselection.append('label')\n    .classed('col-form-label', true)\n    .classed('col-form-label-sm', true)\n    .classed('col-4', true)\n    .attr('for', id)\n    .text(label);\nselection.append('input')\n    .classed('form-control', true)\n    .classed('form-control-sm', true)\n    .classed('form-control-file', true)\n    .classed('col-8', true)\n    .attr('type', 'file')\n    .attr('accept', accept)\n    .attr('id', id);\n}\n\nfunction fileInputBoxValue(selection) {\n  return selection.select('input').property('files')[0];\n}\n\n\nexport default {\n  textBox, updateTextBox, textBoxValue, readonlyBox,\n  textareaBox, updateTextareaBox, textareaBoxValue, textareaBoxLines,\n  checkBox, updateCheckBox, checkBoxValue,\n  numberBox, updateNumberBox, numberBoxValue,\n  fileInputBox, fileInputBoxValue\n};\n","\n/** @module dialog/community */\n\n\nimport {default as button} from '../component/button.js';\nimport {default as box} from '../component/formBox.js';\nimport {default as modal} from '../component/modal.js';\n\n\nconst id = 'community-dialog';\nconst title = 'Comunity detection';\n\n\nfunction menuLink(selection) {\n  selection.call(button.dropdownMenuModal, 'community', title, id);\n}\n\n\nfunction body(selection) {\n  const dialog = selection.call(modal.submitDialog, id, title);\n  // Name\n  dialog.select('.modal-body').append('div')\n      .classed('name', true)\n      .call(box.textBox, 'comm-name', 'New name', 40, 'comm_');\n  // Assign null to isolated nodes\n  dialog.select('.modal-body').append('div')\n      .classed('nulliso', true)\n      .call(box.checkBox, 'comm-nulliso', 'Assign null to isolated nodes', true);\n}\n\n\nfunction value(selection) {\n  return {\n    name: box.textBoxValue(selection.select('.name')),\n    nulliso: box.checkBoxValue(selection.select('.nulliso'))\n  };\n}\n\n\nexport default {\n  menuLink, body, value\n};\n","\n/** @module dialog/rename */\n\n\nimport {default as button} from '../component/button.js';\nimport {default as box} from '../component/formBox.js';\nimport {default as modal} from '../component/modal.js';\n\n\nconst id = 'rename-dialog';\nconst title = 'Rename';\n\n\nfunction menuLink(selection) {\n  selection.call(button.dropdownMenuModal, 'rename', title, id);\n}\n\n\nfunction body(selection, name) {\n  selection.call(modal.submitDialog, id, title)\n    .select('.modal-body').append('div')\n      .classed('rename', true)\n      .call(box.textBox, 'rename', 'New name', 40, name);\n}\n\n\nfunction updateBody(selection, state) {\n  selection.select('.rename')\n      .call(box.updateTextBox, state.data.name);\n}\n\n\nfunction value(selection) {\n  return box.textBoxValue(selection.select('.rename'));\n}\n\n\nexport default {\n  menuLink, body, updateBody, value\n};\n","\n/** @module component/formListBox */\n\nimport d3 from 'd3';\n\n\n/**\n * Render select box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction selectBox(selection, id, label, fields, value) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .attr('for', id)\n      .text(label);\n  selection.append('select')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('id', id);\n  if (fields) {\n    selection.call(selectBoxItems, fields);\n    selection.call(updateSelectBox, value);\n  }\n}\n\nfunction selectBoxItems(selection, items) {\n  const options = selection.select('select')\n    .selectAll('option')\n      .data(items, d => d.key);\n  options.exit().remove();\n  options.enter()\n    .append('option')\n      .attr('value', d => d.key)\n      .text(d => d.name);\n}\n\nfunction updateSelectBox(selection, value) {\n  selection.select('select').property('value', value);\n}\n\nfunction selectBoxValue(selection) {\n  return selection.select('select').property('value');\n}\n\n\n/**\n * Render select box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction checklistBox(selection, id, label, fields, values) {\n  // TODO: scroll\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('ul')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('id', id);\n  if (fields) {\n    selection.call(checklistBoxItems, fields);\n    selection.call(updateChecklistBox, values);\n  }\n}\n\nfunction checklistBoxItems(selection, items) {\n  const listitems = selection.select('ul')\n    .selectAll('li')\n      .data(items, d => d.key);\n  listitems.exit().remove();\n  const form = listitems.enter()\n    .append('li')\n      .attr('class', 'form-check')\n    .append('label')\n      .attr('class', 'form-check-label');\n  form.append('input')\n      .attr('type', 'checkbox')\n      .attr('class', 'form-check-input')\n      .property('value', d => d.key);\n  form.append('span')\n      .text(d => d.name);\n}\n\nfunction updateChecklistBox(selection, values) {\n  if (!values) return;\n  selection.selectAll('input')\n    .each(function (d) {\n      d3.select(this).property('checked', values.includes(d.key));\n    });\n}\n\nfunction checklistBoxValue(selection) {\n  return selection.selectAll('input:checked').data().map(d => d.key);\n}\n\n\nexport default {\n  selectBox, selectBoxItems, updateSelectBox, selectBoxValue,\n  checklistBox, checklistBoxItems, updateChecklistBox, checklistBoxValue\n};\n","\n/** @module component/formRangeBox */\n\nimport d3 from 'd3';\n\n\n/**\n * Render range box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction rangeBox(selection, id, label, range) {\n  selection\n      .classed('form-row', true)\n      .classed('align-items-center', true)\n      .attr('id', id);\n  selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .classed('mb-1', true)\n      .text(label);\n  const f = selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .classed('mb-1', true);\n  f.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('py-0', true)\n      .attr('for', `${id}-from`)\n      .text('min');\n  f.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('min', true)\n      .attr('type', 'text')\n      .attr('id', `${id}-from`);\n  const t = selection.append('div')\n      .classed('form-group', true)\n      .classed('col-4', true)\n      .classed('mb-1', true);\n  t.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('py-0', true)\n      .attr('for', `${id}-to`)\n      .text('max');\n  t.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('max', true)\n      .attr('type', 'text')\n      .attr('id', `${id}-to`);\n  // TODO: validation\n  // not null, undef, text\n  // min <= max\n  selection.call(updateRangeBox, range);\n}\n\n\nfunction updateRangeBox(selection, range) {\n  // TODO: validation\n  // not null, undef, text\n  // min <= max\n  selection.select('.min').property('value', range[0]);\n  selection.select('.max').property('value', range[1]);\n}\n\n\nfunction rangeBoxValue(selection) {\n  return [\n    parseFloat(selection.select('.min').property('value')),\n    parseFloat(selection.select('.max').property('value'))\n  ];\n}\n\n\n/**\n * Render color scale box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction colorScaleBox(selection, id, label, range) {\n  selection\n      .classed('form-row', true)\n      .classed('align-items-center', true)\n      .attr('id', id);\n  selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-3', true)\n      .classed('mb-1', true)\n      .text(label);\n  const f = selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-3', true)\n      .classed('mb-1', true);\n  f.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('py-0', true)\n      .attr('for', `${id}-from`)\n      .text('min');\n  f.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('min', true)\n      .attr('type', 'color')\n      .attr('id', `${id}-from`);\n  const m = selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-3', true)\n      .classed('mb-1', true);\n  m.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('py-0', true)\n      .attr('for', `${id}-mid`)\n      .text('mid');\n  m.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('mid', true)\n      .attr('type', 'color')\n      .attr('id', `${id}-mid`);\n  const t = selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-3', true)\n      .classed('mb-1', true);\n  t.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('py-0', true)\n      .attr('for', `${id}-to`)\n      .text('max');\n  t.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('max', true)\n      .attr('type', 'color')\n      .attr('id', `${id}-to`);\n  selection\n      .call(updateColorScaleBox, range)\n      .on('change', () => {\n        // avoid update by mousemove on the colorpicker\n        d3.event.stopPropagation();\n      });\n}\n\n\nfunction updateColorScaleBox(selection, range) {\n  let rangeArray;\n  if (range.length == 2) {\n    rangeArray = [range[0], null, range[1]];\n  } else if (range.length == 3) {\n    rangeArray = [range[0], range[1], range[2]];\n  } else {\n    rangeArray = [null, null, null];\n  }\n  selection.select('.min')\n      .property('value', rangeArray[0])\n      .property('disabled', rangeArray[0] === null)\n      .style('opacity', rangeArray[0] === null ? 0.3 : null);\n  selection.select('.mid')\n      .attr('value', rangeArray[1])\n      .property('disabled', rangeArray[1] === null)\n      .style('opacity', rangeArray[1] === null ? 0.3 : null);\n  selection.select('.max')\n      .property('value', rangeArray[2])\n      .property('disabled', rangeArray[2] === null)\n      .style('opacity', rangeArray[2] === null ? 0.3 : null);\n}\n\n\nfunction colorScaleBoxValue(selection) {\n  const arr = [];\n  if (!selection.select('.min').property('disabled')) {\n    arr.push(selection.select('.min').property('value'));\n  }\n  if (!selection.select('.mid').property('disabled')) {\n    arr.push(selection.select('.mid').property('value'));\n  }\n  if (!selection.select('.max').property('disabled')) {\n    arr.push(selection.select('.max').property('value'));\n  }\n  return arr;\n}\n\n\nexport default {\n  rangeBox, updateRangeBox, rangeBoxValue,\n  colorScaleBox, updateColorScaleBox, colorScaleBoxValue\n};\n","\n/** @module component/formBoxGroup */\n\nimport d3 from 'd3';\n\nimport {default as lbox} from '../component/formListBox.js';\nimport {default as rbox} from '../component/formRangeBox.js';\nimport {default as scaledef} from '../common/scale.js';\n\n\n/**\n * Render color range control box group\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction colorRangeGroup(selection, id, palettes, rangeTypes, range) {\n  selection\n      .classed('mb-3', true);\n  selection.append('div')\n      .classed('palette', true)\n      .classed('mb-1', true)\n      .call(lbox.selectBox, `${id}-palette`, 'Color palette', palettes, 'hoge');\n  selection.append('div')\n      .classed('rangetype', true)\n      .classed('mb-1', true)\n      .call(\n        lbox.selectBox, `${id}-rangetype`, 'Range type', rangeTypes,\n        scaledef.colorRangeTypes.find(e => e.size === range.length).key\n      );\n  selection.append('div')\n      .classed('range', true)\n      .classed('mb-1', true)\n      .call(rbox.colorScaleBox, `${id}-range`, 'Range', range);\n  selection.call(updateColorRangeGroup, range);\n}\n\n\nfunction updateColorRangeGroup(selection, range) {\n  selection.select('.palette')\n      .call(\n        lbox.updateSelectBox,\n        scaledef.colorRangeTypes.find(e => e.size === range.length).key\n      )\n      .on('change', function () {\n        const value = lbox.selectBoxValue(d3.select(this));\n        const p = scaledef.colorPalettes.find(e => e.key === value);\n        const t = scaledef.colorRangeTypes.find(e => e.size === p.range.length);\n        selection.select('.rangetype').call(lbox.updateSelectBox, t.key);\n        selection.select('.range').call(rbox.updateColorScaleBox, p.range);\n      });\n  selection.select('.rangetype')\n      .on('change', function () {\n        const value = lbox.selectBoxValue(d3.select(this));\n        const size = scaledef.colorRangeTypes.find(e => e.key === value).size;\n        selection.select('.range').select('.min')\n            .property('disabled', size > 3)\n            .style('opacity', size <= 3 ? null : 0.3);\n        selection.select('.range').select('.mid')\n            .property('disabled', size !== 3)\n            .style('opacity', size === 3 ? null : 0.3);\n        selection.select('.range').select('.max')\n            .property('disabled', size > 3)\n            .style('opacity', size <= 3 ? null : 0.3);\n      });\n  selection.select('.range')\n      .call(rbox.updateColorScaleBox, range)\n      .on('focusin', () => {\n        selection.dispatch('change');\n      });\n}\n\n\nfunction colorRangeGroupValue(selection) {\n  const type = lbox.selectBoxValue(selection.select('.rangetype'));\n  const values = rbox.colorScaleBoxValue(selection.select('.range'));\n  if (!values.length) {\n    return scaledef.colorRangeTypes.find(e => e.key === type).range;\n  } else {\n    return values;\n  }\n}\n\n\n/**\n * Render scale and domain control box group\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction scaleBoxGroup(selection, id, presets, scaleTypes, scale, domain) {\n  selection\n      .classed('mb-3', true);\n  selection.append('div')\n      .classed('preset', true)\n      .classed('mb-1', true)\n      .call(lbox.selectBox, `${id}-preset`, 'Scale preset', presets, '');\n  selection.append('div')\n      .classed('scale', true)\n      .classed('mb-1', true)\n      .call(lbox.selectBox, `${id}-scale`, 'Scale type', scaleTypes, scale);\n  selection.append('div')\n      .classed('domain', true)\n      .classed('mb-1', true)\n      .call(rbox.rangeBox, `${id}-domain`, 'Domain', domain);\n  selection.call(updateScaleBoxGroup, scale, domain);\n}\n\n\nfunction updateScaleBoxGroup(selection, scale, domain) {\n  selection.select('.preset')\n    .on('change', function () {\n      const value = lbox.selectBoxValue(d3.select(this));\n      const p = scaledef.presets.find(e => e.key == value);\n      selection.select('.scale').call(lbox.updateSelectBox, p.scale);\n      selection.select('.domain').call(rbox.updateRangeBox, p.domain);\n    });\n  selection.select('.scale')\n      .call(lbox.updateSelectBox, scale)\n      .on('change', () => {\n        selection.select('.domain').dispatch('change');\n      });\n  selection.select('.domain')\n      .call(rbox.updateRangeBox, domain)\n      .on('change', function () {\n        const isLog = lbox.selectBoxValue(selection.select('.scale')) === 'log';\n        const domain = rbox.rangeBoxValue(d3.select(this));\n        const invalid = d => isNaN(d) || (isLog && d <= 0);\n        d3.select(this).select('.min')\n            .style('background-color', invalid(domain[0]) ? '#ffcccc' : '#ffffff');\n        d3.select(this).select('.max')\n            .style('background-color', invalid(domain[1]) ? '#ffcccc' : '#ffffff');\n      });\n}\n\n\nfunction scaleBoxGroupValue(selection) {\n  const scale = lbox.selectBoxValue(selection.select('.scale'));\n  const domain = rbox.rangeBoxValue(selection.select('.domain'));\n  return {scale: scale, domain: domain};\n}\n\n\nexport default {\n  colorRangeGroup, updateColorRangeGroup, colorRangeGroupValue,\n  scaleBoxGroup, updateScaleBoxGroup, scaleBoxGroupValue\n};\n","\n/** @module network/controlBox */\n\nimport d3 from 'd3';\n\nimport {default as misc} from '../common/misc.js';\nimport {default as scaledef} from '../common/scale.js';\n\nimport {default as box} from '../component/formBox.js';\nimport {default as lbox} from '../component/formListBox.js';\nimport {default as rbox} from '../component/formRangeBox.js';\nimport {default as button} from '../component/button.js';\nimport {default as group} from '../component/formBoxGroup.js';\n\n\nfunction mainControlBox(selection, state) {\n  // Zoom\n  selection.append('div')\n      .classed('mb-3', true)\n    .append('div')\n      .classed('fit', true)\n      .call(button.buttonBox, 'fit-to-screen', 'Fit to screen', 'primary');\n  // View modes\n  const viewModes = selection.append('div')\n      .classed('mb-3', true);\n    viewModes.append('div')\n      .classed('focused', true)\n      .classed('mb-1', true)\n      .call(box.checkBox, 'focused', 'Enable focused view', state.enableFocusedView);\n    viewModes.append('div')\n      .classed('overlook', true)\n      .classed('mb-1', true)\n      .call(box.checkBox, 'overlook', 'Enable overlook view', state.enableOverlookView);\n  // Network threshold\n  const thldGroup = selection.append('div')\n      .classed('mb-3', true);\n  thldGroup.append('div')\n      .classed('thld', true)\n      .classed('mb-1', true)\n      .call(box.numberBox, 'thld', 'Network threshold',\n            state.networkThresholdCutoff, 1.000, 0.01, state.networkThreshold);\n  thldGroup.append('div')\n      .classed('logd', true)\n      .classed('mb-1', true)\n      .call(box.readonlyBox, 'logd', 'logD', null);\n  // Force layout\n  const forceBox = selection.append('div')\n      .classed('form-group', true)\n      .classed('form-row', true);\n  forceBox.append('div')\n      .classed('col-6', true)\n    .append('span')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('mb-1', true)\n      .text('Temperature');\n  forceBox.append('div')\n      .classed('col-12', true)\n    .append('div')\n      .classed('temperature', true)\n      .classed('progress', true)\n    .append('div')\n      .classed('progress-bar', true)\n      .classed('w-30', true)\n      .attr('id', 'temperature')\n      .attr('role', 'progressbar')\n      .attr('aria-valuemin', 0)\n      .attr('aria-valuemax', 100);\n  forceBox.append('div')\n      .classed('col-12', true)\n    .append('div')\n      .classed('stick', true)\n      .classed('mb-1', true)\n      .call(box.checkBox, 'stick-nodes', 'Stick nodes', !state.simulationOnLoad);\n  forceBox.append('div')\n      .classed('col-12', true)\n    .append('div')\n      .classed('restart', true)\n      .classed('mb-1', true)\n      .call(button.buttonBox, 'restart-force', 'Activate', 'warning');\n\n  selection.call(updateMainControlBox, state);\n}\n\n\nfunction updateMainControlBox(selection, state) {\n  // Snapshot\n  selection.select('.snapshot')\n      .on('click', function () { state.snapshotNotifier(); });\n  // Zoom\n  selection.select('.fit')\n      .on('click', function () { state.fitNotifier(); });\n  // Focused view\n  selection.select('.focused')\n      .call(box.updateCheckBox, state.enableFocusedView)\n      .on('change', function () {\n        state.enableFocusedView = box.checkBoxValue(d3.select(this));\n        state.focusedView = box.checkBoxValue(d3.select(this));\n        state.updateComponentNotifier();\n      });\n  // Overlook view\n  selection.select('.overlook')\n      .call(box.updateCheckBox, state.enableOverlookView)\n      .on('change', function () {\n        state.enableOverlookView = box.checkBoxValue(d3.select(this));\n        state.overlookView = box.checkBoxValue(d3.select(this));\n        state.updateComponentNotifier();\n      });\n  // Network threshold\n  selection.select('.thld')\n      .call(box.updateNumberBox, state.networkThreshold)\n      .on('change', function () {\n        const value = box.numberBoxValue(d3.select(this));\n        state.networkThreshold = value;\n        state.updateComponentNotifier();\n        state.setForceNotifier();\n        const numEdges = state.edges.filter(e => e.weight >= value).length;\n        const n = state.nodes.length;\n        const combinations = n * (n - 1) / 2;\n        const logD = d3.format('.2f')(Math.log10(numEdges / combinations));\n        selection.select('.logd').call(box.updateTextBox, logD);\n      })\n      .dispatch('change');\n  // Force layout\n  state.tickCallback = (simulation) => {\n    const alpha = simulation.alpha();\n    const isStopped = alpha <= simulation.alphaMin();\n    const progress = parseInt(isStopped ? 0 : alpha * 100);\n    selection.select('.temperature')\n      .select('.progress-bar')\n        .classed('bg-success', isStopped)\n        .classed('bg-warning', !isStopped)\n        .style('width', `${progress}%`)\n        .attr('aria-valuenow', progress);\n  };\n  selection.select('.stick')\n      .call(box.updateCheckBox, !state.simulationOnLoad)\n      .on('change', function () {\n        const value = box.checkBoxValue(d3.select(this));\n        selection.select('.temperature')\n            .style('background-color', value ? '#a3e4d7' : '#e9ecef')\n          .select('.progress-bar')\n            .style('width', `0%`)\n            .attr('aria-valuenow', 0);\n        if (value) {\n          state.stickNotifier();\n        } else {\n          state.relaxNotifier();\n        }\n      });\n  selection.select('.restart')\n      .on('click', function () {\n        selection.select('.stick')\n            .call(box.updateCheckBox, false)\n            .dispatch('change');\n        state.restartNotifier();\n      });\n}\n\n\n\nfunction nodeColorControlBox(selection, state) {\n  selection.append('div')\n      .classed('field', true)\n      .call(\n        lbox.selectBox, 'color-field', 'Field',\n        state.data.nodes.fields.filter(e => misc.sortType(e.format) !== 'none'),\n        state.nodeColor.field || ''\n      );\n  selection.append('div')\n      .classed('range', true)\n      .call(\n        group.colorRangeGroup, 'color', scaledef.colorPalettes,\n        scaledef.colorRangeTypes, state.nodeColor.range\n      );\n  selection.append('div')\n      .classed('scale', true)\n      .call(\n        group.scaleBoxGroup, 'color', scaledef.presets,\n        scaledef.types.filter(e => e.key !== 'ordinal'),\n        state.nodeColor.scale, state.nodeColor.domain\n      );\n\n  selection.call(updateNodeColorControlBox, state);\n}\n\n\nfunction updateNodeColorControlBox(selection, state) {\n  selection.select('.field')\n    .call(lbox.updateSelectBox, state.nodeColor.field)\n    .on('change', function () {\n      state.nodeColor.field = lbox.selectBoxValue(d3.select(this));\n      state.updateNodeAttrNotifier();\n    });\n  selection.select('.range')\n    .call(group.updateColorRangeGroup, state.nodeColor.range)\n    .on('change', function () {\n      const values = group.colorRangeGroupValue(d3.select(this));\n      state.nodeColor.range = values;\n      if (values.length > 3) {\n        state.nodeColor.scale = 'ordinal';\n        selection.select('.scale').selectAll('select,input')\n          .property('disabled', true)\n          .style('opacity', 0.3);\n      } else {\n        selection.select('.scale').selectAll('select,input')\n          .property('disabled', false)\n          .style('opacity', null);\n      }\n      state.updateNodeAttrNotifier();\n    }\n  );\n  selection.select('.scale')\n    .call(group.updateScaleBoxGroup, state.nodeColor.scale, state.nodeColor.domain)\n    .on('change', function () {\n      const values = group.scaleBoxGroupValue(d3.select(this));\n      state.nodeColor.scale = values.scale;\n      state.nodeColor.domain = values.domain;\n      state.updateNodeAttrNotifier();\n    }\n  );\n}\n\n\nfunction nodeSizeControlBox(selection, state) {\n  selection.append('div')\n    .classed('field', true)\n    .call(\n      lbox.selectBox, 'size-field', 'Field',\n      state.data.nodes.fields.filter(e => misc.sortType(e.format) === 'numeric'),\n      state.nodeSize.field || ''\n    );\n  selection.append('div')\n    .classed('range', true)\n    .classed('mb-3', true)\n    .call(rbox.rangeBox, 'size-range', 'Range', state.nodeSize.range);\n  selection.append('div')\n    .classed('scale', true)\n    .call(\n      group.scaleBoxGroup, 'size',\n      scaledef.presets.filter(e => e.scale !== 'ordinal'),\n      scaledef.types.filter(e => e.key !== 'ordinal'),\n      state.nodeSize.scale, state.nodeSize.domain\n    );\n  selection.call(updateNodeSizeControlBox, state);\n}\n\n\nfunction updateNodeSizeControlBox(selection, state) {\n  selection.select('.field')\n    .call(lbox.updateSelectBox, state.nodeSize.field)\n    .on('change', function () {\n      state.nodeSize.field = lbox.selectBoxValue(d3.select(this));\n      state.updateNodeAttrNotifier();\n    });\n  selection.select('.range')\n    .call(rbox.updateRangeBox, state.nodeSize.range)\n    .on('change', function () {\n      state.nodeSize.range = rbox.rangeBoxValue(d3.select(this));\n      state.updateNodeAttrNotifier();\n    });\n  selection.select('.scale')\n    .call(group.updateScaleBoxGroup, state.nodeSize.scale, state.nodeSize.domain)\n    .on('change', function () {\n      const values = group.scaleBoxGroupValue(d3.select(this));\n      state.nodeSize.scale = values.scale;\n      state.nodeSize.domain = values.domain;\n      state.updateNodeAttrNotifier();\n    }\n  );\n}\n\n\nfunction nodeLabelControlBox(selection, state) {\n  // nodeLabel.visible\n  selection.append('div')\n    .append('div')\n      .classed('visible', true)\n      .call(box.checkBox, 'label-visible', 'Show node labels', state.nodeLabel.visible);\n  // nodeLabel\n  const labelGroup = selection.append('div')\n      .classed('mb-3', true);\n  labelGroup.append('div')\n      .classed('text', true)\n      .classed('mb-1', true)\n      .call(\n        lbox.selectBox, 'label-text', 'Text field',\n        state.data.nodes.fields.filter(e => misc.sortType(e.format) !== 'none'),\n        state.nodeLabel.text || ''\n      );\n  labelGroup.append('div')\n      .classed('size', true)\n      .classed('mb-1', true)\n      .call(\n        box.numberBox, 'label-size', 'Font size', 6, 100, 1, state.nodeLabel.size\n      );\n  // nodeLabelColor\n  selection.append('div')\n      .classed('field', true)\n      .call(\n        lbox.selectBox, 'label-field', 'Color field',\n        state.data.nodes.fields.filter(e => misc.sortType(e.format) !== 'none'),\n        state.nodeLabelColor.field || ''\n      );\n  selection.append('div')\n      .classed('range', true)\n      .call(\n        group.colorRangeGroup, 'label', scaledef.colorPalettes,\n        scaledef.colorRangeTypes, state.nodeLabelColor.range\n      );\n  selection.append('div')\n      .classed('scale', true)\n      .call(\n        group.scaleBoxGroup, 'label', scaledef.presets,\n        scaledef.types.filter(e => e.key !== 'ordinal'),\n        state.nodeLabelColor.scale, state.nodeLabelColor.domain\n      );\n  selection.call(updateNodeLabelControlBox, state);\n}\n\n\nfunction updateNodeLabelControlBox(selection, state) {\n  // nodeLabel.visible\n  selection.select('.visible')\n      .call(box.updateCheckBox, state.nodeLabel.visible)\n      .on('change', function () {\n        state.nodeLabel.visible = box.checkBoxValue(d3.select(this));\n        state.updateNodeAttrNotifier();\n      });\n  // nodeLabel\n  selection.select('.text')\n      .call(lbox.updateSelectBox, state.nodeLabel.text)\n      .on('change', function () {\n        state.nodeLabel.text = lbox.selectBoxValue(d3.select(this));\n        state.updateNodeAttrNotifier();\n      });\n  selection.select('.size')\n      .call(box.updateNumberBox, state.nodeLabel.size)\n      .on('change', function () {\n        state.nodeLabel.size = box.numberBoxValue(d3.select(this));\n        state.updateNodeAttrNotifier();\n      });\n  // nodeLabelColor\n  selection.select('.field')\n      .call(lbox.updateSelectBox, state.nodeLabelColor.field)\n      .on('change', function () {\n        state.nodeLabelColor.field = lbox.selectBoxValue(d3.select(this));\n        state.updateNodeAttrNotifier();\n      });\n  selection.select('.range')\n      .call(group.updateColorRangeGroup, state.nodeLabelColor.range)\n      .on('change', function () {\n        const values = group.colorRangeGroupValue(d3.select(this));\n        state.nodeLabelColor.range = values;\n        if (values.length > 3) {\n          state.nodeLabelColor.scale = 'ordinal';\n          selection.select('.scale').selectAll('select,input')\n            .property('disabled', true)\n            .style('opacity', 0.3);\n        } else {\n          state.nodeLabelColor.scale = lbox.selectBoxValue(selection.select('.range'));\n          selection.select('.scale').selectAll('select,input')\n            .property('disabled', false)\n            .style('opacity', null);\n        }\n        state.updateNodeAttrNotifier();\n      });\n  selection.select('.scale')\n      .call(\n        group.updateScaleBoxGroup, state.nodeLabelColor.scale,\n        state.nodeLabelColor.domain\n      )\n      .on('change', function () {\n        const values = group.scaleBoxGroupValue(d3.select(this));\n        state.nodeLabelColor.scale = values.scale;\n        state.nodeLabelColor.domain = values.domain;\n        state.updateNodeAttrNotifier();\n      }\n    );\n}\n\n\nfunction edgeControlBox(selection, state) {\n  // edgeLabel\n  const labelGroup = selection.append('div')\n      .classed('mb-3', true);\n  labelGroup.append('div')\n      .classed('label', true)\n      .classed('mb-1', true)\n      .call(\n        box.checkBox, 'edge-label-visible', 'Show edge weight label',\n        state.edgeLabel.visible\n      );\n  labelGroup.append('div')\n      .classed('size', true)\n      .classed('mb-1', true)\n      .call(\n        box.numberBox, 'edge-label-size', 'Weight label font size',\n        6, 100, 1, state.edgeLabel.size\n      );\n  // edgeWidth\n  const widthGroup = selection.append('div')\n      .classed('mb-3', true);\n  widthGroup.append('div')\n      .classed('range', true)\n      .classed('mb-3', true)\n      .call(rbox.rangeBox, 'edge-width-range', 'Range', state.edgeWidth.range);\n  widthGroup.append('div')\n      .classed('scale', true)\n      .classed('mb-1', true)\n      .call(\n        lbox.selectBox, 'edge-width-scale', 'Scale type',\n        scaledef.types.filter(e => e.key !== 'ordinal'), state.edgeWidth.scale\n      );\n  widthGroup.append('div')\n      .classed('domain', true)\n      .classed('mb-1', true)\n      .call(rbox.rangeBox, 'edge-width-domain', 'Domain', state.edgeWidth.domain);\n}\n\nfunction updateEdgeControlBox(selection, state) {\n  // edgeLabel\n  selection.select('.label')\n      .call(box.updateCheckBox, state.edgeLabel.visible)\n      .on('change', function () {\n        state.edgeLabel.visible = box.checkBoxValue(d3.select(this));\n        state.updateEdgeAttrNotifier();\n      });\n  selection.select('.size')\n      .call(box.updateNumberBox, state.edgeLabel.size)\n      .on('change', function () {\n        state.edgeLabel.size = box.numberBoxValue(d3.select(this));\n        state.updateEdgeAttrNotifier();\n      });\n  // edgeWidth\n  selection.select('.range')\n      .call(rbox.updateRangeBox, state.edgeWidth.range)\n      .on('change', function () {\n        state.edgeWidth.range = rbox.rangeBoxValue(d3.select(this));\n        state.updateEdgeAttrNotifier();\n      });\n  selection.select('.scale')\n      .call(lbox.updateSelectBox, state.edgeWidth.scale)\n      .on('change', function () {\n        state.edgeWidth.scale = lbox.selectBoxValue(d3.select(this));\n        state.updateEdgeAttrNotifier();\n      });\n  selection.select('.domain')\n      .call(rbox.updateRangeBox, state.edgeWidth.domain)\n      .on('change', function () {\n        state.edgeWidth.domain = rbox.rangeBoxValue(d3.select(this));\n        state.updateEdgeAttrNotifier();\n      });\n}\n\n\nfunction controlBoxFrame(selection, navID, contentID) {\n  selection.append('nav')\n    .append('div')\n      .classed('nav', true)\n      .classed('nav-tabs', true)\n      .attr('id', navID)\n      .attr('role', 'tablist');\n  selection.append('div')\n      .classed('tab-content', true)\n      .classed('p-2', true)\n      .attr('id', contentID);\n}\n\n\nfunction controlBoxNav(selection, id, label) {\n  selection\n      .classed('nav-item', true)\n      .classed('nav-link', true)\n      .classed('py-1', true)\n      .attr('id', `${id}-tab`)\n      .attr('data-toggle', 'tab')\n      .attr('href', `#${id}`)\n      .attr('role', 'tab')\n      .attr('aria-controls', id)\n      .attr('aria-selected', 'false')\n      .text(label);\n}\n\n\nfunction controlBoxItem(selection, id) {\n  selection\n      .classed('tab-pane', true)\n      .classed('fade', true)\n      .classed('container', true)\n      .classed('px-0', true)\n      .attr('id', id)\n      .attr('role', 'tabpanel')\n      .attr('aria-labelledby', `${id}-tab`);\n}\n\n\nfunction controlBox(selection, state) {\n  // Clean up\n  selection.select('nav').remove();\n  selection.select('.tab-content').remove();\n\n  selection.call(\n    controlBoxFrame, 'control-frame-nav', 'control-frame-content');\n  const tabs = selection.select('.nav-tabs');\n  const content = selection.select('.tab-content');\n\n  // Main\n  tabs.append('a')\n      .classed('active', true)\n      .attr('aria-selected', 'true')\n      .call(controlBoxNav, 'control-main', 'Main');\n  content.append('div')\n      .classed('show', true)\n      .classed('active', true)\n      .classed('control-main', true)\n      .call(controlBoxItem, 'control-main')\n      .call(mainControlBox, state);\n\n  // Color\n  tabs.append('a')\n      .call(controlBoxNav, 'control-color', 'Color');\n  content.append('div')\n      .classed('control-color', true)\n      .call(controlBoxItem, 'control-color')\n      .call(nodeColorControlBox, state);\n\n  // Size\n  tabs.append('a')\n      .call(controlBoxNav, 'control-size', 'Size');\n  content.append('div')\n      .classed('control-size', true)\n      .call(controlBoxItem, 'control-size')\n      .call(nodeSizeControlBox, state);\n\n  // Label\n  tabs.append('a')\n      .call(controlBoxNav, 'control-label', 'Label');\n  content.append('div')\n      .classed('control-label', true)\n      .call(controlBoxItem, 'control-label')\n      .call(nodeLabelControlBox, state);\n\n  // Edge\n  tabs.append('a')\n      .call(controlBoxNav, 'control-edge', 'Edge');\n  content.append('div')\n      .classed('control-edge', true)\n      .call(controlBoxItem, 'control-edge')\n      .call(edgeControlBox, state);\n\n  selection.call(updateControlBox, state);\n}\n\n\nfunction updateControlBox(selection, state) {\n  selection.select('.control-main')\n      .call(updateMainControlBox, state);\n  selection.select('.control-color')\n      .call(updateNodeColorControlBox, state);\n  selection.select('.control-size')\n      .call(updateNodeSizeControlBox, state);\n  selection.select('.control-label')\n      .call(updateNodeLabelControlBox, state);\n  selection.select('.control-edge')\n      .call(updateEdgeControlBox, state);\n}\n\n\nexport default {\n  controlBox, updateControlBox\n};\n","\n/** @module network/communityDetection */\n\nimport jLouvain from 'jLouvain';\n\n\nexport function communityDetection(nodes, edges, option) {\n  // TODO: partition resolution setting\n  // TODO: Error at edges.length 0\n  if (!edges.length) {\n    const community = {};\n    nodes.forEach(e => { community[e] = option.nulliso ? null : e; });\n    return community;\n  }\n  const clusters = {};\n  const community = jLouvain().nodes(nodes).edges(edges)();\n  Object.entries(community).forEach(e => {\n    if (!clusters.hasOwnProperty(e[1])) {\n      clusters[e[1]] = [];\n    }\n    clusters[e[1]].push(e[0]);\n  });\n  // Sort by cluster size\n  Object.entries(clusters)\n    .sort((a, b) => a[1].length < b[1].length)\n    .forEach((cluster, i) => {\n      if (cluster[1].length === 1) {\n        community[cluster[1][0]] = option.nulliso ? null : i;\n      } else {\n        cluster[1].forEach(e => {\n          community[e] = i;\n        });\n      }\n    });\n  return community;\n}\n\n\nexport default {\n  communityDetection\n};\n","\n/** @module network/networkApp */\n\nimport d3 from 'd3';\n\nimport {default as core} from '../common/core.js';\nimport {default as hfile} from '../common/file.js';\nimport {default as idb} from '../common/idb.js';\nimport {default as mapper} from '../common/mapper.js';\nimport {default as misc} from '../common/misc.js';\nimport {default as scale} from '../common/scale.js';\n\nimport {default as button} from '../component/button.js';\nimport {default as modal} from '../component/modal.js';\n\nimport {default as communityDialog} from '../dialog/community.js';\nimport {default as renameDialog} from '../dialog/rename.js';\n\nimport {default as view} from './view.js';\nimport {default as control} from './controlBox.js';\nimport {default as interaction} from './interaction.js';\nimport {default as force} from './force.js';\nimport {default as community} from './communityDetection.js';\nimport NetworkState from './state.js';\n\n\nfunction getGraph(storeID) {\n  return idb.getItemByID(storeID)\n    .then(edges => {\n      return idb.getItemByID(edges.reference.nodes)\n        .then(nodes => {\n          return {edges: edges, nodes: nodes};\n        });\n    });\n}\n\n\nfunction app(data) {\n  // TODO: define field size according to the data size\n  const width = 1200;\n  const height = 1200;\n  const state = new NetworkState(data, width, height);\n  const simulation = force.forceSimulation(width, height);\n  const frame = d3.select('#nw-frame')\n      .call(view.networkViewFrame, state);\n  frame.select('.nw-view')\n      .call(view.networkView, state)\n      .call(interaction.setInteraction, state)\n      .call(force.activate, simulation, state);\n  d3.select('#nw-control')\n      .call(control.controlBox, state);\n\n  // Resize window\n  window.onresize = () =>\n    d3.select('#nw-frame').call(view.resize, state);\n\n  // Menubar\n  const menubar = d3.select('#menubar');\n  menubar.selectAll('div,span,a').remove();\n  // Network view control\n  const menu = menubar.append('div')\n      .call(button.dropdownMenuButton, null, 'View control', 'primary')\n      .select('.dropdown-menu');\n  menu.append('a')\n      .classed('communityd', true)\n      .call(communityDialog.menuLink);\n  menu.append('a')\n      .classed('renamed', true)\n      .call(renameDialog.menuLink);\n  menu.append('a')\n      .classed('saveview', true)\n      .call(button.dropdownMenuItem, null, 'Save to local storage')\n      .on('click', function () {\n        if (state.data.edges.storeID) {\n          return idb.updateItem(state.data.edges.storeID, item => {\n            item.id = misc.uuidv4();\n            item.name = state.data.edges.name;\n            item.snapshot = state.snapshot();\n          })\n          .then(() => console.info('Snapshot saved'));\n        } else {\n          const data = state.export();\n          return idb.putItem(data.nodes)\n            .then(storeID => {\n              data.edges.reference.nodes = storeID;\n              return idb.putItem(data.edges);\n            })\n            .then(storeID => {\n              window.location = `network.html?id=${storeID}`;\n            });\n        }\n      });\n  menu.append('a')\n      .call(button.dropdownMenuItem, null, 'Export to JSON')\n      .on('click', () => {\n        const data = state.export();\n        // Delete local store information\n        delete data.nodes.storeID;\n        delete data.edges.storeID;\n        delete data.edges.reference.nodes;\n        hfile.downloadJSON(data, data.edges.name);\n      });\n  if (state.data.nodes.storeID) {\n    // Node datagrid link\n    menubar.append('a')\n        .call(button.menuButtonLink, null, 'Node datagrid', 'outline-secondary')\n        .attr('href', `datagrid.html?id=${state.data.nodes.storeID}`)\n        .attr('target', '_blank');\n  }\n  // Control panel\n  menubar.append('a')\n      .call(button.menuButtonLink, null, 'Control panel', 'outline-secondary')\n      .attr('href', 'control.html')\n      .attr('target', '_blank');\n  // Fetch control\n  const ongoing = ['running', 'ready'].includes(state.data.edges.status);\n  if (ongoing) {\n    menubar.append('a')\n        .call(button.menuButtonLink, null, 'Refresh', 'outline-secondary')\n        .on('click', function () {\n          core.fetchProgress(state.data.edges.storeID)\n            .then(() => getGraph(state.data.edges.storeID))\n            .then(app);\n        });\n    menubar.append('a')\n        .call(button.menuButtonLink, null, 'Abort server job', 'warning')\n        .attr('data-toggle', 'modal')\n        .attr('data-target', '#abort-dialog');\n    menubar.append('span')\n        .classed('progress', true)\n      .append('progress')\n        .attr('max', 100)\n        .attr('value', state.data.edges.progress)\n        .text(`${state.data.edges.progress}%`);\n  }\n  menubar.append('span')\n    .classed('title', true)\n    .text(state.data.edges.name);\n  menubar.append('span')\n      .classed('status', true)\n      .text(`(${state.data.edges.status} - ${state.data.edges.records.length} connections created in ${state.data.edges.execTime} sec.)`);\n\n  // Dialogs\n  const dialogs = d3.select('#dialogs');\n  dialogs.selectAll('div').remove();  // Clean up\n  dialogs.append('div')\n      .classed('communityd', true)\n      .call(communityDialog.body);\n  dialogs.append('div')\n      .classed('renamed', true)\n      .call(renameDialog.body, state.data.edges.name);\n  dialogs.append('div')\n      .classed('abortd', true)\n      .call(\n        modal.confirmDialog, 'abort-dialog',\n        'Are you sure you want to abort this calculation job?'\n      );\n  updateApp(state);\n}\n\n\nfunction updateApp(state) {\n  // Title\n  d3.select('title').text(state.data.edges.name);\n  d3.select('#menubar').select('.title').text(state.data.edges.name);\n  // Dialogs\n  const dialogs = d3.select('#dialogs');\n  // Rename dialog\n  dialogs.select('.renamed')\n      .call(renameDialog.updateBody, state)\n      .on('submit', function () {\n        state.data.edges.name = renameDialog.value(d3.select(this));\n        updateApp(state);\n      });\n  // Abort dialog\n  dialogs.select('.abortd')\n      .on('submit', function () {\n        core.fetchProgress(state.data.edges.storeID, 'abort')\n          .then(() => getGraph(state.data.edges.storeID))\n          .then(app);\n      });\n  // Community dialog\n  dialogs.select('.communityd')\n      .on('submit', function () {\n        const value = communityDialog.value(d3.select(this));\n        const nodeIds = state.data.nodes.records.map(e => e.index);\n        const edges = state.data.edges.records\n          .filter(e => e.weight >= state.networkThreshold);\n        const comm = community.communityDetection(\n          nodeIds, edges, {nulliso: value.nulliso}\n        );\n        const mapping = {\n          key: 'index',\n          field: misc.defaultFieldProperties(\n            [{key: value.name, format: 'd3_format', d3_format: 'd'}]\n          )[0],\n          mapping: comm\n        };\n        mapper.apply(state.data.nodes, mapping);\n        state.nodeColor = {\n          field: value.name, scale: 'ordinal', domain: null,\n          range: scale.colorRangeTypes[3].range,\n          unknown: scale.colorRangeTypes[3].unknown\n        };\n        $('#community-dialog').modal('hide');  // TODO:\n        d3.select('#loading-icon').style('display', 'none');\n        app(state.export());\n      });\n}\n\n\nexport default {\n  getGraph, app, updateApp\n};\n","\n/** @module network */\n\nimport d3 from 'd3';\n\nimport {default as core} from './common/core.js';\nimport {default as hfile} from './common/file.js';\nimport {default as misc} from './common/misc.js';\n\nimport {default as button} from './component/button.js';\n\nimport NetworkState from './network/state.js';\nimport {default as view} from './network/view.js';\nimport {default as force} from './network/force.js';\nimport {default as interaction} from './network/interaction.js';\nimport {default as networkApp} from './network/networkApp.js';\n\n\nfunction run() {\n  // TODO: offline mode flags\n  const localFile = document.location.protocol !== \"file:\";  // TODO\n  const offLine = 'onLine' in navigator && !navigator.onLine;  // TODO\n  const storeID = misc.URLQuery().id || null;\n  const dataURL = misc.URLQuery().location || null;\n  if (storeID) {\n    // Load from IndexedDB store\n    return core.fetchProgress(storeID, 'update')\n      .then(() => networkApp.getGraph(storeID))\n      .then(networkApp.app);\n  } else if (dataURL) {\n    // Fetch via HTTP\n    return hfile.fetchJSON(dataURL)\n      .then(networkApp.app);\n  } else {\n    // New network\n    const menubar = d3.select('#menubar');\n    menubar.selectAll('div,a').remove();\n    const menu = menubar.append('div')\n        .call(button.dropdownMenuButton, null, '+ New network', 'primary')\n        .select('.dropdown-menu');\n    menu.append('a')\n        .call(button.dropdownMenuFile, 'import', 'Import view', '.gfc,.gfr,.json,.gz')\n        .on('change', function () {\n          const file = button.dropdownMenuFileValue(d3.select(this));\n          hfile.loadJSON(file).then(networkApp.app);\n        });\n    menubar.append('a')\n        .call(button.menuButton, null, 'Control panel', 'outline-secondary')\n        .attr('href', 'control.html')\n        .attr('target', '_blank');\n  }\n}\n\n\nexport default {\n  NetworkState, view, force, interaction, run\n};\n"],"names":["defaultFieldProperties","fields","map","e","hasOwnProperty","name","key","visible","format","sortType","fmt","includes","formatNum","value","d3format","Number","isNaN","parseFloat","d3","partialMatch","query","target","toString","toUpperCase","indexOf","URLQuery","pairs","window","location","search","substring","split","_","fromPairs","uuidv4","replace","c","r","Math","random","schema","items","idb","Dexie","version","stores","getAllItems","orderBy","reverse","toArray","getItemsByDataType","type","where","equals","sortBy","catch","err","console","error","getItemByID","storeID","first","deleteItem","delete","putItem","data","misc","put","updateItem","updateFunc","modify","reset","then","baseURL","get","url","q","Object","keys","length","JSON","stringify","fetch","credentials","res","status","Promise","reject","Error","statusText","resolve","json","response","text","blob","post","formdata","method","body","fetchProgress","command","id","reference","workflow","fetcher","item","progress","execTime","records","readFile","file","sizeLimit","reader","FileReader","truncated","slice","onload","event","result","onerror","readAsArrayBuffer","readAsText","parseJSON","compressed","pako","inflate","to","parse","downloadDataFile","URL","createObjectURL","Blob","a","document","createElement","download","href","dispatchEvent","MouseEvent","view","bubbles","cancelable","loadJSON","endsWith","fetchJSON","decoded","decodeURIComponent","arrayBuffer","downloadJSON","compress","str","gzip","buttonBox","selection","label","classed","append","attr","menuButton","menuButtonLink","menuModalLink","dropdownMenuButton","dropdownMenuItem","dropdownMenuModal","dropdownMenuFile","accept","on","select","this","node","click","style","dropdownMenuFileValue","files","statusConv","Queued","In progress","Aborting","Aborted","Completed","Failure","dataTypeConv","datatable","connection","v07_to_v08_nodes","columns","sort","dataType","schemaVersion","revision","taskCount","searchCount","doneCount","searchDoneCount","resultCount","recordCount","created","startDate","responseDate","v10_nodes","convertTable","forEach","i","index","structure","_structure","_index","v08_nodes","$schema","width","height","convertNetwork","edges","nodes","nodeFields","snp","fieldTransform","snapshot","nodePositions","nodeColor","nodeSize","nodeLabel","edge","scale","field","find","column","domain","range","unknown","size","nodeContent","nodeTableId","networkThreshold","v07_to_v08_edges","nodesID","idx_converter","source","v08_graph","nodeContentVisible","schemeCategory20","nodeLabelColor","edgeVisible","edgeWidth","edgeLabel","threshold","coords","params","v10_edges","NetworkState","[object Object]","focusedViewThreshold","enableFocusedView","focusedView","overlookViewThreshold","enableOverlookView","overlookView","legacy","n","adjacency","num","push","networkThresholdCutoff","transform","x","y","k","zoomListener","dragListener","updateComponentNotifier","updateNodeNotifier","updateEdgeNotifier","updateNodeAttrNotifier","updateEdgeAttrNotifier","snapShotNotifier","fitNotifier","setForceNotifier","stickNotifier","relaxNotifier","restartNotifier","tickCallback","forceField","top","right","bottom","left","viewBox","focusArea","boundary","prevTransform","simulationOnLoad","setAllCoords","setFocusArea","setBoundary","xs","ys","min","apply","max","tx","ty","tk","coordsList","nbr","sx","sy","filter","weight","types","func","scaleLinear","scaleLog","scaleQuantize","scaleOrdinal","colorRangeTypes","schemeCategory10","schemePaired","concat","schemeSet2","schemePastel2","schemeSet3","presets","colorPalettes","scaleFunction","sf","mid","clamp","d","undefined","svgWidth","svgHeight","updateNodes","showStruct","selectAll","exit","remove","entered","enter","call","updateNodeCoords","merged","merge","html","updateEdges","updateEdgeCoords","updateNodeAttrs","state","each","color","labelColor","d3_format","parseInt","updateEdgeAttrs","updateAttrs","moveNode","moveEdge","updateComponents","nodesToRender","numNodes","edgesToRender","move","datum","resizeViewBox","resize","area","setViewBox","offsetWidth","offsetHeight","component","networkViewFrame","networkView","transition","duration","drag","setCoords","zoom","t","p","xMoved","yMoved","zoomIn","setTransform","fit","getBBox","viewBoxRatio","boundaryHeight","boundaryWidth","zoomIdentity","translate","setInteraction","end","simulation","stick","alpha","stop","fx","fy","interaction","unstick","active","relax","alphaTarget","forceDragListener","restart","setForce","forceEdges","force","links","forceSimulation","forceLink","distance","strength","forceManyBody","distanceMin","distanceMax","forceCollide","radius","forceCenter","forceX","forceY","activate","singleToMulti","mapping","newMapping","entries","m","mappingToTable","mp","keyField","entry","rcd","f","tableToMapping","table","ignore","Date","row","csvToMapping","csvString","lines","header","shift","now","headerIdx","h","line","values","Array","fd","uniqBy","dialogBase","confirmDialog","message","base","footer","dispatch","submitDialog","title","updateTextBox","property","updateTextareaBox","updateCheckBox","checked","updateNumberBox","textBox","textBoxValue","readonlyBox","textareaBox","rows","placeholder","textareaBoxValue","textareaBoxLines","checkBox","box","checkBoxValue","numberBox","step","numberBoxValue","fileInputBox","fileInputBoxValue","menuLink","button","dialog","modal","nulliso","updateBody","selectBoxItems","options","updateSelectBox","checklistBoxItems","listitems","form","updateChecklistBox","selectBox","selectBoxValue","checklistBox","checklistBoxValue","updateRangeBox","updateColorScaleBox","rangeArray","rangeBox","rangeBoxValue","colorScaleBox","stopPropagation","colorScaleBoxValue","arr","updateColorRangeGroup","lbox","scaledef","rbox","updateScaleBoxGroup","isLog","invalid","colorRangeGroup","palettes","rangeTypes","colorRangeGroupValue","scaleBoxGroup","scaleTypes","scaleBoxGroupValue","mainControlBox","viewModes","thldGroup","forceBox","updateMainControlBox","snapshotNotifier","numEdges","combinations","logD","log10","isStopped","alphaMin","nodeColorControlBox","group","updateNodeColorControlBox","nodeSizeControlBox","updateNodeSizeControlBox","nodeLabelControlBox","labelGroup","updateNodeLabelControlBox","edgeControlBox","widthGroup","updateEdgeControlBox","controlBoxFrame","navID","contentID","controlBoxNav","controlBoxItem","updateControlBox","controlBox","tabs","content","communityDetection","option","community","clusters","jLouvain","b","cluster","getGraph","app","control","onresize","menubar","menu","communityDialog","renameDialog","info","export","hfile","core","dialogs","updateApp","nodeIds","comm","mapper","$","run","protocol","navigator","onLine","dataURL","networkApp"],"mappings":"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"}