{"version":3,"file":"kw-datagrid.js","sources":["../src/common/misc.js","../src/common/legacySchema.js","../src/common/mapper.js","../src/datagrid/rowFactory.js","../src/common/image.js","../src/component/formBox.js","../src/datagrid/component.js","../src/datagrid/view.js","../src/datagrid.js","../src/datagrid/state.js","../src/datagrid/rowFilter.js","../src/datagrid/sort.js"],"sourcesContent":["\n/** @module common/misc */\n\nimport d3 from 'd3';\nimport _ from 'lodash';\n\n\nfunction defaultFieldProperties(fields) {\n  return fields.map(e => {\n    if (!e.hasOwnProperty('name')) e.name = e.key;\n    if (!e.hasOwnProperty('visible')) e.visible = true;\n    if (e.hasOwnProperty('d3_format')) e.format = 'd3_format';\n    if (!e.hasOwnProperty('format')) e.format = 'raw';\n    return e;\n  });\n}\n\n\nfunction sortType(fmt) {\n  if (['numeric', 'd3_format'].includes(fmt)) return 'numeric';\n  if (['text', 'compound_id', 'assay_id', 'list'].includes(fmt)) return 'text';\n  return 'none';\n}\n\n\n/**\n * Format number\n * @param {object} value - value\n * @param {string} type - si | scientific | rounded | raw\n */\nfunction formatNum(value, d3format) {\n  if (value === undefined || value === null || Number.isNaN(value)) return '';\n  return value == parseFloat(value) ? d3.format(d3format)(value) : value;\n}\n\n\nfunction partialMatch(query, target) {\n  if (target === undefined || target === null || target === '') return false;\n  return target.toString().toUpperCase()\n    .indexOf(query.toString().toUpperCase()) !== -1;\n}\n\n\nfunction URLQuery() {\n  const pairs = window.location.search.substring(1).split(\"&\")\n    .map(e => e.split('='));\n  return _.fromPairs(pairs);\n}\n\n\n// Ref. https://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript\nfunction uuidv4() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n    var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\n    return v.toString(16);\n  });\n}\n\n\nexport default {\n  defaultFieldProperties, sortType, formatNum, partialMatch, URLQuery, uuidv4\n};\n","\n/** @module common/legacySchema */\n\nimport d3 from 'd3';\nimport {default as misc} from './misc.js';\n\n\nconst statusConv = {\n  Queued: 'ready',\n  'In progress': 'running',\n  Aborting: 'running',\n  Aborted: 'aborted',\n  Completed: 'done',\n  Failure: 'failure'\n};\n\nconst dataTypeConv = {\n  datatable: 'nodes',\n  connection: 'edges'\n};\n\nfunction v07_to_v08_nodes(json) {\n  const fields = json.columns.map(e => {\n    if (e.sort === 'numeric') {\n      e.format = 'numeric';\n    } else if (e.sort === 'text') {\n      e.format = 'text';\n    } else if (e.sort === 'none') {\n      e.format = 'raw';\n    }\n    return e;\n  });\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    status: statusConv[json.status],\n    fields: fields,\n    records: json.records,\n    query: json.query,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n  };\n}\n\nfunction v07_to_v08_edges(json, nodeFields) {\n  const snp = {\n    fieldTransform: json.snapshot.fieldTransform,\n    nodePositions: json.snapshot.nodePositions,\n    nodeColor: {},\n    nodeSize: {},\n    nodeLabel: {},\n    edge: {}\n  };\n  if (json.snapshot.hasOwnProperty('nodeColor')) {\n    snp.nodeColor.id = json.snapshot.nodeColor.id;\n    snp.nodeColor.scale = json.snapshot.nodeColor.scale;\n    snp.nodeColor.field = nodeFields.find(e => e.key === json.snapshot.nodeColor.column);\n  } else {\n    snp.nodeColor = {\n      id: 'color', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeSize')) {\n    snp.nodeSize.id = json.snapshot.nodeSize.id;\n    snp.nodeSize.scale = json.snapshot.nodeSize.scale;\n    snp.nodeSize.field = nodeFields.find(e => e.key === json.snapshot.nodeSize.column);\n  } else {\n    snp.nodeSize = {\n      id: 'size', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: [20, 20], unknown: 20}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeLabel')) {\n    snp.nodeLabel.id = json.snapshot.nodeLabel.id;\n    snp.nodeLabel.size = json.snapshot.nodeLabel.size;\n    snp.nodeLabel.text = json.snapshot.nodeLabel.text;\n    snp.nodeLabel.visible = json.snapshot.nodeLabel.visible;\n    snp.nodeLabel.scale = json.snapshot.nodeLabel.scale;\n    snp.nodeLabel.field = nodeFields.find(e => e.key === json.snapshot.nodeLabel.column);\n  } else {\n    snp.nodeLabel = {\n      id: 'label', size: 12, text: 'index', visible: false, field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeContent')) {\n    snp.nodeContent = json.snapshot.nodeContent;\n  } else {\n    snp.nodeContent = {structure: {visible: false}};\n  }\n  if (json.snapshot.hasOwnProperty('edge')) {\n    snp.edge = json.snapshot.edge;\n  } else {\n    snp.edge = {\n      id: 'label', label: {size: 10, visible: false}, visible: true,\n      scale: {scale: 'linear', domain: [0, 1], range: [5, 5], unknown: 5}\n    };\n  }\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    reference: {\n      nodes: json.nodeTableId\n    },\n    status: statusConv[json.status],\n    fields: misc.defaultFieldProperties([\n      {'key': 'source'},\n      {'key': 'target'},\n      {'key': 'weight'}\n    ]),\n    records: json.records,\n    query: json.query,\n    networkThreshold: json.networkThreshold,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n    snapshot: snp\n  };\n}\n\n\nfunction v08_nodes(json) {\n  json.records.forEach((e, i) => {\n    e.index = i;\n    e.structure = e._structure;\n    delete e._index;\n    delete e._structure;\n  });\n  json.fields.forEach(e => {\n    if (e.key === '_index') e.key = 'index';\n    if (e.key === '_structure') e.key = 'structure';\n    if (e.sort === 'numeric') e.format = 'numeric';\n    if (e.sort === 'text') e.format = 'text';\n    if (e.sort === 'none') e.format = 'raw';\n  });\n  return json;\n}\n\nfunction v08_graph(json) {\n  if (!json.edges.hasOwnProperty('reference')) { // ver0.8.0-0.8.1\n    json.edges.reference = {nodes: json.edges.nodesID};\n  }\n  if (json.nodes.fields.find(e => e.key === '_index')) {\n    const idx_converter = {};\n    json.nodes.records.forEach((e, i) => {\n        e.index = i;\n        e.structure = e._structure;\n        idx_converter[e._index] = e.index;\n        delete e._index;\n        delete e._structure;\n    });\n    json.edges.records.forEach(e => {\n        e.source = idx_converter[e.source];\n        e.target = idx_converter[e.target];\n    });\n    json.nodes.fields.forEach(e => {\n      if (e.key === '_index') e.key = 'index';\n      if (e.key === '_structure') e.key = 'structure';\n      if (e.sort === 'numeric') e.format = 'numeric';\n      if (e.sort === 'text') e.format = 'text';\n      if (e.sort === 'none') e.format = 'raw';\n    });\n  }\n  return json;\n}\n\nfunction v10_nodes(json) {\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: json.dataType,\n    schemaVersion: '0.10',\n    revision: json.revision,\n    status: json.status,\n    fields: json.fields,\n    records: json.records,\n    query: json.query,\n    progress: json.progress,\n    execTime: json.execTime,\n    created: json.created,\n    reference: {}\n  };\n}\n\n\nfunction v10_edges(json) {\n  const snapshot = {\n    networkThreshold: json.networkThreshold\n  };\n  snapshot.nodeContentVisible = json.snapshot.nodeContent.structure.visible;\n  snapshot.nodeColor = json.snapshot.nodeColor.scale || {};\n  if (snapshot.nodeColor.field) {\n    snapshot.nodeColor.field = json.snapshot.nodeColor.field.key;\n    if (snapshot.nodeColor.field === '_index') {\n      snapshot.nodeColor.field = 'index';\n    }\n  }\n  if (snapshot.nodeColor.scale === 'ordinal') {\n    snapshot.nodeColor.range = d3.schemeCategory20;\n  }\n  snapshot.nodeSize = json.snapshot.nodeSize.scale || {};\n  if (json.snapshot.nodeSize.field) {\n    snapshot.nodeSize.field = json.snapshot.nodeSize.field.key;\n    if (snapshot.nodeSize.field === '_index') {\n      snapshot.nodeSize.field = 'index';\n    }\n  }\n  snapshot.nodeLabel = {};\n  if (json.snapshot.nodeLabel.text) {\n    snapshot.nodeLabel.text = json.snapshot.nodeLabel.text.key;\n    if (snapshot.nodeLabel.text === '_index') {\n      snapshot.nodeLabel.text = 'index';\n    }\n  }\n  snapshot.nodeLabel.size = json.snapshot.nodeLabel.size;\n  snapshot.nodeLabel.visible = json.snapshot.nodeLabel.visible;\n  snapshot.nodeLabelColor = json.snapshot.nodeLabel.scale || {};\n  if (json.snapshot.nodeLabel.field) {\n    snapshot.nodeLabelColor.field = json.snapshot.nodeLabel.field.key;\n    if (snapshot.nodeLabelColor.field === '_index') {\n      snapshot.nodeLabelColor.field = 'index';\n    }\n  }\n  if (snapshot.nodeLabelColor.scale === 'ordinal') {\n    snapshot.nodeLabelColor.range = d3.schemeCategory20;\n  }\n  snapshot.edgeVisible = json.snapshot.edge.visible;\n  snapshot.edgeWidth = json.snapshot.edge.scale || {};\n  snapshot.edgeLabel = {};\n  snapshot.edgeLabel.size = json.snapshot.edge.label.size;\n  snapshot.edgeLabel.visible = json.snapshot.edge.label.visible;\n  snapshot.networkThreshold = json.networkThreshold || json.query.threshold;\n  snapshot.coords = json.snapshot.nodePositions;\n  // TODO: when created date is lost\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: json.dataType,\n    schemaVersion: '0.10',\n    revision: json.revision,\n    status: json.status,\n    fields: json.fields,\n    records: json.records,\n    query: {params: json.query},\n    progress: json.progress,\n    execTime: json.execTime,\n    created: json.created,\n    snapshot: snapshot,\n    reference: json.reference\n  };\n}\n\nfunction convertTable(json) {\n  let data = json;\n  if (!(data.hasOwnProperty('schemaVersion') || data.hasOwnProperty('$schema'))) { // v0.7\n    data = v07_to_v08_nodes(data);\n  }\n  if (data.schemaVersion == '0.8') {\n    data = v08_nodes(data);\n    data = v10_nodes(data);\n  }\n  if (!data.hasOwnProperty('$schema')) {\n    delete data.schemaVersion;\n    delete data.revision;\n    data.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n  }\n  data.fields.forEach(e => {\n    if (e.key === 'structure') {\n      e.format = 'svg';\n    }\n    delete e.width;\n    delete e.height;\n  });\n  return data;\n}\n\nfunction convertNetwork(json) {\n  let data = json;\n  if (!(data.edges.hasOwnProperty('schemaVersion') || data.edges.hasOwnProperty('$schema'))) { // v0.7\n    data.nodes = v07_to_v08_nodes(data.nodes);\n    data.edges = v07_to_v08_edges(data.edges, data.nodes.fields);\n  }\n  if (data.edges.schemaVersion == '0.8' || data.edges.schemaVersion === 0.1) {  // wrong conversion of '0.10'\n    data = v08_graph(data);\n    data.nodes = v10_nodes(data.nodes);\n    data.edges = v10_edges(data.edges);\n  }\n  if (!data.edges.hasOwnProperty('$schema')) {\n    delete data.nodes.schemaVersion;\n    delete data.edges.schemaVersion;\n    delete data.nodes.revision;\n    delete data.edges.revision;\n    data.nodes.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n    data.edges.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n  }\n  return data;\n}\n\n\nexport default {\n  convertTable, convertNetwork\n};\n","\n/** @module common/mapper */\n\nimport _ from 'lodash';\n\nimport {default as misc} from './misc.js';\n\n\n/**\n * Convert single field mapping to multi field mapping\n * @param {object} mapping - single field mapping\n * @return {object} multi field mapping\n */\nfunction singleToMulti(mapping) {\n  const newMapping = {};\n  Object.entries(mapping.mapping).forEach(m => {\n    newMapping[m[0]] = [m[1]];\n  });\n  return {\n    created: mapping.created,\n    fields: [mapping.field],\n    key: mapping.key,\n    mapping: newMapping\n  };\n}\n\n\n/**\n * Convert field mapping to table\n * @param {object} mapping - field mapping\n * @return {object} table object\n */\nfunction mappingToTable(mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  const keyField = {key: mp.key, format: 'text'};\n  const data = {\n    fields: misc.defaultFieldProperties([keyField].concat(mp.fields)),\n    records: Object.entries(mp.mapping).map(entry => {\n      const rcd = {};\n      rcd[mp.key] = entry[0];\n      mp.fields.forEach((f, i) => {\n        rcd[f.key] = entry[1][i];\n      });\n      return rcd;\n    })\n  };\n  return data;\n}\n\n\n/**\n * Convert table to field mapping\n * @param {object} table - table\n * @param {object} key - key\n * @return {object} field mapping\n */\nfunction tableToMapping(table, key, ignore=['index']) {\n  const now = new Date();\n  const mapping = {\n    created: now.toString(),\n    fields: misc.defaultFieldProperties(table.fields\n      .filter(e => e.key !== key)\n      .filter(e => !ignore.includes(e.key))),\n    key: key,\n    mapping: {}\n  };\n  table.records.forEach(row => {\n    mapping.mapping[row[key]] = mapping.fields.map(e => row[e.key]);\n  });\n  return mapping;\n}\n\n\n/**\n * Convert csv text to field mapping\n * @param {string} csvString - csv data text\n * @return {object} field mapping\n */\nfunction csvToMapping(csvString) {\n  const lines = csvString.split(/\\n|\\r|\\r\\n/);\n  const header = lines.shift().split(',');\n  const key = header.shift();\n  const now = new Date();\n  const headerIdx = [];\n  const fields = [];\n  header.forEach((h, i) => {\n    if (h === '') return;\n    headerIdx.push(i);\n    fields.push({key: h, format: 'text'});\n  });\n  const mapping = {\n    created: now.toString(),\n    fields: misc.defaultFieldProperties(fields),\n    key: key,\n    mapping: {}\n  };\n  lines.forEach(line => {\n    const values = line.split(',');\n    const k = values.shift();\n    mapping.mapping[k] = Array(headerIdx.length);\n    headerIdx.forEach(i => {\n      mapping.mapping[k][i] = values[i];\n    });\n  });\n  return mapping;\n}\n\n\n/**\n * Apply mapping to the data (in-place)\n * @param {object} data - datatable JSON\n * @param {object} mapping - mapping JSON\n * @return {undefined} undefined\n */\nfunction apply(data, mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  data.records\n    .filter(rcd => mp.mapping.hasOwnProperty(rcd[mp.key]))\n    .forEach(rcd => {\n      mp.fields.forEach((fd, i) => {\n        rcd[fd.key] = mp.mapping[rcd[mp.key]][i];\n      });\n    });\n  data.fields =  _(data.fields)\n    .concat(misc.defaultFieldProperties(mp.fields))\n    .uniqBy('key')\n    .value();\n}\n\nexport default {\n  singleToMulti, mappingToTable, tableToMapping, csvToMapping, apply\n};\n","\n/** @module datagrid/rowFactory */\n\nimport {default as misc} from '../common/misc.js';\nimport {default as img} from '../common/image.js';\n\n\nfunction d3Format(selection, record, field) {\n  selection.text(misc.formatNum(record[field.key], field.d3_format));\n}\n\n\nfunction text(selection, record, field) {\n  selection.text(record[field.key]);\n}\n\n\nfunction html(selection, record, field) {\n  selection.html(record[field.key]);\n}\n\n\nfunction compound_id(selection, record, field) {\n  selection.append('a')\n      .attr('href',`profile.html?compound=${record[field.key]}`)\n      .attr('target', '_blank')\n      .text(record[field.key]);\n}\n\n\nfunction image(selection, record, field) {\n  selection.append('img')\n      .attr('width', 180)\n      .attr('height', 180)\n      .attr('src', record[field.key]);\n}\n\nfunction checkbox(selection, record, field) {\n  selection.append('input')\n      .attr('type', 'checkbox')\n      .property('checked', record[field.key])\n      .property('disabled', field.disabled ? record[field.disabled] : false)\n      .on('click', function () {\n        record[field.key] = this.checked;\n      });\n}\n\nfunction textField(selection, record, field) {\n  selection.append('input')\n      .attr('type', 'text')\n      .style('width', '90%')\n      .property('value', record[field.key])\n      .on('change', function () {\n        record[field.key] = this.value;\n      });\n}\n\nfunction call(selection, value) {\n  selection.call(value);\n}\n\n\nconst cellFunc = {\n  numeric: text,\n  text: text,\n  raw: text,\n  d3_format: d3Format,\n  compound_id: compound_id,\n  assay_id: text,\n  list: text,\n  plot: img.plotCell,\n  image: image,\n  checkbox: checkbox,\n  text_field: textField,\n  control: call,\n  svg: html,\n  html: html\n};\n\n\nfunction rowFactory(fields) {\n  return (selection, record) => {\n    fields.forEach(field => {\n      const cell = selection.append('div')\n        .classed('dg-cell', true)\n        .classed('align-middle', true)\n        .classed('text-truncate', true)\n        .style('display', 'inline-block')\n        .style('width', `${field.width}%`);\n      if (!record.hasOwnProperty(field.key)) return;\n      cell.call(cellFunc[field.format], record, field);\n    });\n  };\n}\n\n\nexport default {\n  d3Format, text, html, compound_id, image, checkbox, textField, call, rowFactory\n};\n","\n/** @module common/image */\n\nimport vega from 'vega';\n\n\nfunction plotCell(selection, record, field) {\n  new vega.View(vega.parse(record[field.key]))\n    .initialize(selection.node())\n    .run();\n}\n\n\nfunction plotThumbnail(vegaSpec) {\n  const view = new vega.View(vega.parse(vegaSpec));\n  return view.toImageURL('png');  // Promise\n}\n\n\nfunction binaryToDataURI(binary) {\n  return new Promise(resolve => {\n    const reader = new FileReader();\n    reader.onload = event => {\n      resolve(event.target.result);\n    };\n    reader.readAsDataURL(binary);\n  });\n}\n\n\nexport default {\n  plotCell, plotThumbnail, binaryToDataURI\n};\n","\n/** @module component/formBox */\n\n\nfunction textBox(selection, id, label, size, value) {  // TODO: remove size\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .attr('for', id)\n      .text(label);\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('id', id)\n      .attr('type', 'text')\n      .attr('size', size);\n  selection.call(updateTextBox, value);\n}\n\nfunction updateTextBox(selection, value) {\n  selection.select('input').property('value', value);\n}\n\nfunction textBoxValue(selection) {\n  return selection.select('input').property('value');\n}\n\n\nfunction readonlyBox(selection, id, label, value) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .attr('for', id)\n      .text(label);\n  selection.append('input')\n      .classed('form-control-plaintext', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('id', id)\n      .attr('type', 'text')\n      .property('readonly', true);\n  selection.call(updateTextBox, value);\n}\n\n\nfunction textareaBox(selection, id, label, rows, placeholder, value) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .attr('for', id)\n      .text(label);\n  selection.append('textarea')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('rows', rows)\n      .attr('placeholder', placeholder)\n      .attr('id', id);\n  selection.call(updateTextareaBox, value);\n}\n\nfunction updateTextareaBox(selection, value) {\n  selection.select('textarea').property('value', value);\n}\n\nfunction textareaBoxValue(selection) {\n  const value = selection.select('textarea').property('value');\n  if (value) return value;  // TODO: 0 is falsy\n  const placeholder = selection.select('textarea').attr('placeholder');\n  if (placeholder) return placeholder;\n  return '';\n}\n\nfunction textareaBoxLines(selection) {\n  const value = selection.select('textarea').property('value');\n  if (value) return value.split('\\n').filter(e => e.length > 0);\n  const placeholder = selection.select('textarea').attr('placeholder');\n  if (placeholder) return placeholder.split('\\n').filter(e => e.length > 0);\n  return [];\n}\n\n\nfunction checkBox(selection, id, label, checked) {\n  const box = selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('form-check', true)\n    .append('label')\n      .classed('form-check-label', true)\n      .classed('col-form-label-sm', true);\n  box.append('input')\n      .classed('form-check-input', true)\n      .attr('type', 'checkbox')\n      .attr('id', id);\n  box.append('span')\n      .text(label);\n  selection.call(updateCheckBox, checked);\n}\n\nfunction updateCheckBox(selection, checked) {\n  selection.select('input').property('checked', checked);\n}\n\nfunction checkBoxValue(selection) {\n  return selection.select('input').property('checked');\n}\n\n\nfunction numberBox(selection, id, label, min, max, step, value) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .attr('for', id)\n      .text(label);\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('id', id)\n      .attr('type', 'number')\n      .attr('min', min)\n      .attr('max', max)\n      .attr('step', step);\n  selection.call(updateNumberBox, value);\n}\n\nfunction updateNumberBox(selection, value) {\n  selection.select('input').property('value', value);\n}\n\nfunction numberBoxValue(selection) {\n  return selection.select('input').property('value');\n}\n\n\nfunction fileInputBox(selection, id, label, accept) {\nselection\n    .classed('form-group', true)\n    .classed('form-row', true);\nselection.append('label')\n    .classed('col-form-label', true)\n    .classed('col-form-label-sm', true)\n    .classed('col-4', true)\n    .attr('for', id)\n    .text(label);\nselection.append('input')\n    .classed('form-control', true)\n    .classed('form-control-sm', true)\n    .classed('form-control-file', true)\n    .classed('col-8', true)\n    .attr('type', 'file')\n    .attr('accept', accept)\n    .attr('id', id);\n}\n\nfunction fileInputBoxValue(selection) {\n  return selection.select('input').property('files')[0];\n}\n\n\nexport default {\n  textBox, updateTextBox, textBoxValue, readonlyBox,\n  textareaBox, updateTextareaBox, textareaBoxValue, textareaBoxLines,\n  checkBox, updateCheckBox, checkBoxValue,\n  numberBox, updateNumberBox, numberBoxValue,\n  fileInputBox, fileInputBoxValue\n};\n","\n/** @module datagrid/component */\n\nimport d3 from 'd3';\n\n\nfunction updateHeader(selection, state) {\n  const header = selection.select('.dg-header');\n  header.selectAll('.dg-hcell').remove();\n  header.selectAll('.dg-hcell').data(state.visibleFields)\n    .enter().append('div')\n      .classed('dg-hcell', true)\n      .style('display', 'inline-block')\n      .style('width', d => `${d.width}%`)\n      .text(d => d.name);\n  selection\n      .style('width', '100%')\n      .dispatch('resize');\n  const pos = Math.floor(state.currentScrollTop / state.rowHeight);\n  state.setScrollPosition(pos);\n  selection.call(updateRows, state);\n}\n\n\nfunction updateRows(selection, state) {\n  selection.select('.dg-body')\n    .style('height', `${state.bodyHeight}px`);\n  const rows = selection.select('.dg-body')\n    .selectAll('.dg-row')\n      .data(state.recordsToShow(), state.keyFunc);\n  rows.exit().remove();\n  rows.enter()\n    .append('div')\n      .attr('class', 'dg-row')\n      .style('position', 'absolute')\n      .style('width', '100%')\n    .merge(rows)\n      .style('height', `${state.rowHeight}px`)\n      .each(function (d, i) {\n        const rowIndex = state.viewportTop + i;\n        const rowPos = rowIndex * state.rowHeight;\n        d3.select(this)\n          .style('transform', `translate(0px, ${rowPos}px)`)\n          .classed('odd', (rowIndex) % 2 === 0);\n        d3.select(this).selectAll('.dg-cell').remove();\n        d3.select(this).call(state.rowFactory(), d, rowIndex);\n      });\n}\n\n\nfunction resizeViewport(selection, state) {\n  selection.select('.dg-viewport').style('height', `${state.viewportHeight}px`);\n}\n\n\nexport default {\n  updateHeader, updateRows, resizeViewport\n};\n","\n/** @module datagrid/view */\n\nimport {default as component} from './component.js';\n\n\nfunction resize(selection, state) {\n  const viewport = selection.select('.dg-viewport');\n  const viewportTop = viewport.node().getBoundingClientRect().top;\n  state.setViewportSize(window.innerHeight - viewportTop - 5);\n  selection.call(component.resizeViewport, state);\n}\n\n\nfunction datagrid(selection, state) {\n  selection.selectAll('div').remove();\n  selection.on('resize', () => selection.call(resize, state));\n  selection.append('div')\n      .classed('dg-header', true);\n  selection.append('div')\n      .classed('dg-viewport', true)\n      .style('overflow-y', 'auto')\n      .on('scroll', function () {\n        const pos = Math.floor(this.scrollTop / state.rowHeight);\n        state.currentScrollTop = this.scrollTop;\n        if (pos !== state.previousViewportTop) {\n          state.setScrollPosition(pos);\n          selection.call(component.updateRows, state);\n        }\n      })\n    .append('div')\n      .classed('dg-body', true)\n      .style('position', 'relative');\n  state.updateContentsNotifier = () => {\n    state.applyData();\n    selection.call(component.updateHeader, state);\n  };\n  state.updateFilterNotifier = value => {\n    state.setFilterText(value);\n    state.setScrollPosition(0);\n    selection.call(component.updateRows, state);\n    selection.select('.dg-viewport').node().scrollTop = 0;\n  };\n  state.updateContentsNotifier();\n}\n\n\nexport default {\n  resize, datagrid\n};\n","\n/** @module datagrid */\n\nimport {default as legacy} from './common/legacySchema.js';\n\nimport DatagridState from './datagrid/state.js';\nimport {default as rowFilter} from './datagrid/rowFilter.js';\nimport {default as sort} from './datagrid/sort.js';\nimport {default as view} from './datagrid/view.js';\n\n\nexport default {\n  DatagridState, rowFilter, sort, view, legacy\n};\n","\n/** @module datagrid/state */\n\nimport _ from 'lodash';\n\nimport {default as mapper} from '../common/mapper.js';\nimport {default as misc} from '../common/misc.js';\n\nimport {default as factory} from './rowFactory.js';\n\n\nexport default class DatagridState {\n  constructor(data) {\n    this.data = data;\n\n    this.visibleFields = null;\n    this.sortedRecords = null;\n    this.filteredRecords = null;\n\n    // Snapshot\n    const snp = this.data.snapshot || {sortOrder: [], filterText: null};\n    this.sortOrder = snp.sortOrder || [];\n    this.filterText = snp.filterText || null;\n\n    this.defaultColumnHeight = {\n      numeric: 40,\n      text: 40,\n      none: 200\n    };\n    this.scrollBarSpace = 20;\n    this.keyFunc = d => d.index;\n\n    // Size\n    this.rowHeight = null;\n    this.contentWidth = null;\n    this.bodyHeight = null;\n\n    // Viewport\n    this.viewportHeight = null;\n    this.numViewportRows = null;\n    this.previousNumViewportRows = null;\n    this.viewportTop = null;\n    this.previousVieportTop = null;\n    this.viewportBottom = null;\n    this.currentScrollTop = 0;\n\n    this.fixedViewportHeight = null;\n\n    // Event notifier\n    this.updateContentsNotifier = null;\n    this.updateFilterNotifier = null;\n\n    this.rowFactory = () => factory.rowFactory(this.visibleFields);\n\n    // Initialize\n    this.applyData();\n  }\n\n  setViewportSize(height) {\n    this.viewportHeight = this.fixedViewportHeight || height;\n    this.previousNumViewportRows = this.numViewportRows;\n    this.numViewportRows = Math.ceil(this.viewportHeight / this.rowHeight) + 1;\n  }\n\n  setScrollPosition(position) {\n    this.previousViewportTop = this.viewportTop;\n    this.viewportTop = position;\n    this.viewportBottom = Math.min(\n      this.viewportTop + this.numViewportRows, this.filteredRecords.length);\n  }\n\n  setSortOrder(key, order) {\n    const ki  = this.sortOrder.findIndex(e => e.key);\n    const obj = {key: key, order: order};\n    if (ki !== -1) this.sortOrder.splice(ki, 1);\n    this.sortOrder.splice(0, 0, obj);\n    this.applyOrder(key, order);\n  }\n\n  setFilterText(text) {\n    this.filterText = text;\n    this.applyFilter();\n  }\n\n  joinFields(mapping) {\n    mapper.apply(this.data, mapping);\n    this.applyData();\n  }\n\n  applyData() {\n    this.visibleFields = this.data.fields.filter(e => e.visible);\n    const widthfSum = this.visibleFields.reduce((a, c) => a + (c.widthf || 1), 0);\n    this.visibleFields = this.visibleFields.map(e => {\n      const field = {\n        width: (e.widthf || 1) / widthfSum * 100,\n        height: e.height || this.defaultColumnHeight[misc.sortType(e.format)]\n      };\n      return Object.assign(field, e);\n    });\n    this.rowHeight = this.visibleFields\n      .reduce((a, b) => a.height > b.height ? a : b).height;\n    this.applyOrder();\n  }\n\n  applyOrder(key, order) {\n    if (key) {\n      this.sortedRecords = _.orderBy(this.data.records.slice(), [key], [order]);\n    } else {\n      const keys = this.sortOrder.map(e => e.key);\n      const orders = this.sortOrder.map(e => e.order);\n      if (keys) {\n        this.sortedRecords = _.orderBy(this.data.records.slice(), keys, orders);\n      }\n    }\n    this.applyFilter();\n  }\n\n  applyFilter() {\n    if (this.filterText === null) {\n      this.filteredRecords = this.sortedRecords.slice();\n    } else {\n      const fields = this.visibleFields\n        .filter(e => misc.sortType(e.format) !== 'none')\n        .map(e => e.key);\n      this.filteredRecords = this.sortedRecords.filter(row => {\n        return fields.some(f => misc.partialMatch(this.filterText, row[f]));\n      });\n    }\n    this.bodyHeight = this.filteredRecords.length * this.rowHeight;\n  }\n\n  recordsToShow() {\n    return this.filteredRecords.slice(this.viewportTop, this.viewportBottom);\n  }\n\n  export() {\n    this.data.id = misc.uuidv4();\n    return this.data;\n  }\n\n}\n","\n/** @module datagrid/rowFilter */\n\nimport {default as box} from '../component/formBox.js';\n\n\nfunction setFilter(selection, state) {\n  const searchBox = selection\n      .classed('row', true)\n      .classed('justify-content-end', true)\n    .append('div')\n      .classed('col-5', true)\n      .call(box.textBox, null, 'Search', 40, null);\n  searchBox.select('label').classed('text-right', true);\n  searchBox.select('input')\n    .on('keyup', function () {\n      state.updateFilterNotifier(box.textBoxValue(searchBox));\n    });\n}\n\n\nexport default {\n  setFilter\n};\n","\n/** @module datagrid/sort */\n\nimport d3 from 'd3';\n\nimport {default as misc} from '../common/misc.js';\nimport {default as component} from './component.js';\n\n\nfunction setSort(selection, state) {\n  selection.select('.dg-header').selectAll('.dg-hcell')\n    .filter(d => misc.sortType(d.format) !== 'none')\n    .append('span').append('a')\n      .attr('id', d => `sort-${d.key}`)\n      .text('^v')\n      .style('display', 'inline-block')\n      .style('width', '30px')\n      .style('text-align', 'center')\n    .on('click', d => {\n      const isAsc = d3.select(`#sort-${d.key}`).text() === 'v';\n      d3.select(`#sort-${d.key}`).text(isAsc ? '^' : 'v');\n      state.setSortOrder(d.key, isAsc ? 'desc' : 'asc');\n      selection.call(component.updateRows, state);\n    });\n  state.updateContentsNotifier = () => {\n    state.applyData();\n    selection.call(component.updateHeader, state)\n      .call(setSort, state);\n  };\n}\n\n\nexport default {\n  setSort\n};\n"],"names":["defaultFieldProperties","fields","map","e","hasOwnProperty","name","key","visible","format","sortType","fmt","includes","formatNum","value","d3format","Number","isNaN","parseFloat","d3","partialMatch","query","target","toString","toUpperCase","indexOf","URLQuery","pairs","window","location","search","substring","split","_","fromPairs","uuidv4","replace","c","r","Math","random","statusConv","Queued","In progress","Aborting","Aborted","Completed","Failure","dataTypeConv","datatable","connection","v07_to_v08_nodes","json","columns","sort","id","dataType","schemaVersion","revision","status","records","taskCount","searchCount","doneCount","searchDoneCount","resultCount","recordCount","progress","execTime","created","startDate","responseDate","v10_nodes","reference","singleToMulti","mapping","newMapping","Object","entries","forEach","m","field","mappingToTable","mp","keyField","misc","concat","entry","rcd","f","i","tableToMapping","table","ignore","Date","filter","row","csvToMapping","csvString","lines","header","shift","now","headerIdx","h","push","line","values","k","Array","length","apply","data","fd","uniqBy","d3Format","selection","record","text","d3_format","html","compound_id","append","attr","image","checkbox","property","disabled","on","this","checked","textField","style","call","cellFunc","numeric","raw","assay_id","list","plot","plotCell","vega","View","parse","initialize","node","run","plotThumbnail","vegaSpec","toImageURL","binaryToDataURI","binary","Promise","resolve","reader","FileReader","onload","event","result","readAsDataURL","text_field","control","svg","rowFactory","cell","classed","width","updateTextBox","select","updateTextareaBox","updateCheckBox","updateNumberBox","textBox","label","size","textBoxValue","readonlyBox","textareaBox","rows","placeholder","textareaBoxValue","textareaBoxLines","checkBox","box","checkBoxValue","numberBox","min","max","step","numberBoxValue","fileInputBox","accept","fileInputBoxValue","updateRows","state","bodyHeight","selectAll","recordsToShow","keyFunc","exit","remove","enter","merge","rowHeight","each","d","rowIndex","viewportTop","rowPos","updateHeader","visibleFields","dispatch","pos","floor","currentScrollTop","setScrollPosition","resizeViewport","viewportHeight","resize","getBoundingClientRect","top","setViewportSize","innerHeight","component","DatagridState","[object Object]","sortedRecords","filteredRecords","snp","snapshot","sortOrder","filterText","defaultColumnHeight","none","scrollBarSpace","index","contentWidth","numViewportRows","previousNumViewportRows","previousVieportTop","viewportBottom","fixedViewportHeight","updateContentsNotifier","updateFilterNotifier","factory","applyData","height","ceil","position","previousViewportTop","order","ki","findIndex","obj","splice","applyOrder","applyFilter","mapper","widthfSum","reduce","a","widthf","assign","b","orderBy","slice","keys","orders","some","rowFilter","setFilter","searchBox","setSort","isAsc","setSortOrder","view","datagrid","scrollTop","setFilterText","legacy","convertTable","structure","_structure","_index","v08_nodes","$schema","convertNetwork","edges","nodes","nodeFields","fieldTransform","nodePositions","nodeColor","nodeSize","nodeLabel","edge","scale","find","column","domain","range","unknown","nodeContent","nodeTableId","networkThreshold","v07_to_v08_edges","nodesID","idx_converter","source","v08_graph","nodeContentVisible","schemeCategory20","nodeLabelColor","edgeVisible","edgeWidth","edgeLabel","threshold","coords","params","v10_edges"],"mappings":"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"}