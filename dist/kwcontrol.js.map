{"version":3,"file":"kwcontrol.js","sources":["../src/helper/mapper.js","../src/store/StoreConnection.js","../src/helper/formatValue.js","../src/helper/file.js","../src/component/Component.js","../src/control.js","../src/helper/definition.js","../src/helper/KArray.js","../src/helper/window.js","../src/helper/misc.js","../src/store/IDBStore.js","../src/helper/d3Form.js","../src/helper/image.js","../src/fetcher.js","../src/component/Dialog.js","../src/common.js"],"sourcesContent":["\n/** @module helper/dataStructure */\n\nimport KArray from './KArray.js';\nimport {default as def} from './definition.js';\n\n\n/**\n * Convert single field mapping to multi field mapping\n * @param {object} mapping - single field mapping\n * @return {object} multi field mapping\n */\nfunction singleToMulti(mapping) {\n  const newMapping = {};\n  Object.entries(mapping.mapping).forEach(m => {\n    newMapping[m[0]] = [m[1]];\n  });\n  return {\n    created: mapping.created,\n    fields: [mapping.field],\n    key: mapping.key,\n    mapping: newMapping\n  };\n}\n\n\n/**\n * Convert field mapping to table\n * @param {object} mapping - field mapping\n * @return {object} table object\n */\nfunction mappingToTable(mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  const keyField = {key: mp.key, valueType: 'text'};\n  const data = {\n    fields: def.defaultFieldProperties([keyField].concat(mp.fields)),\n    records: Object.entries(mp.mapping).map(entry => {\n      const rcd = {};\n      rcd[mp.key] = entry[0];\n      mp.fields.forEach((f, i) => {\n        rcd[f.key] = entry[1][i];\n      });\n      return rcd;\n    })\n  };\n  return data;\n}\n\n\n/**\n * Convert table to field mapping\n * @param {object} table - table\n * @param {object} key - key\n * @return {object} field mapping\n */\nfunction tableToMapping(table, key, ignore=['_index']) {\n  const now = new Date();\n  const mapping = {\n    created: now.toString(),\n    fields: def.defaultFieldProperties(table.fields\n      .filter(e => e.key !== key)\n      .filter(e => !ignore.includes(e.key))),\n    key: key,\n    mapping: {}\n  };\n  table.records.forEach(row => {\n    mapping.mapping[row[key]] = mapping.fields.map(e => row[e.key]);\n  });\n  return mapping;\n}\n\n\n/**\n * Convert csv text to field mapping\n * @param {string} csvString - csv data text\n * @return {object} field mapping\n */\nfunction csvToMapping(csvString) {\n  const lines = csvString.split(/\\n|\\r|\\r\\n/);\n  const header = lines.shift().split(',');\n  const key = header.shift();\n  const now = new Date();\n  const headerIdx = [];\n  const fields = [];\n  header.forEach((h, i) => {\n    if (h === '') return;\n    headerIdx.push(i);\n    fields.push({key: h, valueType: 'text'});\n  });\n  const mapping = {\n    created: now.toString(),\n    fields: def.defaultFieldProperties(fields),\n    key: key,\n    mapping: {}\n  };\n  lines.forEach(line => {\n    const values = line.split(',');\n    const k = values.shift();\n    mapping.mapping[k] = Array(headerIdx.length);\n    headerIdx.forEach(i => {\n      mapping.mapping[k][i] = values[i];\n    });\n  });\n  return mapping;\n}\n\n\n/**\n * Apply mapping to the data (in-place)\n * @param {object} data - datatable JSON\n * @param {object} mapping - mapping JSON\n * @return {undefined} undefined\n */\nfunction apply(data, mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  data.records\n    .filter(rcd => mp.mapping.hasOwnProperty(rcd[mp.key]))\n    .forEach(rcd => {\n      mp.fields.forEach((fd, i) => {\n        rcd[fd.key] = mp.mapping[rcd[mp.key]][i];\n      });\n    });\n  data.fields = def.defaultFieldProperties(\n    KArray.from(data.fields).concat(mp.fields).unique('key'));\n}\n\n\nexport default {\n  singleToMulti, mappingToTable, tableToMapping, csvToMapping, apply\n};\n","\nimport {default as def} from '../helper/definition.js';\nimport {default as mapper} from '../helper/mapper.js';\nimport {default as store} from './IDBStore.js';\n\n\nfunction getAppSetting(key) {\n  return store.getAppSetting(key)\n    .catch(err => {\n      console.error(`Unexpected key: ${key}`);\n      Promise.reject(err);\n    });\n}\n\n\nfunction setAppSetting(key, value) {\n  return store.putAppSetting(key, value)\n    .catch(err => {\n      console.error(`Unexpected key: ${key} or value: ${value}`);\n      Promise.reject(err);\n    });\n}\n\n\nfunction getResources() {\n  return store.getResources();\n}\n\n\nfunction setResources(rsrcs) {\n  return store.putResources(rsrcs)\n    .catch(err => {\n      console.error(`Unexpected resources: ${rsrcs}`);\n      Promise.reject(err);\n    });\n}\n\n\nfunction getAllTables() {\n  return store.getAllItems();\n}\n\n\nfunction getTablesByDataType(type) {\n  return store.getItemsByDataType(type)\n    .catch(err => {\n      console.error(`Unexpected dataType: ${type}`);\n      Promise.reject(err);\n    });\n}\n\n\nfunction getTable(id) {\n  return store.getItemById(id)\n    .catch(err => {\n      console.error(`Unexpected table ID: ${id}`);\n      Promise.reject(err);\n    });\n}\n\n\nfunction setFieldProperties(id, updates) {\n  return store.updateItem(id, item => {\n    item.fields.forEach((fd, i) => {\n      fd.visible = updates.visibles.includes(fd.key);\n      fd.sortType = updates.sortTypes[i];\n      fd.digit = updates.digits[i];\n    });\n    item.revision++;\n  })\n  .catch(err => {\n    console.error(`Unexpected table ID: ${id} or updates: ${updates}`);\n    Promise.reject(err);\n  });\n}\n\n\nfunction joinFields(id, mapping) {\n  return store.updateItem(id, item => {\n    mapper.apply(item, mapping);\n    item.revision++;\n  })\n  .catch(err => {\n    console.error(`Unexpected table ID: ${id} or mapping: ${mapping}`);\n    Promise.reject(err);\n  });\n}\n\n\nfunction updateTableAttribute(id, key, value) {\n  return store.updateItem(id, item => {\n    item[key] = value;\n    item.revision++;\n  })\n  .catch(err => {\n    console.error(`Unexpected table ID: ${id}, key: ${key} or value: ${value}`);\n    Promise.reject(err);\n  });\n}\n\n\nfunction insertTable(data) {\n  data.fields = def.defaultFieldProperties(data.fields);\n  return store.putItem(data)\n    .catch(err => {\n      console.error(`Unexpected data: ${data}`);\n      Promise.reject(err);\n    });\n}\n\n\nfunction updateTable(data) {\n  if (data.status === 'failure') {  // No data found on server\n    return updateTableAttribute(data.id, 'status', 'failure');\n  }\n  // update\n  return store.updateItem(data.id, item => {\n    data.fields = def.defaultFieldProperties(data.fields);\n    Object.assign(item, data);\n    item.revision++;\n  });\n}\n\n\nfunction deleteTable(id) {\n  return store.deleteItem(id)\n    .catch(err => {\n      console.error(`Unexpected table ID: ${id}`);\n      Promise.reject(err);\n    });\n}\n\n\nfunction reset() {\n  return store.reset();\n}\n\n\nexport default {\n  getAppSetting, setAppSetting, getResources, setResources,\n  getAllTables, getTablesByDataType, getTable,\n  setFieldProperties, joinFields,\n  updateTableAttribute, insertTable, updateTable,\n  deleteTable, reset\n};\n","\n/** @module helper/formatValue */\n\nimport d3 from 'd3';\n\n\n/**\n * Format number\n * @param {object} value - value\n * @param {string} type - si | scientific | rounded | raw\n */\nfunction formatNum(value, type) {\n  const conv = {\n    scientific: \".3e\",\n    si: \".3s\",\n    rounded: \".3r\"\n  };\n  if (type === 'raw') return value;\n  if (value === undefined || value === null || Number.isNaN(value)) return '';\n  return value == parseFloat(value) ? d3.format(conv[type])(value) : value;\n}\n\nfunction partialMatch(query, target) {\n  if (target === undefined || target === null || target === '') return false;\n  return target.toString().toUpperCase()\n    .indexOf(query.toString().toUpperCase()) !== -1;\n}\n\nfunction numericAsc(a, b) {\n  const fa = parseFloat(a);\n  const fb = parseFloat(b);\n  if (isNaN(fa) || isNaN(fb)) {\n    return String(b).localeCompare(String(a));\n  }\n  return fb - fa;\n}\n\n\nfunction numericDesc(a, b) {\n  return numericAsc(b, a);\n}\n\n\nfunction textAsc(a, b) {\n  return String(b).localeCompare(String(a));\n}\n\n\nfunction textDesc(a, b) {\n  return textAsc(b, a);\n}\n\n\nexport default {\n  formatNum, partialMatch,\n  numericAsc, numericDesc, textAsc, textDesc\n};\n","\n/** @module helper/file */\n\nimport pako from 'pako';\n\nimport {default as def} from './definition.js';\n\nconst statusConv = {\n  Queued: 'ready',\n  'In progress': 'running',\n  Aborting: 'running',\n  Aborted: 'aborted',\n  Completed: 'done',\n  Failure: 'failure'\n};\n\nconst dataTypeConv = {\n  datatable: 'nodes',\n  connection: 'edges'\n};\n\nfunction v07_to_v08_nodes(json) {\n  const fields = json.columns.map(e => {\n    e.sortType = e.sort;\n    return e;\n  });\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    status: statusConv[json.status],\n    fields: fields,\n    records: json.records,\n    query: json.query,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n  };\n}\n\nfunction v07_to_v08_edges(json, nodeFields) {\n  const snp = {\n    fieldTransform: json.snapshot.fieldTransform,\n    nodePositions: json.snapshot.nodePositions,\n    nodeColor: {},\n    nodeSize: {},\n    nodeLabel: {},\n    edge: {}\n  };\n  if (json.snapshot.hasOwnProperty('nodeColor')) {\n    snp.nodeColor.id = json.snapshot.nodeColor.id;\n    snp.nodeColor.scale = json.snapshot.nodeColor.scale;\n    snp.nodeColor.field = nodeFields.find(e => e.key === json.snapshot.nodeColor.column);\n  } else {\n    snp.nodeColor = {\n      id: 'color', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeSize')) {\n    snp.nodeSize.id = json.snapshot.nodeSize.id;\n    snp.nodeSize.scale = json.snapshot.nodeSize.scale;\n    snp.nodeSize.field = nodeFields.find(e => e.key === json.snapshot.nodeSize.column);\n  } else {\n    snp.nodeSize = {\n      id: 'size', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: [20, 20], unknown: 20}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeLabel')) {\n    snp.nodeLabel.id = json.snapshot.nodeLabel.id;\n    snp.nodeLabel.size = json.snapshot.nodeLabel.size;\n    snp.nodeLabel.text = json.snapshot.nodeLabel.text;\n    snp.nodeLabel.visible = json.snapshot.nodeLabel.visible;\n    snp.nodeLabel.scale = json.snapshot.nodeLabel.scale;\n    snp.nodeLabel.field = nodeFields.find(e => e.key === json.snapshot.nodeLabel.column);\n  } else {\n    snp.nodeLabel = {\n      id: 'label', size: 12, text: '_index', visible: false, field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeContent')) {\n    snp.nodeContent = json.snapshot.nodeContent;\n  } else {\n    snp.nodeContent = {structure: {visible: false}};\n  }\n  if (json.snapshot.hasOwnProperty('edge')) {\n    snp.edge = json.snapshot.edge;\n  } else {\n    snp.edge = {\n      id: 'label', label: {size: 10, visible: false}, visible: true,\n      scale: {scale: 'linear', domain: [0, 1], range: [5, 5], unknown: 5}\n    };\n  }\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    nodesID: json.nodeTableId,\n    status: statusConv[json.status],\n    fields: def.defaultFieldProperties([\n      {'key': 'source'},\n      {'key': 'target'},\n      {'key': 'weight'}\n    ]),\n    records: json.records,\n    query: json.query,\n    networkThreshold: json.networkThreshold,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n    snapshot: snp\n  };\n}\n\nfunction v07_to_v08_convert(json) {\n  if (json.hasOwnProperty('edges')) {\n    const nodes = v07_to_v08_nodes(json.nodes);\n    const edges = v07_to_v08_edges(json.edges, nodes.fields);\n    return {nodes: nodes, edges: edges};\n  } else {\n    return v07_to_v08_nodes(json);\n  }\n}\n\n\nfunction readFile(file, sizeLimit, blob) {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    const truncated = sizeLimit ? file.slice(0, sizeLimit) : file;\n    reader.onload = event => resolve(event.target.result);\n    reader.onerror = error => reject(error);\n    if (blob) {\n      reader.readAsArrayBuffer(truncated);\n    } else {\n      reader.readAsText(truncated);\n    }\n  });\n}\n\n\nfunction parseJSON(data, compressed) {\n  const text = compressed ? pako.inflate(data, {to: 'string'}) : data;\n  const json = JSON.parse(text);\n  if (json.hasOwnProperty('schemaVersion')) return json;\n  if (json.hasOwnProperty('edges')) {\n    if (json.edges.hasOwnProperty('schemaVersion')) return json;\n  }\n  return v07_to_v08_convert(json);\n}\n\n\nfunction loadJSON(file) {\n  const compressed = file.name.endsWith('c') || file.name.endsWith('.gz');\n  return readFile(file, false, compressed)\n    .then(data => parseJSON(data, compressed));\n}\n\n\nfunction fetchJSON(url) {\n  const decoded = decodeURIComponent(url);\n  const compressed = decoded.endsWith('c') || decoded.endsWith('.gz');\n  return fetch(decoded)\n    .then(res => compressed ? res.arrayBuffer() : res.json())\n    .then(data => parseJSON(data, compressed));\n}\n\n\nfunction downloadDataFile(data, name) {\n  try {\n    // cannot hundle large file with dataURI scheme\n    // url = 'data:application/json,' + encodeURIComponent(JSON.stringify(json))\n    const url = window.URL.createObjectURL(new Blob([data]));\n    const a = document.createElement('a');\n    a.download = name;\n    a.href = url;\n    // a.click() does not work on firefox\n    a.dispatchEvent(new MouseEvent('click', {\n      'view': window,\n      'bubbles': true,\n      'cancelable': false\n    }));\n    // window.URL.revokeObjectURL(url) does not work on firefox\n  } catch (e) {\n    // no DOM (unit testing)\n  }\n}\n\n\nfunction downloadJSON(json, name, compress=true) {\n  const str = JSON.stringify(json);\n  const data = compress ? pako.gzip(str) : str;\n  const c = compress ? 'c' : 'r';\n  const ext = json.hasOwnProperty('edges') ? `.gf${c}` :  `.nd${c}`;\n  downloadDataFile(data, `${name}${ext}`);\n}\n\n\nexport default {\n  readFile, parseJSON, loadJSON, fetchJSON,\n  downloadDataFile, downloadJSON\n};\n","\n/** @module component/Component */\n\nimport d3 from 'd3';\nimport {default as fmt} from '../helper/formatValue.js';\n\n\nfunction selectOptions(selection, data, key, text) {\n  const options = selection.selectAll('option')\n    .data(data, key);\n  options.exit().remove();\n  options.enter().append('option')\n    .merge(options)\n      .attr('value', key)\n      .text(text);\n}\n\n\nfunction checkboxList(selection, data, name, key, text) {\n  const items = selection.selectAll('li').data(data, key);\n  items.exit().remove();\n  const entered = items.enter().append('li')\n    .attr('class', 'form-check')\n    .append('label');\n  entered.append('input');\n  entered.append('span');\n  const updated = entered.merge(items.select('label'))\n    .attr('class', 'form-check-label');\n  updated.select('input')\n    .attr('type', 'checkbox')\n    .attr('class', 'form-check-input')\n    .attr('name', name)\n    .attr('value', key);\n  updated.select('span')\n    .text(text);\n}\n\n\n// checkbox list with tooltip\n// call $('[data-toggle=\"tooltip\"]').tooltip() after this function\nfunction checkboxListT(selection, data, name, key, text) {\n  const items = selection.selectAll('li').data(data, key);\n  items.exit().remove();\n  const entered = items.enter().append('li')\n    .attr('class', 'form-check')\n    .append('label');\n  entered.append('input');\n  entered.append('a');\n  const updated = entered.merge(items.select('label'))\n    .attr('class', 'form-check-label');\n  updated.select('input')\n    .attr('type', 'checkbox')\n    .attr('class', 'form-check-input')\n    .attr('name', name)\n    .attr('value', key);\n  updated.select('a')\n    .attr('data-toggle', 'tooltip')\n    .attr('data-placement', 'bottom')\n    .attr('title', d => d.description || 'No')\n    .text(text);\n}\n\n\nfunction createTable(selection, data) {\n  // Header\n  if (selection.select('thead').size()) selection.select('thead').remove();\n  selection.append('thead').append('tr');\n  // Records\n  if (selection.select('tbody').size()) selection.select('tbody').remove();\n    selection.append('tbody');\n\n  const cols = data.fields.filter(e => e.visible);\n  const header = selection.select('thead tr').selectAll('th')\n    .data(cols, d => d.key);\n  header.exit().remove();\n  header.enter().append('th')\n    .merge(header)\n      .text(d => d.name);\n}\n\n\nfunction updateTableRecords(selection, rcds, keyFunc) {\n  const header = selection.select('thead tr').selectAll('th')\n    .data();\n  const rowSelection = selection.select('tbody').selectAll('tr')\n    .data(rcds, keyFunc);\n  rowSelection.exit().remove();\n  const rowEntered = rowSelection.enter().append('tr');\n  rowEntered.selectAll('td')\n    .data(d => header.map(e => d[e.key]))\n    .enter().append('td');\n  rowEntered.merge(rowSelection)\n    .selectAll('td')\n      .classed('align-middle', true)\n    .html(function (d, i) {\n      if (d === undefined) return '';\n      if (header[i].valueType === 'plot') return '[plot]';\n      if (header[i].valueType === 'image') return '[image]';\n      if (header[i].valueType === 'control') return;\n      if (header[i].digit !== 'raw') return fmt.formatNum(d, header[i].digit);\n      return d;\n    })\n    .each((d, i, nodes) => {\n      // This should be called after html\n      if (header[i].valueType === 'control') d3.select(nodes[i]).call(d);\n    });\n}\n\n\nfunction appendTableRows(selection, rcds, keyFunc) {\n  const newRcds = selection.select('tbody').selectAll('tr').data();\n  Array.prototype.push.apply(newRcds, rcds);\n  updateTableRecords(selection, newRcds, keyFunc);\n}\n\n\nfunction addSort(selection) {\n  selection.select('thead tr').selectAll('th')\n    .filter(d => d.sortType !== 'none')\n    .append('span').append('a')\n      .attr('id', d => `sort-${d.key}`)\n      .text('^v')\n      .style('display', 'inline-block')\n      .style('width', '30px')\n      .style('text-align', 'center')\n    .on('click', d => {\n      const isAsc = d3.select(`#sort-${d.key}`).text() === 'v';\n      const isNum = d.sortType === 'numeric';\n      const cmp = isAsc\n        ? (isNum ? fmt.numericAsc : fmt.textAsc)\n        : (isNum ? fmt.numericDesc : fmt.textDesc);\n      selection.select('tbody').selectAll('tr')\n        .sort((a, b) => cmp(a[d.key], b[d.key]));\n      d3.select(`#sort-${d.key}`)\n        .text(isAsc ? '^' : 'v');\n    });\n}\n\n\nfunction formatNumbers(selection) {\n  // DEPRECATED: no longer used\n  selection.select('thead tr').selectAll('th')\n    .each((col, colIdx) => {\n      if (col.digit === 'raw') return;\n      selection.select('tbody').selectAll('tr')\n        .selectAll('td')\n          .filter((d, i) => i === colIdx)\n          .text(d => fmt.formatNum(d, col.digit));\n    });\n}\n\n\nexport default {\n  selectOptions, checkboxList, checkboxListT,\n  createTable, updateTableRecords,\n  appendTableRows, addSort, formatNumbers\n};\n","\nimport d3 from 'd3';\n\nimport {default as common} from './common.js';\nimport {default as fetcher} from './fetcher.js';\nimport {default as cmp} from './component/Component.js';\nimport {default as store} from './store/StoreConnection.js';\nimport {default as def} from './helper/definition.js';\n\n\nfunction tableAction(selection, data, app) {\n  selection.append('a')\n      .classed('btn btn-secondary btn-sm', true)\n      .attr('role', 'button')\n      .attr('href', `${app}?id=${data.id}`)\n      .attr('target', '_blank')\n      .text('Open');\n  const ongoing = def.ongoing(data);\n  selection.insert('button')\n      .classed('btn btn-warning btn-sm', true)\n      .attr('type', 'button')\n      .attr('data-toggle', ongoing ? null : 'modal')\n      .attr('data-target', ongoing ? null : '#confirm-dialog')\n      .property('disabled', ongoing ? 'disabled' : null)\n      .text(ongoing ? 'Running' : 'Delete')\n      .on('click', function() {\n        d3.select('#confirm-message')\n          .text(`Are you sure you want to delete ${data.name} ?`);\n        d3.select('#confirm-submit')\n          .on('click', () => store.deleteTable(data.id).then(run));\n      });\n}\n\n\nfunction renderTableStatus(data) {\n  const table = {\n    fields: def.defaultFieldProperties([\n      {key: 'name', valueType: 'text'},\n      {key: 'status', valueType: 'text'},\n      {key: 'resultCount', valueType: 'count'},\n      {key: 'action', valueType: 'control'}\n    ])\n  };\n  const records = data.map(e => {\n    e.action = (s) => tableAction(s, e, 'datatable.html');\n    return e;\n  });\n  d3.select('#local-tables').call(cmp.createTable, table)\n    .call(cmp.updateTableRecords, records, d => d.id);\n}\n\n\nfunction renderGraphStatus(data) {\n  const table = {\n    fields: def.defaultFieldProperties([\n      {key: 'name', valueType: 'text'},\n      {key: 'nodesID', valueType: 'text'},\n      {key: 'status', valueType: 'text'},\n      {key: 'resultCount', valueType: 'count'},\n      {key: 'action', valueType: 'control'}\n    ])\n  };\n  const records = data.map(e => {\n    e.action = (s) => tableAction(s, e, 'graph.html');\n    return e;\n  });\n  d3.select('#local-graphs').call(cmp.createTable, table)\n    .call(cmp.updateTableRecords, records, d => d.id);\n}\n\n\nfunction renderServerStatus(data) {\n  const calc = {\n    fields: def.defaultFieldProperties(data.calc.fields)\n  };\n  d3.select('#server-calc').call(cmp.createTable, calc)\n    .call(cmp.updateTableRecords, data.calc.records, d => d._index);\n  const server = {\n    fields: def.defaultFieldProperties([\n      {key: 'key', valueType: 'text'},\n      {key: 'value', valueType: 'text'}\n    ])\n  };\n  server.records = Object.entries(data)\n    .filter(e => e[0] !== 'calc')\n    .map(e => ({key: e[0], value: e[1]}));\n  d3.select('#server-status').call(cmp.createTable, server)\n    .call(cmp.updateTableRecords, server.records, d => d._index);\n}\n\n\nfunction run() {\n  d3.select('#refresh-all')\n    .on('click', () => {\n      return store.getAllTables().then(tables => {\n        return Promise.all(tables.map(tbl => {\n          if (tbl.status !== 'running') return Promise.resolve();\n          const query = {id: tbl.id, command: 'fetch'};\n          return fetcher.get('res', query)\n            .then(fetcher.json)\n            .then(store.updateTable);\n        }));\n      }).then(run);\n    });\n  d3.select('#reset-local')\n    .on('click', () => {\n      d3.select('#confirm-message')\n        .text('Are you sure you want to delete all local tables and reset the datastore ?');\n      d3.select('#confirm-submit')\n        .on('click', () => store.reset().then(run));\n    });\n  return common.loader().then(serverStatus => {\n    if (serverStatus) renderServerStatus(serverStatus);\n    return Promise.all([\n      store.getTablesByDataType('nodes').then(renderTableStatus),\n      store.getTablesByDataType('edges').then(renderGraphStatus)\n    ]);\n  });\n}\nrun();\n","\n/** @module helper/definition */\n\n\nconst defaultHiddenFields = ['_mw', '_mw_wo_sw', '_logp', '_formula', '_nonH'];\n\n// TODO: timestamp sort\nconst defaultSort = {\n    id: 'text',\n    compound_id: 'text',\n    assay_id: 'text',\n    svg: 'none',\n    json: 'none',\n    plot: 'none',\n    text: 'text',\n    ec50: 'numeric',\n    'active%': 'numeric',\n    'inhibition%': 'numeric',\n    filesize: 'numeric',\n    numeric: 'numeric',\n    count: 'numeric',\n    int: 'numeric',\n    flag: 'numeric',\n    bool: 'numeric',\n    timestamp: 'none',\n    image: 'none',\n    control: 'none',\n    'undefined': 'none'\n};\n\nconst defaultDigit = {\n    id: 'raw',\n    compound_id: 'raw',\n    assay_id: 'raw',\n    svg: 'raw',\n    json: 'raw',\n    plot: 'raw',\n    text: 'raw',\n    ec50: 'scientific',\n    'active%': 'rounded',\n    'inhibition%': 'rounded',\n    filesize: 'si',\n    numeric: 'rounded',\n    count: 'raw',\n    int: 'raw',\n    flag: 'raw',\n    bool: 'raw',\n    timestamp: 'raw',\n    image: 'raw',\n    control: 'raw',\n    'undefined': 'raw'\n};\n\nfunction defaultFieldProperties(fields) {\n  return fields.map(e => {\n    if (!e.hasOwnProperty('name')) e.name = e.key;\n    if (!e.hasOwnProperty('visible')) e.visible = !defaultHiddenFields.includes(e.key);\n    if (!e.hasOwnProperty('sortType')) e.sortType = defaultSort[e.valueType];\n    if (!e.hasOwnProperty('digit')) e.digit = defaultDigit[e.valueType];\n    return e;\n  });\n}\n\nfunction ongoing(data) {\n  return ['running', 'ready'].includes(data.status);\n}\n\n\nexport default {\n  defaultHiddenFields, defaultFieldProperties, ongoing\n};\n","\n\nclass KArray extends Array {\n  /**\n   * Return array of object filtered by given unique key\n   */\n  unique(key) {\n    return this.reduce((a, b) => {\n      if (a.find(e => e[key] === b[key]) === undefined) a.push(b);\n      return a;\n    }, new KArray());\n  }\n\n\n  /**\n   * Merge arrays\n   */\n  extend() {\n    return this.reduce((a, b) => {\n      Array.prototype.push.apply(a, b);\n      return a;\n    }, new KArray());\n  }\n\n\n  // Merge arrays(Asynchronous)\n  extendAsync() {\n    return Promise.all(this).then(res => {\n      return res.reduce((a, b) => {\n        Array.prototype.push.apply(a, b);\n        return a;\n      }, new KArray());\n    });\n  }\n\n  toArray() {\n    return new Array(this);\n  }\n\n  toObject() {\n    const obj = {};\n    this.forEach(kv => {\n      obj[kv[0]] = kv[1];\n    });\n    return obj;\n  }\n}\n\nexport default KArray;\n","\nimport KArray from './KArray.js';\n\n\nfunction URLQuery() {\n  return KArray.from(window.location.search.substring(1).split(\"&\"))\n    .map(e => e.split('=')).toObject();\n}\n\n\nexport default {\n  URLQuery\n};\n","\n/** @module helper/parser */\n\nfunction getSDFPropList(str) {\n  const re = />.*?<(\\S+)>/g;\n  const uniqCols = new Set();\n  let arr;\n  while ((arr = re.exec(str)) !== null) {\n    uniqCols.add(arr[1]);\n  }\n  return Array.from(uniqCols);\n}\n\n// Ref. https://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript\nfunction uuidv4() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n    var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\n    return v.toString(16);\n  });\n}\n\n// TODO: not used\nfunction queryFormData(query) {\n  const formData = new FormData();\n  Object.entries(query).forEach(kv => {\n    if (Array.isArray(kv[1])) {\n      kv[1].forEach(e => formData.append(kv[0], e));\n    } else {\n      formData.set(kv[0], kv[1]);\n    }\n  });\n  return formData;\n}\n\n\n// TODO: not used\nfunction queryURL(query) {\n  const queryStr = [];\n  Object.entries(query).forEach(e => {\n    const val = Array.isArray(e[1]) ? JSON.stringify(e[1]) : e[1];\n    const key = e[0];\n    // const encoded = encodeURIComponent(val);\n    queryStr.push(`${key}=${val}`);\n  });\n  return queryStr.join('&');\n}\n\n\n// TODO: not used\nfunction capitalized(str) {\n  return str.replace(/(?:^|\\s)\\S/g, e => e.toUpperCase());\n}\n\n\nexport default {\n  getSDFPropList, uuidv4\n};\n","\nimport Dexie from 'Dexie';\n\n// TODO: can indexed records improve query performance ?\n\nconst schema = {\n  app: 'key',\n  items: 'id, dataType, created',\n  resources: 'id'\n};\n\nlet idb = new Dexie('Store');\nidb.version(1).stores(schema);\n\n\nfunction getAppSetting(key) {\n  return idb.app.where('key').equals(key).first()\n    .then(res => {\n      if (res === undefined) return undefined;\n      return res.value;\n    });\n}\n\n\nfunction putAppSetting(k, v) {  // returns id in success\n  return idb.app.put({ key: k, value: v });\n}\n\n\nfunction getResources() {\n  return idb.resources.toArray();\n}\n\n\nfunction putResources(data) { // returns last id in success\n  return idb.resources.bulkPut(data);\n}\n\n\nfunction getAllItems() {\n  return idb.items.orderBy('created').reverse()\n    .toArray();\n}\n\n\nfunction getItemsByDataType(type) {\n  return idb.items.where('dataType').equals(type).reverse()\n    .sortBy('created');\n}\n\n\nfunction getItemById(tableId) {\n  return idb.items.where('id').equals(tableId).first();\n}\n\n\nfunction updateItem(tableId, callback) {  // returns num of updated items\n  return idb.items.where('id').equals(tableId).modify(callback);\n}\n\n\nfunction deleteItem(tableId) { // returns num of deleted items\n  return idb.items.where('id').equals(tableId).delete();\n}\n\n\nfunction putItem(data) { // returns id in success\n  return idb.items.put(data);\n}\n\n\nfunction reset() {\n  // Try this before tackling with local db troubles\n  return idb.delete().then(() => {\n    idb = new Dexie('Store');\n    idb.version(1).stores(schema);\n  });\n}\n\nexport default {\n  getAppSetting, putAppSetting, getResources, putResources,\n  getAllItems, getItemsByDataType, getItemById,\n  updateItem, deleteItem, putItem, reset\n};\n","\n/** @module helper/d3Form */\n\nimport d3 from 'd3';\n\n\nfunction value(selector) {\n  return d3.select(selector).node().value;\n}\n\n\nfunction valueInt(selector) {\n  return parseInt(d3.select(selector).node().value);\n}\n\n\nfunction valueFloat(selector) {\n  return parseFloat(d3.select(selector).node().value);\n}\n\n\nfunction checked(selector) {\n  return d3.select(selector).node().checked;\n}\n\n\nfunction firstFile(selector) {\n  return d3.select(selector).node().files[0];\n}\n\n\nfunction checkboxValues(selector) {\n  return d3.selectAll(selector).selectAll('input:checked').nodes().map(e => e.value);\n}\n\n\nfunction optionValues(selector) {\n  return d3.selectAll(selector).selectAll('select').nodes().map(e => e.value);\n}\n\n\nfunction textareaLines(selector) {\n  return d3.select(selector).node().value.split('\\n').filter(e => e.length > 0);\n}\n\n\nfunction optionData(selector) {\n  const si = d3.select(selector).property('selectedIndex');\n  return d3.select(selector).selectAll('option').data().find((d, i) => i === si);\n}\n\n\nfunction checkboxData(selector) {\n  return d3.selectAll(selector).selectAll('input:checked').data();\n}\n\n\nexport default {\n  value, valueInt, valueFloat, checked,\n  firstFile, checkboxValues, optionValues, textareaLines,\n  optionData, checkboxData\n};\n","\n/** @module helper/image */\n\nimport vega from 'vega';\n\nfunction showPlot(vegaSpec, selector) {\n  new vega.View(vega.parse(vegaSpec))\n    .initialize(selector)\n    .run();\n}\n\n\nfunction plotThumbnail(vegaSpec) {\n  const view = new vega.View(vega.parse(vegaSpec));\n  return view.toImageURL('png');  // Promise\n}\n\n\nexport default {\n  showPlot, plotThumbnail\n};\n","\nconst baseURL = '';\n\nfunction get(url, query={}) {\n  const isEmpty = Object.keys(query).length;\n  const q = isEmpty ? `?query=${JSON.stringify(query)}` : '';\n  return fetch(\n    `${baseURL}${url}${q}`,\n    {\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\nfunction json(response) {\n  return response.json();\n}\n\nfunction text(response) {\n  return response.text();\n}\n\nfunction blob(response) {\n  return response.blob();\n}\n\nfunction post(url, formdata) {\n  return fetch(\n    `${baseURL}${url}`,\n    {\n      method: 'POST',\n      body: formdata,\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\n\nfunction error(err) {\n  console.error(err);\n  return null;\n}\n\n\nexport default {\n  get, json, text, blob, post, error\n};\n","\n/** @module component/Dialog */\n\nimport d3 from 'd3';\n\nimport KArray from '../helper/KArray.js';\nimport {default as d3form} from '../helper/d3Form.js';\nimport {default as mapper} from '../helper/mapper.js';\nimport {default as def} from '../helper/definition.js';\nimport {default as fmt} from '../helper/formatValue.js';\nimport {default as win} from '../helper/window.js';\nimport {default as hfile} from '../helper/file.js';\nimport {default as misc} from '../helper/misc.js';\nimport {default as himg} from '../helper/image.js';\nimport {default as store} from '../store/StoreConnection.js';\nimport {default as cmp} from './Component.js';\nimport {default as fetcher} from '../fetcher.js';\n\n\nfunction pickDialog(resources, callback) {\n  store.getAppSetting('compoundIDPlaceholder').then(ids => {\n    d3.select('#pick-queryarea').text(ids);\n  });\n  d3.select('#pick-submit')\n    .on('click', () => {\n      d3.select('#loading-circle').style('display', 'inline');\n      const query = {\n        type: 'chemsearch',\n        targets: resources.filter(e => e.domain === 'chemical').map(e => e.id),\n        key: 'compound_id',\n        values: d3form.textareaLines('#pick-queryarea')\n      };\n      return fetcher.get('run', query)\n        .then(fetcher.json)\n        .then(callback, fetcher.error);\n    });\n}\n\n\nfunction propDialog(resources, callback) {\n  d3.select('#prop-targets')\n    .call(cmp.checkboxList, resources, 'targets', d => d.id, d => d.name)\n    .on('change', function () {\n      const cols = KArray.from(d3form.checkboxData('#prop-targets'))\n        .map(d => d.fields)\n        .extend().unique('key');\n      d3.select('#prop-key')\n        .call(cmp.selectOptions, cols, d => d.key, d => d.name);\n    });\n  d3.select('#prop-submit')\n    .on('click', () => {\n      d3.select('#loading-circle').style('display', 'inline');\n      const query = {\n        type: 'chemprop',\n        targets: d3form.checkboxValues('#prop-targets'),\n        key: d3form.optionData('#prop-key').key,\n        values: d3form.textareaLines('#prop-queryarea'),\n        operator: d3form.value('#prop-operator')\n      };\n      return fetcher.get('async', query)\n        .then(fetcher.json)\n        .then(callback, fetcher.error);\n    });\n}\n\n\nfunction structDialog(resources, callback) {\n  d3.select('#struct-qsrc')\n    .call(cmp.selectOptions, resources, d => d.id, d => d.name);\n  d3.select('#struct-targets')\n    .call(cmp.checkboxList, resources, 'targets', d => d.id, d => d.name);\n  store.getAppSetting('rdkit').then(rdk => {\n    d3.select('#struct-method').selectAll('option.rd')\n      .attr('disabled', rdk ? null : 'disabled');\n  });\n  d3.selectAll('#struct-method,#struct-thldtype')\n    .on('change', function () {\n      const method = d3form.value('#struct-method');\n      const thldtype = d3form.value('#struct-thldtype');\n      d3.select('#struct-thld')\n        .attr('disabled', ['gls', 'rdmorgan', 'rdfmcs'].includes(method) ? null : 'disabled')\n        .attr('value', thldtype === 'edge' ? 15 : 0.7)\n        .attr('min', thldtype === 'edge' ? 5 : 0)\n        .attr('max', thldtype === 'edge' ? 999 : 1.0)\n        .attr('step', thldtype === 'edge' ? 1 : 0.01);\n      d3.select('#struct-thldtype')\n        .attr('disabled', ['gls', 'rdmorgan', 'rdfmcs'].includes(method) ? null : 'disabled')\n        .property('value', ['gls', 'rdfmcs'].includes(method) ? undefined : 'sim');\n      d3.select('#struct-thldtype option.sim')\n        .attr('disabled', ['gls', 'rdmorgan', 'rdfmcs'].includes(method) ? null : 'disabled');\n      d3.select('#struct-thldtype option.edge')\n        .attr('disabled', ['gls', 'rdfmcs'].includes(method) ? null : 'disabled');\n      d3.select('#struct-options').selectAll('.gls')\n        .attr('disabled', method === 'gls' ? null : 'disabled');\n      d3.select('#struct-options .fmcs')\n        .attr('disabled', method === 'rdfmcs' ? null : 'disabled');\n    })\n    .dispatch('change');\n  d3.select('#struct-format')\n    .on('change', function () {\n      d3.select('#struct-qsrc')\n        .attr('disabled', this.value === 'dbid' ? null : 'disabled');\n    });\n  d3.select('#struct-preview')\n    .on('click', () => {\n      const fmt = d3form.value('#struct-format');\n      const query = {\n        format: fmt,\n        source: fmt === 'dbid' ? d3form.value('#struct-qsrc') : null,\n        value: fmt === 'molfile'\n          ? d3form.value('#struct-queryarea') : d3form.textareaLines('#struct-queryarea')[0],\n      };\n      return fetcher.get('strprev', query)\n        .then(fetcher.text)\n        .then(res => d3.select('#struct-image').html(res), fetcher.error);\n    });\n  d3.select('#struct-submit')\n    .on('click', () => {\n      const method = d3form.value('#struct-method');\n      d3.select('#loading-circle').style('display', 'inline');\n      const fmt = d3form.value('#struct-format');\n      const query = {\n        type: d3form.value('#struct-method'),\n        targets: d3form.checkboxValues('#struct-targets'),\n        queryMol: {\n          format: fmt,\n          source: fmt === 'dbid' ? d3form.value('#struct-qsrc') : null,\n          value: fmt === 'molfile'\n            ? d3form.value('#struct-queryarea') : d3form.textareaLines('#struct-queryarea')[0]\n        },\n        params: {\n          measure: d3form.value('#struct-thldtype'),\n          threshold: d3form.valueFloat('#struct-thld'),\n          ignoreHs: d3form.checked('#struct-ignoreh'),\n          diameter: method === 'gls' ? d3form.valueInt('#struct-diam') : null,\n          maxTreeSize: method === 'gls' ? d3form.valueInt('#struct-tree') : null,\n          molSizeCutoff: method === 'gls' ? d3form.valueInt('#struct-skip') : null,\n          timeout: method === 'rdfmcs' ? d3form.valueInt('#struct-timeout') : null\n        }\n      };\n      const command = query.type === 'exact' ? 'run' : 'async';\n      return fetcher.get(command, query)\n        .then(fetcher.json)\n        .then(callback, fetcher.error);\n    });\n}\n\n\nfunction sdfDialog(callback) {\n  d3.select('#sdf-file')\n    .on('change', () => {\n      const reader = new FileReader();\n      const file = document.getElementById('sdf-file').files[0];\n      reader.onload = (e) => {\n        d3.select('#sdf-cols')\n          .call(cmp.checkboxList, misc.getSDFPropList(e.target.result),\n                'fields', d => d, d => d\n          );\n      };\n      // Scan only first 100mb of the file due to memory limit.\n      reader.readAsText(file.slice(0, 100 * 1024 * 1024));\n    });\n  d3.select('#sdf-selectall')\n    .on('change', () => {\n      d3.select('#sdf-cols').selectAll('input')\n        .property('checked', d3form.checked('#sdf-selectall'));\n    });\n  d3.select('#sdf-submit')\n    .on('click', () => {\n      d3.select('#loading-circle').style('display', 'inline');\n      const params = {\n        fields: d3form.checkboxValues('#sdf-cols'),\n        implh: d3form.checked('#sdf-implh'),\n        recalc: d3form.checked('#sdf-recalc')\n      };\n      const formData = new FormData();\n      formData.append('contents', d3form.firstFile('#sdf-file'));\n      formData.append('params', JSON.stringify(params));\n      return fetcher.post('sdfin', formData)\n        .then(fetcher.json)\n        .then(callback, fetcher.error);\n    });\n}\n\n\nfunction columnDialog(dataFields, callback) {\n  const table = {\n    fields: def.defaultFieldProperties([\n      {key: 'name', valueType: 'text'},\n      {key: 'visible', valueType: 'control'},\n      {key: 'sortType', valueType: 'control'},\n      {key: 'digit', valueType: 'control'}\n    ])\n  };\n  const records = dataFields.map((e, i) => {\n    return {\n      key: e.key,\n      name: e.name,\n      visible: selection => selection\n          .classed('column-vis', true)\n          .classed(`row${i}`, true)\n        .append('input')\n          .attr('type', 'checkbox')\n          .attr('value', e.key)\n          .property('checked', e.visible)\n      ,sortType: selection => selection\n          .classed('column-sort', true)\n          .classed(`row${i}`, true)\n        .append('select')\n          .call(cmp.selectOptions,\n                e.sortType === 'none' ? ['none'] : ['numeric', 'text'], d => d, d => d)\n          .property('value', e.sortType)\n          .on('change', function () {\n            d3.select(`.column-digit.row${i} select`)\n              .attr('disabled', this.value === 'numeric' ? null : 'disabled');\n          })\n      ,digit: selection => selection\n          .classed('column-digit', true)\n          .classed(`row${i}`, true)\n        .append('select')\n          .call(cmp.selectOptions, ['raw', 'rounded', 'scientific', 'si'], d => d, d => d)\n          .property('value', e.digit)\n          .attr('disabled', e.sortType === 'numeric' ? null : 'disabled')\n    };\n  });\n  d3.select('#column-table')\n    .call(cmp.createTable, table)\n    .call(cmp.updateTableRecords, records, d => d.key);\n  d3.select('#column-submit')\n    .on('click', () => {\n      const query = {\n        visibles: d3form.checkboxValues('.column-vis'),\n        sortTypes: d3form.optionValues('.column-sort'),\n        digits: d3form.optionValues('.column-digit')\n      };\n      return store.setFieldProperties(win.URLQuery().id, query)\n        .then(callback);\n    });\n}\n\n\n// TODO:\nfunction fieldFetchDialog(compoundIDs, dataFields, resources, callback) {\n  // Prevent implicit submission\n  document.getElementById('join-search')\n    .addEventListener('keypress', event => {\n      if (event.keyCode === 13) event.preventDefault();\n    });\n  const dataKeys = dataFields.map(e => e.key);\n  const resourceFields = KArray.from(resources.map(e => e.fields))\n    .extend().unique('key').filter(e => e.key !== 'id');\n  d3.select('#join-keys')\n    .call(cmp.checkboxList, resourceFields, 'keys', d => d.key, d => d.name)\n    .selectAll('li')\n    .each(function(d) { // disable already shown columns\n      d3.select(this).selectAll('label').select('input')\n        .property('checked', dataKeys.includes(d.key))\n        .attr('disabled', dataKeys.includes(d.key) ? 'disabled' : null);\n    });\n  d3.select('#join-search')\n    .on('keyup', function () {\n      const match = d => fmt.partialMatch(d3form.value(this), d.name);\n      d3.select('#join-keys').selectAll('li')\n        .style('visibility', d => match(d) ? null : 'hidden')\n        .style('position', d => match(d) ? null : 'absolute');\n    });\n  d3.select('#join-submit')\n    .on('click', () => {\n      d3.select('#loading-circle').style('display', 'inline');\n      const selected = d3form.checkboxValues('#join-keys');\n      const queryFieldKeys = resourceFields.map(e => e.key)\n        .filter(e => !dataKeys.includes(e))\n        .filter(e => selected.includes(e));\n      const query = {\n        type: 'fieldfilter',\n        targetFields: queryFieldKeys,\n        key: 'compound_id',\n        values: compoundIDs\n      };\n      return fetcher.get('run', query)\n        .then(fetcher.json)\n        .then(json => callback(mapper.tableToMapping(json, 'id')),\n              fetcher.error);\n  });\n}\n\n\nfunction fieldFileDialog(callback) {\n  // TODO: need to refactor\n  d3.select('#importcol-file')\n    .on('change', () => {\n      const file = document.getElementById('importcol-file').files[0];\n      const isCsv = file.name.split('.').pop() === 'csv';\n      hfile.readFile(file).then(res => {\n        const mapping = isCsv ? mapper.csvToMapping(res) : JSON.parse(res);\n        const tbl = mapper.mappingToTable(mapping);\n        d3.select('#importcol-preview').call(cmp.createTable, tbl)\n          .call(cmp.updateTableRecords,\n                tbl.records.slice(0, 5), d => d[tbl.fields[0].key]);\n        // bind mapping\n        d3.select('#importcol-preview').datum(mapping);\n      });\n    });\n  d3.select('#importcol-submit')\n    .on('click', () => {\n      let mapping = d3.select('#importcol-preview').datum();\n      d3.select('#importcol-preview').datum(null);  // unbind mapping\n      // Generate thumbnails\n      const plotCols = [];\n      if (mapping.hasOwnProperty('field')) {\n        mapping = mapper.singleToMulti(mapping);\n      }\n      mapping.fields.forEach((e, i) => {\n        if (e.valueType === 'plot') {\n          mapping.fields[i].valueType = 'image';\n          plotCols.push(i);\n        }\n      });\n      if (plotCols.length > 0) {\n        const ps = [];\n        Object.entries(mapping.mapping).forEach(m => {\n          plotCols.forEach(e => {\n            const p = himg.plotThumbnail(m[1][e])\n              .then(img => {\n                mapping.mapping[m[0]][e] = img;\n              });\n            ps.push(p);\n          });\n        });\n        Promise.all(ps).then(() => callback(mapping));\n      } else {\n        callback(mapping);\n      }\n    });\n}\n\n\nfunction graphDialog(callback) {\n  store.getAppSetting('rdkit').then(rdk => {\n    d3.select('#graph-measure').selectAll('option.rd')\n      .attr('disabled', rdk ? null : 'disabled');\n  });\n  d3.select('#graph-measure')\n    .on('change', function () {\n      d3.select('#graph-options').selectAll('.gls')\n        .attr('disabled', this.value === 'gls' ? null : 'disabled');\n      d3.select('#graph-options').selectAll('.fmcs')\n        .attr('disabled', this.value === 'rdfmcs' ? null : 'disabled');\n    });\n  d3.select('#graph-submit')\n    .on('click', () => {\n      d3.select('#loading-circle').style('display', 'inline');\n      const measure = d3form.value('#graph-measure');\n      const params = {\n        measure: measure,\n        threshold: d3form.valueFloat('#graph-thld'),\n        ignoreHs: d3form.checked('#graph-ignoreh'),\n        diameter: measure === 'gls' ? d3form.valueInt('#graph-diam') : null,\n        maxTreeSize: measure === 'gls' ? d3form.valueInt('#graph-tree') : null,\n        molSizeCutoff: measure === 'gls' ? d3form.valueInt('#graph-skip') : null,\n        timeout: measure === 'rdfmcs' ? d3form.valueInt('#graph-timeout') : null\n      };\n      callback(params);\n    });\n}\n\n\nfunction graphConfigDialog(currentThld, minThld, callback) {\n  d3.select('#graphconfig-thld')\n    .attr('value', currentThld)\n    .attr('max', 1.0)\n    .attr('min', minThld);\n  d3.select('#graphconfig-submit')\n    .on('click', () => {\n      const newThld = d3form.valueFloat('#graphconfig-thld');\n      if (newThld < minThld) return;  // TODO: fool proof\n      callback(newThld);\n    });\n}\n\n\nfunction communityDialog(callback) {\n  d3.select('#community-name').attr('value', 'comm_');\n  d3.select('#community-submit')\n    .on('click', () => {\n      const query = {\n        name: d3form.value('#community-name'),\n        nulliso: d3form.checked('#community-nulliso')\n      };\n      callback(query);\n    });\n}\n\n\nfunction importConfirmDialog(callback) {\n  d3.select('#importconfirm-overwrite')\n    .on('click', () => callback('overwrite'));\n  d3.select('#importconfirm-keepboth')\n    .on('click', () => callback('keepboth'));\n  d3.select('#importconfirm-cancel')\n    .on('click', () => callback('cancel'));\n}\n\n\nexport default {\n  pickDialog, propDialog, structDialog, sdfDialog,\n  columnDialog, fieldFetchDialog, fieldFileDialog, graphDialog,\n  graphConfigDialog, communityDialog, importConfirmDialog\n};\n","\nimport {default as def} from './helper/definition.js';\nimport {default as win} from './helper/window.js';\nimport {default as misc} from './helper/misc.js';\nimport {default as store} from './store/StoreConnection.js';\nimport {default as dialog} from './component/Dialog.js';\nimport {default as fetcher} from './fetcher.js';\n\n\nfunction interactiveInsert(data) {\n  return store.getTable(data.id)\n    .then(found => {\n      if (!found) return Promise.resolve(data); // no existing table\n      if (data.revision == found.revision) return Promise.reject(data.id); // same revision\n      // data id conflict\n      $('#importconfirm-dialog').modal('toggle');\n      return new Promise(res => {\n        dialog.importConfirmDialog(action => {\n          if (action === 'overwrite') {\n            res(data);\n          }\n          if (action === 'keepboth') {\n            data.id = misc.uuidv4();\n            res(data);\n          }\n        });\n      });\n    })\n    .then(\n      data => store.insertTable(data).then(() => data.id), // insert or update table\n      id => {\n        if (id) return Promise.resolve(id); // same revision -> call existing table\n        return Promise.reject();\n      }\n    );\n}\n\n\nfunction fetchResults(command='update') {\n  return store.getTable(win.URLQuery().id)\n    .then(data => {\n      if (!def.ongoing(data)) return Promise.reject();\n      return data;\n    })\n    .then(data => {\n      const query = {id: data.id, command: command};\n      return fetcher.get('res', query)\n        .then(fetcher.json)\n        .then(store.updateTable, fetcher.error);\n    }, () => Promise.resolve());\n}\n\n\nfunction loader() {\n  /*\n  if (document.location.protocol === \"file:\") {\n    console.info('Off-line mode (local file)');\n    store.setGlobalConfig('onLine', false);\n    return Promise.resolve();\n  }\n  if ('onLine' in navigator) {\n    if (!navigator.onLine) {\n      console.info('Off-line mode (no internet connection)');\n      store.setGlobalConfig('onLine', false);\n      return Promise.resolve();\n    }\n  }*/\n  if ('serviceWorker' in navigator && !debug) {\n    navigator.serviceWorker\n      .register('sw.js')\n      .then(reg => {\n        console.info('ServiceWorker registration successful with scope: ', reg.scope);\n      }).catch(err => {\n        console.info('ServiceWorker registration failed: ', err);\n      });\n  } else if (debug) {\n    console.info('Off-line mode is disabled for debugging');\n  } else {\n    console.info('Off-line mode is not supported');\n  }\n  const server = fetcher.get('server')\n    .then(fetcher.json)\n    .catch(() => null);\n  const local = store.getAppSetting('serverInstance');\n  return Promise.all([server, local]).then(ps => {\n    const serverStatus = ps[0];\n    const clientInstance = ps[1];\n    if (!serverStatus) return Promise.resolve(null);\n    if (serverStatus.instance === clientInstance) {\n      console.info('Resource schema is already up to date');\n      return Promise.resolve(serverStatus);\n    } else {\n      return fetcher.get('schema')\n        .then(fetcher.json)\n        .then(schema => {\n          console.info(`New resource schema version: ${serverStatus.instance}`);\n          return Promise.all([\n            store.setResources(schema.resources),\n            store.setAppSetting('templates', schema.templates),\n            store.setAppSetting(\n              'compoundIDPlaceholder', schema.compoundIDPlaceholder),\n            store.setAppSetting('serverInstance', serverStatus.instance),\n            store.setAppSetting('rdkit', serverStatus.rdkit)\n          ])\n          .then(() => Promise.resolve(serverStatus));\n        }, fetcher.error);\n    }\n  });\n}\n\n\nexport default {\n  interactiveInsert, fetchResults, loader\n};\n"],"names":["singleToMulti","mapping","newMapping","Object","entries","forEach","m","created","fields","field","key","updateTableAttribute","id","value","store","updateItem","item","revision","catch","err","console","error","Promise","reject","numericAsc","a","b","fa","parseFloat","fb","isNaN","String","localeCompare","textAsc","v07_to_v08_nodes","json","columns","map","e","sortType","sort","name","dataType","dataTypeConv","format","schemaVersion","status","statusConv","records","query","taskCount","searchCount","doneCount","searchDoneCount","resultCount","recordCount","progress","execTime","startDate","responseDate","v07_to_v08_edges","nodeFields","snp","fieldTransform","snapshot","nodePositions","nodeColor","nodeSize","nodeLabel","edge","hasOwnProperty","scale","find","column","domain","range","unknown","size","text","visible","nodeContent","structure","label","nodesID","nodeTableId","def","defaultFieldProperties","networkThreshold","v07_to_v08_convert","nodes","edges","readFile","file","sizeLimit","blob","resolve","reader","FileReader","truncated","slice","onload","event","target","result","onerror","readAsArrayBuffer","readAsText","parseJSON","data","compressed","pako","inflate","to","JSON","parse","downloadDataFile","url","window","URL","createObjectURL","Blob","document","createElement","download","href","dispatchEvent","MouseEvent","view","bubbles","cancelable","updateTableRecords","selection","rcds","keyFunc","header","select","selectAll","rowSelection","exit","remove","rowEntered","enter","append","d","merge","classed","html","i","undefined","valueType","digit","fmt","formatNum","each","d3","call","tableAction","app","attr","ongoing","insert","property","on","deleteTable","then","run","renderTableStatus","table","action","s","cmp","createTable","renderGraphStatus","renderServerStatus","calc","_index","server","filter","getAllTables","tables","all","tbl","command","fetcher","get","updateTable","reset","common","loader","serverStatus","getTablesByDataType","defaultHiddenFields","defaultSort","compound_id","assay_id","svg","plot","ec50","active%","inhibition%","filesize","numeric","count","int","flag","bool","timestamp","image","control","defaultDigit","includes","KArray","Array","[object Object]","this","reduce","push","prototype","apply","res","obj","kv","URLQuery","from","location","search","substring","split","toObject","getSDFPropList","str","re","uniqCols","Set","arr","exec","add","uuidv4","replace","c","r","Math","random","toString","mappingToTable","mp","keyField","concat","entry","rcd","f","tableToMapping","ignore","Date","row","csvToMapping","csvString","lines","shift","now","headerIdx","h","line","values","k","length","fd","unique","schema","items","resources","idb","Dexie","version","stores","where","equals","first","putAppSetting","v","put","toArray","putResources","bulkPut","getAllItems","orderBy","reverse","getItemsByDataType","type","sortBy","getItemById","tableId","callback","modify","deleteItem","delete","putItem","getAppSetting","setAppSetting","getResources","setResources","rsrcs","getTable","setFieldProperties","updates","visibles","sortTypes","digits","joinFields","mapper","insertTable","assign","selector","node","valueInt","parseInt","valueFloat","checked","firstFile","files","checkboxValues","optionValues","textareaLines","optionData","si","checkboxData","conv","scientific","rounded","Number","partialMatch","toUpperCase","indexOf","numericDesc","textDesc","Queued","In progress","Aborting","Aborted","Completed","Failure","datatable","connection","loadJSON","endsWith","fetchJSON","decoded","decodeURIComponent","fetch","arrayBuffer","downloadJSON","compress","stringify","gzip","showPlot","vegaSpec","vega","View","initialize","plotThumbnail","toImageURL","selectOptions","options","checkboxList","entered","updated","checkboxListT","description","cols","appendTableRows","newRcds","addSort","style","isAsc","isNum","formatNumbers","col","colIdx","baseURL","q","keys","credentials","Error","statusText","response","post","formdata","method","body","pickDialog","ids","targets","d3form","propDialog","extend","operator","structDialog","rdk","thldtype","dispatch","source","queryMol","params","measure","threshold","ignoreHs","diameter","maxTreeSize","molSizeCutoff","timeout","sdfDialog","getElementById","misc","implh","recalc","formData","FormData","columnDialog","dataFields","win","fieldFetchDialog","compoundIDs","addEventListener","keyCode","preventDefault","dataKeys","resourceFields","match","selected","targetFields","fieldFileDialog","isCsv","pop","hfile","datum","plotCols","ps","p","himg","img","graphDialog","graphConfigDialog","currentThld","minThld","newThld","communityDialog","nulliso","importConfirmDialog","interactiveInsert","found","$","modal","dialog","fetchResults","navigator","debug","serviceWorker","register","reg","info","scope","local","clientInstance","instance","templates","compoundIDPlaceholder","rdkit"],"mappings":"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"}