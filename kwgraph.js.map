{"version":3,"file":"kwgraph.js","sources":["../src/helper/file.js","../src/helper/mapper.js","../src/store/StoreConnection.js","../src/helper/formatValue.js","../src/component/Component.js","../src/common.js","../src/graph/GraphControlBox.js","../src/graph/GraphInteraction.js","../src/graph.js","../src/helper/d3Form.js","../src/helper/d3Scale.js","../src/helper/definition.js","../src/helper/KArray.js","../src/helper/window.js","../src/helper/misc.js","../src/store/IDBStore.js","../src/helper/image.js","../src/fetcher.js","../src/component/Dialog.js","../src/component/Header.js","../src/graph/GraphForce.js","../src/graph/defaultGraphControl.js","../src/graph/GraphComponent.js","../src/graph/communityDetection.js"],"sourcesContent":["\n/** @module helper/file */\n\nimport pako from 'pako';\n\nimport {default as def} from './definition.js';\n\nconst statusConv = {\n  Queued: 'ready',\n  'In progress': 'running',\n  Aborting: 'running',\n  Aborted: 'aborted',\n  Completed: 'done',\n  Failure: 'failure'\n};\n\nconst dataTypeConv = {\n  datatable: 'nodes',\n  connection: 'edges'\n};\n\nfunction v07_to_v08_nodes(json) {\n  const fields = json.columns.map(e => {\n    e.format = 'raw';\n    return e;\n  });\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    status: statusConv[json.status],\n    fields: fields,\n    records: json.records,\n    query: json.query,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n  };\n}\n\nfunction v07_to_v08_edges(json, nodeFields) {\n  const snp = {\n    fieldTransform: json.snapshot.fieldTransform,\n    nodePositions: json.snapshot.nodePositions,\n    nodeColor: {},\n    nodeSize: {},\n    nodeLabel: {},\n    edge: {}\n  };\n  if (json.snapshot.hasOwnProperty('nodeColor')) {\n    snp.nodeColor.id = json.snapshot.nodeColor.id;\n    snp.nodeColor.scale = json.snapshot.nodeColor.scale;\n    snp.nodeColor.field = nodeFields.find(e => e.key === json.snapshot.nodeColor.column);\n  } else {\n    snp.nodeColor = {\n      id: 'color', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeSize')) {\n    snp.nodeSize.id = json.snapshot.nodeSize.id;\n    snp.nodeSize.scale = json.snapshot.nodeSize.scale;\n    snp.nodeSize.field = nodeFields.find(e => e.key === json.snapshot.nodeSize.column);\n  } else {\n    snp.nodeSize = {\n      id: 'size', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: [20, 20], unknown: 20}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeLabel')) {\n    snp.nodeLabel.id = json.snapshot.nodeLabel.id;\n    snp.nodeLabel.size = json.snapshot.nodeLabel.size;\n    snp.nodeLabel.text = json.snapshot.nodeLabel.text;\n    snp.nodeLabel.visible = json.snapshot.nodeLabel.visible;\n    snp.nodeLabel.scale = json.snapshot.nodeLabel.scale;\n    snp.nodeLabel.field = nodeFields.find(e => e.key === json.snapshot.nodeLabel.column);\n  } else {\n    snp.nodeLabel = {\n      id: 'label', size: 12, text: 'index', visible: false, field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeContent')) {\n    snp.nodeContent = json.snapshot.nodeContent;\n  } else {\n    snp.nodeContent = {structure: {visible: false}};\n  }\n  if (json.snapshot.hasOwnProperty('edge')) {\n    snp.edge = json.snapshot.edge;\n  } else {\n    snp.edge = {\n      id: 'label', label: {size: 10, visible: false}, visible: true,\n      scale: {scale: 'linear', domain: [0, 1], range: [5, 5], unknown: 5}\n    };\n  }\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    reference: {\n      nodes: json.nodeTableId\n    },\n    status: statusConv[json.status],\n    fields: def.defaultFieldProperties([\n      {'key': 'source'},\n      {'key': 'target'},\n      {'key': 'weight'}\n    ]),\n    records: json.records,\n    query: json.query,\n    networkThreshold: json.networkThreshold,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n    snapshot: snp\n  };\n}\n\nfunction v07_to_v08_convert(json) {\n  if (json.hasOwnProperty('edges')) {\n    const nodes = v07_to_v08_nodes(json.nodes);\n    const edges = v07_to_v08_edges(json.edges, nodes.fields);\n    return {nodes: nodes, edges: edges};\n  } else {\n    return v07_to_v08_nodes(json);\n  }\n}\n\n\nfunction readFile(file, sizeLimit, blob) {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    const truncated = sizeLimit ? file.slice(0, sizeLimit) : file;\n    reader.onload = event => resolve(event.target.result);\n    reader.onerror = error => reject(error);\n    if (blob) {\n      reader.readAsArrayBuffer(truncated);\n    } else {\n      reader.readAsText(truncated);\n    }\n  });\n}\n\n\nfunction parseJSON(data, compressed) {\n  const text = compressed ? pako.inflate(data, {to: 'string'}) : data;\n  const json = JSON.parse(text);\n  if (json.hasOwnProperty('schemaVersion')) return json;\n  if (json.hasOwnProperty('edges')) {\n    if (json.edges.hasOwnProperty('schemaVersion')) return json;\n  }\n  return v07_to_v08_convert(json);\n}\n\n\nfunction loadJSON(file) {\n  const compressed = file.name.endsWith('c') || file.name.endsWith('.gz');\n  return readFile(file, false, compressed)\n    .then(data => parseJSON(data, compressed));\n}\n\n\nfunction fetchJSON(url) {\n  const decoded = decodeURIComponent(url);\n  const compressed = decoded.endsWith('c') || decoded.endsWith('.gz');\n  return fetch(decoded)\n    .then(res => compressed ? res.arrayBuffer() : res.json())\n    .then(data => parseJSON(data, compressed));\n}\n\n\nfunction downloadDataFile(data, name) {\n  try {\n    // cannot hundle large file with dataURI scheme\n    // url = 'data:application/json,' + encodeURIComponent(JSON.stringify(json))\n    const url = window.URL.createObjectURL(new Blob([data]));\n    const a = document.createElement('a');\n    a.download = name;\n    a.href = url;\n    // a.click() does not work on firefox\n    a.dispatchEvent(new MouseEvent('click', {\n      'view': window,\n      'bubbles': true,\n      'cancelable': false\n    }));\n    // window.URL.revokeObjectURL(url) does not work on firefox\n  } catch (e) {\n    // no DOM (unit testing)\n  }\n}\n\n\nfunction downloadJSON(json, name, compress=true) {\n  const str = JSON.stringify(json);\n  const data = compress ? pako.gzip(str) : str;\n  const c = compress ? 'c' : 'r';\n  const ext = json.hasOwnProperty('edges') ? `.gf${c}` :  `.nd${c}`;\n  downloadDataFile(data, `${name}${ext}`);\n}\n\n\nexport default {\n  readFile, parseJSON, loadJSON, fetchJSON,\n  downloadDataFile, downloadJSON\n};\n","\n/** @module helper/dataStructure */\n\nimport KArray from './KArray.js';\nimport {default as def} from './definition.js';\n\n\n/**\n * Convert single field mapping to multi field mapping\n * @param {object} mapping - single field mapping\n * @return {object} multi field mapping\n */\nfunction singleToMulti(mapping) {\n  const newMapping = {};\n  Object.entries(mapping.mapping).forEach(m => {\n    newMapping[m[0]] = [m[1]];\n  });\n  return {\n    created: mapping.created,\n    fields: [mapping.field],\n    key: mapping.key,\n    mapping: newMapping\n  };\n}\n\n\n/**\n * Convert field mapping to table\n * @param {object} mapping - field mapping\n * @return {object} table object\n */\nfunction mappingToTable(mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  const keyField = {key: mp.key, format: 'text'};\n  const data = {\n    fields: def.defaultFieldProperties([keyField].concat(mp.fields)),\n    records: Object.entries(mp.mapping).map(entry => {\n      const rcd = {};\n      rcd[mp.key] = entry[0];\n      mp.fields.forEach((f, i) => {\n        rcd[f.key] = entry[1][i];\n      });\n      return rcd;\n    })\n  };\n  return data;\n}\n\n\n/**\n * Convert table to field mapping\n * @param {object} table - table\n * @param {object} key - key\n * @return {object} field mapping\n */\nfunction tableToMapping(table, key, ignore=['index']) {\n  const now = new Date();\n  const mapping = {\n    created: now.toString(),\n    fields: def.defaultFieldProperties(table.fields\n      .filter(e => e.key !== key)\n      .filter(e => !ignore.includes(e.key))),\n    key: key,\n    mapping: {}\n  };\n  table.records.forEach(row => {\n    mapping.mapping[row[key]] = mapping.fields.map(e => row[e.key]);\n  });\n  return mapping;\n}\n\n\n/**\n * Convert csv text to field mapping\n * @param {string} csvString - csv data text\n * @return {object} field mapping\n */\nfunction csvToMapping(csvString) {\n  const lines = csvString.split(/\\n|\\r|\\r\\n/);\n  const header = lines.shift().split(',');\n  const key = header.shift();\n  const now = new Date();\n  const headerIdx = [];\n  const fields = [];\n  header.forEach((h, i) => {\n    if (h === '') return;\n    headerIdx.push(i);\n    fields.push({key: h, format: 'text'});\n  });\n  const mapping = {\n    created: now.toString(),\n    fields: def.defaultFieldProperties(fields),\n    key: key,\n    mapping: {}\n  };\n  lines.forEach(line => {\n    const values = line.split(',');\n    const k = values.shift();\n    mapping.mapping[k] = Array(headerIdx.length);\n    headerIdx.forEach(i => {\n      mapping.mapping[k][i] = values[i];\n    });\n  });\n  return mapping;\n}\n\n\n/**\n * Apply mapping to the data (in-place)\n * @param {object} data - datatable JSON\n * @param {object} mapping - mapping JSON\n * @return {undefined} undefined\n */\nfunction apply(data, mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  data.records\n    .filter(rcd => mp.mapping.hasOwnProperty(rcd[mp.key]))\n    .forEach(rcd => {\n      mp.fields.forEach((fd, i) => {\n        rcd[fd.key] = mp.mapping[rcd[mp.key]][i];\n      });\n    });\n  data.fields = def.defaultFieldProperties(\n    KArray.from(data.fields).concat(mp.fields).unique('key'));\n}\n\n\nexport default {\n  singleToMulti, mappingToTable, tableToMapping, csvToMapping, apply\n};\n","\nimport {default as def} from '../helper/definition.js';\nimport {default as mapper} from '../helper/mapper.js';\nimport {default as store} from './IDBStore.js';\n\n\nfunction getAppSetting(key) {\n  return store.getAppSetting(key)\n    .catch(err => {\n      console.error(`Unexpected key: ${key}`);\n      Promise.reject(err);\n    });\n}\n\n\nfunction setAppSetting(key, value) {\n  return store.putAppSetting(key, value)\n    .catch(err => {\n      console.error(`Unexpected key: ${key} or value: ${value}`);\n      Promise.reject(err);\n    });\n}\n\n\nfunction getResources() {\n  return store.getResources();\n}\n\n\nfunction setResources(rsrcs) {\n  return store.putResources(rsrcs)\n    .catch(err => {\n      console.error(`Unexpected resources: ${rsrcs}`);\n      Promise.reject(err);\n    });\n}\n\n\nfunction getAllTables() {\n  return store.getAllItems();\n}\n\n\nfunction getTablesByDataType(type) {\n  return store.getItemsByDataType(type)\n    .catch(err => {\n      console.error(`Unexpected dataType: ${type}`);\n      Promise.reject(err);\n    });\n}\n\n\nfunction getTable(id) {\n  return store.getItemById(id)\n    .catch(err => {\n      console.error(`Unexpected table ID: ${id}`);\n      Promise.reject(err);\n    });\n}\n\n\nfunction setFieldProperties(id, updates) {\n  return store.updateItem(id, item => {\n    item.fields.forEach((fd, i) => {\n      fd.visible = updates.visibles.includes(fd.key);\n      fd.format = updates.formats[i];\n      if (updates.d3_formats[i]) fd.d3_format = updates.d3_formats[i];\n    });\n    item.revision++;\n  })\n  .catch(err => {\n    console.error(`Unexpected table ID: ${id} or updates: ${updates}`);\n    Promise.reject(err);\n  });\n}\n\n\nfunction joinFields(id, mapping) {\n  return store.updateItem(id, item => {\n    mapper.apply(item, mapping);\n    item.revision++;\n  })\n  .catch(err => {\n    console.error(`Unexpected table ID: ${id} or mapping: ${mapping}`);\n    Promise.reject(err);\n  });\n}\n\n\nfunction updateTableAttribute(id, key, value) {\n  return store.updateItem(id, item => {\n    item[key] = value;\n    item.revision++;\n  })\n  .catch(err => {\n    console.error(`Unexpected table ID: ${id}, key: ${key} or value: ${value}`);\n    Promise.reject(err);\n  });\n}\n\n\nfunction insertTable(data) {\n  data.fields = def.defaultFieldProperties(data.fields);\n  return store.putItem(data)\n    .catch(err => {\n      console.error(`Unexpected data: ${data}`);\n      Promise.reject(err);\n    });\n}\n\n\nfunction updateTable(data) {\n  if (data.status === 'failure') {  // No data found on server\n    return updateTableAttribute(data.id, 'status', 'failure');\n  }\n  // update\n  return store.updateItem(data.id, item => {\n    data.fields = def.defaultFieldProperties(data.fields);\n    Object.assign(item, data);\n    item.revision++;\n  });\n}\n\n\nfunction deleteTable(id) {\n  return store.deleteItem(id)\n    .catch(err => {\n      console.error(`Unexpected table ID: ${id}`);\n      Promise.reject(err);\n    });\n}\n\n\nfunction reset() {\n  return store.reset();\n}\n\n\nexport default {\n  getAppSetting, setAppSetting, getResources, setResources,\n  getAllTables, getTablesByDataType, getTable,\n  setFieldProperties, joinFields,\n  updateTableAttribute, insertTable, updateTable,\n  deleteTable, reset\n};\n","\n/** @module helper/formatValue */\n\nimport d3 from 'd3';\n\n\n/**\n * Format number\n * @param {object} value - value\n * @param {string} type - si | scientific | rounded | raw\n */\nfunction formatNum(value, d3format) {\n  if (value === undefined || value === null || Number.isNaN(value)) return '';\n  return value == parseFloat(value) ? d3.format(d3format)(value) : value;\n}\n\nfunction partialMatch(query, target) {\n  if (target === undefined || target === null || target === '') return false;\n  return target.toString().toUpperCase()\n    .indexOf(query.toString().toUpperCase()) !== -1;\n}\n\nfunction numericAsc(a, b) {\n  const fa = parseFloat(a);\n  const fb = parseFloat(b);\n  if (isNaN(fa) || isNaN(fb)) {\n    return String(b).localeCompare(String(a));\n  }\n  return fb - fa;\n}\n\n\nfunction numericDesc(a, b) {\n  return numericAsc(b, a);\n}\n\n\nfunction textAsc(a, b) {\n  return String(b).localeCompare(String(a));\n}\n\n\nfunction textDesc(a, b) {\n  return textAsc(b, a);\n}\n\n\nexport default {\n  formatNum, partialMatch,\n  numericAsc, numericDesc, textAsc, textDesc\n};\n","\n/** @module component/Component */\n\nimport d3 from 'd3';\nimport {default as def} from '../helper/definition.js';\nimport {default as fmt} from '../helper/formatValue.js';\n\n\nfunction selectOptions(selection, data, key, text) {\n  const options = selection.selectAll('option')\n    .data(data, key);\n  options.exit().remove();\n  options.enter().append('option')\n    .merge(options)\n      .attr('value', key)\n      .text(text);\n}\n\n\nfunction checkboxList(selection, data, name, key, text) {\n  const items = selection.selectAll('li').data(data, key);\n  items.exit().remove();\n  const entered = items.enter().append('li')\n    .attr('class', 'form-check')\n    .append('label');\n  entered.append('input');\n  entered.append('span');\n  const updated = entered.merge(items.select('label'))\n    .attr('class', 'form-check-label');\n  updated.select('input')\n    .attr('type', 'checkbox')\n    .attr('class', 'form-check-input')\n    .attr('name', name)\n    .attr('value', key);\n  updated.select('span')\n    .text(text);\n}\n\n\n// checkbox list with tooltip\n// call $('[data-toggle=\"tooltip\"]').tooltip() after this function\nfunction checkboxListT(selection, data, name, key, text) {\n  const items = selection.selectAll('li').data(data, key);\n  items.exit().remove();\n  const entered = items.enter().append('li')\n    .attr('class', 'form-check')\n    .append('label');\n  entered.append('input');\n  entered.append('a');\n  const updated = entered.merge(items.select('label'))\n    .attr('class', 'form-check-label');\n  updated.select('input')\n    .attr('type', 'checkbox')\n    .attr('class', 'form-check-input')\n    .attr('name', name)\n    .attr('value', key);\n  updated.select('a')\n    .attr('data-toggle', 'tooltip')\n    .attr('data-placement', 'bottom')\n    .attr('title', d => d.description || 'No')\n    .text(text);\n}\n\n\nfunction createTable(selection, data) {\n  // Header\n  if (selection.select('thead').size()) selection.select('thead').remove();\n  selection.append('thead').append('tr');\n  // Records\n  if (selection.select('tbody').size()) selection.select('tbody').remove();\n    selection.append('tbody');\n\n  const cols = data.fields.filter(e => e.visible);\n  const header = selection.select('thead tr').selectAll('th')\n    .data(cols, d => d.key);\n  header.exit().remove();\n  header.enter().append('th')\n    .merge(header)\n      .text(d => d.name);\n}\n\n\nfunction updateTableRecords(selection, rcds, keyFunc) {\n  const header = selection.select('thead tr').selectAll('th')\n    .data();\n  const rowSelection = selection.select('tbody').selectAll('tr')\n    .data(rcds, keyFunc);\n  rowSelection.exit().remove();\n  const rowEntered = rowSelection.enter().append('tr');\n  rowEntered.selectAll('td')\n    .data(d => header.map(e => d[e.key]))\n    .enter().append('td');\n  rowEntered.merge(rowSelection)\n    .selectAll('td')\n      .classed('align-middle', true)\n    .html(function (d, i) {\n      if (d === undefined) return '';\n      if (header[i].format === 'd3_format') {\n        return fmt.formatNum(d, header[i].d3_format);\n      }\n      if (header[i].format === 'plot') return '[plot]';\n      if (header[i].format === 'image') return '[image]';\n      if (header[i].format === 'control') return;\n      return d;\n    })\n    .each((d, i, nodes) => {\n      // This should be called after html\n      if (header[i].format === 'control') d3.select(nodes[i]).call(d);\n    });\n}\n\n\nfunction appendTableRows(selection, rcds, keyFunc) {\n  const newRcds = selection.select('tbody').selectAll('tr').data();\n  Array.prototype.push.apply(newRcds, rcds);\n  updateTableRecords(selection, newRcds, keyFunc);\n}\n\n\nfunction addSort(selection) {\n  selection.select('thead tr').selectAll('th')\n    .filter(d => def.sortType(d.format) !== 'none')\n    .append('span').append('a')\n      .attr('id', d => `sort-${d.key}`)\n      .text('^v')\n      .style('display', 'inline-block')\n      .style('width', '30px')\n      .style('text-align', 'center')\n    .on('click', d => {\n      const isAsc = d3.select(`#sort-${d.key}`).text() === 'v';\n      const isNum = def.sortType(d.format) === 'numeric';\n      const cmp = isAsc\n        ? (isNum ? fmt.numericAsc : fmt.textAsc)\n        : (isNum ? fmt.numericDesc : fmt.textDesc);\n      selection.select('tbody').selectAll('tr')\n        .sort((a, b) => cmp(a[d.key], b[d.key]));\n      d3.select(`#sort-${d.key}`)\n        .text(isAsc ? '^' : 'v');\n    });\n}\n\n\nfunction formatNumbers(selection) {\n  // DEPRECATED: no longer used\n  selection.select('thead tr').selectAll('th')\n    .each((col, colIdx) => {\n      if (col.digit === 'raw') return;\n      selection.select('tbody').selectAll('tr')\n        .selectAll('td')\n          .filter((d, i) => i === colIdx)\n          .text(d => fmt.formatNum(d, col.digit));\n    });\n}\n\n\nexport default {\n  selectOptions, checkboxList, checkboxListT,\n  createTable, updateTableRecords,\n  appendTableRows, addSort, formatNumbers\n};\n","\nimport {default as def} from './helper/definition.js';\nimport {default as win} from './helper/window.js';\nimport {default as misc} from './helper/misc.js';\nimport {default as store} from './store/StoreConnection.js';\nimport {default as dialog} from './component/Dialog.js';\nimport {default as fetcher} from './fetcher.js';\n\n\nfunction interactiveInsert(data) {\n  return store.getTable(data.id)\n    .then(found => {\n      if (!found) return Promise.resolve(data); // no existing table\n      if (data.revision == found.revision) return Promise.reject(data.id); // same revision\n      // data id conflict\n      $('#importconfirm-dialog').modal('toggle');\n      return new Promise(res => {\n        dialog.importConfirmDialog(action => {\n          if (action === 'overwrite') {\n            res(data);\n          }\n          if (action === 'keepboth') {\n            data.id = misc.uuidv4();\n            res(data);\n          }\n        });\n      });\n    })\n    .then(\n      data => store.insertTable(data).then(() => data.id), // insert or update table\n      id => {\n        if (id) return Promise.resolve(id); // same revision -> call existing table\n        return Promise.reject();\n      }\n    );\n}\n\n\nfunction fetchResults(command='update') {\n  return store.getTable(win.URLQuery().id)\n    .then(data => {\n      if (!def.ongoing(data)) return Promise.reject();\n      return data;\n    })\n    .then(data => {\n      const query = {id: data.id, command: command};\n      return fetcher.get('res', query)\n        .then(fetcher.json)\n        .then(store.updateTable, fetcher.error);\n    }, () => Promise.resolve());\n}\n\n\nfunction registerServiceWorker() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker\n      .register('sw.js')\n      .then(reg => {\n        console.info('ServiceWorker registration successful with scope: ', reg.scope);\n      }).catch(err => {\n        console.info('ServiceWorker registration failed: ', err);\n      });\n  } else {\n    console.info('Off-line mode is not supported');\n  }\n}\n\n\nfunction loader() {\n  /*\n  if (document.location.protocol === \"file:\") {\n    console.info('Off-line mode (local file)');\n    store.setGlobalConfig('onLine', false);\n    return Promise.resolve();\n  }\n  if ('onLine' in navigator) {\n    if (!navigator.onLine) {\n      console.info('Off-line mode (no internet connection)');\n      store.setGlobalConfig('onLine', false);\n      return Promise.resolve();\n    }\n  }*/\n  const server = fetcher.get('server')\n    .then(fetcher.json)\n    .catch(() => null);\n  const local = store.getAppSetting('serverInstance');\n  return Promise.all([server, local]).then(ps => {\n    const serverStatus = ps[0];\n    const clientInstance = ps[1];\n    if (!serverStatus) return Promise.resolve(null);\n    if (!serverStatus.debugMode) {\n      registerServiceWorker();\n    } else {\n      console.info('Off-line mode is disabled for debugging');\n    }\n    if (serverStatus.instance === clientInstance) {\n      console.info('Resource schema is already up to date');\n      return Promise.resolve(serverStatus);\n    } else {\n      return fetcher.get('schema')\n        .then(fetcher.json)\n        .then(schema => {\n          console.info(`New resource schema version: ${serverStatus.instance}`);\n          return Promise.all([\n            store.setResources(schema.resources),\n            store.setAppSetting('templates', schema.templates),\n            store.setAppSetting(\n              'compoundIDPlaceholder', schema.compoundIDPlaceholder),\n              store.setAppSetting(\n                'defaultDataType', schema.defaultDataType),\n            store.setAppSetting('serverInstance', serverStatus.instance),\n            store.setAppSetting('rdkit', serverStatus.rdkit)\n          ])\n          .then(() => Promise.resolve(serverStatus));\n        }, fetcher.error);\n    }\n  });\n}\n\n\nexport default {\n  interactiveInsert, fetchResults, registerServiceWorker, loader\n};\n","\nimport d3 from 'd3';\nimport {default as d3scale} from '../helper/d3Scale.js';\nimport {default as d3form} from '../helper/d3Form.js';\nimport {default as def} from '../helper/definition.js';\nimport {default as fmt} from '../helper/formatValue.js';\nimport {default as cmp} from '../component/Component.js';\n\n\n\n// Get data\n\nfunction colorControlInput(id) {\n  const data = {\n    id: id,\n    field: d3form.optionData(`#${id}-col`)\n  };\n  const preset = d3form.optionData(`#${id}-preset`);\n  if (preset.scale.scale === 'ordinal') {\n    data.scale = preset.scale;\n    return data;\n  }\n  data.scale = {\n    scale: d3form.value(`#${id}-scaletype`),\n    domain: [\n      d3form.value(`#${id}-domain-from`),\n      d3form.value(`#${id}-domain-to`)\n    ],\n    unknown: '#696969'\n  };\n  const range = [d3form.value(`#${id}-range-from`)];\n  if (d3form.checked(`#${id}-range-enable-mid`)) {\n    range.push(d3form.value(`#${id}-range-mid`));\n  }\n  range.push(d3form.value(`#${id}-range-to`));\n  data.scale.range = range;\n  return data;\n}\n\n\nfunction labelControlInput() {\n  const data = colorControlInput('label');\n  data.text = d3form.optionData('#label-text');\n  data.size = d3form.value('#label-size');\n  data.visible = d3form.checked('#label-visible');\n  return data;\n}\n\n\nfunction sizeControlInput(id) {\n  return {\n    id: id,\n    scale: {\n      scale: d3form.value(`#${id}-scaletype`),\n      domain: [\n        d3form.value(`#${id}-domain-from`),\n        d3form.value(`#${id}-domain-to`)\n      ],\n      range: [\n        d3form.value(`#${id}-range-from`),\n        d3form.value(`#${id}-range-to`)\n      ],\n      unknown: 10\n    }\n  };\n}\n\n\nfunction nodeSizeControlInput() {\n  const data = sizeControlInput('size');\n  data.field = d3form.optionData('#size-col');\n  return data;\n}\n\n\nfunction nodeContentInput() {\n  return {\n    structure: {\n      visible: d3form.checked('#show-struct')\n    }\n  };\n}\n\n\nfunction edgeControlInput() {\n  const data = sizeControlInput('edge');\n  data.visible = d3form.checked('#edge-visible');\n  data.label = {\n    size: d3form.value('#edge-label-size'),\n    visible: d3form.checked('#edge-label-visible')\n  };\n  return data;\n}\n\n\n// Update DOM attributes\n\nfunction updateNodeColor(data) {\n  d3.selectAll('.node').select('.node-symbol')\n    .style('fill', d =>\n      d3scale.scaleFunction(data.scale)(data.field ? d[data.field.key] : null)\n    );\n}\n\n\nfunction updateNodeSize(data) {\n  d3.selectAll('.node').select('.node-symbol')\n    .attr('r', d =>\n      d3scale.scaleFunction(data.scale)(data.field ? d[data.field.key] : null));\n}\n\n\nfunction updateNodeLabelVisibility(visible) {\n  d3.selectAll('.node').select('.node-label')\n    .attr('visibility', visible ? 'inherit' : 'hidden');\n}\n\n\nfunction updateNodeLabel(data) {\n  d3.selectAll('.node').select('.node-label')\n    .text(d => {\n      if (data.text === null) return '';\n      if (!d.hasOwnProperty(data.text.key)) return '';\n      if (data.text.format === 'd3_format') {\n        return fmt.formatNum(d[data.text.key], data.text.d3_format);\n      }\n      return d[data.text.key];\n    })\n    .attr('font-size', data.size)\n    .attr('y', 90) // TODO: derived from structure size or node circle radius\n    .attr('visibility', data.visible ? 'inherit' : 'hidden')\n    .style('fill', d =>\n      d3scale.scaleFunction(data.scale)(data.field ? d[data.field.key] : null));\n}\n\n\nfunction updateNodeStructure(data) {\n  d3.selectAll('.node').select('.node-struct')\n    .attr('visibility', data.structure.visible ? 'inherit' : 'hidden')\n    .each((d, i, nds) => {\n      const w = d3.select(nds[i]).select('svg').attr('width');\n      const h = d3.select(nds[i]).select('svg').attr('height');\n      d3.select(nds[i]).attr('transform', `translate(${-w / 2},${-h / 2})`);\n    });\n}\n\n\nfunction updateNodeImage(data) {\n  updateNodeSize(data.nodeSize);\n  updateNodeColor(data.nodeColor);\n  updateNodeLabel(data.nodeLabel);\n  updateNodeStructure(data.nodeContent);\n}\n\n\nfunction updateEdgeVisibility(visible) {\n  d3.selectAll('.link').select('.edge-line')\n    .attr('visibility', visible ? 'inherit' : 'hidden');\n}\n\n\nfunction updateEdgeLabelVisibility(visible) {\n  d3.selectAll('.link').select('.edge-label')\n    .attr('visibility', visible ? 'inherit' : 'hidden');\n}\n\n\nfunction updateEdge(data) {\n  d3.selectAll('.link').select('.edge-line')\n    .style('stroke-width', d => d3scale.scaleFunction(data.scale)(d.weight));\n  d3.selectAll('.link').select('.edge-label')\n    .attr('font-size', data.label.size);\n  updateEdgeVisibility(data.visible);\n  updateEdgeLabelVisibility(data.label.visible);\n}\n\n\nfunction updateRange(range, id) {\n  if (range.length === 2) {\n    d3.select(`#${id}-range-from`).property('value', range[0]);\n    d3.select(`#${id}-range-enable-mid`).attr('checked', null);\n    d3.select(`#${id}-range-mid`).attr('disabled','disabled');\n    d3.select(`#${id}-range-to`).property('value', range[1]);\n    d3.selectAll(`#${id}-range input`).attr('disabled', null);\n  } else if (range.length === 3) {\n    d3.select(`#${id}-range-from`).property('value', range[0]);\n    d3.select(`#${id}-range-enable-mid`).attr('checked', 'checked');\n    d3.select(`#${id}-range-mid`).property('value', range[1]);\n    d3.select(`#${id}-range-to`).property('value', range[2]);\n    d3.selectAll(`#${id}-range input`).attr('disabled', null);\n  } else {\n    d3.selectAll(`#${id}-range input`).attr('disabled', 'disabled');\n  }\n}\n\n\nfunction updateScale(scale, id) {\n  d3.select(`#${id}-scaletype`).property('value', scale.scale);\n  const hasDomain = scale.hasOwnProperty('domain');\n  d3.selectAll(`#${id}-domain input`)\n    .attr('disabled', hasDomain ? null : 'disabled');\n  if (hasDomain) {\n    d3.select(`#${id}-domain-from`).property('value', scale.domain[0]);\n    d3.select(`#${id}-domain-to`).property('value', scale.domain[1]);\n  }\n  updateRange(scale.range, id);\n}\n\n\nfunction updateControl(data) {\n  const id = data.id;\n  d3.select(`#${id}-visible`).attr('checked', data.visible ? 'checked' : null);\n  d3.select(`#${id}-size`).property('value', data.size);\n  d3.select(`#${id}-text`).property('value', data.text ? data.text.key : null);\n  d3.select(`#${id}-col`).property('value', data.field ? data.field.key : null);\n  if (data.hasOwnProperty('label')) {\n    d3.select(`#${id}-label-visible`)\n      .attr('checked', data.label.visible ? 'checked' : null);\n    d3.select(`#${id}-label-size`).property('value', data.label.size);\n  }\n  updateScale(data.scale, data.id);\n}\n\n\n\n// Generate controlBox elements\n\nfunction mainControlBox() {\n  d3.select('#show-struct')\n    .on('change', function () {\n      const data = nodeContentInput();\n      d3.select('#main-control').datum(data);\n      updateNodeStructure(data);\n    })\n    .dispatch('change');\n}\n\n\nfunction colorControlBox(fields, id) {\n  d3.select(`#${id}-col`)\n    .call(cmp.selectOptions, fields, d => d.key, d => d.name);\n  d3.select(`#${id}-preset`)\n    .call(cmp.selectOptions, d3scale.colorPresets, d => d.name, d => d.name)\n    .on('change', function() {\n      updateScale(d3form.optionData(this).scale, id);\n      d3.select(`.${id}-update`).dispatch('change');\n    });\n  d3.select(`#${id}-palette`)\n    .call(cmp.selectOptions, d3scale.colorPalette, d => d.name, d => d.name)\n    .on('change', function() {\n      updateRange(d3form.optionData(this).range, id);\n      d3.select(`.${id}-update`).dispatch('change');\n    });\n  d3.select(`#${id}-scaletype`)\n    .call(cmp.selectOptions, d3scale.scaleTypes, d => d.name, d => d.name);\n}\n\n\nfunction nodeColorControlBox(fields) {\n  const textCols = fields.filter(e => def.sortType(e.format) !== 'none');\n  colorControlBox(textCols, 'color');\n  d3.selectAll('.color-update')\n    .on('change', () => {\n      const data = colorControlInput('color');\n      d3.select('#color-control').datum(data);\n      updateControl(data);\n      updateNodeColor(data);\n    });\n  d3.select('.color-update').dispatch('change');\n}\n\n\nfunction nodeLabelControlBox(fields) {\n  const textCols = fields.filter(e => def.sortType(e.format) !== 'none');\n  d3.select('#label-text')\n    .call(cmp.selectOptions, textCols, d => d.key, d => d.name);\n  colorControlBox(textCols, 'label');\n  d3.select('#label-visible')\n    .on('change', function() {\n      updateNodeLabelVisibility(d3form.checked(this), 'label');\n      d3.select(`.label-update`).dispatch('change');\n    });\n  d3.selectAll('.label-update')\n    .on('change', () => {\n      const data = labelControlInput();\n      d3.select('#label-control').datum(data);\n      updateControl(data);\n      updateNodeLabel(data);\n    });\n  d3.select(`.label-update`).dispatch('change');\n}\n\n\nfunction sizeControlBox(presets, id) {\n  d3.select(`#${id}-preset`)\n    .call(cmp.selectOptions, presets, d => d.name, d => d.name)\n    .on('change', function() {\n      updateScale(d3form.optionData(this).scale, id);\n      d3.select(`.${id}-update`).dispatch('change');\n    });\n  d3.select(`#${id}-scaletype`)\n    .call(cmp.selectOptions, d3scale.sizeScaleTypes, d => d.name, d => d.name);\n}\n\n\nfunction nodeSizeControlBox(fields) {\n  const numCols = fields.filter(e => def.sortType(e.format) === 'numeric');\n  d3.select(`#size-col`)\n    .call(cmp.selectOptions, numCols, d => d.key, d => d.name);\n  sizeControlBox(d3scale.sizePresets, 'size');\n  d3.selectAll('.size-update')\n    .on('change', () => {\n      const data = nodeSizeControlInput('size');\n      d3.select('#size-control').datum(data);\n      updateControl(data);\n      updateNodeSize(data);\n    });\n  d3.select(`.size-update`).dispatch('change');\n}\n\n\nfunction edgeControlBox() {\n  sizeControlBox(d3scale.edgeWidthPresets, 'edge');\n  d3.select('#edge-visible')\n    .on('change', function() {\n      updateEdgeVisibility(d3form.checked(this));\n      updateEdgeLabelVisibility(d3form.checked(this));\n      d3.select(`.edge-update`).dispatch('change');\n    });\n  d3.select('#edge-label-visible')\n    .on('change', function() {\n      updateEdgeLabelVisibility(d3form.checked(this));\n      d3.select(`.edge-update`).dispatch('change');\n    });\n  d3.selectAll('.edge-update')\n    .on('change', () => {\n      const data = edgeControlInput('edge');\n      d3.select('#edge-control').datum(data);\n      updateControl(data);\n      updateEdge(data);\n    });\n  d3.select(`.edge-update`).dispatch('change');\n}\n\n\nexport default {\n  updateNodeStructure, updateNodeImage, updateEdge, updateControl,\n  mainControlBox, nodeColorControlBox, nodeLabelControlBox, nodeSizeControlBox, edgeControlBox\n};\n","\nimport d3 from 'd3';\n\nimport {default as force} from './GraphForce.js';\n\nconst zoom = d3.zoom()\n  .on('zoom', () => {\n    d3.select('#graph-contents').attr('transform', d3.event.transform);\n  });\n\nconst dragWithForce = d3.drag()\n  .on('start', () => {\n    d3.select('#graph-contents').selectAll('.link')\n      .attr('visibility', 'hidden');\n    if (!d3.event.active) force.simulation.alphaTarget(0.1).restart();\n  })\n  .on('drag', d => {\n    d.fx = d3.event.x;\n    d.fy = d3.event.y;\n  })\n  .on('end', d => {\n    if (!d3.event.active) force.simulation.alphaTarget(0);\n    d.fx = null;\n    d.fy = null;\n  });\n\nconst dragNoForce = d3.drag()\n  .on('drag', function (d) {\n    d3.select(this)\n      .attr('transform', () => `translate(${d3.event.x}, ${d3.event.y})`);\n    d.x = d3.event.x;\n    d.y = d3.event.y;\n    const connected = d3.select('#graph-contents').selectAll('.link')\n      .filter(d => [d.source.index, d.target.index].includes(this.__data__.index));\n    connected.attr('transform', d => `translate(${d.source.x}, ${d.source.y})`)\n      .attr('visibility', 'visible');\n    connected.select('.edge-line')\n      .attr('x1', 0)\n      .attr('y1', 0)\n      .attr('x2', d => d.target.x - d.source.x)\n      .attr('y2', d => d.target.y - d.source.y);\n    connected.select('.edge-label')\n      .attr('x', d => (d.target.x - d.source.x) / 2)\n      .attr('y', d => (d.target.y - d.source.y) / 2);\n  })\n  .on('end', () => {\n    force.end();\n  });\n\n\nfunction stickNodes() {\n  force.simulation.alpha(0).stop();\n  d3.selectAll('.node').each(d => {\n    d.fx = d.x;\n    d.fy = d.y;\n  });\n  force.tick();\n  force.end();\n  d3.select('#stick-nodes').property('checked', true);\n  d3.select('#graph-contents').selectAll('.link')\n    .attr('visibility', 'visible');\n  d3.select('#graph-contents').selectAll('.node')\n    .call(dragNoForce);\n}\n\n\nfunction unstickNodes() {\n  d3.selectAll('.node').each(d => {\n    d.fx = null;\n    d.fy = null;\n  });\n  d3.select('#stick-nodes').property('checked', false);\n  d3.select('#graph-contents').selectAll('.link')\n    .attr('visibility', 'hidden');\n  d3.select('#graph-contents').selectAll('.node')\n    .call(dragWithForce);\n}\n\n\nfunction relax() {\n  unstickNodes();\n  force.simulation.alpha(0.1).restart();\n}\n\n\nfunction restart() {\n  unstickNodes();\n  force.simulation.alpha(1).restart();\n}\n\n\nfunction fitToScreen() {\n  d3.select('#graph-field').call(zoom.transform, d3.zoomIdentity);\n  // TODO\n  /*\n  const p = 0.9;  // padding factor\n  const x = extent(selectAll('.node').data(), d => d.x);\n  const y = extent(selectAll('.node').data(), d => d.y);\n  const w = x[1] - x[0];\n  const h = y[1] - y[0];\n  const vb = select('#graph-field').attr('viewBox').split(' ');\n  const xScaleF = vb[2] / w * p;\n  const yScaleF = vb[3] / h * p;\n  const scaleF = Math.max(xScaleF, yScaleF);\n  const center = [(w * (1 - p) / 2 - x[0]) * xScaleF,\n                  (h * (1 - p) / 2 - y[0]) * yScaleF];\n  // Reset zoom point\n  zoom.scale(scaleF);\n  zoom.translate(center);\n  updateViewportTransform(center, scaleF);\n  */\n}\n\n\nexport default {\n  zoom, dragWithForce, dragNoForce,\n  stickNodes, unstickNodes,\n  relax, restart, fitToScreen\n};\n","\n/** @module graph */\n\nimport d3 from 'd3';\n\nimport {default as d3form} from './helper/d3Form.js';\nimport {default as d3scale} from './helper/d3Scale.js';\nimport {default as def} from './helper/definition.js';\nimport {default as hfile} from './helper/file.js';\nimport {default as win} from './helper/window.js';\nimport {default as common} from './common.js';\nimport {default as store} from './store/StoreConnection.js';\nimport {default as header} from './component/Header.js';\nimport {default as dialog} from './component/Dialog.js';\nimport {default as force} from './graph/GraphForce.js';\nimport {default as dflt} from './graph/defaultGraphControl.js';\nimport {default as control} from './graph/GraphControlBox.js';\nimport {default as component} from './graph/GraphComponent.js';\nimport {default as interaction} from './graph/GraphInteraction.js';\nimport {default as community} from './graph/communityDetection.js';\n\n\nfunction takeSnapshot() {\n  return {\n    nodePositions: d3.selectAll('.node').data().map(d => ({x: d.x, y: d.y})),\n    fieldTransform: d3.zoomTransform(d3.select('#graph-field').node()),\n    nodeContent: d3.select('#main-control').datum(),\n    nodeColor: d3.select('#color-control').datum(),\n    nodeSize: d3.select('#size-control').datum(),\n    nodeLabel: d3.select('#label-control').datum(),\n    edge: d3.select('#edge-control').datum()\n  };\n}\n\n\nfunction saveSnapshot() {\n  return store.updateTableAttribute(win.URLQuery().id, 'snapshot', takeSnapshot())\n    .then(() => console.info('Snapshot saved'));\n}\n\n\nfunction resume(snapshot) {\n  d3.select('#main-control').datum(snapshot.nodeContent);\n  d3.select('#show-struct')\n    .property('checked', snapshot.nodeContent.structure.visible);\n  d3.select('#color-control').datum(snapshot.nodeColor);\n  control.updateControl(snapshot.nodeColor);\n  d3.select('#size-control').datum(snapshot.nodeSize);\n  control.updateControl(snapshot.nodeSize);\n  d3.select('#label-control').datum(snapshot.nodeLabel);\n  control.updateControl(snapshot.nodeLabel);\n  d3.select('#edge-control').datum(snapshot.edge);\n  control.updateControl(snapshot.edge);\n  const tf = snapshot.fieldTransform;\n  const transform = d3.zoomIdentity.translate(tf.x, tf.y).scale(tf.k);\n  d3.select('#graph-contents').attr('transform', transform);\n  d3.select('#graph-field').call(interaction.zoom.transform, transform);\n  d3.selectAll('.node').each((d, i) => {\n    d.x = snapshot.nodePositions[i].x;\n    d.y = snapshot.nodePositions[i].y;\n  });\n  control.updateNodeImage(snapshot);\n}\n\n\nfunction getGraph() {\n  return store.getTable(win.URLQuery().id)\n    .then(edges => {\n      return store.getTable(edges.reference.nodes)\n        .then(nodes => {\n          return {edges: edges, nodes: nodes};\n        });\n    });\n}\n\n\nfunction start() {\n  return getGraph()\n    .then(g => {\n      header.renderStatus(g.edges,\n        () => common.fetchResults().then(render),\n        () => common.fetchResults('abort').then(render));\n      const edgesToDraw = g.edges.records\n        .filter(e => e.weight >= g.edges.networkThreshold);\n      const logD = d3.format('.2f')(Math.log10(edgesToDraw.length / g.edges.taskCount));\n      d3.select('#edge-density').text(logD);\n      d3.select('#network-thld').text(g.edges.networkThreshold);\n      component.graphEdges(d3.select('#graph-contents'), edgesToDraw);\n      component.graphNodes(d3.select('#graph-contents'), g.nodes.records);\n      force.setForce(\n        g.nodes.records, edgesToDraw, force.tick,\n        () => {\n          force.end();\n          saveSnapshot();\n        });\n      if (g.edges.hasOwnProperty('snapshot')) {\n        resume(g.edges.snapshot);\n        interaction.stickNodes();\n      } else {\n        // Set default appearance\n        // TODO: refactor\n        d3.select('#color-control').datum(dflt.defaultNodeColor);\n        control.updateControl(dflt.defaultNodeColor);\n        d3.select('#size-control').datum(dflt.defaultNodeSize);\n        control.updateControl(dflt.defaultNodeSize);\n        d3.select('#label-control').datum(dflt.defaultNodeLabel);\n        control.updateControl(dflt.defaultNodeLabel);\n        d3.select('#main-control').datum(dflt.defaultNodeContent);\n        d3.select('#show-struct')\n          .property('checked', dflt.defaultNodeContent.structure.visible);\n        d3.select('#edge-control').datum(dflt.defaultEdge);\n        control.updateControl(dflt.defaultEdge);\n        control.updateNodeImage({\n          nodeColor: dflt.defaultNodeColor,\n          nodeSize: dflt.defaultNodeSize,\n          nodeLabel: dflt.defaultNodeLabel,\n          nodeContent: dflt.defaultNodeContent\n        });\n        control.updateEdge(dflt.defaultEdge);\n        interaction.restart();\n      }\n      d3.select('#graph-contents').style('opacity', 1e-6)\n        .transition()\n        .duration(1000)\n        .style('opacity', 1);\n    });\n}\n\n\nfunction render() {\n  return getGraph()\n    .then(g => {\n      g.nodes.records.forEach(e => { delete e._mol; });\n      dialog.graphConfigDialog(\n          g.edges.networkThreshold, g.edges.query.threshold, thld => {\n        return store.updateTableAttribute(win.URLQuery().id, 'networkThreshold', thld)\n          .then(saveSnapshot)\n          .then(start);\n      });\n      dialog.communityDialog(query => {\n        const nodeIds = g.nodes.records.map(e => e.index);\n        const visibleEdges = g.edges.records\n          .filter(e => e.weight >= g.edges.networkThreshold);\n        const comm = community.communityDetection(\n          nodeIds, visibleEdges, {nulliso: query.nulliso}\n        );\n        const mapping = {\n          key: 'index',\n          field: def.defaultFieldProperties(\n            [{key: query.name, format: 'd3_format', d3_format: 'd'}]),\n          mapping: comm\n        };\n        store.joinFields(g.nodes.id, mapping)\n          .then(() => {\n            const snapshot = takeSnapshot();\n            snapshot.nodeColor.field = query.name;\n            snapshot.nodeColor.scale = d3scale.colorPresets\n              .find(e => e.name === 'Categories').scale;\n            return store.updateTableAttribute(win.URLQuery().id, 'snapshot', snapshot)\n              .then(() => console.info('snapshot saved'));\n          }).then(render);\n      });\n      control.mainControlBox();\n      control.nodeColorControlBox(g.nodes.fields);\n      control.nodeSizeControlBox(g.nodes.fields);\n      control.nodeLabelControlBox(g.nodes.fields);\n      control.edgeControlBox();\n      d3.select('#stick-nodes')\n        .on('change', function() {\n          d3form.checked(this) === true ? interaction.stickNodes() : interaction.relax();\n        });\n      d3.select('#nodetable').attr('href', `datatable.html?id=${g.edges.reference.nodes}`);\n      d3.select('#rename')\n        .on('click', () => {\n          d3.select('#prompt-title').text('Rename table');\n          d3.select('#prompt-label').text('New name');\n          d3.select('#prompt-input').attr('value', g.edges.name);\n          d3.select('#prompt-submit')\n            .on('click', () => {\n              const name = d3form.value('#prompt-input');\n              return store.updateTableAttribute(win.URLQuery().id, 'name', name)\n                .then(() => store.getTable(win.URLQuery().id))  // updateTableAttribute returns 1\n                .then(t => header.renderStatus(t,\n                  () => common.fetchResults().then(render),\n                  () => common.fetchResults('abort').then(render))\n                );\n            });\n        });\n      return start();\n    });\n}\n\n\nfunction loadNewGraph(data) {\n  return common.interactiveInsert(data.nodes)\n    .then(id => {\n      data.edges.reference.nodes = id;\n      return common.interactiveInsert(data.edges);\n    })\n    .then(id => {\n      window.location = `graph.html?id=${id}`;\n    });\n}\n\n\nfunction run() {\n  d3.select('#export')\n    .on('click', () => {\n      // Working copy of edges and nodes are modified by d3.force.\n      // Load original data from store.\n      return getGraph().then(g => hfile.downloadJSON(g, g.edges.name));\n    });\n  d3.select('#graph-field')\n    .attr('viewBox', `0 0 ${force.fieldWidth} ${force.fieldHeight}`)\n    .call(interaction.zoom);\n  d3.select('#snapshot')\n    .on('click', saveSnapshot);\n  d3.select('#restart')\n    .on('click', interaction.restart);\n  d3.select('#import-json')\n    .on('click', () => document.getElementById('select-file').click());\n  d3.select('#select-file')\n    .on('change', () => {\n      const file = document.getElementById('select-file').files[0];\n      hfile.loadJSON(file).then(loadNewGraph);\n    });\n  // location parameter enables direct access to graph JSON via HTTP\n  if (win.URLQuery().hasOwnProperty('location')) {\n    return hfile.fetchJSON(win.URLQuery().location)\n      .then(data => {\n        return common.interactiveInsert(data.nodes)\n          .then(id => {\n            data.edges.reference.nodes = id;\n            return common.interactiveInsert(data.edges);\n          })\n          .then(id => {\n            window.location = `graph.html?id=${id}`;\n          });\n      });\n\n  }\n  return common.loader()\n    .then(() => {\n      if (win.URLQuery().hasOwnProperty('id')) {\n        header.initializeWithData();\n        return common.fetchResults('update').then(render);\n      } else {\n        header.initialize();\n        return Promise.resolve();\n      }\n    });\n}\n\nexport default {\n  force, control, component, interaction, community, run\n};\n","\n/** @module helper/d3Form */\n\nimport d3 from 'd3';\n\n\nfunction value(selector) {\n  return d3.select(selector).node().value;\n}\n\n\nfunction valueInt(selector) {\n  return parseInt(d3.select(selector).node().value);\n}\n\n\nfunction valueFloat(selector) {\n  return parseFloat(d3.select(selector).node().value);\n}\n\n\nfunction checked(selector) {\n  return d3.select(selector).node().checked;\n}\n\n\nfunction firstFile(selector) {\n  return d3.select(selector).node().files[0];\n}\n\n\nfunction inputValues(selector) {\n  return d3.selectAll(selector).selectAll('input').nodes().map(e => e.value);\n}\n\n\nfunction checkboxValues(selector) {\n  return d3.selectAll(selector).selectAll('input:checked').nodes().map(e => e.value);\n}\n\n\nfunction optionValues(selector) {\n  return d3.selectAll(selector).selectAll('select').nodes().map(e => e.value);\n}\n\n\nfunction textareaLines(selector) {\n  return d3.select(selector).node().value.split('\\n').filter(e => e.length > 0);\n}\n\n\nfunction optionData(selector) {\n  const si = d3.select(selector).property('selectedIndex');\n  return d3.select(selector).selectAll('option').data().find((d, i) => i === si);\n}\n\n\nfunction checkboxData(selector) {\n  return d3.selectAll(selector).selectAll('input:checked').data();\n}\n\n\nexport default {\n  value, valueInt, valueFloat, checked,\n  firstFile, inputValues, checkboxValues, optionValues, textareaLines,\n  optionData, checkboxData\n};\n","\n/** @module helper/d3Scale */\n\nimport d3 from 'd3';\n\nconst categoryMany = d3.schemeSet1\n  .concat(d3.schemeSet3, d3.schemePastel2, d3.schemeSet2);\nconst defaultSizeRange = [20, 80];\n\nconst colorPresets = [\n  {\n    name: 'Activity',\n    scale: {\n      scale: 'log',\n      domain: [1e-4, 1e-6],\n      range: ['#708090', '#7fffd4'],\n      unknown: '#696969'\n    }\n  },\n  {\n    name: 'Percent',\n    scale: {\n      scale: 'linear',\n      domain: [0, 100],\n      range: ['#708090', '#7fffd4'],\n      unknown: '#696969'\n    }\n  },\n  {\n    name: 'True or False',\n    scale: {\n      scale: 'quantize',\n      domain: [1, 0],\n      range: ['#708090', '#7fffd4'],\n      unknown: '#696969'\n    }\n  },\n  {\n    name: 'LogP',\n    scale: {\n      scale: 'linear',\n      domain: [-2, 8],\n      range: ['#6495ed', '#ccff66', '#ffa500'],\n      unknown: '#696969'\n    }\n  },\n  {\n    name: 'Categories',\n    scale: {\n      scale: 'ordinal',\n      range: d3.schemeCategory20,\n      unknown: '#dedede'\n    }\n  },\n  {\n    name: 'ManyCategories',\n    scale: {\n      scale: 'ordinal',\n      range: categoryMany,\n      unknown: '#dedede'\n    }\n  }\n];\n\nconst sizePresets = [\n  {\n    name: 'Activity',\n    scale: {\n      scale: 'log',\n      domain: [1e-4, 1e-6],\n      range: defaultSizeRange,\n      unknown: defaultSizeRange[0]\n    }\n  },\n  {\n    name: 'Percent',\n    scale: {\n      scale: 'linear',\n      domain: [0, 100],\n      range: defaultSizeRange,\n      unknown: defaultSizeRange[0]\n    }\n  },\n  {\n    name: 'True or False',\n    scale: {\n      scale: 'quantize',\n      domain: [1, 0],\n      range: defaultSizeRange,\n      unknown: defaultSizeRange[0]\n    }\n  },\n  {\n    name: 'LogP',\n    scale: {\n      scale: 'linear',\n      domain: [-2, 6],\n      range: defaultSizeRange,\n      unknown: defaultSizeRange[0]\n    }\n  }\n];\n\nconst edgeWidthPresets = [\n  {\n    name: 'Universal',\n    scale: {\n      scale: 'linear',\n      domain: [0.3, 1],\n      range: [0.5, 5],\n      unknown: 1\n    }\n  },\n  {\n    name: 'Thin',\n    scale: {\n      scale: 'linear',\n      domain: [0.5, 1],\n      range: [0.5, 3],\n      unknown: 1\n    }\n  },\n  {\n    name: 'Amplified',\n    scale: {\n      scale: 'linear',\n      domain: [0.5, 1],\n      range: [1, 10],\n      unknown: 1\n    }\n  }\n];\n\nconst colorPalette = [\n  {name: 'Aquamarine', range: ['#778899', '#7fffd4'], unknown: '#696969'},\n  {name: 'Chartreuse', range: ['#778899', '#7fff00'], unknown: '#696969'},\n  {name: 'Salmon', range: ['#778899', '#fa8072'], unknown: '#696969'},\n  {name: 'Violet', range: ['#778899', '#ee82ee'], unknown: '#696969'},\n  {name: 'blue-red', range: ['#87ceeb', '#fff5ee', '#fa8072'], unknown: '#696969'},\n  {name: 'Spectrum', range: ['#6495ed', '#ccff66', '#ffa500'], unknown: '#696969'}\n];\n\nconst scaleTypes = [\n  {name: 'linear', func: d3.scaleLinear()},\n  {name: 'log', func: d3.scaleLog()},\n  {name: 'quantize', func: d3.scaleQuantize()},\n  {name: 'ordinal', func: d3.scaleOrdinal()}\n];\n\nconst sizeScaleTypes = [\n  {name: 'linear', func: d3.scaleLinear()},\n  {name: 'log', func: d3.scaleLog()},\n  {name: 'quantize', func: d3.scaleQuantize()}\n];\n\nfunction scaleFunction(scale) {\n  let sf = scaleTypes.find(e => e.name === scale.scale).func;\n  let domain = scale.domain;\n  if (scale.range.length === 3) {\n    const mid = (parseFloat(scale.domain[0]) + parseFloat(scale.domain[1])) / 2;\n    domain = [scale.domain[0], mid, scale.domain[1]];\n  }\n  if (scale.scale !== 'ordinal') {\n    sf = sf.domain(domain);\n  }\n  sf = sf.range(scale.range);\n  if (['linear', 'log'].includes(scale.scale)) {\n    sf = sf.clamp(true);\n  }\n  return d => {\n    if (d === '' || typeof d === 'undefined' || d === null) {\n      return scale.unknown;\n    }\n    if (scale.scale !== 'ordinal' && parseFloat(d) != d) {\n      return scale.unknown;\n    }\n    if (scale.scale === 'log' && d <= 0) {\n      return scale.unknown;\n    }\n    const result = sf(d);\n    if (result === undefined) {\n      return scale.unknown;\n    }\n    return result;\n  };\n}\n\n\nexport default {\n  colorPresets, sizePresets, edgeWidthPresets,\n  colorPalette, scaleTypes, sizeScaleTypes,\n  scaleFunction\n};\n","\n/** @module helper/definition */\n\n\nfunction defaultFieldProperties(fields) {\n  return fields.map(e => {\n    if (!e.hasOwnProperty('name')) e.name = e.key;\n    if (!e.hasOwnProperty('visible')) e.visible = true;\n    if (e.hasOwnProperty('d3_format')) e.format = 'd3_format';\n    if (!e.hasOwnProperty('format')) e.format = 'raw';\n    return e;\n  });\n}\n\n\nfunction sortType(fmt) {\n  if (['numeric', 'd3_format'].includes(fmt)) return 'numeric';\n  if (['text', 'compound_id'].includes(fmt)) return 'text';\n  return 'none';\n}\n\n\nfunction ongoing(data) {\n  return ['running', 'ready'].includes(data.status);\n}\n\n\nexport default {\n  defaultFieldProperties, sortType, ongoing\n};\n","\n\nclass KArray extends Array {\n  /**\n   * Return array of object filtered by given unique key\n   */\n  unique(key) {\n    return this.reduce((a, b) => {\n      if (a.find(e => e[key] === b[key]) === undefined) a.push(b);\n      return a;\n    }, new KArray());\n  }\n\n\n  /**\n   * Merge arrays\n   */\n  extend() {\n    return this.reduce((a, b) => {\n      Array.prototype.push.apply(a, b);\n      return a;\n    }, new KArray());\n  }\n\n\n  // Merge arrays(Asynchronous)\n  extendAsync() {\n    return Promise.all(this).then(res => {\n      return res.reduce((a, b) => {\n        Array.prototype.push.apply(a, b);\n        return a;\n      }, new KArray());\n    });\n  }\n\n  toArray() {\n    return new Array(this);\n  }\n\n  toObject() {\n    const obj = {};\n    this.forEach(kv => {\n      obj[kv[0]] = kv[1];\n    });\n    return obj;\n  }\n}\n\nexport default KArray;\n","\nimport KArray from './KArray.js';\n\n\nfunction URLQuery() {\n  return KArray.from(window.location.search.substring(1).split(\"&\"))\n    .map(e => e.split('=')).toObject();\n}\n\n\nexport default {\n  URLQuery\n};\n","\n/** @module helper/parser */\n\nfunction getSDFPropList(str) {\n  const re = />.*?<(\\S+)>/g;\n  const uniqCols = new Set();\n  let arr;\n  while ((arr = re.exec(str)) !== null) {\n    uniqCols.add(arr[1]);\n  }\n  return Array.from(uniqCols);\n}\n\n// Ref. https://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript\nfunction uuidv4() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n    var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\n    return v.toString(16);\n  });\n}\n\n// TODO: not used\nfunction queryFormData(query) {\n  const formData = new FormData();\n  Object.entries(query).forEach(kv => {\n    if (Array.isArray(kv[1])) {\n      kv[1].forEach(e => formData.append(kv[0], e));\n    } else {\n      formData.set(kv[0], kv[1]);\n    }\n  });\n  return formData;\n}\n\n\n// TODO: not used\nfunction queryURL(query) {\n  const queryStr = [];\n  Object.entries(query).forEach(e => {\n    const val = Array.isArray(e[1]) ? JSON.stringify(e[1]) : e[1];\n    const key = e[0];\n    // const encoded = encodeURIComponent(val);\n    queryStr.push(`${key}=${val}`);\n  });\n  return queryStr.join('&');\n}\n\n\n// TODO: not used\nfunction capitalized(str) {\n  return str.replace(/(?:^|\\s)\\S/g, e => e.toUpperCase());\n}\n\n\nexport default {\n  getSDFPropList, uuidv4\n};\n","\nimport Dexie from 'Dexie';\n\n// TODO: can indexed records improve query performance ?\n\nconst schema = {\n  app: 'key',\n  items: 'id, dataType, created',\n  resources: 'id'\n};\n\nlet idb = new Dexie('Store');\nidb.version(1).stores(schema);\n\n\nfunction getAppSetting(key) {\n  return idb.app.where('key').equals(key).first()\n    .then(res => {\n      if (res === undefined) return undefined;\n      return res.value;\n    });\n}\n\n\nfunction putAppSetting(k, v) {  // returns id in success\n  return idb.app.put({ key: k, value: v });\n}\n\n\nfunction getResources() {\n  return idb.resources.toArray();\n}\n\n\nfunction putResources(data) { // returns last id in success\n  return idb.resources.bulkPut(data);\n}\n\n\nfunction getAllItems() {\n  return idb.items.orderBy('created').reverse()\n    .toArray();\n}\n\n\nfunction getItemsByDataType(type) {\n  return idb.items.where('dataType').equals(type).reverse()\n    .sortBy('created');\n}\n\n\nfunction getItemById(tableId) {\n  return idb.items.where('id').equals(tableId).first();\n}\n\n\nfunction updateItem(tableId, callback) {  // returns num of updated items\n  return idb.items.where('id').equals(tableId).modify(callback);\n}\n\n\nfunction deleteItem(tableId) { // returns num of deleted items\n  return idb.items.where('id').equals(tableId).delete();\n}\n\n\nfunction putItem(data) { // returns id in success\n  return idb.items.put(data);\n}\n\n\nfunction reset() {\n  // Try this before tackling with local db troubles\n  return idb.delete().then(() => {\n    idb = new Dexie('Store');\n    idb.version(1).stores(schema);\n  });\n}\n\nexport default {\n  getAppSetting, putAppSetting, getResources, putResources,\n  getAllItems, getItemsByDataType, getItemById,\n  updateItem, deleteItem, putItem, reset\n};\n","\n/** @module helper/image */\n\nimport vega from 'vega';\n\nfunction showPlot(vegaSpec, selector) {\n  new vega.View(vega.parse(vegaSpec))\n    .initialize(selector)\n    .run();\n}\n\n\nfunction plotThumbnail(vegaSpec) {\n  const view = new vega.View(vega.parse(vegaSpec));\n  return view.toImageURL('png');  // Promise\n}\n\n\nexport default {\n  showPlot, plotThumbnail\n};\n","\nconst baseURL = '';\n\nfunction get(url, query={}) {\n  const isEmpty = Object.keys(query).length;\n  const q = isEmpty ? `?query=${JSON.stringify(query)}` : '';\n  return fetch(\n    `${baseURL}${url}${q}`,\n    {\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\nfunction json(response) {\n  return response.json();\n}\n\nfunction text(response) {\n  return response.text();\n}\n\nfunction blob(response) {\n  return response.blob();\n}\n\nfunction post(url, formdata) {\n  return fetch(\n    `${baseURL}${url}`,\n    {\n      method: 'POST',\n      body: formdata,\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\n\nfunction error(err) {\n  console.error(err);\n  return null;\n}\n\n\nexport default {\n  get, json, text, blob, post, error\n};\n","\n/** @module component/Dialog */\n\nimport d3 from 'd3';\n\nimport KArray from '../helper/KArray.js';\nimport {default as d3form} from '../helper/d3Form.js';\nimport {default as mapper} from '../helper/mapper.js';\nimport {default as def} from '../helper/definition.js';\nimport {default as fmt} from '../helper/formatValue.js';\nimport {default as win} from '../helper/window.js';\nimport {default as hfile} from '../helper/file.js';\nimport {default as misc} from '../helper/misc.js';\nimport {default as himg} from '../helper/image.js';\nimport {default as store} from '../store/StoreConnection.js';\nimport {default as cmp} from './Component.js';\nimport {default as fetcher} from '../fetcher.js';\n\n\nfunction pickDialog(resources, callback) {\n  store.getAppSetting('compoundIDPlaceholder').then(ids => {\n    d3.select('#pick-queryarea').text(ids);\n  });\n  d3.select('#pick-submit')\n    .on('click', () => {\n      d3.select('#loading-icon').style('display', 'inline');\n      const query = {\n        type: 'chemsearch',\n        targets: resources.filter(e => e.domain === 'chemical').map(e => e.id),\n        key: 'compound_id',\n        values: d3form.textareaLines('#pick-queryarea')\n      };\n      return fetcher.get('run', query)\n        .then(fetcher.json)\n        .then(callback, fetcher.error);\n    });\n}\n\n\nfunction propDialog(resources, callback) {\n  d3.select('#prop-targets')\n    .call(cmp.checkboxList, resources, 'targets', d => d.id, d => d.name)\n    .on('change', function () {\n      const cols = KArray.from(d3form.checkboxData('#prop-targets'))\n        .map(d => d.fields)\n        .extend().unique('key');\n      d3.select('#prop-key')\n        .call(cmp.selectOptions, cols, d => d.key, d => d.name);\n    });\n  d3.select('#prop-submit')\n    .on('click', () => {\n      d3.select('#loading-circle').style('display', 'inline');\n      const query = {\n        type: 'chemprop',\n        targets: d3form.checkboxValues('#prop-targets'),\n        key: d3form.optionData('#prop-key').key,\n        values: d3form.textareaLines('#prop-queryarea'),\n        operator: d3form.value('#prop-operator')\n      };\n      return fetcher.get('async', query)\n        .then(fetcher.json)\n        .then(callback, fetcher.error);\n    });\n}\n\n\nfunction structDialog(resources, callback) {\n  d3.select('#struct-qsrc')\n    .call(cmp.selectOptions, resources, d => d.id, d => d.name);\n  d3.select('#struct-targets')\n    .call(cmp.checkboxList, resources, 'targets', d => d.id, d => d.name);\n  store.getAppSetting('rdkit').then(rdk => {\n    d3.select('#struct-method').selectAll('option.rd')\n      .attr('disabled', rdk ? null : 'disabled');\n  });\n  d3.selectAll('#struct-method,#struct-thldtype')\n    .on('change', function () {\n      const method = d3form.value('#struct-method');\n      const thldtype = d3form.value('#struct-thldtype');\n      d3.select('#struct-thld')\n        .attr('disabled', ['gls', 'rdmorgan', 'rdfmcs'].includes(method) ? null : 'disabled')\n        .attr('value', thldtype === 'edge' ? 15 : 0.7)\n        .attr('min', thldtype === 'edge' ? 5 : 0)\n        .attr('max', thldtype === 'edge' ? 999 : 1.0)\n        .attr('step', thldtype === 'edge' ? 1 : 0.01);\n      d3.select('#struct-thldtype')\n        .attr('disabled', ['gls', 'rdmorgan', 'rdfmcs'].includes(method) ? null : 'disabled')\n        .property('value', ['gls', 'rdfmcs'].includes(method) ? undefined : 'sim');\n      d3.select('#struct-thldtype option.sim')\n        .attr('disabled', ['gls', 'rdmorgan', 'rdfmcs'].includes(method) ? null : 'disabled');\n      d3.select('#struct-thldtype option.edge')\n        .attr('disabled', ['gls', 'rdfmcs'].includes(method) ? null : 'disabled');\n      d3.select('#struct-options').selectAll('.gls')\n        .attr('disabled', method === 'gls' ? null : 'disabled');\n      d3.select('#struct-options .fmcs')\n        .attr('disabled', method === 'rdfmcs' ? null : 'disabled');\n    })\n    .dispatch('change');\n  d3.select('#struct-format')\n    .on('change', function () {\n      d3.select('#struct-qsrc')\n        .attr('disabled', this.value === 'dbid' ? null : 'disabled');\n    });\n  d3.select('#struct-preview')\n    .on('click', () => {\n      const f = d3form.value('#struct-format');\n      const query = {\n        format: f,\n        source: f === 'dbid' ? d3form.value('#struct-qsrc') : null,\n        value: f === 'molfile'\n          ? d3form.value('#struct-queryarea') : d3form.textareaLines('#struct-queryarea')[0],\n      };\n      return fetcher.get('strprev', query)\n        .then(fetcher.text)\n        .then(res => d3.select('#struct-image').html(res), fetcher.error);\n    });\n  d3.select('#struct-submit')\n    .on('click', () => {\n      const method = d3form.value('#struct-method');\n      d3.select('#loading-circle').style('display', 'inline');\n      const f = d3form.value('#struct-format');\n      const query = {\n        type: d3form.value('#struct-method'),\n        targets: d3form.checkboxValues('#struct-targets'),\n        queryMol: {\n          format: f,\n          source: f === 'dbid' ? d3form.value('#struct-qsrc') : null,\n          value: f === 'molfile'\n            ? d3form.value('#struct-queryarea') : d3form.textareaLines('#struct-queryarea')[0]\n        },\n        params: {\n          measure: d3form.value('#struct-thldtype'),\n          threshold: d3form.valueFloat('#struct-thld'),\n          ignoreHs: d3form.checked('#struct-ignoreh'),\n          diameter: method === 'gls' ? d3form.valueInt('#struct-diam') : null,\n          maxTreeSize: method === 'gls' ? d3form.valueInt('#struct-tree') : null,\n          molSizeCutoff: method === 'gls' ? d3form.valueInt('#struct-skip') : null,\n          timeout: method === 'rdfmcs' ? d3form.valueInt('#struct-timeout') : null\n        }\n      };\n      const command = query.type === 'exact' ? 'run' : 'async';\n      return fetcher.get(command, query)\n        .then(fetcher.json)\n        .then(callback, fetcher.error);\n    });\n}\n\n\nfunction sdfDialog(callback) {\n  d3.select('#sdf-file')\n    .on('change', () => {\n      const reader = new FileReader();\n      const file = document.getElementById('sdf-file').files[0];\n      reader.onload = (e) => {\n        d3.select('#sdf-cols')\n          .call(cmp.checkboxList, misc.getSDFPropList(e.target.result),\n                'fields', d => d, d => d\n          );\n      };\n      // Scan only first 100mb of the file due to memory limit.\n      reader.readAsText(file.slice(0, 100 * 1024 * 1024));\n    });\n  d3.select('#sdf-selectall')\n    .on('change', () => {\n      d3.select('#sdf-cols').selectAll('input')\n        .property('checked', d3form.checked('#sdf-selectall'));\n    });\n  d3.select('#sdf-submit')\n    .on('click', () => {\n      d3.select('#loading-circle').style('display', 'inline');\n      const params = {\n        fields: d3form.checkboxValues('#sdf-cols'),\n        implh: d3form.checked('#sdf-implh'),\n        recalc: d3form.checked('#sdf-recalc')\n      };\n      const formData = new FormData();\n      formData.append('contents', d3form.firstFile('#sdf-file'));\n      formData.append('params', JSON.stringify(params));\n      return fetcher.post('sdfin', formData)\n        .then(fetcher.json)\n        .then(callback, fetcher.error);\n    });\n}\n\n\nfunction columnDialog(dataFields, callback) {\n  const table = {\n    fields: def.defaultFieldProperties([\n      {key: 'name', format: 'text'},\n      {key: 'visible', format: 'control'},\n      {key: 'format', format: 'control'},\n      {key: 'd3_format', format: 'control'}\n    ])\n  };\n  const records = dataFields.map(e => {\n    const rcd = {};\n    const generalFormat = ['text', 'numeric', 'd3_format', 'raw', 'compound_id'];\n    rcd.name = e.name;\n    rcd.visible = selection => selection\n        .classed('column-vis', true)\n        .classed(`row-${e.key}`, true)\n      .append('input')\n        .attr('type', 'checkbox')\n        .attr('value', e.key)\n        .property('checked', e.visible);\n    rcd.format = selection => selection\n        .classed('column-format', true)\n        .classed(`row-${e.key}`, true)\n      .append('select')\n        .call(cmp.selectOptions,\n              generalFormat.includes(e.format) ? generalFormat : [e.format],\n              d => d, d => d)\n        .attr('disabled', generalFormat.includes(e.format) ? null : 'disabled')\n        .property('value', e.format)\n        .on('change', function () {\n          d3.select(`.column-d3f.row-${e.key} input`)\n            .attr('disabled', this.value === 'd3_format' ? null : 'disabled');\n        });\n    rcd.d3_format = selection => selection\n        .classed('column-d3f', true)\n        .classed(`row-${e.key}`, true)\n      .append('input')\n        .attr('size', 10)\n        .attr('disabled', e.format === 'd3_format' ? null : 'disabled')\n        .property('value', e.d3_format);\n    return rcd;\n  });\n  d3.select('#column-table')\n    .call(cmp.createTable, table)\n    .call(cmp.updateTableRecords, records, d => d.key);\n  d3.select('#column-submit')\n    .on('click', () => {\n      const query = {\n        visibles: d3form.checkboxValues('.column-vis'),\n        formats: d3form.optionValues('.column-format'),\n        d3_formats: d3form.inputValues('.column-d3f')\n      };\n      return store.setFieldProperties(win.URLQuery().id, query)\n        .then(callback);\n    });\n}\n\n\n// TODO:\nfunction fieldFetchDialog(compoundIDs, dataFields, resources, callback) {\n  // Prevent implicit submission\n  document.getElementById('join-search')\n    .addEventListener('keypress', event => {\n      if (event.keyCode === 13) event.preventDefault();\n    });\n  const dataKeys = dataFields.map(e => e.key);\n  const resourceFields = KArray.from(resources.map(e => e.fields))\n    .extend().unique('key').filter(e => e.key !== 'id');\n  d3.select('#join-keys')\n    .call(cmp.checkboxList, resourceFields, 'keys', d => d.key, d => d.name)\n    .selectAll('li')\n    .each(function(d) { // disable already shown columns\n      d3.select(this).selectAll('label').select('input')\n        .property('checked', dataKeys.includes(d.key))\n        .attr('disabled', dataKeys.includes(d.key) ? 'disabled' : null);\n    });\n  d3.select('#join-search')\n    .on('keyup', function () {\n      const match = d => fmt.partialMatch(d3form.value(this), d.name);\n      d3.select('#join-keys').selectAll('li')\n        .style('visibility', d => match(d) ? null : 'hidden')\n        .style('position', d => match(d) ? null : 'absolute');\n    });\n  d3.select('#join-submit')\n    .on('click', () => {\n      d3.select('#loading-circle').style('display', 'inline');\n      const selected = d3form.checkboxValues('#join-keys');\n      const queryFieldKeys = resourceFields.map(e => e.key)\n        .filter(e => !dataKeys.includes(e))\n        .filter(e => selected.includes(e));\n      const query = {\n        type: 'fieldfilter',\n        targetFields: queryFieldKeys,\n        key: 'compound_id',\n        values: compoundIDs\n      };\n      return fetcher.get('run', query)\n        .then(fetcher.json)\n        .then(json => callback(mapper.tableToMapping(json, 'id')),\n              fetcher.error);\n  });\n}\n\n\nfunction fieldFileDialog(callback) {\n  // TODO: need to refactor\n  d3.select('#importcol-file')\n    .on('change', () => {\n      const file = document.getElementById('importcol-file').files[0];\n      const isCsv = file.name.split('.').pop() === 'csv';\n      hfile.readFile(file).then(res => {\n        const mapping = isCsv ? mapper.csvToMapping(res) : JSON.parse(res);\n        const tbl = mapper.mappingToTable(mapping);\n        d3.select('#importcol-preview').call(cmp.createTable, tbl)\n          .call(cmp.updateTableRecords,\n                tbl.records.slice(0, 5), d => d[tbl.fields[0].key]);\n        // bind mapping\n        d3.select('#importcol-preview').datum(mapping);\n      });\n    });\n  d3.select('#importcol-submit')\n    .on('click', () => {\n      let mapping = d3.select('#importcol-preview').datum();\n      d3.select('#importcol-preview').datum(null);  // unbind mapping\n      // Generate thumbnails\n      const plotCols = [];\n      if (mapping.hasOwnProperty('field')) {\n        mapping = mapper.singleToMulti(mapping);\n      }\n      mapping.fields.forEach((e, i) => {\n        if (e.format === 'plot') {\n          mapping.fields[i].format = 'image';\n          plotCols.push(i);\n        }\n      });\n      if (plotCols.length > 0) {\n        const ps = [];\n        Object.entries(mapping.mapping).forEach(m => {\n          plotCols.forEach(e => {\n            const p = himg.plotThumbnail(m[1][e])\n              .then(img => {\n                mapping.mapping[m[0]][e] = img;\n              });\n            ps.push(p);\n          });\n        });\n        Promise.all(ps).then(() => callback(mapping));\n      } else {\n        callback(mapping);\n      }\n    });\n}\n\n\nfunction graphDialog(callback) {\n  store.getAppSetting('rdkit').then(rdk => {\n    d3.select('#graph-measure').selectAll('option.rd')\n      .attr('disabled', rdk ? null : 'disabled');\n  });\n  d3.select('#graph-measure')\n    .on('change', function () {\n      d3.select('#graph-options').selectAll('.gls')\n        .attr('disabled', this.value === 'gls' ? null : 'disabled');\n      d3.select('#graph-options').selectAll('.fmcs')\n        .attr('disabled', this.value === 'rdfmcs' ? null : 'disabled');\n    });\n  d3.select('#graph-submit')\n    .on('click', () => {\n      d3.select('#loading-circle').style('display', 'inline');\n      const measure = d3form.value('#graph-measure');\n      const params = {\n        measure: measure,\n        threshold: d3form.valueFloat('#graph-thld'),\n        ignoreHs: d3form.checked('#graph-ignoreh'),\n        diameter: measure === 'gls' ? d3form.valueInt('#graph-diam') : null,\n        maxTreeSize: measure === 'gls' ? d3form.valueInt('#graph-tree') : null,\n        molSizeCutoff: measure === 'gls' ? d3form.valueInt('#graph-skip') : null,\n        timeout: measure === 'rdfmcs' ? d3form.valueInt('#graph-timeout') : null\n      };\n      callback(params);\n    });\n}\n\n\nfunction graphConfigDialog(currentThld, minThld, callback) {\n  d3.select('#graphconfig-thld')\n    .attr('value', currentThld)\n    .attr('max', 1.0)\n    .attr('min', minThld);\n  d3.select('#graphconfig-submit')\n    .on('click', () => {\n      const newThld = d3form.valueFloat('#graphconfig-thld');\n      if (newThld < minThld) return;  // TODO: fool proof\n      callback(newThld);\n    });\n}\n\n\nfunction communityDialog(callback) {\n  d3.select('#community-name').attr('value', 'comm_');\n  d3.select('#community-submit')\n    .on('click', () => {\n      const query = {\n        name: d3form.value('#community-name'),\n        nulliso: d3form.checked('#community-nulliso')\n      };\n      callback(query);\n    });\n}\n\n\nfunction importConfirmDialog(callback) {\n  d3.select('#importconfirm-overwrite')\n    .on('click', () => callback('overwrite'));\n  d3.select('#importconfirm-keepboth')\n    .on('click', () => callback('keepboth'));\n  d3.select('#importconfirm-cancel')\n    .on('click', () => callback('cancel'));\n}\n\n\nexport default {\n  pickDialog, propDialog, structDialog, sdfDialog,\n  columnDialog, fieldFetchDialog, fieldFileDialog, graphDialog,\n  graphConfigDialog, communityDialog, importConfirmDialog\n};\n","\n/** @module component/Header */\n\nimport d3 from 'd3';\nimport {default as def} from '../helper/definition.js';\n\n\nfunction renderStatus(data, refresh_callback, abort_callback) {\n  d3.select('#loading-circle').style('display', 'none');\n  d3.select('title').text(data.name);\n  d3.select('#title').text(data.name);\n  d3.select('#refresh')\n    .style('display', def.ongoing(data) ? 'inline-block' : 'none');\n  d3.select('#abort')\n    .style('display', def.ongoing(data) ? 'inline-block' : 'none');\n  const doneText = {\n    'nodes': 'entries found',\n    'edges': 'connections created'\n  };\n  const dtx = doneText[data.dataType];\n  d3.select('#progress')\n    .text(`(${data.status} - ${data.records.length} ${dtx} in ${data.execTime} sec.)`);\n  if (def.ongoing(data)) {\n    d3.select('#progress').append('div').append('progress')\n      .attr('max', 100)\n      .attr('value', data.progress)\n      .text(`${data.progress}%`);\n  }\n  d3.select('#refresh').on('click', refresh_callback);\n  d3.select('#abort')\n    .on('click', () => {\n      d3.select('#confirm-message')\n        .text('Are you sure you want to abort this calculation job?');\n      d3.select('#confirm-submit')\n        .classed('btn-primary', false)\n        .classed('btn-warning', true)\n        .on('click', abort_callback);\n    });\n  console.info('Query');\n  console.info(data.query);  // query datails are available on browser console.\n}\n\n\nfunction initializeWithData() {\n  d3.select('#new-data').style('display', 'none');\n  d3.select('#loading-circle').style('display', 'none');\n}\n\n\nfunction initialize() {\n  d3.select('#data-control').style('display', 'none');\n  d3.select('#nodedata').style('display', 'none');\n  d3.select('#refresh').style('display', 'none');\n  d3.select('#abort').style('display', 'none');\n  d3.select('#loading-circle').style('display', 'none');\n  d3.select('#status').selectAll('li').style('display', 'none');\n}\n\n\nexport default {\n  renderStatus, initializeWithData, initialize\n};\n","\n/** @module graph/GraphForce */\n\nimport d3 from 'd3';\n\nconst fieldWidth = 1200;\nconst fieldHeight = 1200;\n\nconst simulation = d3.forceSimulation()\n  .force('link',\n    d3.forceLink().id(d => d.index)\n      .distance(60)\n      .strength(1))\n  .force('charge',\n    d3.forceManyBody()\n      .strength(-600)\n      .distanceMin(15)\n      .distanceMax(720))\n  .force('collide',\n    d3.forceCollide()\n      .radius(90))\n  .force('center',\n    d3.forceCenter(fieldWidth / 2, fieldHeight / 2))\n  .force('x',\n    d3.forceX()\n      .strength(0.002))\n  .force('y',\n    d3.forceY()\n      .strength(0.002))\n  .stop();\n\n\nfunction setForce(nodes, edges, tick, end) {\n  simulation.nodes(nodes)\n    .force('link').links(edges);\n  simulation.on('tick', tick)\n    .on('end', end);\n}\n\n\nfunction tick() {\n  d3.select('#graph-contents').selectAll('.node')\n    .attr('transform', d => `translate(${d.x}, ${d.y})`);\n  const alpha = simulation.alpha();\n  const isStopped = alpha <= simulation.alphaMin();\n  d3.select('#temperature')\n    .classed('progress-success', isStopped)\n    .classed('progress-warning', !isStopped)\n    .attr('value', isStopped ? 1 : 1 - alpha)\n    .text(isStopped ? 1 : 1 - alpha);\n}\n\n\nfunction end() {\n  d3.select('#graph-contents').selectAll('.link')\n    .attr('transform', d => `translate(${d.source.x}, ${d.source.y})`)\n    .attr('visibility', 'visible');\n  d3.select('#graph-contents').selectAll('.edge-line')\n    .attr('x1', 0)\n    .attr('y1', 0)\n    .attr('x2', d => d.target.x - d.source.x)\n    .attr('y2', d => d.target.y - d.source.y);\n  d3.select('#graph-contents').selectAll('.edge-label')\n    .attr('x', d => (d.target.x - d.source.x) / 2)\n    .attr('y', d => (d.target.y - d.source.y) / 2);\n}\n\n\nexport default {\n  fieldWidth, fieldHeight, simulation, setForce, tick, end\n};\n","\nconst defaultNodeColor = {\n  id: 'color',\n  field: null,\n  scale: {\n    domain: [0, 1],\n    range: ['#7fffd4', '#7fffd4'],\n    scale: 'linear',\n    unknown: '#7fffd4'\n  }\n};\n\nconst defaultNodeSize = {\n  id: 'size',\n  field: null,\n  scale: {\n    domain: [0, 1],\n    range: [40, 40],\n    scale: 'linear',\n    unknown: 40\n  }\n};\n\nconst defaultNodeLabel = {\n  id: 'label',\n  text: null,\n  size: 12,\n  visible: false,\n  field: null,\n  scale: {\n    domain: [0, 1],\n    range: ['#000000', '#000000'],\n    scale: 'linear',\n    unknown: '#000000'\n  }\n};\n\nconst defaultNodeContent = {\n  structure: {visible: false}\n};\n\nconst defaultEdge = {\n  id: 'edge',\n  visible: true,\n  label: {\n    size: 10,\n    visible: false\n  },\n  scale: {\n    domain: [0, 1],\n    range: [5, 5],\n    scale: 'linear',\n    unknown: 5\n  }\n};\n\n\nexport default {\n  defaultNodeColor, defaultNodeSize, defaultNodeLabel, defaultNodeContent,\n  defaultEdge\n};\n","\nfunction graphNodes(selection, data) {\n  const nodes = selection.selectAll('.node')\n    .data(data, d => d.key);\n  nodes.exit().remove();\n  const entered = nodes.enter().append('g')\n    .attr('class', 'node');\n  entered.append('circle')\n    .attr('class', 'node-symbol');\n  entered.append('g')\n    .attr('class', 'node-struct');\n  entered.append('text')\n    .attr('class', 'node-label');\n  const updated = entered.merge(nodes);\n  updated.select('.node-struct')\n    .html(d => d.structure);\n  updated.select('.node-label')\n    .attr('x', 0)\n    .attr('text-anchor', 'middle');\n}\n\n\nfunction graphEdges(selection, data) {\n  const edges = selection.selectAll('.link')\n    .data(data, d => `${d.source}_${d.target}`);\n  edges.exit().remove();\n  const entered = edges.enter().append('g')\n    .attr('class', 'link');\n  entered.append('line')\n    .attr('class', 'edge-line');\n  entered.append('text')\n    .attr('class', 'edge-label');\n  const updated = entered.merge(edges);\n  updated.select('.edge-line')\n    .style('stroke', '#999')\n    .style('stroke-opacity', 0.6);\n  updated.select('.edge-label')\n    .attr('text-anchor', 'middle')\n    .text(d => d.weight);\n}\n\n\nexport default {\n  graphNodes, graphEdges\n};\n","\nimport jLouvain from 'jLouvain';\n\n\nexport function communityDetection(nodes, edges, option) {\n  // TODO: partition resolution setting\n  // TODO: Error at edges.length 0\n  const community = jLouvain().nodes(nodes).edges(edges)();\n  // assign null to singletons\n  if (option.nulliso) {\n    const clusters = {};\n    Object.entries(community).forEach(e => {\n      if (!clusters.hasOwnProperty(e[1])) {\n        clusters[e[1]] = [];\n      }\n      clusters[e[1]].push(e[0]);\n    });\n    Object.entries(clusters).forEach(e => {\n      if (e[1].length === 1) {\n        community[e[1][0]] = null;\n      }\n    });\n  }\n  return community;\n}\n\n\nexport default {\n  communityDetection\n};\n"],"names":["v07_to_v08_nodes","json","fields","columns","map","e","format","id","name","dataType","dataTypeConv","schemaVersion","revision","status","statusConv","records","query","taskCount","searchCount","doneCount","searchDoneCount","resultCount","recordCount","progress","execTime","created","startDate","responseDate","v07_to_v08_convert","hasOwnProperty","nodes","edges","nodeFields","snp","fieldTransform","snapshot","nodePositions","nodeColor","nodeSize","nodeLabel","edge","scale","field","find","key","column","domain","range","unknown","size","text","visible","nodeContent","structure","label","reference","nodeTableId","def","defaultFieldProperties","networkThreshold","v07_to_v08_edges","readFile","file","sizeLimit","blob","Promise","resolve","reject","reader","FileReader","truncated","slice","onload","event","target","result","onerror","error","readAsArrayBuffer","readAsText","parseJSON","data","compressed","pako","inflate","to","JSON","parse","downloadDataFile","url","window","URL","createObjectURL","Blob","a","document","createElement","download","href","dispatchEvent","MouseEvent","view","bubbles","cancelable","singleToMulti","mapping","newMapping","Object","entries","forEach","m","updateTableAttribute","value","store","updateItem","item","catch","err","console","numericAsc","b","fa","parseFloat","fb","isNaN","String","localeCompare","textAsc","updateTableRecords","selection","rcds","keyFunc","header","select","selectAll","rowSelection","exit","remove","rowEntered","enter","append","d","merge","classed","html","i","undefined","fmt","formatNum","d3_format","each","d3","call","registerServiceWorker","navigator","serviceWorker","register","then","reg","info","scope","colorControlInput","d3form","optionData","preset","checked","push","sizeControlInput","updateNodeColor","style","d3scale","scaleFunction","updateNodeSize","attr","updateNodeLabel","updateNodeStructure","nds","w","h","updateEdgeVisibility","updateEdgeLabelVisibility","updateEdge","weight","updateRange","length","property","updateScale","hasDomain","updateControl","colorControlBox","cmp","selectOptions","colorPresets","on","this","dispatch","colorPalette","scaleTypes","sizeControlBox","presets","sizeScaleTypes","unstickNodes","fx","fy","dragWithForce","takeSnapshot","x","y","zoomTransform","node","datum","saveSnapshot","win","URLQuery","getGraph","getTable","start","g","renderStatus","common","fetchResults","render","edgesToDraw","filter","logD","Math","log10","component","graphEdges","graphNodes","force","setForce","tick","end","control","tf","transform","zoomIdentity","translate","k","interaction","zoom","updateNodeImage","resume","stickNodes","dflt","defaultNodeColor","defaultNodeSize","defaultNodeLabel","defaultNodeContent","defaultEdge","restart","transition","duration","_mol","dialog","graphConfigDialog","threshold","thld","communityDialog","nodeIds","index","visibleEdges","comm","community","communityDetection","nulliso","joinFields","mainControlBox","nodeColorControlBox","nodeSizeControlBox","nodeLabelControlBox","edgeControlBox","relax","t","loadNewGraph","interactiveInsert","location","selector","valueInt","parseInt","valueFloat","firstFile","files","inputValues","checkboxValues","optionValues","textareaLines","split","si","checkboxData","categoryMany","schemeSet1","concat","schemeSet3","schemePastel2","schemeSet2","defaultSizeRange","schemeCategory20","sizePresets","func","scaleLinear","scaleLog","scaleQuantize","scaleOrdinal","edgeWidthPresets","sf","mid","includes","clamp","sortType","ongoing","Queued","In progress","Aborting","Aborted","Completed","Failure","datatable","connection","loadJSON","endsWith","fetchJSON","decoded","decodeURIComponent","fetch","res","arrayBuffer","downloadJSON","compress","str","stringify","gzip","c","KArray","Array","[object Object]","reduce","prototype","apply","all","obj","kv","from","search","substring","toObject","getSDFPropList","re","uniqCols","Set","arr","exec","add","uuidv4","replace","r","random","toString","mappingToTable","mp","keyField","entry","rcd","f","tableToMapping","table","ignore","Date","row","csvToMapping","csvString","lines","shift","now","headerIdx","line","values","fd","unique","schema","app","items","resources","idb","Dexie","version","stores","where","equals","first","putAppSetting","v","put","toArray","putResources","bulkPut","getAllItems","orderBy","reverse","getItemsByDataType","type","sortBy","getItemById","tableId","callback","modify","deleteItem","delete","putItem","getAppSetting","setAppSetting","getResources","setResources","rsrcs","getAllTables","getTablesByDataType","setFieldProperties","updates","visibles","formats","d3_formats","mapper","insertTable","updateTable","assign","deleteTable","reset","d3format","Number","partialMatch","toUpperCase","indexOf","numericDesc","textDesc","showPlot","vegaSpec","vega","View","initialize","run","plotThumbnail","toImageURL","options","checkboxList","entered","updated","checkboxListT","description","createTable","cols","appendTableRows","newRcds","addSort","isAsc","isNum","sort","formatNumbers","col","colIdx","digit","baseURL","get","q","keys","credentials","Error","statusText","response","post","formdata","method","body","pickDialog","ids","targets","fetcher","propDialog","extend","operator","structDialog","rdk","thldtype","source","queryMol","params","measure","ignoreHs","diameter","maxTreeSize","molSizeCutoff","timeout","command","sdfDialog","getElementById","misc","implh","recalc","formData","FormData","columnDialog","dataFields","generalFormat","fieldFetchDialog","compoundIDs","addEventListener","keyCode","preventDefault","dataKeys","resourceFields","match","selected","targetFields","fieldFileDialog","isCsv","pop","hfile","tbl","plotCols","ps","p","himg","img","graphDialog","currentThld","minThld","newThld","importConfirmDialog","found","$","modal","action","loader","server","local","serverStatus","clientInstance","debugMode","instance","templates","compoundIDPlaceholder","defaultDataType","rdkit","refresh_callback","abort_callback","dtx","initializeWithData","simulation","forceSimulation","forceLink","distance","strength","forceManyBody","distanceMin","distanceMax","forceCollide","radius","forceCenter","fieldWidth","fieldHeight","forceX","forceY","stop","links","alpha","isStopped","alphaMin","textCols","updateNodeLabelVisibility","labelControlInput","numCols","nodeSizeControlInput","edgeControlInput","drag","active","alphaTarget","dragNoForce","connected","__data__","fitToScreen","option","jLouvain","clusters","click"],"mappings":"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"}