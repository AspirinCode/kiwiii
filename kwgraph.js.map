{"version":3,"file":"kwgraph.js","sources":["../src/helper/file.js","../src/helper/mapper.js","../src/store/StoreConnection.js","../src/helper/formatValue.js","../src/component/Component.js","../src/common.js","../src/graph/GraphControlBox.js","../src/graph/GraphInteraction.js","../src/graph.js","../src/helper/d3Form.js","../src/helper/d3Scale.js","../src/helper/definition.js","../src/helper/KArray.js","../src/helper/window.js","../src/helper/misc.js","../src/store/IDBStore.js","../src/helper/image.js","../src/fetcher.js","../src/component/Dialog.js","../src/component/Header.js","../src/graph/GraphForce.js","../src/graph/defaultGraphControl.js","../src/graph/GraphComponent.js","../src/graph/communityDetection.js"],"sourcesContent":["\n/** @module helper/file */\n\nimport pako from 'pako';\n\nimport {default as def} from './definition.js';\n\nconst statusConv = {\n  Queued: 'ready',\n  'In progress': 'running',\n  Aborting: 'running',\n  Aborted: 'aborted',\n  Completed: 'done',\n  Failure: 'failure'\n};\n\nconst dataTypeConv = {\n  datatable: 'nodes',\n  connection: 'edges'\n};\n\nfunction v07_to_v08_nodes(json) {\n  const fields = json.columns.map(e => {\n    e.format = 'raw';\n    return e;\n  });\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    status: statusConv[json.status],\n    fields: fields,\n    records: json.records,\n    query: json.query,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n  };\n}\n\nfunction v07_to_v08_edges(json, nodeFields) {\n  const snp = {\n    fieldTransform: json.snapshot.fieldTransform,\n    nodePositions: json.snapshot.nodePositions,\n    nodeColor: {},\n    nodeSize: {},\n    nodeLabel: {},\n    edge: {}\n  };\n  if (json.snapshot.hasOwnProperty('nodeColor')) {\n    snp.nodeColor.id = json.snapshot.nodeColor.id;\n    snp.nodeColor.scale = json.snapshot.nodeColor.scale;\n    snp.nodeColor.field = nodeFields.find(e => e.key === json.snapshot.nodeColor.column);\n  } else {\n    snp.nodeColor = {\n      id: 'color', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeSize')) {\n    snp.nodeSize.id = json.snapshot.nodeSize.id;\n    snp.nodeSize.scale = json.snapshot.nodeSize.scale;\n    snp.nodeSize.field = nodeFields.find(e => e.key === json.snapshot.nodeSize.column);\n  } else {\n    snp.nodeSize = {\n      id: 'size', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: [20, 20], unknown: 20}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeLabel')) {\n    snp.nodeLabel.id = json.snapshot.nodeLabel.id;\n    snp.nodeLabel.size = json.snapshot.nodeLabel.size;\n    snp.nodeLabel.text = json.snapshot.nodeLabel.text;\n    snp.nodeLabel.visible = json.snapshot.nodeLabel.visible;\n    snp.nodeLabel.scale = json.snapshot.nodeLabel.scale;\n    snp.nodeLabel.field = nodeFields.find(e => e.key === json.snapshot.nodeLabel.column);\n  } else {\n    snp.nodeLabel = {\n      id: 'label', size: 12, text: 'index', visible: false, field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeContent')) {\n    snp.nodeContent = json.snapshot.nodeContent;\n  } else {\n    snp.nodeContent = {structure: {visible: false}};\n  }\n  if (json.snapshot.hasOwnProperty('edge')) {\n    snp.edge = json.snapshot.edge;\n  } else {\n    snp.edge = {\n      id: 'label', label: {size: 10, visible: false}, visible: true,\n      scale: {scale: 'linear', domain: [0, 1], range: [5, 5], unknown: 5}\n    };\n  }\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    reference: {\n      nodes: json.nodeTableId\n    },\n    status: statusConv[json.status],\n    fields: def.defaultFieldProperties([\n      {'key': 'source'},\n      {'key': 'target'},\n      {'key': 'weight'}\n    ]),\n    records: json.records,\n    query: json.query,\n    networkThreshold: json.networkThreshold,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n    snapshot: snp\n  };\n}\n\nfunction v07_to_v08_convert(json) {\n  if (json.hasOwnProperty('edges')) {\n    const nodes = v07_to_v08_nodes(json.nodes);\n    const edges = v07_to_v08_edges(json.edges, nodes.fields);\n    return {nodes: nodes, edges: edges};\n  } else {\n    return v07_to_v08_nodes(json);\n  }\n}\n\n\nfunction readFile(file, sizeLimit, blob) {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    const truncated = sizeLimit ? file.slice(0, sizeLimit) : file;\n    reader.onload = event => resolve(event.target.result);\n    reader.onerror = error => reject(error);\n    if (blob) {\n      reader.readAsArrayBuffer(truncated);\n    } else {\n      reader.readAsText(truncated);\n    }\n  });\n}\n\n\nfunction parseJSON(data, compressed) {\n  const text = compressed ? pako.inflate(data, {to: 'string'}) : data;\n  const json = JSON.parse(text);\n  if (json.hasOwnProperty('schemaVersion')) return json;\n  if (json.hasOwnProperty('edges')) {\n    if (json.edges.hasOwnProperty('schemaVersion')) {\n      if (!json.edges.hasOwnProperty('reference')) { // ver0.8.0-0.8.1\n        json.edges.reference = {nodes: json.edges.nodesID};\n        const idx_converter = {};\n        json.nodes.records.forEach((e, i) => {\n            e.index = i;\n            e.structure = e._structure;\n            idx_converter[e._index] = e.index;\n            delete e._index;\n            delete e._structure;\n        });\n        json.edges.records.forEach(e => {\n            e.source = idx_converter[e.source];\n            e.target = idx_converter[e.target];\n        });\n        json.nodes.fields.forEach(e => {\n          if (e.key === '_index') e.key = 'index';\n          if (e.key === '_structure') e.key = 'structure';\n        });\n        json.edges.snapshot.nodeColor.field.key = 'index';\n        json.edges.snapshot.nodeLabel.field.key = 'index';\n        json.edges.snapshot.nodeSize.field.key = 'index';\n      }\n      return json;\n    }\n  }\n  return v07_to_v08_convert(json);\n}\n\n\nfunction loadJSON(file) {\n  const compressed = file.name.endsWith('c') || file.name.endsWith('.gz');\n  return readFile(file, false, compressed)\n    .then(data => parseJSON(data, compressed));\n}\n\n\nfunction fetchJSON(url) {\n  const decoded = decodeURIComponent(url);\n  const compressed = decoded.endsWith('c') || decoded.endsWith('.gz');\n  return fetch(decoded)\n    .then(res => compressed ? res.arrayBuffer() : res.json())\n    .then(data => parseJSON(data, compressed));\n}\n\n\nfunction downloadDataFile(data, name) {\n  try {\n    // cannot hundle large file with dataURI scheme\n    // url = 'data:application/json,' + encodeURIComponent(JSON.stringify(json))\n    const url = window.URL.createObjectURL(new Blob([data]));\n    const a = document.createElement('a');\n    a.download = name;\n    a.href = url;\n    // a.click() does not work on firefox\n    a.dispatchEvent(new MouseEvent('click', {\n      'view': window,\n      'bubbles': true,\n      'cancelable': false\n    }));\n    // window.URL.revokeObjectURL(url) does not work on firefox\n  } catch (e) {\n    // no DOM (unit testing)\n  }\n}\n\n\nfunction downloadJSON(json, name, compress=true) {\n  const str = JSON.stringify(json);\n  const data = compress ? pako.gzip(str) : str;\n  const c = compress ? 'c' : 'r';\n  const ext = json.hasOwnProperty('edges') ? `.gf${c}` :  `.nd${c}`;\n  downloadDataFile(data, `${name}${ext}`);\n}\n\n\nexport default {\n  readFile, parseJSON, loadJSON, fetchJSON,\n  downloadDataFile, downloadJSON\n};\n","\n/** @module helper/dataStructure */\n\nimport KArray from './KArray.js';\nimport {default as def} from './definition.js';\n\n\n/**\n * Convert single field mapping to multi field mapping\n * @param {object} mapping - single field mapping\n * @return {object} multi field mapping\n */\nfunction singleToMulti(mapping) {\n  const newMapping = {};\n  Object.entries(mapping.mapping).forEach(m => {\n    newMapping[m[0]] = [m[1]];\n  });\n  return {\n    created: mapping.created,\n    fields: [mapping.field],\n    key: mapping.key,\n    mapping: newMapping\n  };\n}\n\n\n/**\n * Convert field mapping to table\n * @param {object} mapping - field mapping\n * @return {object} table object\n */\nfunction mappingToTable(mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  const keyField = {key: mp.key, format: 'text'};\n  const data = {\n    fields: def.defaultFieldProperties([keyField].concat(mp.fields)),\n    records: Object.entries(mp.mapping).map(entry => {\n      const rcd = {};\n      rcd[mp.key] = entry[0];\n      mp.fields.forEach((f, i) => {\n        rcd[f.key] = entry[1][i];\n      });\n      return rcd;\n    })\n  };\n  return data;\n}\n\n\n/**\n * Convert table to field mapping\n * @param {object} table - table\n * @param {object} key - key\n * @return {object} field mapping\n */\nfunction tableToMapping(table, key, ignore=['index']) {\n  const now = new Date();\n  const mapping = {\n    created: now.toString(),\n    fields: def.defaultFieldProperties(table.fields\n      .filter(e => e.key !== key)\n      .filter(e => !ignore.includes(e.key))),\n    key: key,\n    mapping: {}\n  };\n  table.records.forEach(row => {\n    mapping.mapping[row[key]] = mapping.fields.map(e => row[e.key]);\n  });\n  return mapping;\n}\n\n\n/**\n * Convert csv text to field mapping\n * @param {string} csvString - csv data text\n * @return {object} field mapping\n */\nfunction csvToMapping(csvString) {\n  const lines = csvString.split(/\\n|\\r|\\r\\n/);\n  const header = lines.shift().split(',');\n  const key = header.shift();\n  const now = new Date();\n  const headerIdx = [];\n  const fields = [];\n  header.forEach((h, i) => {\n    if (h === '') return;\n    headerIdx.push(i);\n    fields.push({key: h, format: 'text'});\n  });\n  const mapping = {\n    created: now.toString(),\n    fields: def.defaultFieldProperties(fields),\n    key: key,\n    mapping: {}\n  };\n  lines.forEach(line => {\n    const values = line.split(',');\n    const k = values.shift();\n    mapping.mapping[k] = Array(headerIdx.length);\n    headerIdx.forEach(i => {\n      mapping.mapping[k][i] = values[i];\n    });\n  });\n  return mapping;\n}\n\n\n/**\n * Apply mapping to the data (in-place)\n * @param {object} data - datatable JSON\n * @param {object} mapping - mapping JSON\n * @return {undefined} undefined\n */\nfunction apply(data, mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  data.records\n    .filter(rcd => mp.mapping.hasOwnProperty(rcd[mp.key]))\n    .forEach(rcd => {\n      mp.fields.forEach((fd, i) => {\n        rcd[fd.key] = mp.mapping[rcd[mp.key]][i];\n      });\n    });\n  data.fields = def.defaultFieldProperties(\n    KArray.from(data.fields).concat(mp.fields).unique('key'));\n}\n\n\nexport default {\n  singleToMulti, mappingToTable, tableToMapping, csvToMapping, apply\n};\n","\nimport {default as def} from '../helper/definition.js';\nimport {default as mapper} from '../helper/mapper.js';\nimport {default as store} from './IDBStore.js';\n\n\nfunction getAppSetting(key) {\n  return store.getAppSetting(key)\n    .catch(err => {\n      console.error(`Unexpected key: ${key}`);\n      Promise.reject(err);\n    });\n}\n\n\nfunction setAppSetting(key, value) {\n  return store.putAppSetting(key, value)\n    .catch(err => {\n      console.error(`Unexpected key: ${key} or value: ${value}`);\n      Promise.reject(err);\n    });\n}\n\n\nfunction getResources() {\n  return store.getResources();\n}\n\n\nfunction setResources(rsrcs) {\n  return store.putResources(rsrcs)\n    .catch(err => {\n      console.error(`Unexpected resources: ${rsrcs}`);\n      Promise.reject(err);\n    });\n}\n\n\nfunction getAllTables() {\n  return store.getAllItems();\n}\n\n\nfunction getTablesByDataType(type) {\n  return store.getItemsByDataType(type)\n    .catch(err => {\n      console.error(`Unexpected dataType: ${type}`);\n      Promise.reject(err);\n    });\n}\n\n\nfunction getTable(id) {\n  return store.getItemById(id)\n    .catch(err => {\n      console.error(`Unexpected table ID: ${id}`);\n      Promise.reject(err);\n    });\n}\n\n\nfunction setFieldProperties(id, updates) {\n  return store.updateItem(id, item => {\n    item.fields.forEach((fd, i) => {\n      fd.visible = updates.visibles.includes(fd.key);\n      fd.format = updates.formats[i];\n      if (updates.d3_formats[i]) fd.d3_format = updates.d3_formats[i];\n    });\n    item.revision++;\n  })\n  .catch(err => {\n    console.error(`Unexpected table ID: ${id} or updates: ${updates}`);\n    Promise.reject(err);\n  });\n}\n\n\nfunction joinFields(id, mapping) {\n  return store.updateItem(id, item => {\n    mapper.apply(item, mapping);\n    item.revision++;\n  })\n  .catch(err => {\n    console.error(`Unexpected table ID: ${id} or mapping: ${mapping}`);\n    Promise.reject(err);\n  });\n}\n\n\nfunction updateTableAttribute(id, key, value) {\n  return store.updateItem(id, item => {\n    item[key] = value;\n    item.revision++;\n  })\n  .catch(err => {\n    console.error(`Unexpected table ID: ${id}, key: ${key} or value: ${value}`);\n    Promise.reject(err);\n  });\n}\n\n\nfunction insertTable(data) {\n  data.fields = def.defaultFieldProperties(data.fields);\n  return store.putItem(data)\n    .catch(err => {\n      console.error(`Unexpected data: ${data}`);\n      Promise.reject(err);\n    });\n}\n\n\nfunction updateTable(data) {\n  if (data.status === 'failure') {  // No data found on server\n    return updateTableAttribute(data.id, 'status', 'failure');\n  }\n  // update\n  return store.updateItem(data.id, item => {\n    data.fields = def.defaultFieldProperties(data.fields);\n    Object.assign(item, data);\n    item.revision++;\n  });\n}\n\n\nfunction deleteTable(id) {\n  return store.deleteItem(id)\n    .catch(err => {\n      console.error(`Unexpected table ID: ${id}`);\n      Promise.reject(err);\n    });\n}\n\n\nfunction reset() {\n  return store.reset();\n}\n\n\nexport default {\n  getAppSetting, setAppSetting, getResources, setResources,\n  getAllTables, getTablesByDataType, getTable,\n  setFieldProperties, joinFields,\n  updateTableAttribute, insertTable, updateTable,\n  deleteTable, reset\n};\n","\n/** @module helper/formatValue */\n\nimport d3 from 'd3';\n\n\n/**\n * Format number\n * @param {object} value - value\n * @param {string} type - si | scientific | rounded | raw\n */\nfunction formatNum(value, d3format) {\n  if (value === undefined || value === null || Number.isNaN(value)) return '';\n  return value == parseFloat(value) ? d3.format(d3format)(value) : value;\n}\n\nfunction partialMatch(query, target) {\n  if (target === undefined || target === null || target === '') return false;\n  return target.toString().toUpperCase()\n    .indexOf(query.toString().toUpperCase()) !== -1;\n}\n\nfunction numericAsc(a, b) {\n  const fa = parseFloat(a);\n  const fb = parseFloat(b);\n  if (isNaN(fa) || isNaN(fb)) {\n    return String(b).localeCompare(String(a));\n  }\n  return fb - fa;\n}\n\n\nfunction numericDesc(a, b) {\n  return numericAsc(b, a);\n}\n\n\nfunction textAsc(a, b) {\n  return String(b).localeCompare(String(a));\n}\n\n\nfunction textDesc(a, b) {\n  return textAsc(b, a);\n}\n\n\nexport default {\n  formatNum, partialMatch,\n  numericAsc, numericDesc, textAsc, textDesc\n};\n","\n/** @module component/Component */\n\nimport d3 from 'd3';\nimport {default as def} from '../helper/definition.js';\nimport {default as fmt} from '../helper/formatValue.js';\n\n\nfunction selectOptions(selection, data, key, text) {\n  const options = selection.selectAll('option')\n    .data(data, key);\n  options.exit().remove();\n  options.enter().append('option')\n    .merge(options)\n      .attr('value', key)\n      .text(text);\n}\n\n\nfunction checkboxList(selection, data, name, key, text) {\n  const items = selection.selectAll('li').data(data, key);\n  items.exit().remove();\n  const entered = items.enter().append('li')\n    .attr('class', 'form-check')\n    .append('label');\n  entered.append('input');\n  entered.append('span');\n  const updated = entered.merge(items.select('label'))\n    .attr('class', 'form-check-label');\n  updated.select('input')\n    .attr('type', 'checkbox')\n    .attr('class', 'form-check-input')\n    .attr('name', name)\n    .attr('value', key);\n  updated.select('span')\n    .text(text);\n}\n\n\n// checkbox list with tooltip\n// call $('[data-toggle=\"tooltip\"]').tooltip() after this function\nfunction checkboxListT(selection, data, name, key, text) {\n  const items = selection.selectAll('li').data(data, key);\n  items.exit().remove();\n  const entered = items.enter().append('li')\n    .attr('class', 'form-check')\n    .append('label');\n  entered.append('input');\n  entered.append('a');\n  const updated = entered.merge(items.select('label'))\n    .attr('class', 'form-check-label');\n  updated.select('input')\n    .attr('type', 'checkbox')\n    .attr('class', 'form-check-input')\n    .attr('name', name)\n    .attr('value', key);\n  updated.select('a')\n    .attr('data-toggle', 'tooltip')\n    .attr('data-placement', 'bottom')\n    .attr('title', d => d.description || 'No')\n    .text(text);\n}\n\n\nfunction createTable(selection, data) {\n  // Header\n  if (selection.select('thead').size()) selection.select('thead').remove();\n  selection.append('thead').append('tr');\n  // Records\n  if (selection.select('tbody').size()) selection.select('tbody').remove();\n    selection.append('tbody');\n\n  const cols = data.fields.filter(e => e.visible);\n  const header = selection.select('thead tr').selectAll('th')\n    .data(cols, d => d.key);\n  header.exit().remove();\n  header.enter().append('th')\n    .merge(header)\n      .text(d => d.name);\n}\n\n\nfunction updateTableRecords(selection, rcds, keyFunc) {\n  const header = selection.select('thead tr').selectAll('th')\n    .data();\n  const rowSelection = selection.select('tbody').selectAll('tr')\n    .data(rcds, keyFunc);\n  rowSelection.exit().remove();\n  const rowEntered = rowSelection.enter().append('tr');\n  rowEntered.selectAll('td')\n    .data(d => header.map(e => d[e.key]))\n    .enter().append('td');\n  rowEntered.merge(rowSelection)\n    .selectAll('td')\n      .classed('align-middle', true)\n    .html(function (d, i) {\n      if (d === undefined) return '';\n      if (header[i].format === 'd3_format') {\n        return fmt.formatNum(d, header[i].d3_format);\n      }\n      if (header[i].format === 'plot') return '[plot]';\n      if (header[i].format === 'image') return '[image]';\n      if (header[i].format === 'control') return;\n      return d;\n    })\n    .each((d, i, nodes) => {\n      // This should be called after html\n      if (header[i].format === 'control') d3.select(nodes[i]).call(d);\n    });\n}\n\n\nfunction appendTableRows(selection, rcds, keyFunc) {\n  const newRcds = selection.select('tbody').selectAll('tr').data();\n  Array.prototype.push.apply(newRcds, rcds);\n  updateTableRecords(selection, newRcds, keyFunc);\n}\n\n\nfunction addSort(selection) {\n  selection.select('thead tr').selectAll('th')\n    .filter(d => def.sortType(d.format) !== 'none')\n    .append('span').append('a')\n      .attr('id', d => `sort-${d.key}`)\n      .text('^v')\n      .style('display', 'inline-block')\n      .style('width', '30px')\n      .style('text-align', 'center')\n    .on('click', d => {\n      const isAsc = d3.select(`#sort-${d.key}`).text() === 'v';\n      const isNum = def.sortType(d.format) === 'numeric';\n      const cmp = isAsc\n        ? (isNum ? fmt.numericAsc : fmt.textAsc)\n        : (isNum ? fmt.numericDesc : fmt.textDesc);\n      selection.select('tbody').selectAll('tr')\n        .sort((a, b) => cmp(a[d.key], b[d.key]));\n      d3.select(`#sort-${d.key}`)\n        .text(isAsc ? '^' : 'v');\n    });\n}\n\n\nfunction formatNumbers(selection) {\n  // DEPRECATED: no longer used\n  selection.select('thead tr').selectAll('th')\n    .each((col, colIdx) => {\n      if (col.digit === 'raw') return;\n      selection.select('tbody').selectAll('tr')\n        .selectAll('td')\n          .filter((d, i) => i === colIdx)\n          .text(d => fmt.formatNum(d, col.digit));\n    });\n}\n\n\nexport default {\n  selectOptions, checkboxList, checkboxListT,\n  createTable, updateTableRecords,\n  appendTableRows, addSort, formatNumbers\n};\n","\nimport {default as def} from './helper/definition.js';\nimport {default as win} from './helper/window.js';\nimport {default as misc} from './helper/misc.js';\nimport {default as store} from './store/StoreConnection.js';\nimport {default as dialog} from './component/Dialog.js';\nimport {default as fetcher} from './fetcher.js';\n\n\nfunction interactiveInsert(data) {\n  return store.getTable(data.id)\n    .then(found => {\n      if (!found) return Promise.resolve(data); // no existing table\n      if (data.revision == found.revision) return Promise.reject(data.id); // same revision\n      // data id conflict\n      $('#importconfirm-dialog').modal('toggle');\n      return new Promise(res => {\n        dialog.importConfirmDialog(action => {\n          if (action === 'overwrite') {\n            res(data);\n          }\n          if (action === 'keepboth') {\n            data.id = misc.uuidv4();\n            res(data);\n          }\n        });\n      });\n    })\n    .then(\n      data => store.insertTable(data).then(() => data.id), // insert or update table\n      id => {\n        if (id) return Promise.resolve(id); // same revision -> call existing table\n        return Promise.reject();\n      }\n    );\n}\n\n\nfunction fetchResults(command='update') {\n  return store.getTable(win.URLQuery().id)\n    .then(data => {\n      if (!def.ongoing(data)) return Promise.reject();\n      return data;\n    })\n    .then(data => {\n      const query = {id: data.id, command: command};\n      return fetcher.get('res', query)\n        .then(fetcher.json)\n        .then(store.updateTable, fetcher.error);\n    }, () => Promise.resolve());\n}\n\n\nfunction registerServiceWorker() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker\n      .register('sw.js')\n      .then(reg => {\n        console.info('ServiceWorker registration successful with scope: ', reg.scope);\n      }).catch(err => {\n        console.info('ServiceWorker registration failed: ', err);\n      });\n  } else {\n    console.info('Off-line mode is not supported');\n  }\n}\n\n\nfunction loader() {\n  /*\n  if (document.location.protocol === \"file:\") {\n    console.info('Off-line mode (local file)');\n    store.setGlobalConfig('onLine', false);\n    return Promise.resolve();\n  }\n  if ('onLine' in navigator) {\n    if (!navigator.onLine) {\n      console.info('Off-line mode (no internet connection)');\n      store.setGlobalConfig('onLine', false);\n      return Promise.resolve();\n    }\n  }*/\n  const server = fetcher.get('server')\n    .then(fetcher.json)\n    .catch(() => null);\n  const local = store.getAppSetting('serverInstance');\n  return Promise.all([server, local]).then(ps => {\n    const serverStatus = ps[0];\n    const clientInstance = ps[1];\n    if (!serverStatus) return Promise.resolve(null);\n    if (!serverStatus.debugMode) {\n      registerServiceWorker();\n    } else {\n      console.info('Off-line mode is disabled for debugging');\n    }\n    if (serverStatus.instance === clientInstance) {\n      console.info('Resource schema is already up to date');\n      return Promise.resolve(serverStatus);\n    } else {\n      return fetcher.get('schema')\n        .then(fetcher.json)\n        .then(schema => {\n          console.info(`New resource schema version: ${serverStatus.instance}`);\n          return Promise.all([\n            store.setResources(schema.resources),\n            store.setAppSetting('templates', schema.templates),\n            store.setAppSetting(\n              'compoundIDPlaceholder', schema.compoundIDPlaceholder),\n              store.setAppSetting(\n                'defaultDataType', schema.defaultDataType),\n            store.setAppSetting('serverInstance', serverStatus.instance),\n            store.setAppSetting('rdkit', serverStatus.rdkit)\n          ])\n          .then(() => Promise.resolve(serverStatus));\n        }, fetcher.error);\n    }\n  });\n}\n\n\nexport default {\n  interactiveInsert, fetchResults, registerServiceWorker, loader\n};\n","\nimport d3 from 'd3';\nimport {default as d3scale} from '../helper/d3Scale.js';\nimport {default as d3form} from '../helper/d3Form.js';\nimport {default as def} from '../helper/definition.js';\nimport {default as fmt} from '../helper/formatValue.js';\nimport {default as cmp} from '../component/Component.js';\n\n\n\n// Get data\n\nfunction colorControlInput(id) {\n  const data = {\n    id: id,\n    field: d3form.optionData(`#${id}-col`)\n  };\n  const preset = d3form.optionData(`#${id}-preset`);\n  if (preset.scale.scale === 'ordinal') {\n    data.scale = preset.scale;\n    return data;\n  }\n  data.scale = {\n    scale: d3form.value(`#${id}-scaletype`),\n    domain: [\n      d3form.value(`#${id}-domain-from`),\n      d3form.value(`#${id}-domain-to`)\n    ],\n    unknown: '#696969'\n  };\n  const range = [d3form.value(`#${id}-range-from`)];\n  if (d3form.checked(`#${id}-range-enable-mid`)) {\n    range.push(d3form.value(`#${id}-range-mid`));\n  }\n  range.push(d3form.value(`#${id}-range-to`));\n  data.scale.range = range;\n  return data;\n}\n\n\nfunction labelControlInput() {\n  const data = colorControlInput('label');\n  data.text = d3form.optionData('#label-text');\n  data.size = d3form.value('#label-size');\n  data.visible = d3form.checked('#label-visible');\n  return data;\n}\n\n\nfunction sizeControlInput(id) {\n  return {\n    id: id,\n    scale: {\n      scale: d3form.value(`#${id}-scaletype`),\n      domain: [\n        d3form.value(`#${id}-domain-from`),\n        d3form.value(`#${id}-domain-to`)\n      ],\n      range: [\n        d3form.value(`#${id}-range-from`),\n        d3form.value(`#${id}-range-to`)\n      ],\n      unknown: 10\n    }\n  };\n}\n\n\nfunction nodeSizeControlInput() {\n  const data = sizeControlInput('size');\n  data.field = d3form.optionData('#size-col');\n  return data;\n}\n\n\nfunction nodeContentInput() {\n  return {\n    structure: {\n      visible: d3form.checked('#show-struct')\n    }\n  };\n}\n\n\nfunction edgeControlInput() {\n  const data = sizeControlInput('edge');\n  data.visible = d3form.checked('#edge-visible');\n  data.label = {\n    size: d3form.value('#edge-label-size'),\n    visible: d3form.checked('#edge-label-visible')\n  };\n  return data;\n}\n\n\n// Update DOM attributes\n\nfunction updateNodeColor(data) {\n  d3.selectAll('.node').select('.node-symbol')\n    .style('fill', d =>\n      d3scale.scaleFunction(data.scale)(data.field ? d[data.field.key] : null)\n    );\n}\n\n\nfunction updateNodeSize(data) {\n  d3.selectAll('.node').select('.node-symbol')\n    .attr('r', d =>\n      d3scale.scaleFunction(data.scale)(data.field ? d[data.field.key] : null));\n}\n\n\nfunction updateNodeLabelVisibility(visible) {\n  d3.selectAll('.node').select('.node-label')\n    .attr('visibility', visible ? 'inherit' : 'hidden');\n}\n\n\nfunction updateNodeLabel(data) {\n  d3.selectAll('.node').select('.node-label')\n    .text(d => {\n      if (data.text === null) return '';\n      if (!d.hasOwnProperty(data.text.key)) return '';\n      if (data.text.format === 'd3_format') {\n        return fmt.formatNum(d[data.text.key], data.text.d3_format);\n      }\n      return d[data.text.key];\n    })\n    .attr('font-size', data.size)\n    .attr('y', 90) // TODO: derived from structure size or node circle radius\n    .attr('visibility', data.visible ? 'inherit' : 'hidden')\n    .style('fill', d =>\n      d3scale.scaleFunction(data.scale)(data.field ? d[data.field.key] : null));\n}\n\n\nfunction updateNodeStructure(data) {\n  d3.selectAll('.node').select('.node-struct')\n    .attr('visibility', data.structure.visible ? 'inherit' : 'hidden')\n    .each((d, i, nds) => {\n      const w = d3.select(nds[i]).select('svg').attr('width');\n      const h = d3.select(nds[i]).select('svg').attr('height');\n      d3.select(nds[i]).attr('transform', `translate(${-w / 2},${-h / 2})`);\n    });\n}\n\n\nfunction updateNodeImage(data) {\n  updateNodeSize(data.nodeSize);\n  updateNodeColor(data.nodeColor);\n  updateNodeLabel(data.nodeLabel);\n  updateNodeStructure(data.nodeContent);\n}\n\n\nfunction updateEdgeVisibility(visible) {\n  d3.selectAll('.link').select('.edge-line')\n    .attr('visibility', visible ? 'inherit' : 'hidden');\n}\n\n\nfunction updateEdgeLabelVisibility(visible) {\n  d3.selectAll('.link').select('.edge-label')\n    .attr('visibility', visible ? 'inherit' : 'hidden');\n}\n\n\nfunction updateEdge(data) {\n  d3.selectAll('.link').select('.edge-line')\n    .style('stroke-width', d => d3scale.scaleFunction(data.scale)(d.weight));\n  d3.selectAll('.link').select('.edge-label')\n    .attr('font-size', data.label.size);\n  updateEdgeVisibility(data.visible);\n  updateEdgeLabelVisibility(data.label.visible);\n}\n\n\nfunction updateRange(range, id) {\n  if (range.length === 2) {\n    d3.select(`#${id}-range-from`).property('value', range[0]);\n    d3.select(`#${id}-range-enable-mid`).attr('checked', null);\n    d3.select(`#${id}-range-mid`).attr('disabled','disabled');\n    d3.select(`#${id}-range-to`).property('value', range[1]);\n    d3.selectAll(`#${id}-range input`).attr('disabled', null);\n  } else if (range.length === 3) {\n    d3.select(`#${id}-range-from`).property('value', range[0]);\n    d3.select(`#${id}-range-enable-mid`).attr('checked', 'checked');\n    d3.select(`#${id}-range-mid`).property('value', range[1]);\n    d3.select(`#${id}-range-to`).property('value', range[2]);\n    d3.selectAll(`#${id}-range input`).attr('disabled', null);\n  } else {\n    d3.selectAll(`#${id}-range input`).attr('disabled', 'disabled');\n  }\n}\n\n\nfunction updateScale(scale, id) {\n  d3.select(`#${id}-scaletype`).property('value', scale.scale);\n  const hasDomain = scale.hasOwnProperty('domain');\n  d3.selectAll(`#${id}-domain input`)\n    .attr('disabled', hasDomain ? null : 'disabled');\n  if (hasDomain) {\n    d3.select(`#${id}-domain-from`).property('value', scale.domain[0]);\n    d3.select(`#${id}-domain-to`).property('value', scale.domain[1]);\n  }\n  updateRange(scale.range, id);\n}\n\n\nfunction updateControl(data) {\n  const id = data.id;\n  d3.select(`#${id}-visible`).attr('checked', data.visible ? 'checked' : null);\n  d3.select(`#${id}-size`).property('value', data.size);\n  d3.select(`#${id}-text`).property('value', data.text ? data.text.key : null);\n  d3.select(`#${id}-col`).property('value', data.field ? data.field.key : null);\n  if (data.hasOwnProperty('label')) {\n    d3.select(`#${id}-label-visible`)\n      .attr('checked', data.label.visible ? 'checked' : null);\n    d3.select(`#${id}-label-size`).property('value', data.label.size);\n  }\n  updateScale(data.scale, data.id);\n}\n\n\n\n// Generate controlBox elements\n\nfunction mainControlBox() {\n  d3.select('#show-struct')\n    .on('change', function () {\n      const data = nodeContentInput();\n      d3.select('#main-control').datum(data);\n      updateNodeStructure(data);\n    })\n    .dispatch('change');\n}\n\n\nfunction colorControlBox(fields, id) {\n  d3.select(`#${id}-col`)\n    .call(cmp.selectOptions, fields, d => d.key, d => d.name);\n  d3.select(`#${id}-preset`)\n    .call(cmp.selectOptions, d3scale.colorPresets, d => d.name, d => d.name)\n    .on('change', function() {\n      updateScale(d3form.optionData(this).scale, id);\n      d3.select(`.${id}-update`).dispatch('change');\n    });\n  d3.select(`#${id}-palette`)\n    .call(cmp.selectOptions, d3scale.colorPalette, d => d.name, d => d.name)\n    .on('change', function() {\n      updateRange(d3form.optionData(this).range, id);\n      d3.select(`.${id}-update`).dispatch('change');\n    });\n  d3.select(`#${id}-scaletype`)\n    .call(cmp.selectOptions, d3scale.scaleTypes, d => d.name, d => d.name);\n}\n\n\nfunction nodeColorControlBox(fields) {\n  const textCols = fields.filter(e => def.sortType(e.format) !== 'none');\n  colorControlBox(textCols, 'color');\n  d3.selectAll('.color-update')\n    .on('change', () => {\n      const data = colorControlInput('color');\n      d3.select('#color-control').datum(data);\n      updateControl(data);\n      updateNodeColor(data);\n    });\n  d3.select('.color-update').dispatch('change');\n}\n\n\nfunction nodeLabelControlBox(fields) {\n  const textCols = fields.filter(e => def.sortType(e.format) !== 'none');\n  d3.select('#label-text')\n    .call(cmp.selectOptions, textCols, d => d.key, d => d.name);\n  colorControlBox(textCols, 'label');\n  d3.select('#label-visible')\n    .on('change', function() {\n      updateNodeLabelVisibility(d3form.checked(this), 'label');\n      d3.select(`.label-update`).dispatch('change');\n    });\n  d3.selectAll('.label-update')\n    .on('change', () => {\n      const data = labelControlInput();\n      d3.select('#label-control').datum(data);\n      updateControl(data);\n      updateNodeLabel(data);\n    });\n  d3.select(`.label-update`).dispatch('change');\n}\n\n\nfunction sizeControlBox(presets, id) {\n  d3.select(`#${id}-preset`)\n    .call(cmp.selectOptions, presets, d => d.name, d => d.name)\n    .on('change', function() {\n      updateScale(d3form.optionData(this).scale, id);\n      d3.select(`.${id}-update`).dispatch('change');\n    });\n  d3.select(`#${id}-scaletype`)\n    .call(cmp.selectOptions, d3scale.sizeScaleTypes, d => d.name, d => d.name);\n}\n\n\nfunction nodeSizeControlBox(fields) {\n  const numCols = fields.filter(e => def.sortType(e.format) === 'numeric');\n  d3.select(`#size-col`)\n    .call(cmp.selectOptions, numCols, d => d.key, d => d.name);\n  sizeControlBox(d3scale.sizePresets, 'size');\n  d3.selectAll('.size-update')\n    .on('change', () => {\n      const data = nodeSizeControlInput('size');\n      d3.select('#size-control').datum(data);\n      updateControl(data);\n      updateNodeSize(data);\n    });\n  d3.select(`.size-update`).dispatch('change');\n}\n\n\nfunction edgeControlBox() {\n  sizeControlBox(d3scale.edgeWidthPresets, 'edge');\n  d3.select('#edge-visible')\n    .on('change', function() {\n      updateEdgeVisibility(d3form.checked(this));\n      updateEdgeLabelVisibility(d3form.checked(this));\n      d3.select(`.edge-update`).dispatch('change');\n    });\n  d3.select('#edge-label-visible')\n    .on('change', function() {\n      updateEdgeLabelVisibility(d3form.checked(this));\n      d3.select(`.edge-update`).dispatch('change');\n    });\n  d3.selectAll('.edge-update')\n    .on('change', () => {\n      const data = edgeControlInput('edge');\n      d3.select('#edge-control').datum(data);\n      updateControl(data);\n      updateEdge(data);\n    });\n  d3.select(`.edge-update`).dispatch('change');\n}\n\n\nexport default {\n  updateNodeStructure, updateNodeImage, updateEdge, updateControl,\n  mainControlBox, nodeColorControlBox, nodeLabelControlBox, nodeSizeControlBox, edgeControlBox\n};\n","\nimport d3 from 'd3';\n\nimport {default as force} from './GraphForce.js';\n\nconst zoom = d3.zoom()\n  .on('zoom', () => {\n    d3.select('#graph-contents').attr('transform', d3.event.transform);\n  });\n\nconst dragWithForce = d3.drag()\n  .on('start', () => {\n    d3.select('#graph-contents').selectAll('.link')\n      .attr('visibility', 'hidden');\n    if (!d3.event.active) force.simulation.alphaTarget(0.1).restart();\n  })\n  .on('drag', d => {\n    d.fx = d3.event.x;\n    d.fy = d3.event.y;\n  })\n  .on('end', d => {\n    if (!d3.event.active) force.simulation.alphaTarget(0);\n    d.fx = null;\n    d.fy = null;\n  });\n\nconst dragNoForce = d3.drag()\n  .on('drag', function (d) {\n    d3.select(this)\n      .attr('transform', () => `translate(${d3.event.x}, ${d3.event.y})`);\n    d.x = d3.event.x;\n    d.y = d3.event.y;\n    const connected = d3.select('#graph-contents').selectAll('.link')\n      .filter(d => [d.source.index, d.target.index].includes(this.__data__.index));\n    connected.attr('transform', d => `translate(${d.source.x}, ${d.source.y})`)\n      .attr('visibility', 'visible');\n    connected.select('.edge-line')\n      .attr('x1', 0)\n      .attr('y1', 0)\n      .attr('x2', d => d.target.x - d.source.x)\n      .attr('y2', d => d.target.y - d.source.y);\n    connected.select('.edge-label')\n      .attr('x', d => (d.target.x - d.source.x) / 2)\n      .attr('y', d => (d.target.y - d.source.y) / 2);\n  })\n  .on('end', () => {\n    force.end();\n  });\n\n\nfunction stickNodes() {\n  force.simulation.alpha(0).stop();\n  d3.selectAll('.node').each(d => {\n    d.fx = d.x;\n    d.fy = d.y;\n  });\n  force.tick();\n  force.end();\n  d3.select('#stick-nodes').property('checked', true);\n  d3.select('#graph-contents').selectAll('.link')\n    .attr('visibility', 'visible');\n  d3.select('#graph-contents').selectAll('.node')\n    .call(dragNoForce);\n}\n\n\nfunction unstickNodes() {\n  d3.selectAll('.node').each(d => {\n    d.fx = null;\n    d.fy = null;\n  });\n  d3.select('#stick-nodes').property('checked', false);\n  d3.select('#graph-contents').selectAll('.link')\n    .attr('visibility', 'hidden');\n  d3.select('#graph-contents').selectAll('.node')\n    .call(dragWithForce);\n}\n\n\nfunction relax() {\n  unstickNodes();\n  force.simulation.alpha(0.1).restart();\n}\n\n\nfunction restart() {\n  unstickNodes();\n  force.simulation.alpha(1).restart();\n}\n\n\nfunction fitToScreen() {\n  d3.select('#graph-field').call(zoom.transform, d3.zoomIdentity);\n  // TODO\n  /*\n  const p = 0.9;  // padding factor\n  const x = extent(selectAll('.node').data(), d => d.x);\n  const y = extent(selectAll('.node').data(), d => d.y);\n  const w = x[1] - x[0];\n  const h = y[1] - y[0];\n  const vb = select('#graph-field').attr('viewBox').split(' ');\n  const xScaleF = vb[2] / w * p;\n  const yScaleF = vb[3] / h * p;\n  const scaleF = Math.max(xScaleF, yScaleF);\n  const center = [(w * (1 - p) / 2 - x[0]) * xScaleF,\n                  (h * (1 - p) / 2 - y[0]) * yScaleF];\n  // Reset zoom point\n  zoom.scale(scaleF);\n  zoom.translate(center);\n  updateViewportTransform(center, scaleF);\n  */\n}\n\n\nexport default {\n  zoom, dragWithForce, dragNoForce,\n  stickNodes, unstickNodes,\n  relax, restart, fitToScreen\n};\n","\n/** @module graph */\n\nimport d3 from 'd3';\n\nimport {default as d3form} from './helper/d3Form.js';\nimport {default as d3scale} from './helper/d3Scale.js';\nimport {default as def} from './helper/definition.js';\nimport {default as hfile} from './helper/file.js';\nimport {default as win} from './helper/window.js';\nimport {default as common} from './common.js';\nimport {default as store} from './store/StoreConnection.js';\nimport {default as header} from './component/Header.js';\nimport {default as dialog} from './component/Dialog.js';\nimport {default as force} from './graph/GraphForce.js';\nimport {default as dflt} from './graph/defaultGraphControl.js';\nimport {default as control} from './graph/GraphControlBox.js';\nimport {default as component} from './graph/GraphComponent.js';\nimport {default as interaction} from './graph/GraphInteraction.js';\nimport {default as community} from './graph/communityDetection.js';\n\n\nfunction takeSnapshot() {\n  return {\n    nodePositions: d3.selectAll('.node').data().map(d => ({x: d.x, y: d.y})),\n    fieldTransform: d3.zoomTransform(d3.select('#graph-field').node()),\n    nodeContent: d3.select('#main-control').datum(),\n    nodeColor: d3.select('#color-control').datum(),\n    nodeSize: d3.select('#size-control').datum(),\n    nodeLabel: d3.select('#label-control').datum(),\n    edge: d3.select('#edge-control').datum()\n  };\n}\n\n\nfunction saveSnapshot() {\n  return store.updateTableAttribute(win.URLQuery().id, 'snapshot', takeSnapshot())\n    .then(() => console.info('Snapshot saved'));\n}\n\n\nfunction resume(snapshot) {\n  d3.select('#main-control').datum(snapshot.nodeContent);\n  d3.select('#show-struct')\n    .property('checked', snapshot.nodeContent.structure.visible);\n  d3.select('#color-control').datum(snapshot.nodeColor);\n  control.updateControl(snapshot.nodeColor);\n  d3.select('#size-control').datum(snapshot.nodeSize);\n  control.updateControl(snapshot.nodeSize);\n  d3.select('#label-control').datum(snapshot.nodeLabel);\n  control.updateControl(snapshot.nodeLabel);\n  d3.select('#edge-control').datum(snapshot.edge);\n  control.updateControl(snapshot.edge);\n  const tf = snapshot.fieldTransform;\n  const transform = d3.zoomIdentity.translate(tf.x, tf.y).scale(tf.k);\n  d3.select('#graph-contents').attr('transform', transform);\n  d3.select('#graph-field').call(interaction.zoom.transform, transform);\n  d3.selectAll('.node').each((d, i) => {\n    d.x = snapshot.nodePositions[i].x;\n    d.y = snapshot.nodePositions[i].y;\n  });\n  control.updateNodeImage(snapshot);\n}\n\n\nfunction getGraph() {\n  return store.getTable(win.URLQuery().id)\n    .then(edges => {\n      return store.getTable(edges.reference.nodes)\n        .then(nodes => {\n          return {edges: edges, nodes: nodes};\n        });\n    });\n}\n\n\nfunction start() {\n  return getGraph()\n    .then(g => {\n      header.renderStatus(g.edges,\n        () => common.fetchResults().then(render),\n        () => common.fetchResults('abort').then(render));\n      const edgesToDraw = g.edges.records\n        .filter(e => e.weight >= g.edges.networkThreshold);\n      const logD = d3.format('.2f')(Math.log10(edgesToDraw.length / g.edges.taskCount));\n      d3.select('#edge-density').text(logD);\n      d3.select('#network-thld').text(g.edges.networkThreshold);\n      component.graphEdges(d3.select('#graph-contents'), edgesToDraw);\n      component.graphNodes(d3.select('#graph-contents'), g.nodes.records);\n      force.setForce(\n        g.nodes.records, edgesToDraw, force.tick,\n        () => {\n          force.end();\n          saveSnapshot();\n        });\n      if (g.edges.hasOwnProperty('snapshot')) {\n        resume(g.edges.snapshot);\n        interaction.stickNodes();\n      } else {\n        // Set default appearance\n        // TODO: refactor\n        d3.select('#color-control').datum(dflt.defaultNodeColor);\n        control.updateControl(dflt.defaultNodeColor);\n        d3.select('#size-control').datum(dflt.defaultNodeSize);\n        control.updateControl(dflt.defaultNodeSize);\n        d3.select('#label-control').datum(dflt.defaultNodeLabel);\n        control.updateControl(dflt.defaultNodeLabel);\n        d3.select('#main-control').datum(dflt.defaultNodeContent);\n        d3.select('#show-struct')\n          .property('checked', dflt.defaultNodeContent.structure.visible);\n        d3.select('#edge-control').datum(dflt.defaultEdge);\n        control.updateControl(dflt.defaultEdge);\n        control.updateNodeImage({\n          nodeColor: dflt.defaultNodeColor,\n          nodeSize: dflt.defaultNodeSize,\n          nodeLabel: dflt.defaultNodeLabel,\n          nodeContent: dflt.defaultNodeContent\n        });\n        control.updateEdge(dflt.defaultEdge);\n        interaction.restart();\n      }\n      d3.select('#graph-contents').style('opacity', 1e-6)\n        .transition()\n        .duration(1000)\n        .style('opacity', 1);\n    });\n}\n\n\nfunction render() {\n  return getGraph()\n    .then(g => {\n      g.nodes.records.forEach(e => { delete e._mol; });\n      dialog.graphConfigDialog(\n          g.edges.networkThreshold, g.edges.query.threshold, thld => {\n        return store.updateTableAttribute(win.URLQuery().id, 'networkThreshold', thld)\n          .then(saveSnapshot)\n          .then(start);\n      });\n      dialog.communityDialog(query => {\n        const nodeIds = g.nodes.records.map(e => e.index);\n        const visibleEdges = g.edges.records\n          .filter(e => e.weight >= g.edges.networkThreshold);\n        const comm = community.communityDetection(\n          nodeIds, visibleEdges, {nulliso: query.nulliso}\n        );\n        const mapping = {\n          key: 'index',\n          field: def.defaultFieldProperties(\n            [{key: query.name, format: 'd3_format', d3_format: 'd'}]),\n          mapping: comm\n        };\n        store.joinFields(g.nodes.id, mapping)\n          .then(() => {\n            const snapshot = takeSnapshot();\n            snapshot.nodeColor.field = query.name;\n            snapshot.nodeColor.scale = d3scale.colorPresets\n              .find(e => e.name === 'Categories').scale;\n            return store.updateTableAttribute(win.URLQuery().id, 'snapshot', snapshot)\n              .then(() => console.info('snapshot saved'));\n          }).then(render);\n      });\n      control.mainControlBox();\n      control.nodeColorControlBox(g.nodes.fields);\n      control.nodeSizeControlBox(g.nodes.fields);\n      control.nodeLabelControlBox(g.nodes.fields);\n      control.edgeControlBox();\n      d3.select('#stick-nodes')\n        .on('change', function() {\n          d3form.checked(this) === true ? interaction.stickNodes() : interaction.relax();\n        });\n      d3.select('#nodetable').attr('href', `datatable.html?id=${g.edges.reference.nodes}`);\n      d3.select('#rename')\n        .on('click', () => {\n          d3.select('#prompt-title').text('Rename table');\n          d3.select('#prompt-label').text('New name');\n          d3.select('#prompt-input').attr('value', g.edges.name);\n          d3.select('#prompt-submit')\n            .on('click', () => {\n              const name = d3form.value('#prompt-input');\n              return store.updateTableAttribute(win.URLQuery().id, 'name', name)\n                .then(() => store.getTable(win.URLQuery().id))  // updateTableAttribute returns 1\n                .then(t => header.renderStatus(t,\n                  () => common.fetchResults().then(render),\n                  () => common.fetchResults('abort').then(render))\n                );\n            });\n        });\n      return start();\n    });\n}\n\n\nfunction loadNewGraph(data) {\n  return common.interactiveInsert(data.nodes)\n    .then(id => {\n      data.edges.reference.nodes = id;\n      return common.interactiveInsert(data.edges);\n    })\n    .then(id => {\n      window.location = `graph.html?id=${id}`;\n    });\n}\n\n\nfunction run() {\n  d3.select('#export')\n    .on('click', () => {\n      // Working copy of edges and nodes are modified by d3.force.\n      // Load original data from store.\n      return getGraph().then(g => hfile.downloadJSON(g, g.edges.name));\n    });\n  d3.select('#graph-field')\n    .attr('viewBox', `0 0 ${force.fieldWidth} ${force.fieldHeight}`)\n    .call(interaction.zoom);\n  d3.select('#snapshot')\n    .on('click', saveSnapshot);\n  d3.select('#restart')\n    .on('click', interaction.restart);\n  d3.select('#import-json')\n    .on('click', () => document.getElementById('select-file').click());\n  d3.select('#select-file')\n    .on('change', () => {\n      const file = document.getElementById('select-file').files[0];\n      hfile.loadJSON(file).then(loadNewGraph);\n    });\n  // location parameter enables direct access to graph JSON via HTTP\n  if (win.URLQuery().hasOwnProperty('location')) {\n    return hfile.fetchJSON(win.URLQuery().location)\n      .then(data => {\n        return common.interactiveInsert(data.nodes)\n          .then(id => {\n            data.edges.reference.nodes = id;\n            return common.interactiveInsert(data.edges);\n          })\n          .then(id => {\n            window.location = `graph.html?id=${id}`;\n          });\n      });\n\n  }\n  return common.loader()\n    .then(() => {\n      if (win.URLQuery().hasOwnProperty('id')) {\n        header.initializeWithData();\n        return common.fetchResults('update').then(render);\n      } else {\n        header.initialize();\n        return Promise.resolve();\n      }\n    });\n}\n\nexport default {\n  force, control, component, interaction, community, run\n};\n","\n/** @module helper/d3Form */\n\nimport d3 from 'd3';\n\n\nfunction value(selector) {\n  return d3.select(selector).node().value;\n}\n\n\nfunction valueInt(selector) {\n  return parseInt(d3.select(selector).node().value);\n}\n\n\nfunction valueFloat(selector) {\n  return parseFloat(d3.select(selector).node().value);\n}\n\n\nfunction checked(selector) {\n  return d3.select(selector).node().checked;\n}\n\n\nfunction firstFile(selector) {\n  return d3.select(selector).node().files[0];\n}\n\n\nfunction inputValues(selector) {\n  return d3.selectAll(selector).selectAll('input').nodes().map(e => e.value);\n}\n\n\nfunction checkboxValues(selector) {\n  return d3.selectAll(selector).selectAll('input:checked').nodes().map(e => e.value);\n}\n\n\nfunction optionValues(selector) {\n  return d3.selectAll(selector).selectAll('select').nodes().map(e => e.value);\n}\n\n\nfunction textareaLines(selector) {\n  return d3.select(selector).node().value.split('\\n').filter(e => e.length > 0);\n}\n\n\nfunction optionData(selector) {\n  const si = d3.select(selector).property('selectedIndex');\n  return d3.select(selector).selectAll('option').data().find((d, i) => i === si);\n}\n\n\nfunction checkboxData(selector) {\n  return d3.selectAll(selector).selectAll('input:checked').data();\n}\n\n\nexport default {\n  value, valueInt, valueFloat, checked,\n  firstFile, inputValues, checkboxValues, optionValues, textareaLines,\n  optionData, checkboxData\n};\n","\n/** @module helper/d3Scale */\n\nimport d3 from 'd3';\n\nconst categoryMany = d3.schemeSet1\n  .concat(d3.schemeSet3, d3.schemePastel2, d3.schemeSet2);\nconst defaultSizeRange = [20, 80];\n\nconst colorPresets = [\n  {\n    name: 'Activity',\n    scale: {\n      scale: 'log',\n      domain: [1e-4, 1e-6],\n      range: ['#708090', '#7fffd4'],\n      unknown: '#696969'\n    }\n  },\n  {\n    name: 'Percent',\n    scale: {\n      scale: 'linear',\n      domain: [0, 100],\n      range: ['#708090', '#7fffd4'],\n      unknown: '#696969'\n    }\n  },\n  {\n    name: 'True or False',\n    scale: {\n      scale: 'quantize',\n      domain: [1, 0],\n      range: ['#708090', '#7fffd4'],\n      unknown: '#696969'\n    }\n  },\n  {\n    name: 'LogP',\n    scale: {\n      scale: 'linear',\n      domain: [-2, 8],\n      range: ['#6495ed', '#ccff66', '#ffa500'],\n      unknown: '#696969'\n    }\n  },\n  {\n    name: 'Categories',\n    scale: {\n      scale: 'ordinal',\n      range: d3.schemeCategory20,\n      unknown: '#dedede'\n    }\n  },\n  {\n    name: 'ManyCategories',\n    scale: {\n      scale: 'ordinal',\n      range: categoryMany,\n      unknown: '#dedede'\n    }\n  }\n];\n\nconst sizePresets = [\n  {\n    name: 'Activity',\n    scale: {\n      scale: 'log',\n      domain: [1e-4, 1e-6],\n      range: defaultSizeRange,\n      unknown: defaultSizeRange[0]\n    }\n  },\n  {\n    name: 'Percent',\n    scale: {\n      scale: 'linear',\n      domain: [0, 100],\n      range: defaultSizeRange,\n      unknown: defaultSizeRange[0]\n    }\n  },\n  {\n    name: 'True or False',\n    scale: {\n      scale: 'quantize',\n      domain: [1, 0],\n      range: defaultSizeRange,\n      unknown: defaultSizeRange[0]\n    }\n  },\n  {\n    name: 'LogP',\n    scale: {\n      scale: 'linear',\n      domain: [-2, 6],\n      range: defaultSizeRange,\n      unknown: defaultSizeRange[0]\n    }\n  }\n];\n\nconst edgeWidthPresets = [\n  {\n    name: 'Universal',\n    scale: {\n      scale: 'linear',\n      domain: [0.3, 1],\n      range: [0.5, 5],\n      unknown: 1\n    }\n  },\n  {\n    name: 'Thin',\n    scale: {\n      scale: 'linear',\n      domain: [0.5, 1],\n      range: [0.5, 3],\n      unknown: 1\n    }\n  },\n  {\n    name: 'Amplified',\n    scale: {\n      scale: 'linear',\n      domain: [0.5, 1],\n      range: [1, 10],\n      unknown: 1\n    }\n  }\n];\n\nconst colorPalette = [\n  {name: 'Aquamarine', range: ['#778899', '#7fffd4'], unknown: '#696969'},\n  {name: 'Chartreuse', range: ['#778899', '#7fff00'], unknown: '#696969'},\n  {name: 'Salmon', range: ['#778899', '#fa8072'], unknown: '#696969'},\n  {name: 'Violet', range: ['#778899', '#ee82ee'], unknown: '#696969'},\n  {name: 'blue-red', range: ['#87ceeb', '#fff5ee', '#fa8072'], unknown: '#696969'},\n  {name: 'Spectrum', range: ['#6495ed', '#ccff66', '#ffa500'], unknown: '#696969'}\n];\n\nconst scaleTypes = [\n  {name: 'linear', func: d3.scaleLinear()},\n  {name: 'log', func: d3.scaleLog()},\n  {name: 'quantize', func: d3.scaleQuantize()},\n  {name: 'ordinal', func: d3.scaleOrdinal()}\n];\n\nconst sizeScaleTypes = [\n  {name: 'linear', func: d3.scaleLinear()},\n  {name: 'log', func: d3.scaleLog()},\n  {name: 'quantize', func: d3.scaleQuantize()}\n];\n\nfunction scaleFunction(scale) {\n  let sf = scaleTypes.find(e => e.name === scale.scale).func;\n  let domain = scale.domain;\n  if (scale.range.length === 3) {\n    const mid = (parseFloat(scale.domain[0]) + parseFloat(scale.domain[1])) / 2;\n    domain = [scale.domain[0], mid, scale.domain[1]];\n  }\n  if (scale.scale !== 'ordinal') {\n    sf = sf.domain(domain);\n  }\n  sf = sf.range(scale.range);\n  if (['linear', 'log'].includes(scale.scale)) {\n    sf = sf.clamp(true);\n  }\n  return d => {\n    if (d === '' || typeof d === 'undefined' || d === null) {\n      return scale.unknown;\n    }\n    if (scale.scale !== 'ordinal' && parseFloat(d) != d) {\n      return scale.unknown;\n    }\n    if (scale.scale === 'log' && d <= 0) {\n      return scale.unknown;\n    }\n    const result = sf(d);\n    if (result === undefined) {\n      return scale.unknown;\n    }\n    return result;\n  };\n}\n\n\nexport default {\n  colorPresets, sizePresets, edgeWidthPresets,\n  colorPalette, scaleTypes, sizeScaleTypes,\n  scaleFunction\n};\n","\n/** @module helper/definition */\n\n\nfunction defaultFieldProperties(fields) {\n  return fields.map(e => {\n    if (!e.hasOwnProperty('name')) e.name = e.key;\n    if (!e.hasOwnProperty('visible')) e.visible = true;\n    if (e.hasOwnProperty('d3_format')) e.format = 'd3_format';\n    if (!e.hasOwnProperty('format')) e.format = 'raw';\n    return e;\n  });\n}\n\n\nfunction sortType(fmt) {\n  if (['numeric', 'd3_format'].includes(fmt)) return 'numeric';\n  if (['text', 'compound_id'].includes(fmt)) return 'text';\n  return 'none';\n}\n\n\nfunction ongoing(data) {\n  return ['running', 'ready'].includes(data.status);\n}\n\n\nexport default {\n  defaultFieldProperties, sortType, ongoing\n};\n","\n\nclass KArray extends Array {\n  /**\n   * Return array of object filtered by given unique key\n   */\n  unique(key) {\n    return this.reduce((a, b) => {\n      if (a.find(e => e[key] === b[key]) === undefined) a.push(b);\n      return a;\n    }, new KArray());\n  }\n\n\n  /**\n   * Merge arrays\n   */\n  extend() {\n    return this.reduce((a, b) => {\n      Array.prototype.push.apply(a, b);\n      return a;\n    }, new KArray());\n  }\n\n\n  // Merge arrays(Asynchronous)\n  extendAsync() {\n    return Promise.all(this).then(res => {\n      return res.reduce((a, b) => {\n        Array.prototype.push.apply(a, b);\n        return a;\n      }, new KArray());\n    });\n  }\n\n  toArray() {\n    return new Array(this);\n  }\n\n  toObject() {\n    const obj = {};\n    this.forEach(kv => {\n      obj[kv[0]] = kv[1];\n    });\n    return obj;\n  }\n}\n\nexport default KArray;\n","\nimport KArray from './KArray.js';\n\n\nfunction URLQuery() {\n  return KArray.from(window.location.search.substring(1).split(\"&\"))\n    .map(e => e.split('=')).toObject();\n}\n\n\nexport default {\n  URLQuery\n};\n","\n/** @module helper/parser */\n\nfunction getSDFPropList(str) {\n  const re = />.*?<(\\S+)>/g;\n  const uniqCols = new Set();\n  let arr;\n  while ((arr = re.exec(str)) !== null) {\n    uniqCols.add(arr[1]);\n  }\n  return Array.from(uniqCols);\n}\n\n// Ref. https://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript\nfunction uuidv4() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n    var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\n    return v.toString(16);\n  });\n}\n\n// TODO: not used\nfunction queryFormData(query) {\n  const formData = new FormData();\n  Object.entries(query).forEach(kv => {\n    if (Array.isArray(kv[1])) {\n      kv[1].forEach(e => formData.append(kv[0], e));\n    } else {\n      formData.set(kv[0], kv[1]);\n    }\n  });\n  return formData;\n}\n\n\n// TODO: not used\nfunction queryURL(query) {\n  const queryStr = [];\n  Object.entries(query).forEach(e => {\n    const val = Array.isArray(e[1]) ? JSON.stringify(e[1]) : e[1];\n    const key = e[0];\n    // const encoded = encodeURIComponent(val);\n    queryStr.push(`${key}=${val}`);\n  });\n  return queryStr.join('&');\n}\n\n\n// TODO: not used\nfunction capitalized(str) {\n  return str.replace(/(?:^|\\s)\\S/g, e => e.toUpperCase());\n}\n\n\nexport default {\n  getSDFPropList, uuidv4\n};\n","\nimport Dexie from 'Dexie';\n\n// TODO: can indexed records improve query performance ?\n\nconst schema = {\n  app: 'key',\n  items: 'id, dataType, created',\n  resources: 'id'\n};\n\nlet idb = new Dexie('Store');\nidb.version(1).stores(schema);\n\n\nfunction getAppSetting(key) {\n  return idb.app.where('key').equals(key).first()\n    .then(res => {\n      if (res === undefined) return undefined;\n      return res.value;\n    });\n}\n\n\nfunction putAppSetting(k, v) {  // returns id in success\n  return idb.app.put({ key: k, value: v });\n}\n\n\nfunction getResources() {\n  return idb.resources.toArray();\n}\n\n\nfunction putResources(data) { // returns last id in success\n  return idb.resources.bulkPut(data);\n}\n\n\nfunction getAllItems() {\n  return idb.items.orderBy('created').reverse()\n    .toArray();\n}\n\n\nfunction getItemsByDataType(type) {\n  return idb.items.where('dataType').equals(type).reverse()\n    .sortBy('created');\n}\n\n\nfunction getItemById(tableId) {\n  return idb.items.where('id').equals(tableId).first();\n}\n\n\nfunction updateItem(tableId, callback) {  // returns num of updated items\n  return idb.items.where('id').equals(tableId).modify(callback);\n}\n\n\nfunction deleteItem(tableId) { // returns num of deleted items\n  return idb.items.where('id').equals(tableId).delete();\n}\n\n\nfunction putItem(data) { // returns id in success\n  return idb.items.put(data);\n}\n\n\nfunction reset() {\n  // Try this before tackling with local db troubles\n  return idb.delete().then(() => {\n    idb = new Dexie('Store');\n    idb.version(1).stores(schema);\n  });\n}\n\nexport default {\n  getAppSetting, putAppSetting, getResources, putResources,\n  getAllItems, getItemsByDataType, getItemById,\n  updateItem, deleteItem, putItem, reset\n};\n","\n/** @module helper/image */\n\nimport vega from 'vega';\n\nfunction showPlot(vegaSpec, selector) {\n  new vega.View(vega.parse(vegaSpec))\n    .initialize(selector)\n    .run();\n}\n\n\nfunction plotThumbnail(vegaSpec) {\n  const view = new vega.View(vega.parse(vegaSpec));\n  return view.toImageURL('png');  // Promise\n}\n\n\nexport default {\n  showPlot, plotThumbnail\n};\n","\nconst baseURL = '';\n\nfunction get(url, query={}) {\n  const isEmpty = Object.keys(query).length;\n  const q = isEmpty ? `?query=${JSON.stringify(query)}` : '';\n  return fetch(\n    `${baseURL}${url}${q}`,\n    {\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\nfunction json(response) {\n  return response.json();\n}\n\nfunction text(response) {\n  return response.text();\n}\n\nfunction blob(response) {\n  return response.blob();\n}\n\nfunction post(url, formdata) {\n  return fetch(\n    `${baseURL}${url}`,\n    {\n      method: 'POST',\n      body: formdata,\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\n\nfunction error(err) {\n  console.error(err);\n  return null;\n}\n\n\nexport default {\n  get, json, text, blob, post, error\n};\n","\n/** @module component/Dialog */\n\nimport d3 from 'd3';\n\nimport KArray from '../helper/KArray.js';\nimport {default as d3form} from '../helper/d3Form.js';\nimport {default as mapper} from '../helper/mapper.js';\nimport {default as def} from '../helper/definition.js';\nimport {default as fmt} from '../helper/formatValue.js';\nimport {default as win} from '../helper/window.js';\nimport {default as hfile} from '../helper/file.js';\nimport {default as misc} from '../helper/misc.js';\nimport {default as himg} from '../helper/image.js';\nimport {default as store} from '../store/StoreConnection.js';\nimport {default as cmp} from './Component.js';\nimport {default as fetcher} from '../fetcher.js';\n\n\nfunction pickDialog(resources, callback) {\n  store.getAppSetting('compoundIDPlaceholder').then(ids => {\n    d3.select('#pick-queryarea').text(ids);\n  });\n  d3.select('#pick-submit')\n    .on('click', () => {\n      d3.select('#loading-icon').style('display', 'inline');\n      const query = {\n        type: 'chemsearch',\n        targets: resources.filter(e => e.domain === 'chemical').map(e => e.id),\n        key: 'compound_id',\n        values: d3form.textareaLines('#pick-queryarea')\n      };\n      return fetcher.get('run', query)\n        .then(fetcher.json)\n        .then(callback, fetcher.error);\n    });\n}\n\n\nfunction propDialog(resources, callback) {\n  d3.select('#prop-targets')\n    .call(cmp.checkboxList, resources, 'targets', d => d.id, d => d.name)\n    .on('change', function () {\n      const cols = KArray.from(d3form.checkboxData('#prop-targets'))\n        .map(d => d.fields)\n        .extend().unique('key');\n      d3.select('#prop-key')\n        .call(cmp.selectOptions, cols, d => d.key, d => d.name);\n    });\n  d3.select('#prop-submit')\n    .on('click', () => {\n      d3.select('#loading-circle').style('display', 'inline');\n      const query = {\n        type: 'chemprop',\n        targets: d3form.checkboxValues('#prop-targets'),\n        key: d3form.optionData('#prop-key').key,\n        values: d3form.textareaLines('#prop-queryarea'),\n        operator: d3form.value('#prop-operator')\n      };\n      return fetcher.get('async', query)\n        .then(fetcher.json)\n        .then(callback, fetcher.error);\n    });\n}\n\n\nfunction structDialog(resources, callback) {\n  d3.select('#struct-qsrc')\n    .call(cmp.selectOptions, resources, d => d.id, d => d.name);\n  d3.select('#struct-targets')\n    .call(cmp.checkboxList, resources, 'targets', d => d.id, d => d.name);\n  store.getAppSetting('rdkit').then(rdk => {\n    d3.select('#struct-method').selectAll('option.rd')\n      .attr('disabled', rdk ? null : 'disabled');\n  });\n  d3.selectAll('#struct-method,#struct-thldtype')\n    .on('change', function () {\n      const method = d3form.value('#struct-method');\n      const thldtype = d3form.value('#struct-thldtype');\n      d3.select('#struct-thld')\n        .attr('disabled', ['gls', 'rdmorgan', 'rdfmcs'].includes(method) ? null : 'disabled')\n        .attr('value', thldtype === 'edge' ? 15 : 0.7)\n        .attr('min', thldtype === 'edge' ? 5 : 0)\n        .attr('max', thldtype === 'edge' ? 999 : 1.0)\n        .attr('step', thldtype === 'edge' ? 1 : 0.01);\n      d3.select('#struct-thldtype')\n        .attr('disabled', ['gls', 'rdmorgan', 'rdfmcs'].includes(method) ? null : 'disabled')\n        .property('value', ['gls', 'rdfmcs'].includes(method) ? undefined : 'sim');\n      d3.select('#struct-thldtype option.sim')\n        .attr('disabled', ['gls', 'rdmorgan', 'rdfmcs'].includes(method) ? null : 'disabled');\n      d3.select('#struct-thldtype option.edge')\n        .attr('disabled', ['gls', 'rdfmcs'].includes(method) ? null : 'disabled');\n      d3.select('#struct-options').selectAll('.gls')\n        .attr('disabled', method === 'gls' ? null : 'disabled');\n      d3.select('#struct-options .fmcs')\n        .attr('disabled', method === 'rdfmcs' ? null : 'disabled');\n    })\n    .dispatch('change');\n  d3.select('#struct-format')\n    .on('change', function () {\n      d3.select('#struct-qsrc')\n        .attr('disabled', this.value === 'dbid' ? null : 'disabled');\n    });\n  d3.select('#struct-preview')\n    .on('click', () => {\n      const f = d3form.value('#struct-format');\n      const query = {\n        format: f,\n        source: f === 'dbid' ? d3form.value('#struct-qsrc') : null,\n        value: f === 'molfile'\n          ? d3form.value('#struct-queryarea') : d3form.textareaLines('#struct-queryarea')[0],\n      };\n      return fetcher.get('strprev', query)\n        .then(fetcher.text)\n        .then(res => d3.select('#struct-image').html(res), fetcher.error);\n    });\n  d3.select('#struct-submit')\n    .on('click', () => {\n      const method = d3form.value('#struct-method');\n      d3.select('#loading-circle').style('display', 'inline');\n      const f = d3form.value('#struct-format');\n      const query = {\n        type: d3form.value('#struct-method'),\n        targets: d3form.checkboxValues('#struct-targets'),\n        queryMol: {\n          format: f,\n          source: f === 'dbid' ? d3form.value('#struct-qsrc') : null,\n          value: f === 'molfile'\n            ? d3form.value('#struct-queryarea') : d3form.textareaLines('#struct-queryarea')[0]\n        },\n        params: {\n          measure: d3form.value('#struct-thldtype'),\n          threshold: d3form.valueFloat('#struct-thld'),\n          ignoreHs: d3form.checked('#struct-ignoreh'),\n          diameter: method === 'gls' ? d3form.valueInt('#struct-diam') : null,\n          maxTreeSize: method === 'gls' ? d3form.valueInt('#struct-tree') : null,\n          molSizeCutoff: method === 'gls' ? d3form.valueInt('#struct-skip') : null,\n          timeout: method === 'rdfmcs' ? d3form.valueInt('#struct-timeout') : null\n        }\n      };\n      const command = query.type === 'exact' ? 'run' : 'async';\n      return fetcher.get(command, query)\n        .then(fetcher.json)\n        .then(callback, fetcher.error);\n    });\n}\n\n\nfunction sdfDialog(callback) {\n  d3.select('#sdf-file')\n    .on('change', () => {\n      const reader = new FileReader();\n      const file = document.getElementById('sdf-file').files[0];\n      reader.onload = (e) => {\n        d3.select('#sdf-cols')\n          .call(cmp.checkboxList, misc.getSDFPropList(e.target.result),\n                'fields', d => d, d => d\n          );\n      };\n      // Scan only first 100mb of the file due to memory limit.\n      reader.readAsText(file.slice(0, 100 * 1024 * 1024));\n    });\n  d3.select('#sdf-selectall')\n    .on('change', () => {\n      d3.select('#sdf-cols').selectAll('input')\n        .property('checked', d3form.checked('#sdf-selectall'));\n    });\n  d3.select('#sdf-submit')\n    .on('click', () => {\n      d3.select('#loading-circle').style('display', 'inline');\n      const params = {\n        fields: d3form.checkboxValues('#sdf-cols'),\n        implh: d3form.checked('#sdf-implh'),\n        recalc: d3form.checked('#sdf-recalc')\n      };\n      const formData = new FormData();\n      formData.append('contents', d3form.firstFile('#sdf-file'));\n      formData.append('params', JSON.stringify(params));\n      return fetcher.post('sdfin', formData)\n        .then(fetcher.json)\n        .then(callback, fetcher.error);\n    });\n}\n\n\nfunction columnDialog(dataFields, callback) {\n  const table = {\n    fields: def.defaultFieldProperties([\n      {key: 'name', format: 'text'},\n      {key: 'visible', format: 'control'},\n      {key: 'format', format: 'control'},\n      {key: 'd3_format', format: 'control'}\n    ])\n  };\n  const records = dataFields.map(e => {\n    const rcd = {};\n    const generalFormat = ['text', 'numeric', 'd3_format', 'raw', 'compound_id'];\n    rcd.name = e.name;\n    rcd.visible = selection => selection\n        .classed('column-vis', true)\n        .classed(`row-${e.key}`, true)\n      .append('input')\n        .attr('type', 'checkbox')\n        .attr('value', e.key)\n        .property('checked', e.visible);\n    rcd.format = selection => selection\n        .classed('column-format', true)\n        .classed(`row-${e.key}`, true)\n      .append('select')\n        .call(cmp.selectOptions,\n              generalFormat.includes(e.format) ? generalFormat : [e.format],\n              d => d, d => d)\n        .attr('disabled', generalFormat.includes(e.format) ? null : 'disabled')\n        .property('value', e.format)\n        .on('change', function () {\n          d3.select(`.column-d3f.row-${e.key} input`)\n            .attr('disabled', this.value === 'd3_format' ? null : 'disabled');\n        });\n    rcd.d3_format = selection => selection\n        .classed('column-d3f', true)\n        .classed(`row-${e.key}`, true)\n      .append('input')\n        .attr('size', 10)\n        .attr('disabled', e.format === 'd3_format' ? null : 'disabled')\n        .property('value', e.d3_format);\n    return rcd;\n  });\n  d3.select('#column-table')\n    .call(cmp.createTable, table)\n    .call(cmp.updateTableRecords, records, d => d.key);\n  d3.select('#column-submit')\n    .on('click', () => {\n      const query = {\n        visibles: d3form.checkboxValues('.column-vis'),\n        formats: d3form.optionValues('.column-format'),\n        d3_formats: d3form.inputValues('.column-d3f')\n      };\n      return store.setFieldProperties(win.URLQuery().id, query)\n        .then(callback);\n    });\n}\n\n\n// TODO:\nfunction fieldFetchDialog(compoundIDs, dataFields, resources, callback) {\n  // Prevent implicit submission\n  document.getElementById('join-search')\n    .addEventListener('keypress', event => {\n      if (event.keyCode === 13) event.preventDefault();\n    });\n  const dataKeys = dataFields.map(e => e.key);\n  const resourceFields = KArray.from(resources.map(e => e.fields))\n    .extend().unique('key').filter(e => e.key !== 'id');\n  d3.select('#join-keys')\n    .call(cmp.checkboxList, resourceFields, 'keys', d => d.key, d => d.name)\n    .selectAll('li')\n    .each(function(d) { // disable already shown columns\n      d3.select(this).selectAll('label').select('input')\n        .property('checked', dataKeys.includes(d.key))\n        .attr('disabled', dataKeys.includes(d.key) ? 'disabled' : null);\n    });\n  d3.select('#join-search')\n    .on('keyup', function () {\n      const match = d => fmt.partialMatch(d3form.value(this), d.name);\n      d3.select('#join-keys').selectAll('li')\n        .style('visibility', d => match(d) ? null : 'hidden')\n        .style('position', d => match(d) ? null : 'absolute');\n    });\n  d3.select('#join-submit')\n    .on('click', () => {\n      d3.select('#loading-circle').style('display', 'inline');\n      const selected = d3form.checkboxValues('#join-keys');\n      const queryFieldKeys = resourceFields.map(e => e.key)\n        .filter(e => !dataKeys.includes(e))\n        .filter(e => selected.includes(e));\n      const query = {\n        type: 'fieldfilter',\n        targetFields: queryFieldKeys,\n        key: 'compound_id',\n        values: compoundIDs\n      };\n      return fetcher.get('run', query)\n        .then(fetcher.json)\n        .then(json => callback(mapper.tableToMapping(json, 'id')),\n              fetcher.error);\n  });\n}\n\n\nfunction fieldFileDialog(callback) {\n  // TODO: need to refactor\n  d3.select('#importcol-file')\n    .on('change', () => {\n      const file = document.getElementById('importcol-file').files[0];\n      const isCsv = file.name.split('.').pop() === 'csv';\n      hfile.readFile(file).then(res => {\n        const mapping = isCsv ? mapper.csvToMapping(res) : JSON.parse(res);\n        const tbl = mapper.mappingToTable(mapping);\n        d3.select('#importcol-preview').call(cmp.createTable, tbl)\n          .call(cmp.updateTableRecords,\n                tbl.records.slice(0, 5), d => d[tbl.fields[0].key]);\n        // bind mapping\n        d3.select('#importcol-preview').datum(mapping);\n      });\n    });\n  d3.select('#importcol-submit')\n    .on('click', () => {\n      let mapping = d3.select('#importcol-preview').datum();\n      d3.select('#importcol-preview').datum(null);  // unbind mapping\n      // Generate thumbnails\n      const plotCols = [];\n      if (mapping.hasOwnProperty('field')) {\n        mapping = mapper.singleToMulti(mapping);\n      }\n      mapping.fields.forEach((e, i) => {\n        if (e.format === 'plot') {\n          mapping.fields[i].format = 'image';\n          plotCols.push(i);\n        }\n      });\n      if (plotCols.length > 0) {\n        const ps = [];\n        Object.entries(mapping.mapping).forEach(m => {\n          plotCols.forEach(e => {\n            const p = himg.plotThumbnail(m[1][e])\n              .then(img => {\n                mapping.mapping[m[0]][e] = img;\n              });\n            ps.push(p);\n          });\n        });\n        Promise.all(ps).then(() => callback(mapping));\n      } else {\n        callback(mapping);\n      }\n    });\n}\n\n\nfunction graphDialog(callback) {\n  store.getAppSetting('rdkit').then(rdk => {\n    d3.select('#graph-measure').selectAll('option.rd')\n      .attr('disabled', rdk ? null : 'disabled');\n  });\n  d3.select('#graph-measure')\n    .on('change', function () {\n      d3.select('#graph-options').selectAll('.gls')\n        .attr('disabled', this.value === 'gls' ? null : 'disabled');\n      d3.select('#graph-options').selectAll('.fmcs')\n        .attr('disabled', this.value === 'rdfmcs' ? null : 'disabled');\n    });\n  d3.select('#graph-submit')\n    .on('click', () => {\n      d3.select('#loading-circle').style('display', 'inline');\n      const measure = d3form.value('#graph-measure');\n      const params = {\n        measure: measure,\n        threshold: d3form.valueFloat('#graph-thld'),\n        ignoreHs: d3form.checked('#graph-ignoreh'),\n        diameter: measure === 'gls' ? d3form.valueInt('#graph-diam') : null,\n        maxTreeSize: measure === 'gls' ? d3form.valueInt('#graph-tree') : null,\n        molSizeCutoff: measure === 'gls' ? d3form.valueInt('#graph-skip') : null,\n        timeout: measure === 'rdfmcs' ? d3form.valueInt('#graph-timeout') : null\n      };\n      callback(params);\n    });\n}\n\n\nfunction graphConfigDialog(currentThld, minThld, callback) {\n  d3.select('#graphconfig-thld')\n    .attr('value', currentThld)\n    .attr('max', 1.0)\n    .attr('min', minThld);\n  d3.select('#graphconfig-submit')\n    .on('click', () => {\n      const newThld = d3form.valueFloat('#graphconfig-thld');\n      if (newThld < minThld) return;  // TODO: fool proof\n      callback(newThld);\n    });\n}\n\n\nfunction communityDialog(callback) {\n  d3.select('#community-name').attr('value', 'comm_');\n  d3.select('#community-submit')\n    .on('click', () => {\n      const query = {\n        name: d3form.value('#community-name'),\n        nulliso: d3form.checked('#community-nulliso')\n      };\n      callback(query);\n    });\n}\n\n\nfunction importConfirmDialog(callback) {\n  d3.select('#importconfirm-overwrite')\n    .on('click', () => callback('overwrite'));\n  d3.select('#importconfirm-keepboth')\n    .on('click', () => callback('keepboth'));\n  d3.select('#importconfirm-cancel')\n    .on('click', () => callback('cancel'));\n}\n\n\nexport default {\n  pickDialog, propDialog, structDialog, sdfDialog,\n  columnDialog, fieldFetchDialog, fieldFileDialog, graphDialog,\n  graphConfigDialog, communityDialog, importConfirmDialog\n};\n","\n/** @module component/Header */\n\nimport d3 from 'd3';\nimport {default as def} from '../helper/definition.js';\n\n\nfunction renderStatus(data, refresh_callback, abort_callback) {\n  d3.select('#loading-circle').style('display', 'none');\n  d3.select('title').text(data.name);\n  d3.select('#title').text(data.name);\n  d3.select('#refresh')\n    .style('display', def.ongoing(data) ? 'inline-block' : 'none');\n  d3.select('#abort')\n    .style('display', def.ongoing(data) ? 'inline-block' : 'none');\n  const doneText = {\n    'nodes': 'entries found',\n    'edges': 'connections created'\n  };\n  const dtx = doneText[data.dataType];\n  d3.select('#progress')\n    .text(`(${data.status} - ${data.records.length} ${dtx} in ${data.execTime} sec.)`);\n  if (def.ongoing(data)) {\n    d3.select('#progress').append('div').append('progress')\n      .attr('max', 100)\n      .attr('value', data.progress)\n      .text(`${data.progress}%`);\n  }\n  d3.select('#refresh').on('click', refresh_callback);\n  d3.select('#abort')\n    .on('click', () => {\n      d3.select('#confirm-message')\n        .text('Are you sure you want to abort this calculation job?');\n      d3.select('#confirm-submit')\n        .classed('btn-primary', false)\n        .classed('btn-warning', true)\n        .on('click', abort_callback);\n    });\n  console.info('Query');\n  console.info(data.query);  // query datails are available on browser console.\n}\n\n\nfunction initializeWithData() {\n  d3.select('#new-data').style('display', 'none');\n  d3.select('#loading-circle').style('display', 'none');\n}\n\n\nfunction initialize() {\n  d3.select('#data-control').style('display', 'none');\n  d3.select('#nodedata').style('display', 'none');\n  d3.select('#refresh').style('display', 'none');\n  d3.select('#abort').style('display', 'none');\n  d3.select('#loading-circle').style('display', 'none');\n  d3.select('#status').selectAll('li').style('display', 'none');\n}\n\n\nexport default {\n  renderStatus, initializeWithData, initialize\n};\n","\n/** @module graph/GraphForce */\n\nimport d3 from 'd3';\n\nconst fieldWidth = 1200;\nconst fieldHeight = 1200;\n\nconst simulation = d3.forceSimulation()\n  .force('link',\n    d3.forceLink().id(d => d.index)\n      .distance(60)\n      .strength(1))\n  .force('charge',\n    d3.forceManyBody()\n      .strength(-600)\n      .distanceMin(15)\n      .distanceMax(720))\n  .force('collide',\n    d3.forceCollide()\n      .radius(90))\n  .force('center',\n    d3.forceCenter(fieldWidth / 2, fieldHeight / 2))\n  .force('x',\n    d3.forceX()\n      .strength(0.002))\n  .force('y',\n    d3.forceY()\n      .strength(0.002))\n  .stop();\n\n\nfunction setForce(nodes, edges, tick, end) {\n  simulation.nodes(nodes)\n    .force('link').links(edges);\n  simulation.on('tick', tick)\n    .on('end', end);\n}\n\n\nfunction tick() {\n  d3.select('#graph-contents').selectAll('.node')\n    .attr('transform', d => `translate(${d.x}, ${d.y})`);\n  const alpha = simulation.alpha();\n  const isStopped = alpha <= simulation.alphaMin();\n  d3.select('#temperature')\n    .classed('progress-success', isStopped)\n    .classed('progress-warning', !isStopped)\n    .attr('value', isStopped ? 1 : 1 - alpha)\n    .text(isStopped ? 1 : 1 - alpha);\n}\n\n\nfunction end() {\n  d3.select('#graph-contents').selectAll('.link')\n    .attr('transform', d => `translate(${d.source.x}, ${d.source.y})`)\n    .attr('visibility', 'visible');\n  d3.select('#graph-contents').selectAll('.edge-line')\n    .attr('x1', 0)\n    .attr('y1', 0)\n    .attr('x2', d => d.target.x - d.source.x)\n    .attr('y2', d => d.target.y - d.source.y);\n  d3.select('#graph-contents').selectAll('.edge-label')\n    .attr('x', d => (d.target.x - d.source.x) / 2)\n    .attr('y', d => (d.target.y - d.source.y) / 2);\n}\n\n\nexport default {\n  fieldWidth, fieldHeight, simulation, setForce, tick, end\n};\n","\nconst defaultNodeColor = {\n  id: 'color',\n  field: null,\n  scale: {\n    domain: [0, 1],\n    range: ['#7fffd4', '#7fffd4'],\n    scale: 'linear',\n    unknown: '#7fffd4'\n  }\n};\n\nconst defaultNodeSize = {\n  id: 'size',\n  field: null,\n  scale: {\n    domain: [0, 1],\n    range: [40, 40],\n    scale: 'linear',\n    unknown: 40\n  }\n};\n\nconst defaultNodeLabel = {\n  id: 'label',\n  text: null,\n  size: 12,\n  visible: false,\n  field: null,\n  scale: {\n    domain: [0, 1],\n    range: ['#000000', '#000000'],\n    scale: 'linear',\n    unknown: '#000000'\n  }\n};\n\nconst defaultNodeContent = {\n  structure: {visible: false}\n};\n\nconst defaultEdge = {\n  id: 'edge',\n  visible: true,\n  label: {\n    size: 10,\n    visible: false\n  },\n  scale: {\n    domain: [0, 1],\n    range: [5, 5],\n    scale: 'linear',\n    unknown: 5\n  }\n};\n\n\nexport default {\n  defaultNodeColor, defaultNodeSize, defaultNodeLabel, defaultNodeContent,\n  defaultEdge\n};\n","\nfunction graphNodes(selection, data) {\n  const nodes = selection.selectAll('.node')\n    .data(data, d => d.key);\n  nodes.exit().remove();\n  const entered = nodes.enter().append('g')\n    .attr('class', 'node');\n  entered.append('circle')\n    .attr('class', 'node-symbol');\n  entered.append('g')\n    .attr('class', 'node-struct');\n  entered.append('text')\n    .attr('class', 'node-label');\n  const updated = entered.merge(nodes);\n  updated.select('.node-struct')\n    .html(d => d.structure);\n  updated.select('.node-label')\n    .attr('x', 0)\n    .attr('text-anchor', 'middle');\n}\n\n\nfunction graphEdges(selection, data) {\n  const edges = selection.selectAll('.link')\n    .data(data, d => `${d.source}_${d.target}`);\n  edges.exit().remove();\n  const entered = edges.enter().append('g')\n    .attr('class', 'link');\n  entered.append('line')\n    .attr('class', 'edge-line');\n  entered.append('text')\n    .attr('class', 'edge-label');\n  const updated = entered.merge(edges);\n  updated.select('.edge-line')\n    .style('stroke', '#999')\n    .style('stroke-opacity', 0.6);\n  updated.select('.edge-label')\n    .attr('text-anchor', 'middle')\n    .text(d => d.weight);\n}\n\n\nexport default {\n  graphNodes, graphEdges\n};\n","\nimport jLouvain from 'jLouvain';\n\n\nexport function communityDetection(nodes, edges, option) {\n  // TODO: partition resolution setting\n  // TODO: Error at edges.length 0\n  const community = jLouvain().nodes(nodes).edges(edges)();\n  // assign null to singletons\n  if (option.nulliso) {\n    const clusters = {};\n    Object.entries(community).forEach(e => {\n      if (!clusters.hasOwnProperty(e[1])) {\n        clusters[e[1]] = [];\n      }\n      clusters[e[1]].push(e[0]);\n    });\n    Object.entries(clusters).forEach(e => {\n      if (e[1].length === 1) {\n        community[e[1][0]] = null;\n      }\n    });\n  }\n  return community;\n}\n\n\nexport default {\n  communityDetection\n};\n"],"names":["v07_to_v08_nodes","json","fields","columns","map","e","format","id","name","dataType","dataTypeConv","schemaVersion","revision","status","statusConv","records","query","taskCount","searchCount","doneCount","searchDoneCount","resultCount","recordCount","progress","execTime","created","startDate","responseDate","v07_to_v08_convert","hasOwnProperty","nodes","edges","nodeFields","snp","fieldTransform","snapshot","nodePositions","nodeColor","nodeSize","nodeLabel","edge","scale","field","find","key","column","domain","range","unknown","size","text","visible","nodeContent","structure","label","reference","nodeTableId","def","defaultFieldProperties","networkThreshold","v07_to_v08_edges","readFile","file","sizeLimit","blob","Promise","resolve","reject","reader","FileReader","truncated","slice","onload","event","target","result","onerror","error","readAsArrayBuffer","readAsText","parseJSON","data","compressed","pako","inflate","to","JSON","parse","nodesID","idx_converter","forEach","i","index","_structure","_index","source","downloadDataFile","url","window","URL","createObjectURL","Blob","a","document","createElement","download","href","dispatchEvent","MouseEvent","view","bubbles","cancelable","singleToMulti","mapping","newMapping","Object","entries","m","updateTableAttribute","value","store","updateItem","item","catch","err","console","numericAsc","b","fa","parseFloat","fb","isNaN","String","localeCompare","textAsc","updateTableRecords","selection","rcds","keyFunc","header","select","selectAll","rowSelection","exit","remove","rowEntered","enter","append","d","merge","classed","html","undefined","fmt","formatNum","d3_format","each","d3","call","registerServiceWorker","navigator","serviceWorker","register","then","reg","info","scope","colorControlInput","d3form","optionData","preset","checked","push","sizeControlInput","updateNodeColor","style","d3scale","scaleFunction","updateNodeSize","attr","updateNodeLabel","updateNodeStructure","nds","w","h","updateEdgeVisibility","updateEdgeLabelVisibility","updateEdge","weight","updateRange","length","property","updateScale","hasDomain","updateControl","colorControlBox","cmp","selectOptions","colorPresets","on","this","dispatch","colorPalette","scaleTypes","sizeControlBox","presets","sizeScaleTypes","unstickNodes","fx","fy","dragWithForce","takeSnapshot","x","y","zoomTransform","node","datum","saveSnapshot","win","URLQuery","getGraph","getTable","start","g","renderStatus","common","fetchResults","render","edgesToDraw","filter","logD","Math","log10","component","graphEdges","graphNodes","force","setForce","tick","end","control","tf","transform","zoomIdentity","translate","k","interaction","zoom","updateNodeImage","resume","stickNodes","dflt","defaultNodeColor","defaultNodeSize","defaultNodeLabel","defaultNodeContent","defaultEdge","restart","transition","duration","_mol","dialog","graphConfigDialog","threshold","thld","communityDialog","nodeIds","visibleEdges","comm","community","communityDetection","nulliso","joinFields","mainControlBox","nodeColorControlBox","nodeSizeControlBox","nodeLabelControlBox","edgeControlBox","relax","t","loadNewGraph","interactiveInsert","location","selector","valueInt","parseInt","valueFloat","firstFile","files","inputValues","checkboxValues","optionValues","textareaLines","split","si","checkboxData","categoryMany","schemeSet1","concat","schemeSet3","schemePastel2","schemeSet2","defaultSizeRange","schemeCategory20","sizePresets","func","scaleLinear","scaleLog","scaleQuantize","scaleOrdinal","edgeWidthPresets","sf","mid","includes","clamp","sortType","ongoing","Queued","In progress","Aborting","Aborted","Completed","Failure","datatable","connection","loadJSON","endsWith","fetchJSON","decoded","decodeURIComponent","fetch","res","arrayBuffer","downloadJSON","compress","str","stringify","gzip","c","KArray","Array","[object Object]","reduce","prototype","apply","all","obj","kv","from","search","substring","toObject","getSDFPropList","re","uniqCols","Set","arr","exec","add","uuidv4","replace","r","random","toString","mappingToTable","mp","keyField","entry","rcd","f","tableToMapping","table","ignore","Date","row","csvToMapping","csvString","lines","shift","now","headerIdx","line","values","fd","unique","schema","app","items","resources","idb","Dexie","version","stores","where","equals","first","putAppSetting","v","put","toArray","putResources","bulkPut","getAllItems","orderBy","reverse","getItemsByDataType","type","sortBy","getItemById","tableId","callback","modify","deleteItem","delete","putItem","getAppSetting","setAppSetting","getResources","setResources","rsrcs","getAllTables","getTablesByDataType","setFieldProperties","updates","visibles","formats","d3_formats","mapper","insertTable","updateTable","assign","deleteTable","reset","d3format","Number","partialMatch","toUpperCase","indexOf","numericDesc","textDesc","showPlot","vegaSpec","vega","View","initialize","run","plotThumbnail","toImageURL","options","checkboxList","entered","updated","checkboxListT","description","createTable","cols","appendTableRows","newRcds","addSort","isAsc","isNum","sort","formatNumbers","col","colIdx","digit","baseURL","get","q","keys","credentials","Error","statusText","response","post","formdata","method","body","pickDialog","ids","targets","fetcher","propDialog","extend","operator","structDialog","rdk","thldtype","queryMol","params","measure","ignoreHs","diameter","maxTreeSize","molSizeCutoff","timeout","command","sdfDialog","getElementById","misc","implh","recalc","formData","FormData","columnDialog","dataFields","generalFormat","fieldFetchDialog","compoundIDs","addEventListener","keyCode","preventDefault","dataKeys","resourceFields","match","selected","targetFields","fieldFileDialog","isCsv","pop","hfile","tbl","plotCols","ps","p","himg","img","graphDialog","currentThld","minThld","newThld","importConfirmDialog","found","$","modal","action","loader","server","local","serverStatus","clientInstance","debugMode","instance","templates","compoundIDPlaceholder","defaultDataType","rdkit","refresh_callback","abort_callback","dtx","initializeWithData","simulation","forceSimulation","forceLink","distance","strength","forceManyBody","distanceMin","distanceMax","forceCollide","radius","forceCenter","fieldWidth","fieldHeight","forceX","forceY","stop","links","alpha","isStopped","alphaMin","textCols","updateNodeLabelVisibility","labelControlInput","numCols","nodeSizeControlInput","edgeControlInput","drag","active","alphaTarget","dragNoForce","connected","__data__","fitToScreen","option","jLouvain","clusters","click"],"mappings":"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"}