{"version":3,"file":"kwgraph.js","sources":["../src/helper/file.js","../src/helper/mapper.js","../src/store/StoreConnection.js","../src/helper/formatValue.js","../src/component/Component.js","../src/graph/GraphControlBox.js","../src/graph/GraphInteraction.js","../src/graph.js","../src/helper/d3Form.js","../src/helper/d3Scale.js","../src/helper/definition.js","../src/helper/KArray.js","../src/helper/window.js","../src/helper/misc.js","../src/store/IDBStore.js","../src/helper/image.js","../src/fetcher.js","../src/component/Dialog.js","../src/common.js","../src/component/Header.js","../src/graph/GraphForce.js","../src/graph/defaultGraphControl.js","../src/graph/GraphComponent.js","../src/graph/communityDetection.js"],"sourcesContent":["\n/** @module helper/file */\n\nimport pako from 'pako';\n\nimport {default as def} from './definition.js';\n\nconst statusConv = {\n  Queued: 'ready',\n  'In progress': 'running',\n  Aborting: 'running',\n  Aborted: 'aborted',\n  Completed: 'done',\n  Failure: 'failure'\n};\n\nconst dataTypeConv = {\n  datatable: 'nodes',\n  connection: 'edges'\n};\n\nfunction v07_to_v08_nodes(json) {\n  const fields = json.columns.map(e => {\n    e.sortType = e.sort;\n    return e;\n  });\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    status: statusConv[json.status],\n    fields: fields,\n    records: json.records,\n    query: json.query,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n  };\n}\n\nfunction v07_to_v08_edges(json, nodeFields) {\n  const snp = {\n    fieldTransform: json.snapshot.fieldTransform,\n    nodePositions: json.snapshot.nodePositions,\n    nodeColor: {},\n    nodeSize: {},\n    nodeLabel: {},\n    edge: {}\n  };\n  if (json.snapshot.hasOwnProperty('nodeColor')) {\n    snp.nodeColor.id = json.snapshot.nodeColor.id;\n    snp.nodeColor.scale = json.snapshot.nodeColor.scale;\n    snp.nodeColor.field = nodeFields.find(e => e.key === json.snapshot.nodeColor.column);\n  } else {\n    snp.nodeColor = {\n      id: 'color', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeSize')) {\n    snp.nodeSize.id = json.snapshot.nodeSize.id;\n    snp.nodeSize.scale = json.snapshot.nodeSize.scale;\n    snp.nodeSize.field = nodeFields.find(e => e.key === json.snapshot.nodeSize.column);\n  } else {\n    snp.nodeSize = {\n      id: 'size', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: [20, 20], unknown: 20}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeLabel')) {\n    snp.nodeLabel.id = json.snapshot.nodeLabel.id;\n    snp.nodeLabel.size = json.snapshot.nodeLabel.size;\n    snp.nodeLabel.text = json.snapshot.nodeLabel.text;\n    snp.nodeLabel.visible = json.snapshot.nodeLabel.visible;\n    snp.nodeLabel.scale = json.snapshot.nodeLabel.scale;\n    snp.nodeLabel.field = nodeFields.find(e => e.key === json.snapshot.nodeLabel.column);\n  } else {\n    snp.nodeLabel = {\n      id: 'label', size: 12, text: '_index', visible: false, field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeContent')) {\n    snp.nodeContent = json.snapshot.nodeContent;\n  } else {\n    snp.nodeContent = {structure: {visible: false}};\n  }\n  if (json.snapshot.hasOwnProperty('edge')) {\n    snp.edge = json.snapshot.edge;\n  } else {\n    snp.edge = {\n      id: 'label', label: {size: 10, visible: false}, visible: true,\n      scale: {scale: 'linear', domain: [0, 1], range: [5, 5], unknown: 5}\n    };\n  }\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    nodesID: json.nodeTableId,\n    status: statusConv[json.status],\n    fields: def.defaultFieldProperties([\n      {'key': 'source'},\n      {'key': 'target'},\n      {'key': 'weight'}\n    ]),\n    records: json.records,\n    query: json.query,\n    networkThreshold: json.networkThreshold,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n    snapshot: snp\n  };\n}\n\nfunction v07_to_v08_convert(json) {\n  if (json.hasOwnProperty('edges')) {\n    const nodes = v07_to_v08_nodes(json.nodes);\n    const edges = v07_to_v08_edges(json.edges, nodes.fields);\n    return {nodes: nodes, edges: edges};\n  } else {\n    return v07_to_v08_nodes(json);\n  }\n}\n\n\nfunction readFile(file, sizeLimit, blob) {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    const truncated = sizeLimit ? file.slice(0, sizeLimit) : file;\n    reader.onload = event => resolve(event.target.result);\n    reader.onerror = error => reject(error);\n    if (blob) {\n      reader.readAsArrayBuffer(truncated);\n    } else {\n      reader.readAsText(truncated);\n    }\n  });\n}\n\n\nfunction parseJSON(data, compressed) {\n  const text = compressed ? pako.inflate(data, {to: 'string'}) : data;\n  const json = JSON.parse(text);\n  if (json.hasOwnProperty('schemaVersion')) return json;\n  if (json.hasOwnProperty('edges')) {\n    if (json.edges.hasOwnProperty('schemaVersion')) return json;\n  }\n  return v07_to_v08_convert(json);\n}\n\n\nfunction loadJSON(file) {\n  const compressed = file.name.endsWith('c') || file.name.endsWith('.gz');\n  return readFile(file, false, compressed)\n    .then(data => parseJSON(data, compressed));\n}\n\n\nfunction fetchJSON(url) {\n  const decoded = decodeURIComponent(url);\n  const compressed = decoded.endsWith('c') || decoded.endsWith('.gz');\n  return fetch(decoded)\n    .then(res => compressed ? res.arrayBuffer() : res.json())\n    .then(data => parseJSON(data, compressed));\n}\n\n\nfunction downloadDataFile(data, name) {\n  try {\n    // cannot hundle large file with dataURI scheme\n    // url = 'data:application/json,' + encodeURIComponent(JSON.stringify(json))\n    const url = window.URL.createObjectURL(new Blob([data]));\n    const a = document.createElement('a');\n    a.download = name;\n    a.href = url;\n    // a.click() does not work on firefox\n    a.dispatchEvent(new MouseEvent('click', {\n      'view': window,\n      'bubbles': true,\n      'cancelable': false\n    }));\n    // window.URL.revokeObjectURL(url) does not work on firefox\n  } catch (e) {\n    // no DOM (unit testing)\n  }\n}\n\n\nfunction downloadJSON(json, name, compress=true) {\n  const str = JSON.stringify(json);\n  const data = compress ? pako.gzip(str) : str;\n  const c = compress ? 'c' : 'r';\n  const ext = json.hasOwnProperty('edges') ? `.gf${c}` :  `.nd${c}`;\n  downloadDataFile(data, `${name}${ext}`);\n}\n\n\nexport default {\n  readFile, parseJSON, loadJSON, fetchJSON,\n  downloadDataFile, downloadJSON\n};\n","\n/** @module helper/dataStructure */\n\nimport KArray from './KArray.js';\nimport {default as def} from './definition.js';\n\n\n/**\n * Convert single field mapping to multi field mapping\n * @param {object} mapping - single field mapping\n * @return {object} multi field mapping\n */\nfunction singleToMulti(mapping) {\n  const newMapping = {};\n  Object.entries(mapping.mapping).forEach(m => {\n    newMapping[m[0]] = [m[1]];\n  });\n  return {\n    created: mapping.created,\n    fields: [mapping.field],\n    key: mapping.key,\n    mapping: newMapping\n  };\n}\n\n\n/**\n * Convert field mapping to table\n * @param {object} mapping - field mapping\n * @return {object} table object\n */\nfunction mappingToTable(mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  const keyField = {key: mp.key, valueType: 'text'};\n  const data = {\n    fields: def.defaultFieldProperties([keyField].concat(mp.fields)),\n    records: Object.entries(mp.mapping).map(entry => {\n      const rcd = {};\n      rcd[mp.key] = entry[0];\n      mp.fields.forEach((f, i) => {\n        rcd[f.key] = entry[1][i];\n      });\n      return rcd;\n    })\n  };\n  return data;\n}\n\n\n/**\n * Convert table to field mapping\n * @param {object} table - table\n * @param {object} key - key\n * @return {object} field mapping\n */\nfunction tableToMapping(table, key, ignore=['_index']) {\n  const now = new Date();\n  const mapping = {\n    created: now.toString(),\n    fields: def.defaultFieldProperties(table.fields\n      .filter(e => e.key !== key)\n      .filter(e => !ignore.includes(e.key))),\n    key: key,\n    mapping: {}\n  };\n  table.records.forEach(row => {\n    mapping.mapping[row[key]] = mapping.fields.map(e => row[e.key]);\n  });\n  return mapping;\n}\n\n\n/**\n * Convert csv text to field mapping\n * @param {string} csvString - csv data text\n * @return {object} field mapping\n */\nfunction csvToMapping(csvString) {\n  const lines = csvString.split(/\\n|\\r|\\r\\n/);\n  const header = lines.shift().split(',');\n  const key = header.shift();\n  const now = new Date();\n  const headerIdx = [];\n  const fields = [];\n  header.forEach((h, i) => {\n    if (h === '') return;\n    headerIdx.push(i);\n    fields.push({key: h, valueType: 'text'});\n  });\n  const mapping = {\n    created: now.toString(),\n    fields: def.defaultFieldProperties(fields),\n    key: key,\n    mapping: {}\n  };\n  lines.forEach(line => {\n    const values = line.split(',');\n    const k = values.shift();\n    mapping.mapping[k] = Array(headerIdx.length);\n    headerIdx.forEach(i => {\n      mapping.mapping[k][i] = values[i];\n    });\n  });\n  return mapping;\n}\n\n\n/**\n * Apply mapping to the data (in-place)\n * @param {object} data - datatable JSON\n * @param {object} mapping - mapping JSON\n * @return {undefined} undefined\n */\nfunction apply(data, mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  data.records\n    .filter(rcd => mp.mapping.hasOwnProperty(rcd[mp.key]))\n    .forEach(rcd => {\n      mp.fields.forEach((fd, i) => {\n        rcd[fd.key] = mp.mapping[rcd[mp.key]][i];\n      });\n    });\n  data.fields = def.defaultFieldProperties(\n    KArray.from(data.fields).concat(mp.fields).unique('key'));\n}\n\n\nexport default {\n  singleToMulti, mappingToTable, tableToMapping, csvToMapping, apply\n};\n","\nimport {default as def} from '../helper/definition.js';\nimport {default as mapper} from '../helper/mapper.js';\nimport {default as store} from './IDBStore.js';\n\n\nfunction getAppSetting(key) {\n  return store.getAppSetting(key)\n    .catch(err => {\n      console.error(`Unexpected key: ${key}`);\n      Promise.reject(err);\n    });\n}\n\n\nfunction setAppSetting(key, value) {\n  return store.putAppSetting(key, value)\n    .catch(err => {\n      console.error(`Unexpected key: ${key} or value: ${value}`);\n      Promise.reject(err);\n    });\n}\n\n\nfunction getResources() {\n  return store.getResources();\n}\n\n\nfunction setResources(rsrcs) {\n  return store.putResources(rsrcs)\n    .catch(err => {\n      console.error(`Unexpected resources: ${rsrcs}`);\n      Promise.reject(err);\n    });\n}\n\n\nfunction getAllTables() {\n  return store.getAllItems();\n}\n\n\nfunction getTablesByDataType(type) {\n  return store.getItemsByDataType(type)\n    .catch(err => {\n      console.error(`Unexpected dataType: ${type}`);\n      Promise.reject(err);\n    });\n}\n\n\nfunction getTable(id) {\n  return store.getItemById(id)\n    .catch(err => {\n      console.error(`Unexpected table ID: ${id}`);\n      Promise.reject(err);\n    });\n}\n\n\nfunction setFieldProperties(id, updates) {\n  return store.updateItem(id, item => {\n    item.fields.forEach((fd, i) => {\n      fd.visible = updates.visibles.includes(fd.key);\n      fd.sortType = updates.sortTypes[i];\n      fd.digit = updates.digits[i];\n    });\n    item.revision++;\n  })\n  .catch(err => {\n    console.error(`Unexpected table ID: ${id} or updates: ${updates}`);\n    Promise.reject(err);\n  });\n}\n\n\nfunction joinFields(id, mapping) {\n  return store.updateItem(id, item => {\n    mapper.apply(item, mapping);\n    item.revision++;\n  })\n  .catch(err => {\n    console.error(`Unexpected table ID: ${id} or mapping: ${mapping}`);\n    Promise.reject(err);\n  });\n}\n\n\nfunction updateTableAttribute(id, key, value) {\n  return store.updateItem(id, item => {\n    item[key] = value;\n    item.revision++;\n  })\n  .catch(err => {\n    console.error(`Unexpected table ID: ${id}, key: ${key} or value: ${value}`);\n    Promise.reject(err);\n  });\n}\n\n\nfunction insertTable(data) {\n  data.fields = def.defaultFieldProperties(data.fields);\n  return store.putItem(data)\n    .catch(err => {\n      console.error(`Unexpected data: ${data}`);\n      Promise.reject(err);\n    });\n}\n\n\nfunction updateTable(data) {\n  if (data.status === 'failure') {  // No data found on server\n    return updateTableAttribute(data.id, 'status', 'failure');\n  }\n  // update\n  return store.updateItem(data.id, item => {\n    data.fields = def.defaultFieldProperties(data.fields);\n    Object.assign(item, data);\n    item.revision++;\n  });\n}\n\n\nfunction deleteTable(id) {\n  return store.deleteItem(id)\n    .catch(err => {\n      console.error(`Unexpected table ID: ${id}`);\n      Promise.reject(err);\n    });\n}\n\n\nfunction reset() {\n  return store.reset();\n}\n\n\nexport default {\n  getAppSetting, setAppSetting, getResources, setResources,\n  getAllTables, getTablesByDataType, getTable,\n  setFieldProperties, joinFields,\n  updateTableAttribute, insertTable, updateTable,\n  deleteTable, reset\n};\n","\n/** @module helper/formatValue */\n\nimport d3 from 'd3';\n\n\n/**\n * Format number\n * @param {object} value - value\n * @param {string} type - si | scientific | rounded | raw\n */\nfunction formatNum(value, type) {\n  const conv = {\n    scientific: \".3e\",\n    si: \".3s\",\n    rounded: \".3r\"\n  };\n  if (type === 'raw') return value;\n  if (value === undefined || value === null || Number.isNaN(value)) return '';\n  return value == parseFloat(value) ? d3.format(conv[type])(value) : value;\n}\n\nfunction partialMatch(query, target) {\n  if (target === undefined || target === null || target === '') return false;\n  return target.toString().toUpperCase()\n    .indexOf(query.toString().toUpperCase()) !== -1;\n}\n\nfunction numericAsc(a, b) {\n  const fa = parseFloat(a);\n  const fb = parseFloat(b);\n  if (isNaN(fa) || isNaN(fb)) {\n    return String(b).localeCompare(String(a));\n  }\n  return fb - fa;\n}\n\n\nfunction numericDesc(a, b) {\n  return numericAsc(b, a);\n}\n\n\nfunction textAsc(a, b) {\n  return String(b).localeCompare(String(a));\n}\n\n\nfunction textDesc(a, b) {\n  return textAsc(b, a);\n}\n\n\nexport default {\n  formatNum, partialMatch,\n  numericAsc, numericDesc, textAsc, textDesc\n};\n","\n/** @module component/Component */\n\nimport d3 from 'd3';\nimport {default as fmt} from '../helper/formatValue.js';\n\n\nfunction selectOptions(selection, data, key, text) {\n  const options = selection.selectAll('option')\n    .data(data, key);\n  options.exit().remove();\n  options.enter().append('option')\n    .merge(options)\n      .attr('value', key)\n      .text(text);\n}\n\n\nfunction checkboxList(selection, data, name, key, text) {\n  const items = selection.selectAll('li').data(data, key);\n  items.exit().remove();\n  const entered = items.enter().append('li')\n    .attr('class', 'form-check')\n    .append('label');\n  entered.append('input');\n  entered.append('span');\n  const updated = entered.merge(items.select('label'))\n    .attr('class', 'form-check-label');\n  updated.select('input')\n    .attr('type', 'checkbox')\n    .attr('class', 'form-check-input')\n    .attr('name', name)\n    .attr('value', key);\n  updated.select('span')\n    .text(text);\n}\n\n\n// checkbox list with tooltip\n// call $('[data-toggle=\"tooltip\"]').tooltip() after this function\nfunction checkboxListT(selection, data, name, key, text) {\n  const items = selection.selectAll('li').data(data, key);\n  items.exit().remove();\n  const entered = items.enter().append('li')\n    .attr('class', 'form-check')\n    .append('label');\n  entered.append('input');\n  entered.append('a');\n  const updated = entered.merge(items.select('label'))\n    .attr('class', 'form-check-label');\n  updated.select('input')\n    .attr('type', 'checkbox')\n    .attr('class', 'form-check-input')\n    .attr('name', name)\n    .attr('value', key);\n  updated.select('a')\n    .attr('data-toggle', 'tooltip')\n    .attr('data-placement', 'bottom')\n    .attr('title', d => d.description || 'No')\n    .text(text);\n}\n\n\nfunction createTable(selection, data) {\n  // Header\n  if (selection.select('thead').size()) selection.select('thead').remove();\n  selection.append('thead').append('tr');\n  // Records\n  if (selection.select('tbody').size()) selection.select('tbody').remove();\n    selection.append('tbody');\n\n  const cols = data.fields.filter(e => e.visible);\n  const header = selection.select('thead tr').selectAll('th')\n    .data(cols, d => d.key);\n  header.exit().remove();\n  header.enter().append('th')\n    .merge(header)\n      .text(d => d.name);\n}\n\n\nfunction updateTableRecords(selection, rcds, keyFunc) {\n  const header = selection.select('thead tr').selectAll('th')\n    .data();\n  const rowSelection = selection.select('tbody').selectAll('tr')\n    .data(rcds, keyFunc);\n  rowSelection.exit().remove();\n  const rowEntered = rowSelection.enter().append('tr');\n  rowEntered.selectAll('td')\n    .data(d => header.map(e => d[e.key]))\n    .enter().append('td');\n  rowEntered.merge(rowSelection)\n    .selectAll('td')\n      .classed('align-middle', true)\n    .html(function (d, i) {\n      if (d === undefined) return '';\n      if (header[i].valueType === 'plot') return '[plot]';\n      if (header[i].valueType === 'image') return '[image]';\n      if (header[i].valueType === 'control') return;\n      if (header[i].digit !== 'raw') return fmt.formatNum(d, header[i].digit);\n      return d;\n    })\n    .each((d, i, nodes) => {\n      // This should be called after html\n      if (header[i].valueType === 'control') d3.select(nodes[i]).call(d);\n    });\n}\n\n\nfunction appendTableRows(selection, rcds, keyFunc) {\n  const newRcds = selection.select('tbody').selectAll('tr').data();\n  Array.prototype.push.apply(newRcds, rcds);\n  updateTableRecords(selection, newRcds, keyFunc);\n}\n\n\nfunction addSort(selection) {\n  selection.select('thead tr').selectAll('th')\n    .filter(d => d.sortType !== 'none')\n    .append('span').append('a')\n      .attr('id', d => `sort-${d.key}`)\n      .text('^v')\n      .style('display', 'inline-block')\n      .style('width', '30px')\n      .style('text-align', 'center')\n    .on('click', d => {\n      const isAsc = d3.select(`#sort-${d.key}`).text() === 'v';\n      const isNum = d.sortType === 'numeric';\n      const cmp = isAsc\n        ? (isNum ? fmt.numericAsc : fmt.textAsc)\n        : (isNum ? fmt.numericDesc : fmt.textDesc);\n      selection.select('tbody').selectAll('tr')\n        .sort((a, b) => cmp(a[d.key], b[d.key]));\n      d3.select(`#sort-${d.key}`)\n        .text(isAsc ? '^' : 'v');\n    });\n}\n\n\nfunction formatNumbers(selection) {\n  // DEPRECATED: no longer used\n  selection.select('thead tr').selectAll('th')\n    .each((col, colIdx) => {\n      if (col.digit === 'raw') return;\n      selection.select('tbody').selectAll('tr')\n        .selectAll('td')\n          .filter((d, i) => i === colIdx)\n          .text(d => fmt.formatNum(d, col.digit));\n    });\n}\n\n\nexport default {\n  selectOptions, checkboxList, checkboxListT,\n  createTable, updateTableRecords,\n  appendTableRows, addSort, formatNumbers\n};\n","\nimport d3 from 'd3';\nimport {default as d3scale} from '../helper/d3Scale.js';\nimport {default as d3form} from '../helper/d3Form.js';\nimport {default as fmt} from '../helper/formatValue.js';\nimport {default as cmp} from '../component/Component.js';\n\n\n\n// Get data\n\nfunction colorControlInput(id) {\n  const data = {\n    id: id,\n    field: d3form.optionData(`#${id}-col`)\n  };\n  const preset = d3form.optionData(`#${id}-preset`);\n  if (preset.scale.scale === 'ordinal') {\n    data.scale = preset.scale;\n    return data;\n  }\n  data.scale = {\n    scale: d3form.value(`#${id}-scaletype`),\n    domain: [\n      d3form.value(`#${id}-domain-from`),\n      d3form.value(`#${id}-domain-to`)\n    ],\n    unknown: '#696969'\n  };\n  const range = [d3form.value(`#${id}-range-from`)];\n  if (d3form.checked(`#${id}-range-enable-mid`)) {\n    range.push(d3form.value(`#${id}-range-mid`));\n  }\n  range.push(d3form.value(`#${id}-range-to`));\n  data.scale.range = range;\n  return data;\n}\n\n\nfunction labelControlInput() {\n  const data = colorControlInput('label');\n  data.text = d3form.optionData('#label-text');\n  data.size = d3form.value('#label-size');\n  data.visible = d3form.checked('#label-visible');\n  return data;\n}\n\n\nfunction sizeControlInput(id) {\n  return {\n    id: id,\n    scale: {\n      scale: d3form.value(`#${id}-scaletype`),\n      domain: [\n        d3form.value(`#${id}-domain-from`),\n        d3form.value(`#${id}-domain-to`)\n      ],\n      range: [\n        d3form.value(`#${id}-range-from`),\n        d3form.value(`#${id}-range-to`)\n      ],\n      unknown: 10\n    }\n  };\n}\n\n\nfunction nodeSizeControlInput() {\n  const data = sizeControlInput('size');\n  data.field = d3form.optionData('#size-col');\n  return data;\n}\n\n\nfunction nodeContentInput() {\n  return {\n    structure: {\n      visible: d3form.checked('#show-struct')\n    }\n  };\n}\n\n\nfunction edgeControlInput() {\n  const data = sizeControlInput('edge');\n  data.visible = d3form.checked('#edge-visible');\n  data.label = {\n    size: d3form.value('#edge-label-size'),\n    visible: d3form.checked('#edge-label-visible')\n  };\n  return data;\n}\n\n\n// Update DOM attributes\n\nfunction updateNodeColor(data) {\n  d3.selectAll('.node').select('.node-symbol')\n    .style('fill', d =>\n      d3scale.scaleFunction(data.scale)(data.field ? d[data.field.key] : null)\n    );\n}\n\n\nfunction updateNodeSize(data) {\n  d3.selectAll('.node').select('.node-symbol')\n    .attr('r', d =>\n      d3scale.scaleFunction(data.scale)(data.field ? d[data.field.key] : null));\n}\n\n\nfunction updateNodeLabelVisibility(visible) {\n  d3.selectAll('.node').select('.node-label')\n    .attr('visibility', visible ? 'inherit' : 'hidden');\n}\n\n\nfunction updateNodeLabel(data) {\n  d3.selectAll('.node').select('.node-label')\n    .text(d => {\n      if (data.text === null) return '';\n      if (!d.hasOwnProperty(data.text.key)) return '';\n      if (data.text.digit === 'raw') return d[data.text.key];\n      return fmt.formatNum(d[data.text.key], data.text.digit);\n    })\n    .attr('font-size', data.size)\n    .attr('y', 90) // TODO: derived from structure size or node circle radius\n    .attr('visibility', data.visible ? 'inherit' : 'hidden')\n    .style('fill', d =>\n      d3scale.scaleFunction(data.scale)(data.field ? d[data.field.key] : null));\n}\n\n\nfunction updateNodeStructure(data) {\n  d3.selectAll('.node').select('.node-struct')\n    .attr('visibility', data.structure.visible ? 'inherit' : 'hidden')\n    .each((d, i, nds) => {\n      const w = d3.select(nds[i]).select('svg').attr('width');\n      const h = d3.select(nds[i]).select('svg').attr('height');\n      d3.select(nds[i]).attr('transform', `translate(${-w / 2},${-h / 2})`);\n    });\n}\n\n\nfunction updateNodeImage(data) {\n  updateNodeSize(data.nodeSize);\n  updateNodeColor(data.nodeColor);\n  updateNodeLabel(data.nodeLabel);\n  updateNodeStructure(data.nodeContent);\n}\n\n\nfunction updateEdgeVisibility(visible) {\n  d3.selectAll('.link').select('.edge-line')\n    .attr('visibility', visible ? 'inherit' : 'hidden');\n}\n\n\nfunction updateEdgeLabelVisibility(visible) {\n  d3.selectAll('.link').select('.edge-label')\n    .attr('visibility', visible ? 'inherit' : 'hidden');\n}\n\n\nfunction updateEdge(data) {\n  d3.selectAll('.link').select('.edge-line')\n    .style('stroke-width', d => d3scale.scaleFunction(data.scale)(d.weight));\n  d3.selectAll('.link').select('.edge-label')\n    .attr('font-size', data.label.size);\n  updateEdgeVisibility(data.visible);\n  updateEdgeLabelVisibility(data.label.visible);\n}\n\n\nfunction updateRange(range, id) {\n  if (range.length === 2) {\n    d3.select(`#${id}-range-from`).property('value', range[0]);\n    d3.select(`#${id}-range-enable-mid`).attr('checked', null);\n    d3.select(`#${id}-range-mid`).attr('disabled','disabled');\n    d3.select(`#${id}-range-to`).property('value', range[1]);\n    d3.selectAll(`#${id}-range input`).attr('disabled', null);\n  } else if (range.length === 3) {\n    d3.select(`#${id}-range-from`).property('value', range[0]);\n    d3.select(`#${id}-range-enable-mid`).attr('checked', 'checked');\n    d3.select(`#${id}-range-mid`).property('value', range[1]);\n    d3.select(`#${id}-range-to`).property('value', range[2]);\n    d3.selectAll(`#${id}-range input`).attr('disabled', null);\n  } else {\n    d3.selectAll(`#${id}-range input`).attr('disabled', 'disabled');\n  }\n}\n\n\nfunction updateScale(scale, id) {\n  d3.select(`#${id}-scaletype`).property('value', scale.scale);\n  const hasDomain = scale.hasOwnProperty('domain');\n  d3.selectAll(`#${id}-domain input`)\n    .attr('disabled', hasDomain ? null : 'disabled');\n  if (hasDomain) {\n    d3.select(`#${id}-domain-from`).property('value', scale.domain[0]);\n    d3.select(`#${id}-domain-to`).property('value', scale.domain[1]);\n  }\n  updateRange(scale.range, id);\n}\n\n\nfunction updateControl(data) {\n  const id = data.id;\n  d3.select(`#${id}-visible`).attr('checked', data.visible ? 'checked' : null);\n  d3.select(`#${id}-size`).property('value', data.size);\n  d3.select(`#${id}-text`).property('value', data.text ? data.text.key : null);\n  d3.select(`#${id}-col`).property('value', data.field ? data.field.key : null);\n  if (data.hasOwnProperty('label')) {\n    d3.select(`#${id}-label-visible`)\n      .attr('checked', data.label.visible ? 'checked' : null);\n    d3.select(`#${id}-label-size`).property('value', data.label.size);\n  }\n  updateScale(data.scale, data.id);\n}\n\n\n\n// Generate controlBox elements\n\nfunction mainControlBox() {\n  d3.select('#show-struct')\n    .on('change', function () {\n      const data = nodeContentInput();\n      d3.select('#main-control').datum(data);\n      updateNodeStructure(data);\n    })\n    .dispatch('change');\n}\n\n\nfunction colorControlBox(fields, id) {\n  d3.select(`#${id}-col`)\n    .call(cmp.selectOptions, fields, d => d.key, d => d.name);\n  d3.select(`#${id}-preset`)\n    .call(cmp.selectOptions, d3scale.colorPresets, d => d.name, d => d.name)\n    .on('change', function() {\n      updateScale(d3form.optionData(this).scale, id);\n      d3.select(`.${id}-update`).dispatch('change');\n    });\n  d3.select(`#${id}-palette`)\n    .call(cmp.selectOptions, d3scale.colorPalette, d => d.name, d => d.name)\n    .on('change', function() {\n      updateRange(d3form.optionData(this).range, id);\n      d3.select(`.${id}-update`).dispatch('change');\n    });\n  d3.select(`#${id}-scaletype`)\n    .call(cmp.selectOptions, d3scale.scaleTypes, d => d.name, d => d.name);\n}\n\n\nfunction nodeColorControlBox(fields) {\n  const textCols = fields.filter(e => e.sortType !== 'none');\n  colorControlBox(textCols, 'color');\n  d3.selectAll('.color-update')\n    .on('change', () => {\n      const data = colorControlInput('color');\n      d3.select('#color-control').datum(data);\n      updateControl(data);\n      updateNodeColor(data);\n    });\n  d3.select('.color-update').dispatch('change');\n}\n\n\nfunction nodeLabelControlBox(fields) {\n  const textCols = fields.filter(e => e.sortType !== 'none');\n  d3.select('#label-text')\n    .call(cmp.selectOptions, textCols, d => d.key, d => d.name);\n  colorControlBox(textCols, 'label');\n  d3.select('#label-visible')\n    .on('change', function() {\n      updateNodeLabelVisibility(d3form.checked(this), 'label');\n      d3.select(`.label-update`).dispatch('change');\n    });\n  d3.selectAll('.label-update')\n    .on('change', () => {\n      const data = labelControlInput();\n      d3.select('#label-control').datum(data);\n      updateControl(data);\n      updateNodeLabel(data);\n    });\n  d3.select(`.label-update`).dispatch('change');\n}\n\n\nfunction sizeControlBox(presets, id) {\n  d3.select(`#${id}-preset`)\n    .call(cmp.selectOptions, presets, d => d.name, d => d.name)\n    .on('change', function() {\n      updateScale(d3form.optionData(this).scale, id);\n      d3.select(`.${id}-update`).dispatch('change');\n    });\n  d3.select(`#${id}-scaletype`)\n    .call(cmp.selectOptions, d3scale.sizeScaleTypes, d => d.name, d => d.name);\n}\n\n\nfunction nodeSizeControlBox(fields) {\n  const numCols = fields.filter(e => e.sortType === 'numeric');\n  d3.select(`#size-col`)\n    .call(cmp.selectOptions, numCols, d => d.key, d => d.name);\n  sizeControlBox(d3scale.sizePresets, 'size');\n  d3.selectAll('.size-update')\n    .on('change', () => {\n      const data = nodeSizeControlInput('size');\n      d3.select('#size-control').datum(data);\n      updateControl(data);\n      updateNodeSize(data);\n    });\n  d3.select(`.size-update`).dispatch('change');\n}\n\n\nfunction edgeControlBox() {\n  sizeControlBox(d3scale.edgeWidthPresets, 'edge');\n  d3.select('#edge-visible')\n    .on('change', function() {\n      updateEdgeVisibility(d3form.checked(this));\n      updateEdgeLabelVisibility(d3form.checked(this));\n      d3.select(`.edge-update`).dispatch('change');\n    });\n  d3.select('#edge-label-visible')\n    .on('change', function() {\n      updateEdgeLabelVisibility(d3form.checked(this));\n      d3.select(`.edge-update`).dispatch('change');\n    });\n  d3.selectAll('.edge-update')\n    .on('change', () => {\n      const data = edgeControlInput('edge');\n      d3.select('#edge-control').datum(data);\n      updateControl(data);\n      updateEdge(data);\n    });\n  d3.select(`.edge-update`).dispatch('change');\n}\n\n\nexport default {\n  updateNodeStructure, updateNodeImage, updateEdge, updateControl,\n  mainControlBox, nodeColorControlBox, nodeLabelControlBox, nodeSizeControlBox, edgeControlBox\n};\n","\nimport d3 from 'd3';\n\nimport {default as force} from './GraphForce.js';\n\nconst zoom = d3.zoom()\n  .on('zoom', () => {\n    d3.select('#graph-contents').attr('transform', d3.event.transform);\n  });\n\nconst dragWithForce = d3.drag()\n  .on('start', () => {\n    d3.select('#graph-contents').selectAll('.link')\n      .attr('visibility', 'hidden');\n    if (!d3.event.active) force.simulation.alphaTarget(0.1).restart();\n  })\n  .on('drag', d => {\n    d.fx = d3.event.x;\n    d.fy = d3.event.y;\n  })\n  .on('end', d => {\n    if (!d3.event.active) force.simulation.alphaTarget(0);\n    d.fx = null;\n    d.fy = null;\n  });\n\nconst dragNoForce = d3.drag()\n  .on('drag', function (d) {\n    d3.select(this)\n      .attr('transform', () => `translate(${d3.event.x}, ${d3.event.y})`);\n    d.x = d3.event.x;\n    d.y = d3.event.y;\n    const connected = d3.select('#graph-contents').selectAll('.link')\n      .filter(d => [d.source.index, d.target.index].includes(this.__data__.index));\n    connected.attr('transform', d => `translate(${d.source.x}, ${d.source.y})`)\n      .attr('visibility', 'visible');\n    connected.select('.edge-line')\n      .attr('x1', 0)\n      .attr('y1', 0)\n      .attr('x2', d => d.target.x - d.source.x)\n      .attr('y2', d => d.target.y - d.source.y);\n    connected.select('.edge-label')\n      .attr('x', d => (d.target.x - d.source.x) / 2)\n      .attr('y', d => (d.target.y - d.source.y) / 2);\n  })\n  .on('end', () => {\n    force.end();\n  });\n\n\nfunction stickNodes() {\n  force.simulation.alpha(0).stop();\n  d3.selectAll('.node').each(d => {\n    d.fx = d.x;\n    d.fy = d.y;\n  });\n  force.tick();\n  force.end();\n  d3.select('#stick-nodes').property('checked', true);\n  d3.select('#graph-contents').selectAll('.link')\n    .attr('visibility', 'visible');\n  d3.select('#graph-contents').selectAll('.node')\n    .call(dragNoForce);\n}\n\n\nfunction unstickNodes() {\n  d3.selectAll('.node').each(d => {\n    d.fx = null;\n    d.fy = null;\n  });\n  d3.select('#stick-nodes').property('checked', false);\n  d3.select('#graph-contents').selectAll('.link')\n    .attr('visibility', 'hidden');\n  d3.select('#graph-contents').selectAll('.node')\n    .call(dragWithForce);\n}\n\n\nfunction relax() {\n  unstickNodes();\n  force.simulation.alpha(0.1).restart();\n}\n\n\nfunction restart() {\n  unstickNodes();\n  force.simulation.alpha(1).restart();\n}\n\n\nfunction fitToScreen() {\n  d3.select('#graph-field').call(zoom.transform, d3.zoomIdentity);\n  // TODO\n  /*\n  const p = 0.9;  // padding factor\n  const x = extent(selectAll('.node').data(), d => d.x);\n  const y = extent(selectAll('.node').data(), d => d.y);\n  const w = x[1] - x[0];\n  const h = y[1] - y[0];\n  const vb = select('#graph-field').attr('viewBox').split(' ');\n  const xScaleF = vb[2] / w * p;\n  const yScaleF = vb[3] / h * p;\n  const scaleF = Math.max(xScaleF, yScaleF);\n  const center = [(w * (1 - p) / 2 - x[0]) * xScaleF,\n                  (h * (1 - p) / 2 - y[0]) * yScaleF];\n  // Reset zoom point\n  zoom.scale(scaleF);\n  zoom.translate(center);\n  updateViewportTransform(center, scaleF);\n  */\n}\n\n\nexport default {\n  zoom, dragWithForce, dragNoForce,\n  stickNodes, unstickNodes,\n  relax, restart, fitToScreen\n};\n","\n/** @module graph */\n\nimport d3 from 'd3';\n\nimport {default as d3form} from './helper/d3Form.js';\nimport {default as d3scale} from './helper/d3Scale.js';\nimport {default as def} from './helper/definition.js';\nimport {default as hfile} from './helper/file.js';\nimport {default as win} from './helper/window.js';\nimport {default as common} from './common.js';\nimport {default as store} from './store/StoreConnection.js';\nimport {default as header} from './component/Header.js';\nimport {default as dialog} from './component/Dialog.js';\nimport {default as force} from './graph/GraphForce.js';\nimport {default as dflt} from './graph/defaultGraphControl.js';\nimport {default as control} from './graph/GraphControlBox.js';\nimport {default as component} from './graph/GraphComponent.js';\nimport {default as interaction} from './graph/GraphInteraction.js';\nimport {default as community} from './graph/communityDetection.js';\n\n\nfunction takeSnapshot() {\n  return {\n    nodePositions: d3.selectAll('.node').data().map(d => ({x: d.x, y: d.y})),\n    fieldTransform: d3.zoomTransform(d3.select('#graph-field').node()),\n    nodeContent: d3.select('#main-control').datum(),\n    nodeColor: d3.select('#color-control').datum(),\n    nodeSize: d3.select('#size-control').datum(),\n    nodeLabel: d3.select('#label-control').datum(),\n    edge: d3.select('#edge-control').datum()\n  };\n}\n\n\nfunction saveSnapshot() {\n  return store.updateTableAttribute(win.URLQuery().id, 'snapshot', takeSnapshot())\n    .then(() => console.info('Snapshot saved'));\n}\n\n\nfunction resume(snapshot) {\n  d3.select('#main-control').datum(snapshot.nodeContent);\n  d3.select('#show-struct')\n    .property('checked', snapshot.nodeContent.structure.visible);\n  d3.select('#color-control').datum(snapshot.nodeColor);\n  control.updateControl(snapshot.nodeColor);\n  d3.select('#size-control').datum(snapshot.nodeSize);\n  control.updateControl(snapshot.nodeSize);\n  d3.select('#label-control').datum(snapshot.nodeLabel);\n  control.updateControl(snapshot.nodeLabel);\n  d3.select('#edge-control').datum(snapshot.edge);\n  control.updateControl(snapshot.edge);\n  const tf = snapshot.fieldTransform;\n  const transform = d3.zoomIdentity.translate(tf.x, tf.y).scale(tf.k);\n  d3.select('#graph-contents').attr('transform', transform);\n  d3.select('#graph-field').call(interaction.zoom.transform, transform);\n  d3.selectAll('.node').each((d, i) => {\n    d.x = snapshot.nodePositions[i].x;\n    d.y = snapshot.nodePositions[i].y;\n  });\n  control.updateNodeImage(snapshot);\n}\n\n\nfunction getGraph() {\n  return store.getTable(win.URLQuery().id)\n    .then(edges => {\n      return store.getTable(edges.nodesID)\n        .then(nodes => {\n          return {edges: edges, nodes: nodes};\n        });\n    });\n}\n\n\nfunction start() {\n  return getGraph()\n    .then(g => {\n      header.renderStatus(g.edges,\n        () => common.fetchResults().then(render),\n        () => common.fetchResults('abort').then(render));\n      const edgesToDraw = g.edges.records\n        .filter(e => e.weight >= g.edges.networkThreshold);\n      const logD = d3.format('.2f')(Math.log10(edgesToDraw.length / g.edges.taskCount));\n      d3.select('#edge-density').text(logD);\n      d3.select('#network-thld').text(g.edges.networkThreshold);\n      component.graphEdges(d3.select('#graph-contents'), edgesToDraw);\n      component.graphNodes(d3.select('#graph-contents'), g.nodes.records);\n      force.setForce(\n        g.nodes.records, edgesToDraw, force.tick,\n        () => {\n          force.end();\n          saveSnapshot();\n        });\n      if (g.edges.hasOwnProperty('snapshot')) {\n        resume(g.edges.snapshot);\n        interaction.stickNodes();\n      } else {\n        // Set default appearance\n        // TODO: refactor\n        d3.select('#color-control').datum(dflt.defaultNodeColor);\n        control.updateControl(dflt.defaultNodeColor);\n        d3.select('#size-control').datum(dflt.defaultNodeSize);\n        control.updateControl(dflt.defaultNodeSize);\n        d3.select('#label-control').datum(dflt.defaultNodeLabel);\n        control.updateControl(dflt.defaultNodeLabel);\n        d3.select('#main-control').datum(dflt.defaultNodeContent);\n        d3.select('#show-struct')\n          .property('checked', dflt.defaultNodeContent.structure.visible);\n        d3.select('#edge-control').datum(dflt.defaultEdge);\n        control.updateControl(dflt.defaultEdge);\n        control.updateNodeImage({\n          nodeColor: dflt.defaultNodeColor,\n          nodeSize: dflt.defaultNodeSize,\n          nodeLabel: dflt.defaultNodeLabel,\n          nodeContent: dflt.defaultNodeContent\n        });\n        control.updateEdge(dflt.defaultEdge);\n        interaction.restart();\n      }\n      d3.select('#graph-contents').style('opacity', 1e-6)\n        .transition()\n        .duration(1000)\n        .style('opacity', 1);\n    });\n}\n\n\nfunction render() {\n  return getGraph()\n    .then(g => {\n      g.nodes.records.forEach(e => { delete e._mol; });\n      dialog.graphConfigDialog(\n          g.edges.networkThreshold, g.edges.query.threshold, thld => {\n        return store.updateTableAttribute(win.URLQuery().id, 'networkThreshold', thld)\n          .then(saveSnapshot)\n          .then(start);\n      });\n      dialog.communityDialog(query => {\n        const nodeIds = g.nodes.records.map(e => e._index);\n        const visibleEdges = g.edges.records\n          .filter(e => e.weight >= g.edges.networkThreshold);\n        const comm = community.communityDetection(\n          nodeIds, visibleEdges, {nulliso: query.nulliso}\n        );\n        const mapping = {\n          key: '_index',\n          field: def.defaultFieldProperties([{key: query.name, valueType: 'numeric'}]),\n          mapping: comm\n        };\n        store.joinFields(g.nodes.id, mapping)\n          .then(() => {\n            const snapshot = takeSnapshot();\n            snapshot.nodeColor.field = query.name;\n            snapshot.nodeColor.scale = d3scale.colorPresets\n              .find(e => e.name === 'Categories').scale;\n            return store.updateTableAttribute(win.URLQuery().id, 'snapshot', snapshot)\n              .then(() => console.info('snapshot saved'));\n          }).then(render);\n      });\n      control.mainControlBox();\n      control.nodeColorControlBox(g.nodes.fields);\n      control.nodeSizeControlBox(g.nodes.fields);\n      control.nodeLabelControlBox(g.nodes.fields);\n      control.edgeControlBox();\n      d3.select('#stick-nodes')\n        .on('change', function() {\n          d3form.checked(this) === true ? interaction.stickNodes() : interaction.relax();\n        });\n      d3.select('#nodetable').attr('href', `datatable.html?id=${g.edges.nodesID}`);\n      d3.select('#rename')\n        .on('click', () => {\n          d3.select('#prompt-title').text('Rename table');\n          d3.select('#prompt-label').text('New name');\n          d3.select('#prompt-input').attr('value', g.edges.name);\n          d3.select('#prompt-submit')\n            .on('click', () => {\n              const name = d3form.value('#prompt-input');\n              return store.updateTableAttribute(win.URLQuery().id, 'name', name)\n                .then(() => store.getTable(win.URLQuery().id))  // updateTableAttribute returns 1\n                .then(t => header.renderStatus(t,\n                  () => common.fetchResults().then(render),\n                  () => common.fetchResults('abort').then(render))\n                );\n            });\n        });\n      return start();\n    });\n}\n\n\nfunction loadNewGraph(data) {\n  return common.interactiveInsert(data.nodes)\n    .then(id => {\n      data.edges.nodesID = id;\n      return common.interactiveInsert(data.edges);\n    })\n    .then(id => {\n      window.location = `graph.html?id=${id}`;\n    });\n}\n\n\nfunction run() {\n  d3.select('#export')\n    .on('click', () => {\n      // Working copy of edges and nodes are modified by d3.force.\n      // Load original data from store.\n      return getGraph().then(g => hfile.downloadJSON(g, g.edges.name));\n    });\n  d3.select('#graph-field')\n    .attr('viewBox', `0 0 ${force.fieldWidth} ${force.fieldHeight}`)\n    .call(interaction.zoom);\n  d3.select('#snapshot')\n    .on('click', saveSnapshot);\n  d3.select('#restart')\n    .on('click', interaction.restart);\n  d3.select('#import-json')\n    .on('click', () => document.getElementById('select-file').click());\n  d3.select('#select-file')\n    .on('change', () => {\n      const file = document.getElementById('select-file').files[0];\n      hfile.loadJSON(file).then(loadNewGraph);\n    });\n  // location parameter enables direct access to graph JSON via HTTP\n  if (win.URLQuery().hasOwnProperty('location')) {\n    return hfile.fetchJSON(win.URLQuery().location)\n      .then(data => {\n        return common.interactiveInsert(data.nodes)\n          .then(id => {\n            data.edges.nodesID = id;\n            return common.interactiveInsert(data.edges);\n          })\n          .then(id => {\n            window.location = `graph.html?id=${id}`;\n          });\n      });\n\n  }\n  return common.loader()\n    .then(() => {\n      if (win.URLQuery().hasOwnProperty('id')) {\n        header.initializeWithData();\n        return common.fetchResults('update').then(render);\n      } else {\n        header.initialize();\n        return Promise.resolve();\n      }\n    });\n}\n\nexport default {\n  force, control, component, interaction, community, run\n};\n","\n/** @module helper/d3Form */\n\nimport d3 from 'd3';\n\n\nfunction value(selector) {\n  return d3.select(selector).node().value;\n}\n\n\nfunction valueInt(selector) {\n  return parseInt(d3.select(selector).node().value);\n}\n\n\nfunction valueFloat(selector) {\n  return parseFloat(d3.select(selector).node().value);\n}\n\n\nfunction checked(selector) {\n  return d3.select(selector).node().checked;\n}\n\n\nfunction firstFile(selector) {\n  return d3.select(selector).node().files[0];\n}\n\n\nfunction checkboxValues(selector) {\n  return d3.selectAll(selector).selectAll('input:checked').nodes().map(e => e.value);\n}\n\n\nfunction optionValues(selector) {\n  return d3.selectAll(selector).selectAll('select').nodes().map(e => e.value);\n}\n\n\nfunction textareaLines(selector) {\n  return d3.select(selector).node().value.split('\\n').filter(e => e.length > 0);\n}\n\n\nfunction optionData(selector) {\n  const si = d3.select(selector).property('selectedIndex');\n  return d3.select(selector).selectAll('option').data().find((d, i) => i === si);\n}\n\n\nfunction checkboxData(selector) {\n  return d3.selectAll(selector).selectAll('input:checked').data();\n}\n\n\nexport default {\n  value, valueInt, valueFloat, checked,\n  firstFile, checkboxValues, optionValues, textareaLines,\n  optionData, checkboxData\n};\n","\n/** @module helper/d3Scale */\n\nimport d3 from 'd3';\n\nconst categoryMany = d3.schemeSet1\n  .concat(d3.schemeSet3, d3.schemePastel2, d3.schemeSet2);\nconst defaultSizeRange = [20, 80];\n\nconst colorPresets = [\n  {\n    name: 'Activity',\n    scale: {\n      scale: 'log',\n      domain: [1e-4, 1e-6],\n      range: ['#708090', '#7fffd4'],\n      unknown: '#696969'\n    }\n  },\n  {\n    name: 'Percent',\n    scale: {\n      scale: 'linear',\n      domain: [0, 100],\n      range: ['#708090', '#7fffd4'],\n      unknown: '#696969'\n    }\n  },\n  {\n    name: 'True or False',\n    scale: {\n      scale: 'quantize',\n      domain: [1, 0],\n      range: ['#708090', '#7fffd4'],\n      unknown: '#696969'\n    }\n  },\n  {\n    name: 'LogP',\n    scale: {\n      scale: 'linear',\n      domain: [-2, 8],\n      range: ['#6495ed', '#ccff66', '#ffa500'],\n      unknown: '#696969'\n    }\n  },\n  {\n    name: 'Categories',\n    scale: {\n      scale: 'ordinal',\n      range: d3.schemeCategory20,\n      unknown: '#dedede'\n    }\n  },\n  {\n    name: 'ManyCategories',\n    scale: {\n      scale: 'ordinal',\n      range: categoryMany,\n      unknown: '#dedede'\n    }\n  }\n];\n\nconst sizePresets = [\n  {\n    name: 'Activity',\n    scale: {\n      scale: 'log',\n      domain: [1e-4, 1e-6],\n      range: defaultSizeRange,\n      unknown: defaultSizeRange[0]\n    }\n  },\n  {\n    name: 'Percent',\n    scale: {\n      scale: 'linear',\n      domain: [0, 100],\n      range: defaultSizeRange,\n      unknown: defaultSizeRange[0]\n    }\n  },\n  {\n    name: 'True or False',\n    scale: {\n      scale: 'quantize',\n      domain: [1, 0],\n      range: defaultSizeRange,\n      unknown: defaultSizeRange[0]\n    }\n  },\n  {\n    name: 'LogP',\n    scale: {\n      scale: 'linear',\n      domain: [-2, 6],\n      range: defaultSizeRange,\n      unknown: defaultSizeRange[0]\n    }\n  }\n];\n\nconst edgeWidthPresets = [\n  {\n    name: 'Universal',\n    scale: {\n      scale: 'linear',\n      domain: [0.3, 1],\n      range: [0.5, 5],\n      unknown: 1\n    }\n  },\n  {\n    name: 'Thin',\n    scale: {\n      scale: 'linear',\n      domain: [0.5, 1],\n      range: [0.5, 3],\n      unknown: 1\n    }\n  },\n  {\n    name: 'Amplified',\n    scale: {\n      scale: 'linear',\n      domain: [0.5, 1],\n      range: [1, 10],\n      unknown: 1\n    }\n  }\n];\n\nconst colorPalette = [\n  {name: 'Aquamarine', range: ['#778899', '#7fffd4'], unknown: '#696969'},\n  {name: 'Chartreuse', range: ['#778899', '#7fff00'], unknown: '#696969'},\n  {name: 'Salmon', range: ['#778899', '#fa8072'], unknown: '#696969'},\n  {name: 'Violet', range: ['#778899', '#ee82ee'], unknown: '#696969'},\n  {name: 'blue-red', range: ['#87ceeb', '#fff5ee', '#fa8072'], unknown: '#696969'},\n  {name: 'Spectrum', range: ['#6495ed', '#ccff66', '#ffa500'], unknown: '#696969'}\n];\n\nconst scaleTypes = [\n  {name: 'linear', func: d3.scaleLinear()},\n  {name: 'log', func: d3.scaleLog()},\n  {name: 'quantize', func: d3.scaleQuantize()},\n  {name: 'ordinal', func: d3.scaleOrdinal()}\n];\n\nconst sizeScaleTypes = [\n  {name: 'linear', func: d3.scaleLinear()},\n  {name: 'log', func: d3.scaleLog()},\n  {name: 'quantize', func: d3.scaleQuantize()}\n];\n\nfunction scaleFunction(scale) {\n  let sf = scaleTypes.find(e => e.name === scale.scale).func;\n  let domain = scale.domain;\n  if (scale.range.length === 3) {\n    const mid = (parseFloat(scale.domain[0]) + parseFloat(scale.domain[1])) / 2;\n    domain = [scale.domain[0], mid, scale.domain[1]];\n  }\n  if (scale.scale !== 'ordinal') {\n    sf = sf.domain(domain);\n  }\n  sf = sf.range(scale.range);\n  if (['linear', 'log'].includes(scale.scale)) {\n    sf = sf.clamp(true);\n  }\n  return d => {\n    if (d === '' || typeof d === 'undefined' || d === null) {\n      return scale.unknown;\n    }\n    if (scale.scale !== 'ordinal' && parseFloat(d) != d) {\n      return scale.unknown;\n    }\n    if (scale.scale === 'log' && d <= 0) {\n      return scale.unknown;\n    }\n    const result = sf(d);\n    if (result === undefined) {\n      return scale.unknown;\n    }\n    return result;\n  };\n}\n\n\nexport default {\n  colorPresets, sizePresets, edgeWidthPresets,\n  colorPalette, scaleTypes, sizeScaleTypes,\n  scaleFunction\n};\n","\n/** @module helper/definition */\n\n\nconst defaultHiddenFields = ['_mw', '_mw_wo_sw', '_logp', '_formula', '_nonH'];\n\n// TODO: timestamp sort\nconst defaultSort = {\n    id: 'text',\n    compound_id: 'text',\n    assay_id: 'text',\n    svg: 'none',\n    json: 'none',\n    plot: 'none',\n    text: 'text',\n    ec50: 'numeric',\n    'active%': 'numeric',\n    'inhibition%': 'numeric',\n    filesize: 'numeric',\n    numeric: 'numeric',\n    count: 'numeric',\n    int: 'numeric',\n    flag: 'numeric',\n    bool: 'numeric',\n    timestamp: 'none',\n    image: 'none',\n    control: 'none',\n    'undefined': 'none'\n};\n\nconst defaultDigit = {\n    id: 'raw',\n    compound_id: 'raw',\n    assay_id: 'raw',\n    svg: 'raw',\n    json: 'raw',\n    plot: 'raw',\n    text: 'raw',\n    ec50: 'scientific',\n    'active%': 'rounded',\n    'inhibition%': 'rounded',\n    filesize: 'si',\n    numeric: 'rounded',\n    count: 'raw',\n    int: 'raw',\n    flag: 'raw',\n    bool: 'raw',\n    timestamp: 'raw',\n    image: 'raw',\n    control: 'raw',\n    'undefined': 'raw'\n};\n\nfunction defaultFieldProperties(fields) {\n  return fields.map(e => {\n    if (!e.hasOwnProperty('name')) e.name = e.key;\n    if (!e.hasOwnProperty('visible')) e.visible = !defaultHiddenFields.includes(e.key);\n    if (!e.hasOwnProperty('sortType')) e.sortType = defaultSort[e.valueType];\n    if (!e.hasOwnProperty('digit')) e.digit = defaultDigit[e.valueType];\n    return e;\n  });\n}\n\nfunction ongoing(data) {\n  return ['running', 'ready'].includes(data.status);\n}\n\n\nexport default {\n  defaultHiddenFields, defaultFieldProperties, ongoing\n};\n","\n\nclass KArray extends Array {\n  /**\n   * Return array of object filtered by given unique key\n   */\n  unique(key) {\n    return this.reduce((a, b) => {\n      if (a.find(e => e[key] === b[key]) === undefined) a.push(b);\n      return a;\n    }, new KArray());\n  }\n\n\n  /**\n   * Merge arrays\n   */\n  extend() {\n    return this.reduce((a, b) => {\n      Array.prototype.push.apply(a, b);\n      return a;\n    }, new KArray());\n  }\n\n\n  // Merge arrays(Asynchronous)\n  extendAsync() {\n    return Promise.all(this).then(res => {\n      return res.reduce((a, b) => {\n        Array.prototype.push.apply(a, b);\n        return a;\n      }, new KArray());\n    });\n  }\n\n  toArray() {\n    return new Array(this);\n  }\n\n  toObject() {\n    const obj = {};\n    this.forEach(kv => {\n      obj[kv[0]] = kv[1];\n    });\n    return obj;\n  }\n}\n\nexport default KArray;\n","\nimport KArray from './KArray.js';\n\n\nfunction URLQuery() {\n  return KArray.from(window.location.search.substring(1).split(\"&\"))\n    .map(e => e.split('=')).toObject();\n}\n\n\nexport default {\n  URLQuery\n};\n","\n/** @module helper/parser */\n\nfunction getSDFPropList(str) {\n  const re = />.*?<(\\S+)>/g;\n  const uniqCols = new Set();\n  let arr;\n  while ((arr = re.exec(str)) !== null) {\n    uniqCols.add(arr[1]);\n  }\n  return Array.from(uniqCols);\n}\n\n// Ref. https://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript\nfunction uuidv4() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n    var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\n    return v.toString(16);\n  });\n}\n\n// TODO: not used\nfunction queryFormData(query) {\n  const formData = new FormData();\n  Object.entries(query).forEach(kv => {\n    if (Array.isArray(kv[1])) {\n      kv[1].forEach(e => formData.append(kv[0], e));\n    } else {\n      formData.set(kv[0], kv[1]);\n    }\n  });\n  return formData;\n}\n\n\n// TODO: not used\nfunction queryURL(query) {\n  const queryStr = [];\n  Object.entries(query).forEach(e => {\n    const val = Array.isArray(e[1]) ? JSON.stringify(e[1]) : e[1];\n    const key = e[0];\n    // const encoded = encodeURIComponent(val);\n    queryStr.push(`${key}=${val}`);\n  });\n  return queryStr.join('&');\n}\n\n\n// TODO: not used\nfunction capitalized(str) {\n  return str.replace(/(?:^|\\s)\\S/g, e => e.toUpperCase());\n}\n\n\nexport default {\n  getSDFPropList, uuidv4\n};\n","\nimport Dexie from 'Dexie';\n\n// TODO: can indexed records improve query performance ?\n\nconst schema = {\n  app: 'key',\n  items: 'id, dataType, created',\n  resources: 'id'\n};\n\nlet idb = new Dexie('Store');\nidb.version(1).stores(schema);\n\n\nfunction getAppSetting(key) {\n  return idb.app.where('key').equals(key).first()\n    .then(res => {\n      if (res === undefined) return undefined;\n      return res.value;\n    });\n}\n\n\nfunction putAppSetting(k, v) {  // returns id in success\n  return idb.app.put({ key: k, value: v });\n}\n\n\nfunction getResources() {\n  return idb.resources.toArray();\n}\n\n\nfunction putResources(data) { // returns last id in success\n  return idb.resources.bulkPut(data);\n}\n\n\nfunction getAllItems() {\n  return idb.items.orderBy('created').reverse()\n    .toArray();\n}\n\n\nfunction getItemsByDataType(type) {\n  return idb.items.where('dataType').equals(type).reverse()\n    .sortBy('created');\n}\n\n\nfunction getItemById(tableId) {\n  return idb.items.where('id').equals(tableId).first();\n}\n\n\nfunction updateItem(tableId, callback) {  // returns num of updated items\n  return idb.items.where('id').equals(tableId).modify(callback);\n}\n\n\nfunction deleteItem(tableId) { // returns num of deleted items\n  return idb.items.where('id').equals(tableId).delete();\n}\n\n\nfunction putItem(data) { // returns id in success\n  return idb.items.put(data);\n}\n\n\nfunction reset() {\n  // Try this before tackling with local db troubles\n  return idb.delete().then(() => {\n    idb = new Dexie('Store');\n    idb.version(1).stores(schema);\n  });\n}\n\nexport default {\n  getAppSetting, putAppSetting, getResources, putResources,\n  getAllItems, getItemsByDataType, getItemById,\n  updateItem, deleteItem, putItem, reset\n};\n","\n/** @module helper/image */\n\nimport vega from 'vega';\n\nfunction showPlot(vegaSpec, selector) {\n  new vega.View(vega.parse(vegaSpec))\n    .initialize(selector)\n    .run();\n}\n\n\nfunction plotThumbnail(vegaSpec) {\n  const view = new vega.View(vega.parse(vegaSpec));\n  return view.toImageURL('png');  // Promise\n}\n\n\nexport default {\n  showPlot, plotThumbnail\n};\n","\nconst baseURL = '';\n\nfunction get(url, query={}) {\n  const isEmpty = Object.keys(query).length;\n  const q = isEmpty ? `?query=${JSON.stringify(query)}` : '';\n  return fetch(\n    `${baseURL}${url}${q}`,\n    {\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\nfunction json(response) {\n  return response.json();\n}\n\nfunction text(response) {\n  return response.text();\n}\n\nfunction blob(response) {\n  return response.blob();\n}\n\nfunction post(url, formdata) {\n  return fetch(\n    `${baseURL}${url}`,\n    {\n      method: 'POST',\n      body: formdata,\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\n\nfunction error(err) {\n  console.error(err);\n  return null;\n}\n\n\nexport default {\n  get, json, text, blob, post, error\n};\n","\n/** @module component/Dialog */\n\nimport d3 from 'd3';\n\nimport KArray from '../helper/KArray.js';\nimport {default as d3form} from '../helper/d3Form.js';\nimport {default as mapper} from '../helper/mapper.js';\nimport {default as def} from '../helper/definition.js';\nimport {default as fmt} from '../helper/formatValue.js';\nimport {default as win} from '../helper/window.js';\nimport {default as hfile} from '../helper/file.js';\nimport {default as misc} from '../helper/misc.js';\nimport {default as himg} from '../helper/image.js';\nimport {default as store} from '../store/StoreConnection.js';\nimport {default as cmp} from './Component.js';\nimport {default as fetcher} from '../fetcher.js';\n\n\nfunction pickDialog(resources, callback) {\n  store.getAppSetting('compoundIDPlaceholder').then(ids => {\n    d3.select('#pick-queryarea').text(ids);\n  });\n  d3.select('#pick-submit')\n    .on('click', () => {\n      d3.select('#loading-circle').style('display', 'inline');\n      const query = {\n        type: 'chemsearch',\n        targets: resources.filter(e => e.domain === 'chemical').map(e => e.id),\n        key: 'compound_id',\n        values: d3form.textareaLines('#pick-queryarea')\n      };\n      return fetcher.get('run', query)\n        .then(fetcher.json)\n        .then(callback, fetcher.error);\n    });\n}\n\n\nfunction propDialog(resources, callback) {\n  d3.select('#prop-targets')\n    .call(cmp.checkboxList, resources, 'targets', d => d.id, d => d.name)\n    .on('change', function () {\n      const cols = KArray.from(d3form.checkboxData('#prop-targets'))\n        .map(d => d.fields)\n        .extend().unique('key');\n      d3.select('#prop-key')\n        .call(cmp.selectOptions, cols, d => d.key, d => d.name);\n    });\n  d3.select('#prop-submit')\n    .on('click', () => {\n      d3.select('#loading-circle').style('display', 'inline');\n      const query = {\n        type: 'chemprop',\n        targets: d3form.checkboxValues('#prop-targets'),\n        key: d3form.optionData('#prop-key').key,\n        values: d3form.textareaLines('#prop-queryarea'),\n        operator: d3form.value('#prop-operator')\n      };\n      return fetcher.get('async', query)\n        .then(fetcher.json)\n        .then(callback, fetcher.error);\n    });\n}\n\n\nfunction structDialog(resources, callback) {\n  d3.select('#struct-qsrc')\n    .call(cmp.selectOptions, resources, d => d.id, d => d.name);\n  d3.select('#struct-targets')\n    .call(cmp.checkboxList, resources, 'targets', d => d.id, d => d.name);\n  store.getAppSetting('rdkit').then(rdk => {\n    d3.select('#struct-method').selectAll('option.rd')\n      .attr('disabled', rdk ? null : 'disabled');\n  });\n  d3.selectAll('#struct-method,#struct-thldtype')\n    .on('change', function () {\n      const method = d3form.value('#struct-method');\n      const thldtype = d3form.value('#struct-thldtype');\n      d3.select('#struct-thld')\n        .attr('disabled', ['gls', 'rdmorgan', 'rdfmcs'].includes(method) ? null : 'disabled')\n        .attr('value', thldtype === 'edge' ? 15 : 0.7)\n        .attr('min', thldtype === 'edge' ? 5 : 0)\n        .attr('max', thldtype === 'edge' ? 999 : 1.0)\n        .attr('step', thldtype === 'edge' ? 1 : 0.01);\n      d3.select('#struct-thldtype')\n        .attr('disabled', ['gls', 'rdmorgan', 'rdfmcs'].includes(method) ? null : 'disabled')\n        .property('value', ['gls', 'rdfmcs'].includes(method) ? undefined : 'sim');\n      d3.select('#struct-thldtype option.sim')\n        .attr('disabled', ['gls', 'rdmorgan', 'rdfmcs'].includes(method) ? null : 'disabled');\n      d3.select('#struct-thldtype option.edge')\n        .attr('disabled', ['gls', 'rdfmcs'].includes(method) ? null : 'disabled');\n      d3.select('#struct-options').selectAll('.gls')\n        .attr('disabled', method === 'gls' ? null : 'disabled');\n      d3.select('#struct-options .fmcs')\n        .attr('disabled', method === 'rdfmcs' ? null : 'disabled');\n    })\n    .dispatch('change');\n  d3.select('#struct-format')\n    .on('change', function () {\n      d3.select('#struct-qsrc')\n        .attr('disabled', this.value === 'dbid' ? null : 'disabled');\n    });\n  d3.select('#struct-preview')\n    .on('click', () => {\n      const fmt = d3form.value('#struct-format');\n      const query = {\n        format: fmt,\n        source: fmt === 'dbid' ? d3form.value('#struct-qsrc') : null,\n        value: fmt === 'molfile'\n          ? d3form.value('#struct-queryarea') : d3form.textareaLines('#struct-queryarea')[0],\n      };\n      return fetcher.get('strprev', query)\n        .then(fetcher.text)\n        .then(res => d3.select('#struct-image').html(res), fetcher.error);\n    });\n  d3.select('#struct-submit')\n    .on('click', () => {\n      const method = d3form.value('#struct-method');\n      d3.select('#loading-circle').style('display', 'inline');\n      const fmt = d3form.value('#struct-format');\n      const query = {\n        type: d3form.value('#struct-method'),\n        targets: d3form.checkboxValues('#struct-targets'),\n        queryMol: {\n          format: fmt,\n          source: fmt === 'dbid' ? d3form.value('#struct-qsrc') : null,\n          value: fmt === 'molfile'\n            ? d3form.value('#struct-queryarea') : d3form.textareaLines('#struct-queryarea')[0]\n        },\n        params: {\n          measure: d3form.value('#struct-thldtype'),\n          threshold: d3form.valueFloat('#struct-thld'),\n          ignoreHs: d3form.checked('#struct-ignoreh'),\n          diameter: method === 'gls' ? d3form.valueInt('#struct-diam') : null,\n          maxTreeSize: method === 'gls' ? d3form.valueInt('#struct-tree') : null,\n          molSizeCutoff: method === 'gls' ? d3form.valueInt('#struct-skip') : null,\n          timeout: method === 'rdfmcs' ? d3form.valueInt('#struct-timeout') : null\n        }\n      };\n      const command = query.type === 'exact' ? 'run' : 'async';\n      return fetcher.get(command, query)\n        .then(fetcher.json)\n        .then(callback, fetcher.error);\n    });\n}\n\n\nfunction sdfDialog(callback) {\n  d3.select('#sdf-file')\n    .on('change', () => {\n      const reader = new FileReader();\n      const file = document.getElementById('sdf-file').files[0];\n      reader.onload = (e) => {\n        d3.select('#sdf-cols')\n          .call(cmp.checkboxList, misc.getSDFPropList(e.target.result),\n                'fields', d => d, d => d\n          );\n      };\n      // Scan only first 100mb of the file due to memory limit.\n      reader.readAsText(file.slice(0, 100 * 1024 * 1024));\n    });\n  d3.select('#sdf-selectall')\n    .on('change', () => {\n      d3.select('#sdf-cols').selectAll('input')\n        .property('checked', d3form.checked('#sdf-selectall'));\n    });\n  d3.select('#sdf-submit')\n    .on('click', () => {\n      d3.select('#loading-circle').style('display', 'inline');\n      const params = {\n        fields: d3form.checkboxValues('#sdf-cols'),\n        implh: d3form.checked('#sdf-implh'),\n        recalc: d3form.checked('#sdf-recalc')\n      };\n      const formData = new FormData();\n      formData.append('contents', d3form.firstFile('#sdf-file'));\n      formData.append('params', JSON.stringify(params));\n      return fetcher.post('sdfin', formData)\n        .then(fetcher.json)\n        .then(callback, fetcher.error);\n    });\n}\n\n\nfunction columnDialog(dataFields, callback) {\n  const table = {\n    fields: def.defaultFieldProperties([\n      {key: 'name', valueType: 'text'},\n      {key: 'visible', valueType: 'control'},\n      {key: 'sortType', valueType: 'control'},\n      {key: 'digit', valueType: 'control'}\n    ])\n  };\n  const records = dataFields.map((e, i) => {\n    return {\n      key: e.key,\n      name: e.name,\n      visible: selection => selection\n          .classed('column-vis', true)\n          .classed(`row${i}`, true)\n        .append('input')\n          .attr('type', 'checkbox')\n          .attr('value', e.key)\n          .property('checked', e.visible)\n      ,sortType: selection => selection\n          .classed('column-sort', true)\n          .classed(`row${i}`, true)\n        .append('select')\n          .call(cmp.selectOptions,\n                e.sortType === 'none' ? ['none'] : ['numeric', 'text'], d => d, d => d)\n          .property('value', e.sortType)\n          .on('change', function () {\n            d3.select(`.column-digit.row${i} select`)\n              .attr('disabled', this.value === 'numeric' ? null : 'disabled');\n          })\n      ,digit: selection => selection\n          .classed('column-digit', true)\n          .classed(`row${i}`, true)\n        .append('select')\n          .call(cmp.selectOptions, ['raw', 'rounded', 'scientific', 'si'], d => d, d => d)\n          .property('value', e.digit)\n          .attr('disabled', e.sortType === 'numeric' ? null : 'disabled')\n    };\n  });\n  d3.select('#column-table')\n    .call(cmp.createTable, table)\n    .call(cmp.updateTableRecords, records, d => d.key);\n  d3.select('#column-submit')\n    .on('click', () => {\n      const query = {\n        visibles: d3form.checkboxValues('.column-vis'),\n        sortTypes: d3form.optionValues('.column-sort'),\n        digits: d3form.optionValues('.column-digit')\n      };\n      return store.setFieldProperties(win.URLQuery().id, query)\n        .then(callback);\n    });\n}\n\n\n// TODO:\nfunction fieldFetchDialog(compoundIDs, dataFields, resources, callback) {\n  // Prevent implicit submission\n  document.getElementById('join-search')\n    .addEventListener('keypress', event => {\n      if (event.keyCode === 13) event.preventDefault();\n    });\n  const dataKeys = dataFields.map(e => e.key);\n  const resourceFields = KArray.from(resources.map(e => e.fields))\n    .extend().unique('key').filter(e => e.key !== 'id');\n  d3.select('#join-keys')\n    .call(cmp.checkboxList, resourceFields, 'keys', d => d.key, d => d.name)\n    .selectAll('li')\n    .each(function(d) { // disable already shown columns\n      d3.select(this).selectAll('label').select('input')\n        .property('checked', dataKeys.includes(d.key))\n        .attr('disabled', dataKeys.includes(d.key) ? 'disabled' : null);\n    });\n  d3.select('#join-search')\n    .on('keyup', function () {\n      const match = d => fmt.partialMatch(d3form.value(this), d.name);\n      d3.select('#join-keys').selectAll('li')\n        .style('visibility', d => match(d) ? null : 'hidden')\n        .style('position', d => match(d) ? null : 'absolute');\n    });\n  d3.select('#join-submit')\n    .on('click', () => {\n      d3.select('#loading-circle').style('display', 'inline');\n      const selected = d3form.checkboxValues('#join-keys');\n      const queryFieldKeys = resourceFields.map(e => e.key)\n        .filter(e => !dataKeys.includes(e))\n        .filter(e => selected.includes(e));\n      const query = {\n        type: 'fieldfilter',\n        targetFields: queryFieldKeys,\n        key: 'compound_id',\n        values: compoundIDs\n      };\n      return fetcher.get('run', query)\n        .then(fetcher.json)\n        .then(json => callback(mapper.tableToMapping(json, 'id')),\n              fetcher.error);\n  });\n}\n\n\nfunction fieldFileDialog(callback) {\n  // TODO: need to refactor\n  d3.select('#importcol-file')\n    .on('change', () => {\n      const file = document.getElementById('importcol-file').files[0];\n      const isCsv = file.name.split('.').pop() === 'csv';\n      hfile.readFile(file).then(res => {\n        const mapping = isCsv ? mapper.csvToMapping(res) : JSON.parse(res);\n        const tbl = mapper.mappingToTable(mapping);\n        d3.select('#importcol-preview').call(cmp.createTable, tbl)\n          .call(cmp.updateTableRecords,\n                tbl.records.slice(0, 5), d => d[tbl.fields[0].key]);\n        // bind mapping\n        d3.select('#importcol-preview').datum(mapping);\n      });\n    });\n  d3.select('#importcol-submit')\n    .on('click', () => {\n      let mapping = d3.select('#importcol-preview').datum();\n      d3.select('#importcol-preview').datum(null);  // unbind mapping\n      // Generate thumbnails\n      const plotCols = [];\n      if (mapping.hasOwnProperty('field')) {\n        mapping = mapper.singleToMulti(mapping);\n      }\n      mapping.fields.forEach((e, i) => {\n        if (e.valueType === 'plot') {\n          mapping.fields[i].valueType = 'image';\n          plotCols.push(i);\n        }\n      });\n      if (plotCols.length > 0) {\n        const ps = [];\n        Object.entries(mapping.mapping).forEach(m => {\n          plotCols.forEach(e => {\n            const p = himg.plotThumbnail(m[1][e])\n              .then(img => {\n                mapping.mapping[m[0]][e] = img;\n              });\n            ps.push(p);\n          });\n        });\n        Promise.all(ps).then(() => callback(mapping));\n      } else {\n        callback(mapping);\n      }\n    });\n}\n\n\nfunction graphDialog(callback) {\n  store.getAppSetting('rdkit').then(rdk => {\n    d3.select('#graph-measure').selectAll('option.rd')\n      .attr('disabled', rdk ? null : 'disabled');\n  });\n  d3.select('#graph-measure')\n    .on('change', function () {\n      d3.select('#graph-options').selectAll('.gls')\n        .attr('disabled', this.value === 'gls' ? null : 'disabled');\n      d3.select('#graph-options').selectAll('.fmcs')\n        .attr('disabled', this.value === 'rdfmcs' ? null : 'disabled');\n    });\n  d3.select('#graph-submit')\n    .on('click', () => {\n      d3.select('#loading-circle').style('display', 'inline');\n      const measure = d3form.value('#graph-measure');\n      const params = {\n        measure: measure,\n        threshold: d3form.valueFloat('#graph-thld'),\n        ignoreHs: d3form.checked('#graph-ignoreh'),\n        diameter: measure === 'gls' ? d3form.valueInt('#graph-diam') : null,\n        maxTreeSize: measure === 'gls' ? d3form.valueInt('#graph-tree') : null,\n        molSizeCutoff: measure === 'gls' ? d3form.valueInt('#graph-skip') : null,\n        timeout: measure === 'rdfmcs' ? d3form.valueInt('#graph-timeout') : null\n      };\n      callback(params);\n    });\n}\n\n\nfunction graphConfigDialog(currentThld, minThld, callback) {\n  d3.select('#graphconfig-thld')\n    .attr('value', currentThld)\n    .attr('max', 1.0)\n    .attr('min', minThld);\n  d3.select('#graphconfig-submit')\n    .on('click', () => {\n      const newThld = d3form.valueFloat('#graphconfig-thld');\n      if (newThld < minThld) return;  // TODO: fool proof\n      callback(newThld);\n    });\n}\n\n\nfunction communityDialog(callback) {\n  d3.select('#community-name').attr('value', 'comm_');\n  d3.select('#community-submit')\n    .on('click', () => {\n      const query = {\n        name: d3form.value('#community-name'),\n        nulliso: d3form.checked('#community-nulliso')\n      };\n      callback(query);\n    });\n}\n\n\nfunction importConfirmDialog(callback) {\n  d3.select('#importconfirm-overwrite')\n    .on('click', () => callback('overwrite'));\n  d3.select('#importconfirm-keepboth')\n    .on('click', () => callback('keepboth'));\n  d3.select('#importconfirm-cancel')\n    .on('click', () => callback('cancel'));\n}\n\n\nexport default {\n  pickDialog, propDialog, structDialog, sdfDialog,\n  columnDialog, fieldFetchDialog, fieldFileDialog, graphDialog,\n  graphConfigDialog, communityDialog, importConfirmDialog\n};\n","\nimport {default as def} from './helper/definition.js';\nimport {default as win} from './helper/window.js';\nimport {default as misc} from './helper/misc.js';\nimport {default as store} from './store/StoreConnection.js';\nimport {default as dialog} from './component/Dialog.js';\nimport {default as fetcher} from './fetcher.js';\n\n\nfunction interactiveInsert(data) {\n  return store.getTable(data.id)\n    .then(found => {\n      if (!found) return Promise.resolve(data); // no existing table\n      if (data.revision == found.revision) return Promise.reject(data.id); // same revision\n      // data id conflict\n      $('#importconfirm-dialog').modal('toggle');\n      return new Promise(res => {\n        dialog.importConfirmDialog(action => {\n          if (action === 'overwrite') {\n            res(data);\n          }\n          if (action === 'keepboth') {\n            data.id = misc.uuidv4();\n            res(data);\n          }\n        });\n      });\n    })\n    .then(\n      data => store.insertTable(data).then(() => data.id), // insert or update table\n      id => {\n        if (id) return Promise.resolve(id); // same revision -> call existing table\n        return Promise.reject();\n      }\n    );\n}\n\n\nfunction fetchResults(command='update') {\n  return store.getTable(win.URLQuery().id)\n    .then(data => {\n      if (!def.ongoing(data)) return Promise.reject();\n      return data;\n    })\n    .then(data => {\n      const query = {id: data.id, command: command};\n      return fetcher.get('res', query)\n        .then(fetcher.json)\n        .then(store.updateTable, fetcher.error);\n    }, () => Promise.resolve());\n}\n\n\nfunction loader() {\n  /*\n  if (document.location.protocol === \"file:\") {\n    console.info('Off-line mode (local file)');\n    store.setGlobalConfig('onLine', false);\n    return Promise.resolve();\n  }\n  if ('onLine' in navigator) {\n    if (!navigator.onLine) {\n      console.info('Off-line mode (no internet connection)');\n      store.setGlobalConfig('onLine', false);\n      return Promise.resolve();\n    }\n  }*/\n  if ('serviceWorker' in navigator && !debug) {\n    navigator.serviceWorker\n      .register('sw.js')\n      .then(reg => {\n        console.info('ServiceWorker registration successful with scope: ', reg.scope);\n      }).catch(err => {\n        console.info('ServiceWorker registration failed: ', err);\n      });\n  } else if (debug) {\n    console.info('Off-line mode is disabled for debugging');\n  } else {\n    console.info('Off-line mode is not supported');\n  }\n  const server = fetcher.get('server')\n    .then(fetcher.json)\n    .catch(() => null);\n  const local = store.getAppSetting('serverInstance');\n  return Promise.all([server, local]).then(ps => {\n    const serverStatus = ps[0];\n    const clientInstance = ps[1];\n    if (!serverStatus) return Promise.resolve(null);\n    if (serverStatus.instance === clientInstance) {\n      console.info('Resource schema is already up to date');\n      return Promise.resolve(serverStatus);\n    } else {\n      return fetcher.get('schema')\n        .then(fetcher.json)\n        .then(schema => {\n          console.info(`New resource schema version: ${serverStatus.instance}`);\n          return Promise.all([\n            store.setResources(schema.resources),\n            store.setAppSetting('templates', schema.templates),\n            store.setAppSetting(\n              'compoundIDPlaceholder', schema.compoundIDPlaceholder),\n            store.setAppSetting('serverInstance', serverStatus.instance),\n            store.setAppSetting('rdkit', serverStatus.rdkit)\n          ])\n          .then(() => Promise.resolve(serverStatus));\n        }, fetcher.error);\n    }\n  });\n}\n\n\nexport default {\n  interactiveInsert, fetchResults, loader\n};\n","\n/** @module component/Header */\n\nimport d3 from 'd3';\nimport {default as def} from '../helper/definition.js';\n\n\nfunction renderStatus(data, refresh_callback, abort_callback) {\n  d3.select('#loading-circle').style('display', 'none');\n  d3.select('title').text(data.name);\n  d3.select('#title').text(data.name);\n  d3.select('#refresh')\n    .style('display', def.ongoing(data) ? 'inline-block' : 'none');\n  d3.select('#abort')\n    .style('display', def.ongoing(data) ? 'inline-block' : 'none');\n  const doneText = {\n    'nodes': 'entries found',\n    'edges': 'connections created'\n  };\n  const dtx = doneText[data.dataType];\n  d3.select('#progress')\n    .text(`(${data.status} - ${data.resultCount} ${dtx} in ${data.execTime} sec.)`);\n  if (def.ongoing(data)) {\n    d3.select('#progress').append('div').append('progress')\n      .attr('max', 100)\n      .attr('value', data.progress)\n      .text(`${data.progress}%`);\n  }\n  d3.select('#refresh').on('click', refresh_callback);\n  d3.select('#abort')\n    .on('click', () => {\n      d3.select('#confirm-message')\n        .text('Are you sure you want to abort this calculation job?');\n      d3.select('#confirm-submit')\n        .classed('btn-primary', false)\n        .classed('btn-warning', true)\n        .on('click', abort_callback);\n    });\n  console.info('Query');\n  console.info(data.query);  // query datails are available on browser console.\n}\n\n\nfunction initializeWithData() {\n  d3.select('#new-data').style('display', 'none');\n  d3.select('#loading-circle').style('display', 'none');\n}\n\n\nfunction initialize() {\n  d3.select('#data-control').style('display', 'none');\n  d3.select('#nodedata').style('display', 'none');\n  d3.select('#refresh').style('display', 'none');\n  d3.select('#abort').style('display', 'none');\n  d3.select('#loading-circle').style('display', 'none');\n  d3.select('#status').selectAll('li').style('display', 'none');\n}\n\n\nexport default {\n  renderStatus, initializeWithData, initialize\n};\n","\n/** @module graph/GraphForce */\n\nimport d3 from 'd3';\n\nconst fieldWidth = 1200;\nconst fieldHeight = 1200;\n\nconst simulation = d3.forceSimulation()\n  .force('link',\n    d3.forceLink().id(d => d._index)\n      .distance(60)\n      .strength(1))\n  .force('charge',\n    d3.forceManyBody()\n      .strength(-600)\n      .distanceMin(15)\n      .distanceMax(720))\n  .force('collide',\n    d3.forceCollide()\n      .radius(90))\n  .force('center',\n    d3.forceCenter(fieldWidth / 2, fieldHeight / 2))\n  .force('x',\n    d3.forceX()\n      .strength(0.002))\n  .force('y',\n    d3.forceY()\n      .strength(0.002))\n  .stop();\n\n\nfunction setForce(nodes, edges, tick, end) {\n  simulation.nodes(nodes)\n    .force('link').links(edges);\n  simulation.on('tick', tick)\n    .on('end', end);\n}\n\n\nfunction tick() {\n  d3.select('#graph-contents').selectAll('.node')\n    .attr('transform', d => `translate(${d.x}, ${d.y})`);\n  const alpha = simulation.alpha();\n  const isStopped = alpha <= simulation.alphaMin();\n  d3.select('#temperature')\n    .classed('progress-success', isStopped)\n    .classed('progress-warning', !isStopped)\n    .attr('value', isStopped ? 1 : 1 - alpha)\n    .text(isStopped ? 1 : 1 - alpha);\n}\n\n\nfunction end() {\n  d3.select('#graph-contents').selectAll('.link')\n    .attr('transform', d => `translate(${d.source.x}, ${d.source.y})`)\n    .attr('visibility', 'visible');\n  d3.select('#graph-contents').selectAll('.edge-line')\n    .attr('x1', 0)\n    .attr('y1', 0)\n    .attr('x2', d => d.target.x - d.source.x)\n    .attr('y2', d => d.target.y - d.source.y);\n  d3.select('#graph-contents').selectAll('.edge-label')\n    .attr('x', d => (d.target.x - d.source.x) / 2)\n    .attr('y', d => (d.target.y - d.source.y) / 2);\n}\n\n\nexport default {\n  fieldWidth, fieldHeight, simulation, setForce, tick, end\n};\n","\nconst defaultNodeColor = {\n  id: 'color',\n  field: null,\n  scale: {\n    domain: [0, 1],\n    range: ['#7fffd4', '#7fffd4'],\n    scale: 'linear',\n    unknown: '#7fffd4'\n  }\n};\n\nconst defaultNodeSize = {\n  id: 'size',\n  field: null,\n  scale: {\n    domain: [0, 1],\n    range: [40, 40],\n    scale: 'linear',\n    unknown: 40\n  }\n};\n\nconst defaultNodeLabel = {\n  id: 'label',\n  text: null,\n  size: 12,\n  visible: false,\n  field: null,\n  scale: {\n    domain: [0, 1],\n    range: ['#000000', '#000000'],\n    scale: 'linear',\n    unknown: '#000000'\n  }\n};\n\nconst defaultNodeContent = {\n  structure: {visible: false}\n};\n\nconst defaultEdge = {\n  id: 'edge',\n  visible: true,\n  label: {\n    size: 10,\n    visible: false\n  },\n  scale: {\n    domain: [0, 1],\n    range: [5, 5],\n    scale: 'linear',\n    unknown: 5\n  }\n};\n\n\nexport default {\n  defaultNodeColor, defaultNodeSize, defaultNodeLabel, defaultNodeContent,\n  defaultEdge\n};\n","\nfunction graphNodes(selection, data) {\n  const nodes = selection.selectAll('.node')\n    .data(data, d => d.key);\n  nodes.exit().remove();\n  const entered = nodes.enter().append('g')\n    .attr('class', 'node');\n  entered.append('circle')\n    .attr('class', 'node-symbol');\n  entered.append('g')\n    .attr('class', 'node-struct');\n  entered.append('text')\n    .attr('class', 'node-label');\n  const updated = entered.merge(nodes);\n  updated.select('.node-struct')\n    .html(d => d._structure);\n  updated.select('.node-label')\n    .attr('x', 0)\n    .attr('text-anchor', 'middle');\n}\n\n\nfunction graphEdges(selection, data) {\n  const edges = selection.selectAll('.link')\n    .data(data, d => `${d.source}_${d.target}`);\n  edges.exit().remove();\n  const entered = edges.enter().append('g')\n    .attr('class', 'link');\n  entered.append('line')\n    .attr('class', 'edge-line');\n  entered.append('text')\n    .attr('class', 'edge-label');\n  const updated = entered.merge(edges);\n  updated.select('.edge-line')\n    .style('stroke', '#999')\n    .style('stroke-opacity', 0.6);\n  updated.select('.edge-label')\n    .attr('text-anchor', 'middle')\n    .text(d => d.weight);\n}\n\n\nexport default {\n  graphNodes, graphEdges\n};\n","\nimport jLouvain from 'jLouvain';\n\n\nexport function communityDetection(nodes, edges, option) {\n  // TODO: partition resolution setting\n  // TODO: Error at edges.length 0\n  const community = jLouvain().nodes(nodes).edges(edges)();\n  // assign null to singletons\n  if (option.nulliso) {\n    const clusters = {};\n    Object.entries(community).forEach(e => {\n      if (!clusters.hasOwnProperty(e[1])) {\n        clusters[e[1]] = [];\n      }\n      clusters[e[1]].push(e[0]);\n    });\n    Object.entries(clusters).forEach(e => {\n      if (e[1].length === 1) {\n        community[e[1][0]] = null;\n      }\n    });\n  }\n  return community;\n}\n\n\nexport default {\n  communityDetection\n};\n"],"names":["v07_to_v08_nodes","json","fields","columns","map","e","sortType","sort","id","name","dataType","dataTypeConv","format","schemaVersion","revision","status","statusConv","records","query","taskCount","searchCount","doneCount","searchDoneCount","resultCount","recordCount","progress","execTime","created","startDate","responseDate","v07_to_v08_edges","nodeFields","snp","fieldTransform","snapshot","nodePositions","nodeColor","nodeSize","nodeLabel","edge","hasOwnProperty","scale","field","find","key","column","domain","range","unknown","size","text","visible","nodeContent","structure","label","nodesID","nodeTableId","def","defaultFieldProperties","networkThreshold","v07_to_v08_convert","nodes","edges","readFile","file","sizeLimit","blob","Promise","resolve","reject","reader","FileReader","truncated","slice","onload","event","target","result","onerror","error","readAsArrayBuffer","readAsText","parseJSON","data","compressed","pako","inflate","to","JSON","parse","downloadDataFile","url","window","URL","createObjectURL","Blob","a","document","createElement","download","href","dispatchEvent","MouseEvent","view","bubbles","cancelable","singleToMulti","mapping","newMapping","Object","entries","forEach","m","updateTableAttribute","value","store","updateItem","item","catch","err","console","numericAsc","b","fa","parseFloat","fb","isNaN","String","localeCompare","textAsc","updateTableRecords","selection","rcds","keyFunc","header","select","selectAll","rowSelection","exit","remove","rowEntered","enter","append","d","merge","classed","html","i","undefined","valueType","digit","fmt","formatNum","each","d3","call","colorControlInput","d3form","optionData","preset","checked","push","labelControlInput","sizeControlInput","nodeSizeControlInput","nodeContentInput","edgeControlInput","updateNodeColor","style","d3scale","scaleFunction","updateNodeSize","attr","updateNodeLabelVisibility","updateNodeLabel","updateNodeStructure","nds","w","h","updateEdgeVisibility","updateEdgeLabelVisibility","updateEdge","weight","updateRange","length","property","updateScale","hasDomain","updateControl","colorControlBox","cmp","selectOptions","colorPresets","on","this","dispatch","colorPalette","scaleTypes","sizeControlBox","presets","sizeScaleTypes","unstickNodes","fx","fy","dragWithForce","takeSnapshot","x","y","zoomTransform","node","datum","saveSnapshot","win","URLQuery","then","info","resume","control","tf","transform","zoomIdentity","translate","k","interaction","zoom","updateNodeImage","getGraph","getTable","start","g","renderStatus","common","fetchResults","render","edgesToDraw","filter","logD","Math","log10","component","graphEdges","graphNodes","force","setForce","tick","end","stickNodes","dflt","defaultNodeColor","defaultNodeSize","defaultNodeLabel","defaultNodeContent","defaultEdge","restart","transition","duration","_mol","dialog","graphConfigDialog","threshold","thld","communityDialog","nodeIds","_index","visibleEdges","comm","community","communityDetection","nulliso","joinFields","mainControlBox","nodeColorControlBox","nodeSizeControlBox","nodeLabelControlBox","edgeControlBox","relax","t","loadNewGraph","interactiveInsert","location","selector","valueInt","parseInt","valueFloat","firstFile","files","checkboxValues","optionValues","textareaLines","split","si","checkboxData","categoryMany","schemeSet1","concat","schemeSet3","schemePastel2","schemeSet2","defaultSizeRange","schemeCategory20","sizePresets","edgeWidthPresets","func","scaleLinear","scaleLog","scaleQuantize","scaleOrdinal","sf","mid","includes","clamp","defaultHiddenFields","defaultSort","compound_id","assay_id","svg","plot","ec50","active%","inhibition%","filesize","numeric","count","int","flag","bool","timestamp","image","defaultDigit","ongoing","Queued","In progress","Aborting","Aborted","Completed","Failure","datatable","connection","loadJSON","endsWith","fetchJSON","decoded","decodeURIComponent","fetch","res","arrayBuffer","downloadJSON","compress","str","stringify","gzip","c","KArray","Array","[object Object]","reduce","prototype","apply","all","obj","kv","from","search","substring","toObject","getSDFPropList","re","uniqCols","Set","arr","exec","add","uuidv4","replace","r","random","toString","mappingToTable","mp","keyField","entry","rcd","f","tableToMapping","table","ignore","Date","row","csvToMapping","csvString","lines","shift","now","headerIdx","line","values","fd","unique","schema","app","items","resources","idb","Dexie","version","stores","where","equals","first","putAppSetting","v","put","toArray","putResources","bulkPut","getAllItems","orderBy","reverse","getItemsByDataType","type","sortBy","getItemById","tableId","callback","modify","deleteItem","delete","putItem","getAppSetting","setAppSetting","getResources","setResources","rsrcs","getAllTables","getTablesByDataType","setFieldProperties","updates","visibles","sortTypes","digits","mapper","insertTable","updateTable","assign","deleteTable","reset","conv","scientific","rounded","Number","partialMatch","toUpperCase","indexOf","numericDesc","textDesc","showPlot","vegaSpec","vega","View","initialize","run","plotThumbnail","toImageURL","options","checkboxList","entered","updated","checkboxListT","description","createTable","cols","appendTableRows","newRcds","addSort","isAsc","isNum","formatNumbers","col","colIdx","baseURL","get","q","keys","credentials","Error","statusText","response","post","formdata","method","body","pickDialog","ids","targets","fetcher","propDialog","extend","operator","structDialog","rdk","thldtype","source","queryMol","params","measure","ignoreHs","diameter","maxTreeSize","molSizeCutoff","timeout","command","sdfDialog","getElementById","misc","implh","recalc","formData","FormData","columnDialog","dataFields","fieldFetchDialog","compoundIDs","addEventListener","keyCode","preventDefault","dataKeys","resourceFields","match","selected","targetFields","fieldFileDialog","isCsv","pop","hfile","tbl","plotCols","ps","p","himg","img","graphDialog","currentThld","minThld","newThld","importConfirmDialog","found","$","modal","action","loader","navigator","debug","serviceWorker","register","reg","scope","server","local","serverStatus","clientInstance","instance","templates","compoundIDPlaceholder","rdkit","refresh_callback","abort_callback","dtx","initializeWithData","simulation","forceSimulation","forceLink","distance","strength","forceManyBody","distanceMin","distanceMax","forceCollide","radius","forceCenter","fieldWidth","fieldHeight","forceX","forceY","stop","links","alpha","isStopped","alphaMin","textCols","numCols","_structure","drag","active","alphaTarget","dragNoForce","connected","index","__data__","fitToScreen","option","jLouvain","clusters","click"],"mappings":"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"}