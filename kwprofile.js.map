{"version":3,"file":"kwprofile.js","sources":["../src/helper/formatValue.js","../src/helper/mapper.js","../src/store/StoreConnection.js","../src/helper/file.js","../src/component/Component.js","../src/common.js","../src/helper/d3Form.js","../src/helper/definition.js","../src/helper/KArray.js","../src/helper/window.js","../src/fetcher.js","../src/helper/misc.js","../src/store/IDBStore.js","../src/helper/image.js","../src/component/Dialog.js","../src/profile.js"],"sourcesContent":["\n/** @module helper/formatValue */\n\nimport d3 from 'd3';\n\n\n/**\n * Format number\n * @param {object} value - value\n * @param {string} type - si | scientific | rounded | raw\n */\nfunction formatNum(value, d3format) {\n  if (value === undefined || value === null || Number.isNaN(value)) return '';\n  return value == parseFloat(value) ? d3.format(d3format)(value) : value;\n}\n\nfunction partialMatch(query, target) {\n  if (target === undefined || target === null || target === '') return false;\n  return target.toString().toUpperCase()\n    .indexOf(query.toString().toUpperCase()) !== -1;\n}\n\nfunction numericAsc(a, b) {\n  const fa = parseFloat(a);\n  const fb = parseFloat(b);\n  if (isNaN(fa) || isNaN(fb)) {\n    return String(b).localeCompare(String(a));\n  }\n  return fb - fa;\n}\n\n\nfunction numericDesc(a, b) {\n  return numericAsc(b, a);\n}\n\n\nfunction textAsc(a, b) {\n  return String(b).localeCompare(String(a));\n}\n\n\nfunction textDesc(a, b) {\n  return textAsc(b, a);\n}\n\n\nexport default {\n  formatNum, partialMatch,\n  numericAsc, numericDesc, textAsc, textDesc\n};\n","\n/** @module helper/dataStructure */\n\nimport KArray from './KArray.js';\nimport {default as def} from './definition.js';\n\n\n/**\n * Convert single field mapping to multi field mapping\n * @param {object} mapping - single field mapping\n * @return {object} multi field mapping\n */\nfunction singleToMulti(mapping) {\n  const newMapping = {};\n  Object.entries(mapping.mapping).forEach(m => {\n    newMapping[m[0]] = [m[1]];\n  });\n  return {\n    created: mapping.created,\n    fields: [mapping.field],\n    key: mapping.key,\n    mapping: newMapping\n  };\n}\n\n\n/**\n * Convert field mapping to table\n * @param {object} mapping - field mapping\n * @return {object} table object\n */\nfunction mappingToTable(mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  const keyField = {key: mp.key, format: 'text'};\n  const data = {\n    fields: def.defaultFieldProperties([keyField].concat(mp.fields)),\n    records: Object.entries(mp.mapping).map(entry => {\n      const rcd = {};\n      rcd[mp.key] = entry[0];\n      mp.fields.forEach((f, i) => {\n        rcd[f.key] = entry[1][i];\n      });\n      return rcd;\n    })\n  };\n  return data;\n}\n\n\n/**\n * Convert table to field mapping\n * @param {object} table - table\n * @param {object} key - key\n * @return {object} field mapping\n */\nfunction tableToMapping(table, key, ignore=['index']) {\n  const now = new Date();\n  const mapping = {\n    created: now.toString(),\n    fields: def.defaultFieldProperties(table.fields\n      .filter(e => e.key !== key)\n      .filter(e => !ignore.includes(e.key))),\n    key: key,\n    mapping: {}\n  };\n  table.records.forEach(row => {\n    mapping.mapping[row[key]] = mapping.fields.map(e => row[e.key]);\n  });\n  return mapping;\n}\n\n\n/**\n * Convert csv text to field mapping\n * @param {string} csvString - csv data text\n * @return {object} field mapping\n */\nfunction csvToMapping(csvString) {\n  const lines = csvString.split(/\\n|\\r|\\r\\n/);\n  const header = lines.shift().split(',');\n  const key = header.shift();\n  const now = new Date();\n  const headerIdx = [];\n  const fields = [];\n  header.forEach((h, i) => {\n    if (h === '') return;\n    headerIdx.push(i);\n    fields.push({key: h, format: 'text'});\n  });\n  const mapping = {\n    created: now.toString(),\n    fields: def.defaultFieldProperties(fields),\n    key: key,\n    mapping: {}\n  };\n  lines.forEach(line => {\n    const values = line.split(',');\n    const k = values.shift();\n    mapping.mapping[k] = Array(headerIdx.length);\n    headerIdx.forEach(i => {\n      mapping.mapping[k][i] = values[i];\n    });\n  });\n  return mapping;\n}\n\n\n/**\n * Apply mapping to the data (in-place)\n * @param {object} data - datatable JSON\n * @param {object} mapping - mapping JSON\n * @return {undefined} undefined\n */\nfunction apply(data, mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  data.records\n    .filter(rcd => mp.mapping.hasOwnProperty(rcd[mp.key]))\n    .forEach(rcd => {\n      mp.fields.forEach((fd, i) => {\n        rcd[fd.key] = mp.mapping[rcd[mp.key]][i];\n      });\n    });\n  data.fields = def.defaultFieldProperties(\n    KArray.from(data.fields).concat(mp.fields).unique('key'));\n}\n\n\nexport default {\n  singleToMulti, mappingToTable, tableToMapping, csvToMapping, apply\n};\n","\nimport {default as def} from '../helper/definition.js';\nimport {default as mapper} from '../helper/mapper.js';\nimport {default as store} from './IDBStore.js';\n\n\nfunction getAppSetting(key) {\n  return store.getAppSetting(key)\n    .catch(err => {\n      console.error(`Unexpected key: ${key}`);\n      Promise.reject(err);\n    });\n}\n\n\nfunction setAppSetting(key, value) {\n  return store.putAppSetting(key, value)\n    .catch(err => {\n      console.error(`Unexpected key: ${key} or value: ${value}`);\n      Promise.reject(err);\n    });\n}\n\n\nfunction getResources() {\n  return store.getResources();\n}\n\n\nfunction setResources(rsrcs) {\n  return store.putResources(rsrcs)\n    .catch(err => {\n      console.error(`Unexpected resources: ${rsrcs}`);\n      Promise.reject(err);\n    });\n}\n\n\nfunction getAllTables() {\n  return store.getAllItems();\n}\n\n\nfunction getTablesByDataType(type) {\n  return store.getItemsByDataType(type)\n    .catch(err => {\n      console.error(`Unexpected dataType: ${type}`);\n      Promise.reject(err);\n    });\n}\n\n\nfunction getTable(id) {\n  return store.getItemById(id)\n    .catch(err => {\n      console.error(`Unexpected table ID: ${id}`);\n      Promise.reject(err);\n    });\n}\n\n\nfunction setFieldProperties(id, updates) {\n  return store.updateItem(id, item => {\n    item.fields.forEach((fd, i) => {\n      fd.visible = updates.visibles.includes(fd.key);\n      fd.format = updates.formats[i];\n      if (updates.d3_formats[i]) fd.d3_format = updates.d3_formats[i];\n    });\n    item.revision++;\n  })\n  .catch(err => {\n    console.error(`Unexpected table ID: ${id} or updates: ${updates}`);\n    Promise.reject(err);\n  });\n}\n\n\nfunction joinFields(id, mapping) {\n  return store.updateItem(id, item => {\n    mapper.apply(item, mapping);\n    item.revision++;\n  })\n  .catch(err => {\n    console.error(`Unexpected table ID: ${id} or mapping: ${mapping}`);\n    Promise.reject(err);\n  });\n}\n\n\nfunction updateTableAttribute(id, key, value) {\n  return store.updateItem(id, item => {\n    item[key] = value;\n    item.revision++;\n  })\n  .catch(err => {\n    console.error(`Unexpected table ID: ${id}, key: ${key} or value: ${value}`);\n    Promise.reject(err);\n  });\n}\n\n\nfunction insertTable(data) {\n  data.fields = def.defaultFieldProperties(data.fields);\n  return store.putItem(data)\n    .catch(err => {\n      console.error(`Unexpected data: ${data}`);\n      Promise.reject(err);\n    });\n}\n\n\nfunction updateTable(data) {\n  if (data.status === 'failure') {  // No data found on server\n    return updateTableAttribute(data.id, 'status', 'failure');\n  }\n  // update\n  return store.updateItem(data.id, item => {\n    data.fields = def.defaultFieldProperties(data.fields);\n    Object.assign(item, data);\n    item.revision++;\n  });\n}\n\n\nfunction deleteTable(id) {\n  return store.deleteItem(id)\n    .catch(err => {\n      console.error(`Unexpected table ID: ${id}`);\n      Promise.reject(err);\n    });\n}\n\n\nfunction reset() {\n  return store.reset();\n}\n\n\nexport default {\n  getAppSetting, setAppSetting, getResources, setResources,\n  getAllTables, getTablesByDataType, getTable,\n  setFieldProperties, joinFields,\n  updateTableAttribute, insertTable, updateTable,\n  deleteTable, reset\n};\n","\n/** @module helper/file */\n\nimport pako from 'pako';\n\nimport {default as def} from './definition.js';\n\nconst statusConv = {\n  Queued: 'ready',\n  'In progress': 'running',\n  Aborting: 'running',\n  Aborted: 'aborted',\n  Completed: 'done',\n  Failure: 'failure'\n};\n\nconst dataTypeConv = {\n  datatable: 'nodes',\n  connection: 'edges'\n};\n\nfunction v07_to_v08_nodes(json) {\n  const fields = json.columns.map(e => {\n    e.format = 'raw';\n    return e;\n  });\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    status: statusConv[json.status],\n    fields: fields,\n    records: json.records,\n    query: json.query,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n  };\n}\n\nfunction v07_to_v08_edges(json, nodeFields) {\n  const snp = {\n    fieldTransform: json.snapshot.fieldTransform,\n    nodePositions: json.snapshot.nodePositions,\n    nodeColor: {},\n    nodeSize: {},\n    nodeLabel: {},\n    edge: {}\n  };\n  if (json.snapshot.hasOwnProperty('nodeColor')) {\n    snp.nodeColor.id = json.snapshot.nodeColor.id;\n    snp.nodeColor.scale = json.snapshot.nodeColor.scale;\n    snp.nodeColor.field = nodeFields.find(e => e.key === json.snapshot.nodeColor.column);\n  } else {\n    snp.nodeColor = {\n      id: 'color', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeSize')) {\n    snp.nodeSize.id = json.snapshot.nodeSize.id;\n    snp.nodeSize.scale = json.snapshot.nodeSize.scale;\n    snp.nodeSize.field = nodeFields.find(e => e.key === json.snapshot.nodeSize.column);\n  } else {\n    snp.nodeSize = {\n      id: 'size', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: [20, 20], unknown: 20}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeLabel')) {\n    snp.nodeLabel.id = json.snapshot.nodeLabel.id;\n    snp.nodeLabel.size = json.snapshot.nodeLabel.size;\n    snp.nodeLabel.text = json.snapshot.nodeLabel.text;\n    snp.nodeLabel.visible = json.snapshot.nodeLabel.visible;\n    snp.nodeLabel.scale = json.snapshot.nodeLabel.scale;\n    snp.nodeLabel.field = nodeFields.find(e => e.key === json.snapshot.nodeLabel.column);\n  } else {\n    snp.nodeLabel = {\n      id: 'label', size: 12, text: 'index', visible: false, field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeContent')) {\n    snp.nodeContent = json.snapshot.nodeContent;\n  } else {\n    snp.nodeContent = {structure: {visible: false}};\n  }\n  if (json.snapshot.hasOwnProperty('edge')) {\n    snp.edge = json.snapshot.edge;\n  } else {\n    snp.edge = {\n      id: 'label', label: {size: 10, visible: false}, visible: true,\n      scale: {scale: 'linear', domain: [0, 1], range: [5, 5], unknown: 5}\n    };\n  }\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    reference: {\n      nodes: json.nodeTableId\n    },\n    status: statusConv[json.status],\n    fields: def.defaultFieldProperties([\n      {'key': 'source'},\n      {'key': 'target'},\n      {'key': 'weight'}\n    ]),\n    records: json.records,\n    query: json.query,\n    networkThreshold: json.networkThreshold,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n    snapshot: snp\n  };\n}\n\nfunction v07_to_v08_convert(json) {\n  if (json.hasOwnProperty('edges')) {\n    const nodes = v07_to_v08_nodes(json.nodes);\n    const edges = v07_to_v08_edges(json.edges, nodes.fields);\n    return {nodes: nodes, edges: edges};\n  } else {\n    return v07_to_v08_nodes(json);\n  }\n}\n\n\nfunction readFile(file, sizeLimit, blob) {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    const truncated = sizeLimit ? file.slice(0, sizeLimit) : file;\n    reader.onload = event => resolve(event.target.result);\n    reader.onerror = error => reject(error);\n    if (blob) {\n      reader.readAsArrayBuffer(truncated);\n    } else {\n      reader.readAsText(truncated);\n    }\n  });\n}\n\n\nfunction parseJSON(data, compressed) {\n  const text = compressed ? pako.inflate(data, {to: 'string'}) : data;\n  const json = JSON.parse(text);\n  if (json.hasOwnProperty('schemaVersion')) return json;\n  if (json.hasOwnProperty('edges')) {\n    if (json.edges.hasOwnProperty('schemaVersion')) {\n      if (!json.edges.hasOwnProperty('reference')) { // ver0.8.0-0.8.1\n        json.edges.reference = {nodes: json.edges.nodesID};\n        const idx_converter = {};\n        json.nodes.records.forEach((e, i) => {\n            e.index = i;\n            e.structure = e._structure;\n            idx_converter[e._index] = e.index;\n            delete e._index;\n            delete e._structure;\n        });\n        json.edges.records.forEach(e => {\n            e.source = idx_converter[e.source];\n            e.target = idx_converter[e.target];\n        });\n        json.nodes.fields.forEach(e => {\n          if (e.key === '_index') e.key = 'index';\n          if (e.key === '_structure') e.key = 'structure';\n        });\n        json.edges.snapshot.nodeColor.field.key = 'index';\n        json.edges.snapshot.nodeLabel.field.key = 'index';\n        json.edges.snapshot.nodeSize.field.key = 'index';\n      }\n      return json;\n    }\n  }\n  return v07_to_v08_convert(json);\n}\n\n\nfunction loadJSON(file) {\n  const compressed = file.name.endsWith('c') || file.name.endsWith('.gz');\n  return readFile(file, false, compressed)\n    .then(data => parseJSON(data, compressed));\n}\n\n\nfunction fetchJSON(url) {\n  const decoded = decodeURIComponent(url);\n  const compressed = decoded.endsWith('c') || decoded.endsWith('.gz');\n  return fetch(decoded)\n    .then(res => compressed ? res.arrayBuffer() : res.json())\n    .then(data => parseJSON(data, compressed));\n}\n\n\nfunction downloadDataFile(data, name) {\n  try {\n    // cannot hundle large file with dataURI scheme\n    // url = 'data:application/json,' + encodeURIComponent(JSON.stringify(json))\n    const url = window.URL.createObjectURL(new Blob([data]));\n    const a = document.createElement('a');\n    a.download = name;\n    a.href = url;\n    // a.click() does not work on firefox\n    a.dispatchEvent(new MouseEvent('click', {\n      'view': window,\n      'bubbles': true,\n      'cancelable': false\n    }));\n    // window.URL.revokeObjectURL(url) does not work on firefox\n  } catch (e) {\n    // no DOM (unit testing)\n  }\n}\n\n\nfunction downloadJSON(json, name, compress=true) {\n  const str = JSON.stringify(json);\n  const data = compress ? pako.gzip(str) : str;\n  const c = compress ? 'c' : 'r';\n  const ext = json.hasOwnProperty('edges') ? `.gf${c}` :  `.nd${c}`;\n  downloadDataFile(data, `${name}${ext}`);\n}\n\n\nexport default {\n  readFile, parseJSON, loadJSON, fetchJSON,\n  downloadDataFile, downloadJSON\n};\n","\n/** @module component/Component */\n\nimport d3 from 'd3';\nimport {default as def} from '../helper/definition.js';\nimport {default as fmt} from '../helper/formatValue.js';\n\n\nfunction selectOptions(selection, data, key, text) {\n  const options = selection.selectAll('option')\n    .data(data, key);\n  options.exit().remove();\n  options.enter().append('option')\n    .merge(options)\n      .attr('value', key)\n      .text(text);\n}\n\n\nfunction checkboxList(selection, data, name, key, text) {\n  const items = selection.selectAll('li').data(data, key);\n  items.exit().remove();\n  const entered = items.enter().append('li')\n    .attr('class', 'form-check')\n    .append('label');\n  entered.append('input');\n  entered.append('span');\n  const updated = entered.merge(items.select('label'))\n    .attr('class', 'form-check-label');\n  updated.select('input')\n    .attr('type', 'checkbox')\n    .attr('class', 'form-check-input')\n    .attr('name', name)\n    .attr('value', key);\n  updated.select('span')\n    .text(text);\n}\n\n\n// checkbox list with tooltip\n// call $('[data-toggle=\"tooltip\"]').tooltip() after this function\nfunction checkboxListT(selection, data, name, key, text) {\n  const items = selection.selectAll('li').data(data, key);\n  items.exit().remove();\n  const entered = items.enter().append('li')\n    .attr('class', 'form-check')\n    .append('label');\n  entered.append('input');\n  entered.append('a');\n  const updated = entered.merge(items.select('label'))\n    .attr('class', 'form-check-label');\n  updated.select('input')\n    .attr('type', 'checkbox')\n    .attr('class', 'form-check-input')\n    .attr('name', name)\n    .attr('value', key);\n  updated.select('a')\n    .attr('data-toggle', 'tooltip')\n    .attr('data-placement', 'bottom')\n    .attr('title', d => d.description || 'No')\n    .text(text);\n}\n\n\nfunction createTable(selection, data) {\n  // Header\n  if (selection.select('thead').size()) selection.select('thead').remove();\n  selection.append('thead').append('tr');\n  // Records\n  if (selection.select('tbody').size()) selection.select('tbody').remove();\n    selection.append('tbody');\n\n  const cols = data.fields.filter(e => e.visible);\n  const header = selection.select('thead tr').selectAll('th')\n    .data(cols, d => d.key);\n  header.exit().remove();\n  header.enter().append('th')\n    .merge(header)\n      .text(d => d.name);\n}\n\n\nfunction updateTableRecords(selection, rcds, keyFunc) {\n  const header = selection.select('thead tr').selectAll('th')\n    .data();\n  const rowSelection = selection.select('tbody').selectAll('tr')\n    .data(rcds, keyFunc);\n  rowSelection.exit().remove();\n  const rowEntered = rowSelection.enter().append('tr');\n  rowEntered.selectAll('td')\n    .data(d => header.map(e => d[e.key]))\n    .enter().append('td');\n  rowEntered.merge(rowSelection)\n    .selectAll('td')\n      .classed('align-middle', true)\n    .html(function (d, i) {\n      if (d === undefined) return '';\n      if (header[i].format === 'd3_format') {\n        return fmt.formatNum(d, header[i].d3_format);\n      }\n      if (header[i].format === 'plot') return '[plot]';\n      if (header[i].format === 'image') return '[image]';\n      if (header[i].format === 'control') return;\n      return d;\n    })\n    .each((d, i, nodes) => {\n      // This should be called after html\n      if (header[i].format === 'control') d3.select(nodes[i]).call(d);\n    });\n}\n\n\nfunction appendTableRows(selection, rcds, keyFunc) {\n  const newRcds = selection.select('tbody').selectAll('tr').data();\n  Array.prototype.push.apply(newRcds, rcds);\n  updateTableRecords(selection, newRcds, keyFunc);\n}\n\n\nfunction addSort(selection) {\n  selection.select('thead tr').selectAll('th')\n    .filter(d => def.sortType(d.format) !== 'none')\n    .append('span').append('a')\n      .attr('id', d => `sort-${d.key}`)\n      .text('^v')\n      .style('display', 'inline-block')\n      .style('width', '30px')\n      .style('text-align', 'center')\n    .on('click', d => {\n      const isAsc = d3.select(`#sort-${d.key}`).text() === 'v';\n      const isNum = def.sortType(d.format) === 'numeric';\n      const cmp = isAsc\n        ? (isNum ? fmt.numericAsc : fmt.textAsc)\n        : (isNum ? fmt.numericDesc : fmt.textDesc);\n      selection.select('tbody').selectAll('tr')\n        .sort((a, b) => cmp(a[d.key], b[d.key]));\n      d3.select(`#sort-${d.key}`)\n        .text(isAsc ? '^' : 'v');\n    });\n}\n\n\nfunction formatNumbers(selection) {\n  // DEPRECATED: no longer used\n  selection.select('thead tr').selectAll('th')\n    .each((col, colIdx) => {\n      if (col.digit === 'raw') return;\n      selection.select('tbody').selectAll('tr')\n        .selectAll('td')\n          .filter((d, i) => i === colIdx)\n          .text(d => fmt.formatNum(d, col.digit));\n    });\n}\n\n\nexport default {\n  selectOptions, checkboxList, checkboxListT,\n  createTable, updateTableRecords,\n  appendTableRows, addSort, formatNumbers\n};\n","\nimport {default as def} from './helper/definition.js';\nimport {default as win} from './helper/window.js';\nimport {default as misc} from './helper/misc.js';\nimport {default as store} from './store/StoreConnection.js';\nimport {default as dialog} from './component/Dialog.js';\nimport {default as fetcher} from './fetcher.js';\n\n\nfunction interactiveInsert(data) {\n  return store.getTable(data.id)\n    .then(found => {\n      if (!found) return Promise.resolve(data); // no existing table\n      if (data.revision == found.revision) return Promise.reject(data.id); // same revision\n      // data id conflict\n      $('#importconfirm-dialog').modal('toggle');\n      return new Promise(res => {\n        dialog.importConfirmDialog(action => {\n          if (action === 'overwrite') {\n            res(data);\n          }\n          if (action === 'keepboth') {\n            data.id = misc.uuidv4();\n            res(data);\n          }\n        });\n      });\n    })\n    .then(\n      data => store.insertTable(data).then(() => data.id), // insert or update table\n      id => {\n        if (id) return Promise.resolve(id); // same revision -> call existing table\n        return Promise.reject();\n      }\n    );\n}\n\n\nfunction fetchResults(command='update') {\n  return store.getTable(win.URLQuery().id)\n    .then(data => {\n      if (!def.ongoing(data)) return Promise.reject();\n      return data;\n    })\n    .then(data => {\n      const query = {id: data.id, command: command};\n      return fetcher.get('res', query)\n        .then(fetcher.json)\n        .then(store.updateTable, fetcher.error);\n    }, () => Promise.resolve());\n}\n\n\nfunction registerServiceWorker() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker\n      .register('sw.js')\n      .then(reg => {\n        console.info('ServiceWorker registration successful with scope: ', reg.scope);\n      }).catch(err => {\n        console.info('ServiceWorker registration failed: ', err);\n      });\n  } else {\n    console.info('Off-line mode is not supported');\n  }\n}\n\n\nfunction loader() {\n  /*\n  if (document.location.protocol === \"file:\") {\n    console.info('Off-line mode (local file)');\n    store.setGlobalConfig('onLine', false);\n    return Promise.resolve();\n  }\n  if ('onLine' in navigator) {\n    if (!navigator.onLine) {\n      console.info('Off-line mode (no internet connection)');\n      store.setGlobalConfig('onLine', false);\n      return Promise.resolve();\n    }\n  }*/\n  const server = fetcher.get('server')\n    .then(fetcher.json)\n    .catch(() => null);\n  const local = store.getAppSetting('serverInstance');\n  return Promise.all([server, local]).then(ps => {\n    const serverStatus = ps[0];\n    const clientInstance = ps[1];\n    if (!serverStatus) return Promise.resolve(null);\n    if (!serverStatus.debugMode) {\n      registerServiceWorker();\n    } else {\n      console.info('Off-line mode is disabled for debugging');\n    }\n    if (serverStatus.instance === clientInstance) {\n      console.info('Resource schema is already up to date');\n      return Promise.resolve(serverStatus);\n    } else {\n      return fetcher.get('schema')\n        .then(fetcher.json)\n        .then(schema => {\n          console.info(`New resource schema version: ${serverStatus.instance}`);\n          return Promise.all([\n            store.setResources(schema.resources),\n            store.setAppSetting('templates', schema.templates),\n            store.setAppSetting(\n              'compoundIDPlaceholder', schema.compoundIDPlaceholder),\n              store.setAppSetting(\n                'defaultDataType', schema.defaultDataType),\n            store.setAppSetting('serverInstance', serverStatus.instance),\n            store.setAppSetting('rdkit', serverStatus.rdkit)\n          ])\n          .then(() => Promise.resolve(serverStatus));\n        }, fetcher.error);\n    }\n  });\n}\n\n\nexport default {\n  interactiveInsert, fetchResults, registerServiceWorker, loader\n};\n","\n/** @module helper/d3Form */\n\nimport d3 from 'd3';\n\n\nfunction value(selector) {\n  return d3.select(selector).node().value;\n}\n\n\nfunction valueInt(selector) {\n  return parseInt(d3.select(selector).node().value);\n}\n\n\nfunction valueFloat(selector) {\n  return parseFloat(d3.select(selector).node().value);\n}\n\n\nfunction checked(selector) {\n  return d3.select(selector).node().checked;\n}\n\n\nfunction firstFile(selector) {\n  return d3.select(selector).node().files[0];\n}\n\n\nfunction inputValues(selector) {\n  return d3.selectAll(selector).selectAll('input').nodes().map(e => e.value);\n}\n\n\nfunction checkboxValues(selector) {\n  return d3.selectAll(selector).selectAll('input:checked').nodes().map(e => e.value);\n}\n\n\nfunction optionValues(selector) {\n  return d3.selectAll(selector).selectAll('select').nodes().map(e => e.value);\n}\n\n\nfunction textareaLines(selector) {\n  return d3.select(selector).node().value.split('\\n').filter(e => e.length > 0);\n}\n\n\nfunction optionData(selector) {\n  const si = d3.select(selector).property('selectedIndex');\n  return d3.select(selector).selectAll('option').data().find((d, i) => i === si);\n}\n\n\nfunction checkboxData(selector) {\n  return d3.selectAll(selector).selectAll('input:checked').data();\n}\n\n\nexport default {\n  value, valueInt, valueFloat, checked,\n  firstFile, inputValues, checkboxValues, optionValues, textareaLines,\n  optionData, checkboxData\n};\n","\n/** @module helper/definition */\n\n\nfunction defaultFieldProperties(fields) {\n  return fields.map(e => {\n    if (!e.hasOwnProperty('name')) e.name = e.key;\n    if (!e.hasOwnProperty('visible')) e.visible = true;\n    if (e.hasOwnProperty('d3_format')) e.format = 'd3_format';\n    if (!e.hasOwnProperty('format')) e.format = 'raw';\n    return e;\n  });\n}\n\n\nfunction sortType(fmt) {\n  if (['numeric', 'd3_format'].includes(fmt)) return 'numeric';\n  if (['text', 'compound_id'].includes(fmt)) return 'text';\n  return 'none';\n}\n\n\nfunction ongoing(data) {\n  return ['running', 'ready'].includes(data.status);\n}\n\n\nexport default {\n  defaultFieldProperties, sortType, ongoing\n};\n","\n\nclass KArray extends Array {\n  /**\n   * Return array of object filtered by given unique key\n   */\n  unique(key) {\n    return this.reduce((a, b) => {\n      if (a.find(e => e[key] === b[key]) === undefined) a.push(b);\n      return a;\n    }, new KArray());\n  }\n\n\n  /**\n   * Merge arrays\n   */\n  extend() {\n    return this.reduce((a, b) => {\n      Array.prototype.push.apply(a, b);\n      return a;\n    }, new KArray());\n  }\n\n\n  // Merge arrays(Asynchronous)\n  extendAsync() {\n    return Promise.all(this).then(res => {\n      return res.reduce((a, b) => {\n        Array.prototype.push.apply(a, b);\n        return a;\n      }, new KArray());\n    });\n  }\n\n  toArray() {\n    return new Array(this);\n  }\n\n  toObject() {\n    const obj = {};\n    this.forEach(kv => {\n      obj[kv[0]] = kv[1];\n    });\n    return obj;\n  }\n}\n\nexport default KArray;\n","\nimport KArray from './KArray.js';\n\n\nfunction URLQuery() {\n  return KArray.from(window.location.search.substring(1).split(\"&\"))\n    .map(e => e.split('=')).toObject();\n}\n\n\nexport default {\n  URLQuery\n};\n","\nconst baseURL = '';\n\nfunction get(url, query={}) {\n  const isEmpty = Object.keys(query).length;\n  const q = isEmpty ? `?query=${JSON.stringify(query)}` : '';\n  return fetch(\n    `${baseURL}${url}${q}`,\n    {\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\nfunction json(response) {\n  return response.json();\n}\n\nfunction text(response) {\n  return response.text();\n}\n\nfunction blob(response) {\n  return response.blob();\n}\n\nfunction post(url, formdata) {\n  return fetch(\n    `${baseURL}${url}`,\n    {\n      method: 'POST',\n      body: formdata,\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\n\nfunction error(err) {\n  console.error(err);\n  return null;\n}\n\n\nexport default {\n  get, json, text, blob, post, error\n};\n","\n/** @module helper/parser */\n\nfunction getSDFPropList(str) {\n  const re = />.*?<(\\S+)>/g;\n  const uniqCols = new Set();\n  let arr;\n  while ((arr = re.exec(str)) !== null) {\n    uniqCols.add(arr[1]);\n  }\n  return Array.from(uniqCols);\n}\n\n// Ref. https://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript\nfunction uuidv4() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n    var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\n    return v.toString(16);\n  });\n}\n\n// TODO: not used\nfunction queryFormData(query) {\n  const formData = new FormData();\n  Object.entries(query).forEach(kv => {\n    if (Array.isArray(kv[1])) {\n      kv[1].forEach(e => formData.append(kv[0], e));\n    } else {\n      formData.set(kv[0], kv[1]);\n    }\n  });\n  return formData;\n}\n\n\n// TODO: not used\nfunction queryURL(query) {\n  const queryStr = [];\n  Object.entries(query).forEach(e => {\n    const val = Array.isArray(e[1]) ? JSON.stringify(e[1]) : e[1];\n    const key = e[0];\n    // const encoded = encodeURIComponent(val);\n    queryStr.push(`${key}=${val}`);\n  });\n  return queryStr.join('&');\n}\n\n\n// TODO: not used\nfunction capitalized(str) {\n  return str.replace(/(?:^|\\s)\\S/g, e => e.toUpperCase());\n}\n\n\nexport default {\n  getSDFPropList, uuidv4\n};\n","\nimport Dexie from 'Dexie';\n\n// TODO: can indexed records improve query performance ?\n\nconst schema = {\n  app: 'key',\n  items: 'id, dataType, created',\n  resources: 'id'\n};\n\nlet idb = new Dexie('Store');\nidb.version(1).stores(schema);\n\n\nfunction getAppSetting(key) {\n  return idb.app.where('key').equals(key).first()\n    .then(res => {\n      if (res === undefined) return undefined;\n      return res.value;\n    });\n}\n\n\nfunction putAppSetting(k, v) {  // returns id in success\n  return idb.app.put({ key: k, value: v });\n}\n\n\nfunction getResources() {\n  return idb.resources.toArray();\n}\n\n\nfunction putResources(data) { // returns last id in success\n  return idb.resources.bulkPut(data);\n}\n\n\nfunction getAllItems() {\n  return idb.items.orderBy('created').reverse()\n    .toArray();\n}\n\n\nfunction getItemsByDataType(type) {\n  return idb.items.where('dataType').equals(type).reverse()\n    .sortBy('created');\n}\n\n\nfunction getItemById(tableId) {\n  return idb.items.where('id').equals(tableId).first();\n}\n\n\nfunction updateItem(tableId, callback) {  // returns num of updated items\n  return idb.items.where('id').equals(tableId).modify(callback);\n}\n\n\nfunction deleteItem(tableId) { // returns num of deleted items\n  return idb.items.where('id').equals(tableId).delete();\n}\n\n\nfunction putItem(data) { // returns id in success\n  return idb.items.put(data);\n}\n\n\nfunction reset() {\n  // Try this before tackling with local db troubles\n  return idb.delete().then(() => {\n    idb = new Dexie('Store');\n    idb.version(1).stores(schema);\n  });\n}\n\nexport default {\n  getAppSetting, putAppSetting, getResources, putResources,\n  getAllItems, getItemsByDataType, getItemById,\n  updateItem, deleteItem, putItem, reset\n};\n","\n/** @module helper/image */\n\nimport vega from 'vega';\n\nfunction showPlot(vegaSpec, selector) {\n  new vega.View(vega.parse(vegaSpec))\n    .initialize(selector)\n    .run();\n}\n\n\nfunction plotThumbnail(vegaSpec) {\n  const view = new vega.View(vega.parse(vegaSpec));\n  return view.toImageURL('png');  // Promise\n}\n\n\nexport default {\n  showPlot, plotThumbnail\n};\n","\n/** @module component/Dialog */\n\nimport d3 from 'd3';\n\nimport KArray from '../helper/KArray.js';\nimport {default as d3form} from '../helper/d3Form.js';\nimport {default as mapper} from '../helper/mapper.js';\nimport {default as def} from '../helper/definition.js';\nimport {default as fmt} from '../helper/formatValue.js';\nimport {default as win} from '../helper/window.js';\nimport {default as hfile} from '../helper/file.js';\nimport {default as misc} from '../helper/misc.js';\nimport {default as himg} from '../helper/image.js';\nimport {default as store} from '../store/StoreConnection.js';\nimport {default as cmp} from './Component.js';\nimport {default as fetcher} from '../fetcher.js';\n\n\nfunction pickDialog(resources, callback) {\n  store.getAppSetting('compoundIDPlaceholder').then(ids => {\n    d3.select('#pick-queryarea').text(ids);\n  });\n  d3.select('#pick-submit')\n    .on('click', () => {\n      d3.select('#loading-icon').style('display', 'inline');\n      const query = {\n        type: 'chemsearch',\n        targets: resources.filter(e => e.domain === 'chemical').map(e => e.id),\n        key: 'compound_id',\n        values: d3form.textareaLines('#pick-queryarea')\n      };\n      return fetcher.get('run', query)\n        .then(fetcher.json)\n        .then(callback, fetcher.error);\n    });\n}\n\n\nfunction propDialog(resources, callback) {\n  d3.select('#prop-targets')\n    .call(cmp.checkboxList, resources, 'targets', d => d.id, d => d.name)\n    .on('change', function () {\n      const cols = KArray.from(d3form.checkboxData('#prop-targets'))\n        .map(d => d.fields)\n        .extend().unique('key');\n      d3.select('#prop-key')\n        .call(cmp.selectOptions, cols, d => d.key, d => d.name);\n    });\n  d3.select('#prop-submit')\n    .on('click', () => {\n      d3.select('#loading-circle').style('display', 'inline');\n      const query = {\n        type: 'chemprop',\n        targets: d3form.checkboxValues('#prop-targets'),\n        key: d3form.optionData('#prop-key').key,\n        values: d3form.textareaLines('#prop-queryarea'),\n        operator: d3form.value('#prop-operator')\n      };\n      return fetcher.get('async', query)\n        .then(fetcher.json)\n        .then(callback, fetcher.error);\n    });\n}\n\n\nfunction structDialog(resources, callback) {\n  d3.select('#struct-qsrc')\n    .call(cmp.selectOptions, resources, d => d.id, d => d.name);\n  d3.select('#struct-targets')\n    .call(cmp.checkboxList, resources, 'targets', d => d.id, d => d.name);\n  store.getAppSetting('rdkit').then(rdk => {\n    d3.select('#struct-method').selectAll('option.rd')\n      .attr('disabled', rdk ? null : 'disabled');\n  });\n  d3.selectAll('#struct-method,#struct-thldtype')\n    .on('change', function () {\n      const method = d3form.value('#struct-method');\n      const thldtype = d3form.value('#struct-thldtype');\n      d3.select('#struct-thld')\n        .attr('disabled', ['gls', 'rdmorgan', 'rdfmcs'].includes(method) ? null : 'disabled')\n        .attr('value', thldtype === 'edge' ? 15 : 0.7)\n        .attr('min', thldtype === 'edge' ? 5 : 0)\n        .attr('max', thldtype === 'edge' ? 999 : 1.0)\n        .attr('step', thldtype === 'edge' ? 1 : 0.01);\n      d3.select('#struct-thldtype')\n        .attr('disabled', ['gls', 'rdmorgan', 'rdfmcs'].includes(method) ? null : 'disabled')\n        .property('value', ['gls', 'rdfmcs'].includes(method) ? undefined : 'sim');\n      d3.select('#struct-thldtype option.sim')\n        .attr('disabled', ['gls', 'rdmorgan', 'rdfmcs'].includes(method) ? null : 'disabled');\n      d3.select('#struct-thldtype option.edge')\n        .attr('disabled', ['gls', 'rdfmcs'].includes(method) ? null : 'disabled');\n      d3.select('#struct-options').selectAll('.gls')\n        .attr('disabled', method === 'gls' ? null : 'disabled');\n      d3.select('#struct-options .fmcs')\n        .attr('disabled', method === 'rdfmcs' ? null : 'disabled');\n    })\n    .dispatch('change');\n  d3.select('#struct-format')\n    .on('change', function () {\n      d3.select('#struct-qsrc')\n        .attr('disabled', this.value === 'dbid' ? null : 'disabled');\n    });\n  d3.select('#struct-preview')\n    .on('click', () => {\n      const f = d3form.value('#struct-format');\n      const query = {\n        format: f,\n        source: f === 'dbid' ? d3form.value('#struct-qsrc') : null,\n        value: f === 'molfile'\n          ? d3form.value('#struct-queryarea') : d3form.textareaLines('#struct-queryarea')[0],\n      };\n      return fetcher.get('strprev', query)\n        .then(fetcher.text)\n        .then(res => d3.select('#struct-image').html(res), fetcher.error);\n    });\n  d3.select('#struct-submit')\n    .on('click', () => {\n      const method = d3form.value('#struct-method');\n      d3.select('#loading-circle').style('display', 'inline');\n      const f = d3form.value('#struct-format');\n      const query = {\n        type: d3form.value('#struct-method'),\n        targets: d3form.checkboxValues('#struct-targets'),\n        queryMol: {\n          format: f,\n          source: f === 'dbid' ? d3form.value('#struct-qsrc') : null,\n          value: f === 'molfile'\n            ? d3form.value('#struct-queryarea') : d3form.textareaLines('#struct-queryarea')[0]\n        },\n        params: {\n          measure: d3form.value('#struct-thldtype'),\n          threshold: d3form.valueFloat('#struct-thld'),\n          ignoreHs: d3form.checked('#struct-ignoreh'),\n          diameter: method === 'gls' ? d3form.valueInt('#struct-diam') : null,\n          maxTreeSize: method === 'gls' ? d3form.valueInt('#struct-tree') : null,\n          molSizeCutoff: method === 'gls' ? d3form.valueInt('#struct-skip') : null,\n          timeout: method === 'rdfmcs' ? d3form.valueInt('#struct-timeout') : null\n        }\n      };\n      const command = query.type === 'exact' ? 'run' : 'async';\n      return fetcher.get(command, query)\n        .then(fetcher.json)\n        .then(callback, fetcher.error);\n    });\n}\n\n\nfunction sdfDialog(callback) {\n  d3.select('#sdf-file')\n    .on('change', () => {\n      const reader = new FileReader();\n      const file = document.getElementById('sdf-file').files[0];\n      reader.onload = (e) => {\n        d3.select('#sdf-cols')\n          .call(cmp.checkboxList, misc.getSDFPropList(e.target.result),\n                'fields', d => d, d => d\n          );\n      };\n      // Scan only first 100mb of the file due to memory limit.\n      reader.readAsText(file.slice(0, 100 * 1024 * 1024));\n    });\n  d3.select('#sdf-selectall')\n    .on('change', () => {\n      d3.select('#sdf-cols').selectAll('input')\n        .property('checked', d3form.checked('#sdf-selectall'));\n    });\n  d3.select('#sdf-submit')\n    .on('click', () => {\n      d3.select('#loading-circle').style('display', 'inline');\n      const params = {\n        fields: d3form.checkboxValues('#sdf-cols'),\n        implh: d3form.checked('#sdf-implh'),\n        recalc: d3form.checked('#sdf-recalc')\n      };\n      const formData = new FormData();\n      formData.append('contents', d3form.firstFile('#sdf-file'));\n      formData.append('params', JSON.stringify(params));\n      return fetcher.post('sdfin', formData)\n        .then(fetcher.json)\n        .then(callback, fetcher.error);\n    });\n}\n\n\nfunction columnDialog(dataFields, callback) {\n  const table = {\n    fields: def.defaultFieldProperties([\n      {key: 'name', format: 'text'},\n      {key: 'visible', format: 'control'},\n      {key: 'format', format: 'control'},\n      {key: 'd3_format', format: 'control'}\n    ])\n  };\n  const records = dataFields.map(e => {\n    const rcd = {};\n    const generalFormat = ['text', 'numeric', 'd3_format', 'raw', 'compound_id'];\n    rcd.name = e.name;\n    rcd.visible = selection => selection\n        .classed('column-vis', true)\n        .classed(`row-${e.key}`, true)\n      .append('input')\n        .attr('type', 'checkbox')\n        .attr('value', e.key)\n        .property('checked', e.visible);\n    rcd.format = selection => selection\n        .classed('column-format', true)\n        .classed(`row-${e.key}`, true)\n      .append('select')\n        .call(cmp.selectOptions,\n              generalFormat.includes(e.format) ? generalFormat : [e.format],\n              d => d, d => d)\n        .attr('disabled', generalFormat.includes(e.format) ? null : 'disabled')\n        .property('value', e.format)\n        .on('change', function () {\n          d3.select(`.column-d3f.row-${e.key} input`)\n            .attr('disabled', this.value === 'd3_format' ? null : 'disabled');\n        });\n    rcd.d3_format = selection => selection\n        .classed('column-d3f', true)\n        .classed(`row-${e.key}`, true)\n      .append('input')\n        .attr('size', 10)\n        .attr('disabled', e.format === 'd3_format' ? null : 'disabled')\n        .property('value', e.d3_format);\n    return rcd;\n  });\n  d3.select('#column-table')\n    .call(cmp.createTable, table)\n    .call(cmp.updateTableRecords, records, d => d.key);\n  d3.select('#column-submit')\n    .on('click', () => {\n      const query = {\n        visibles: d3form.checkboxValues('.column-vis'),\n        formats: d3form.optionValues('.column-format'),\n        d3_formats: d3form.inputValues('.column-d3f')\n      };\n      return store.setFieldProperties(win.URLQuery().id, query)\n        .then(callback);\n    });\n}\n\n\n// TODO:\nfunction fieldFetchDialog(compoundIDs, dataFields, resources, callback) {\n  // Prevent implicit submission\n  document.getElementById('join-search')\n    .addEventListener('keypress', event => {\n      if (event.keyCode === 13) event.preventDefault();\n    });\n  const dataKeys = dataFields.map(e => e.key);\n  const resourceFields = KArray.from(resources.map(e => e.fields))\n    .extend().unique('key').filter(e => e.key !== 'id');\n  d3.select('#join-keys')\n    .call(cmp.checkboxList, resourceFields, 'keys', d => d.key, d => d.name)\n    .selectAll('li')\n    .each(function(d) { // disable already shown columns\n      d3.select(this).selectAll('label').select('input')\n        .property('checked', dataKeys.includes(d.key))\n        .attr('disabled', dataKeys.includes(d.key) ? 'disabled' : null);\n    });\n  d3.select('#join-search')\n    .on('keyup', function () {\n      const match = d => fmt.partialMatch(d3form.value(this), d.name);\n      d3.select('#join-keys').selectAll('li')\n        .style('visibility', d => match(d) ? null : 'hidden')\n        .style('position', d => match(d) ? null : 'absolute');\n    });\n  d3.select('#join-submit')\n    .on('click', () => {\n      d3.select('#loading-circle').style('display', 'inline');\n      const selected = d3form.checkboxValues('#join-keys');\n      const queryFieldKeys = resourceFields.map(e => e.key)\n        .filter(e => !dataKeys.includes(e))\n        .filter(e => selected.includes(e));\n      const query = {\n        type: 'fieldfilter',\n        targetFields: queryFieldKeys,\n        key: 'compound_id',\n        values: compoundIDs\n      };\n      return fetcher.get('run', query)\n        .then(fetcher.json)\n        .then(json => callback(mapper.tableToMapping(json, 'id')),\n              fetcher.error);\n  });\n}\n\n\nfunction fieldFileDialog(callback) {\n  // TODO: need to refactor\n  d3.select('#importcol-file')\n    .on('change', () => {\n      const file = document.getElementById('importcol-file').files[0];\n      const isCsv = file.name.split('.').pop() === 'csv';\n      hfile.readFile(file).then(res => {\n        const mapping = isCsv ? mapper.csvToMapping(res) : JSON.parse(res);\n        const tbl = mapper.mappingToTable(mapping);\n        d3.select('#importcol-preview').call(cmp.createTable, tbl)\n          .call(cmp.updateTableRecords,\n                tbl.records.slice(0, 5), d => d[tbl.fields[0].key]);\n        // bind mapping\n        d3.select('#importcol-preview').datum(mapping);\n      });\n    });\n  d3.select('#importcol-submit')\n    .on('click', () => {\n      let mapping = d3.select('#importcol-preview').datum();\n      d3.select('#importcol-preview').datum(null);  // unbind mapping\n      // Generate thumbnails\n      const plotCols = [];\n      if (mapping.hasOwnProperty('field')) {\n        mapping = mapper.singleToMulti(mapping);\n      }\n      mapping.fields.forEach((e, i) => {\n        if (e.format === 'plot') {\n          mapping.fields[i].format = 'image';\n          plotCols.push(i);\n        }\n      });\n      if (plotCols.length > 0) {\n        const ps = [];\n        Object.entries(mapping.mapping).forEach(m => {\n          plotCols.forEach(e => {\n            const p = himg.plotThumbnail(m[1][e])\n              .then(img => {\n                mapping.mapping[m[0]][e] = img;\n              });\n            ps.push(p);\n          });\n        });\n        Promise.all(ps).then(() => callback(mapping));\n      } else {\n        callback(mapping);\n      }\n    });\n}\n\n\nfunction graphDialog(callback) {\n  store.getAppSetting('rdkit').then(rdk => {\n    d3.select('#graph-measure').selectAll('option.rd')\n      .attr('disabled', rdk ? null : 'disabled');\n  });\n  d3.select('#graph-measure')\n    .on('change', function () {\n      d3.select('#graph-options').selectAll('.gls')\n        .attr('disabled', this.value === 'gls' ? null : 'disabled');\n      d3.select('#graph-options').selectAll('.fmcs')\n        .attr('disabled', this.value === 'rdfmcs' ? null : 'disabled');\n    });\n  d3.select('#graph-submit')\n    .on('click', () => {\n      d3.select('#loading-circle').style('display', 'inline');\n      const measure = d3form.value('#graph-measure');\n      const params = {\n        measure: measure,\n        threshold: d3form.valueFloat('#graph-thld'),\n        ignoreHs: d3form.checked('#graph-ignoreh'),\n        diameter: measure === 'gls' ? d3form.valueInt('#graph-diam') : null,\n        maxTreeSize: measure === 'gls' ? d3form.valueInt('#graph-tree') : null,\n        molSizeCutoff: measure === 'gls' ? d3form.valueInt('#graph-skip') : null,\n        timeout: measure === 'rdfmcs' ? d3form.valueInt('#graph-timeout') : null\n      };\n      callback(params);\n    });\n}\n\n\nfunction graphConfigDialog(currentThld, minThld, callback) {\n  d3.select('#graphconfig-thld')\n    .attr('value', currentThld)\n    .attr('max', 1.0)\n    .attr('min', minThld);\n  d3.select('#graphconfig-submit')\n    .on('click', () => {\n      const newThld = d3form.valueFloat('#graphconfig-thld');\n      if (newThld < minThld) return;  // TODO: fool proof\n      callback(newThld);\n    });\n}\n\n\nfunction communityDialog(callback) {\n  d3.select('#community-name').attr('value', 'comm_');\n  d3.select('#community-submit')\n    .on('click', () => {\n      const query = {\n        name: d3form.value('#community-name'),\n        nulliso: d3form.checked('#community-nulliso')\n      };\n      callback(query);\n    });\n}\n\n\nfunction importConfirmDialog(callback) {\n  d3.select('#importconfirm-overwrite')\n    .on('click', () => callback('overwrite'));\n  d3.select('#importconfirm-keepboth')\n    .on('click', () => callback('keepboth'));\n  d3.select('#importconfirm-cancel')\n    .on('click', () => callback('cancel'));\n}\n\n\nexport default {\n  pickDialog, propDialog, structDialog, sdfDialog,\n  columnDialog, fieldFetchDialog, fieldFileDialog, graphDialog,\n  graphConfigDialog, communityDialog, importConfirmDialog\n};\n","\nimport d3 from 'd3';\nimport {default as d3form} from './helper/d3Form.js';\nimport {default as def} from './helper/definition.js';\nimport {default as fmt} from './helper/formatValue.js';\nimport {default as win} from './helper/window.js';\nimport {default as fetcher} from './fetcher.js';\nimport {default as common} from './common.js';\nimport {default as store} from './store/StoreConnection.js';\nimport {default as cmp} from './component/Component.js';\n\n\nfunction updateChem(resources) {\n  const compound = win.URLQuery().compound;\n  d3.select('title').text(compound);\n  const query = {\n    type: 'chemsearch',\n    targets: resources.filter(e => e.domain === 'chemical').map(e => e.id),\n    key: 'compound_id',\n    values: [compound]\n  };\n  return fetcher.get('run', query)\n    .then(fetcher.json)\n    .then(res => {\n      const rcd = res.records[0];\n      d3.select('#compoundid').html(rcd.compound_id);\n      d3.select('#compounddb').html(\n        resources.find(e => e.id === rcd.__source).name);\n      d3.select('#structure').html(rcd.structure);\n      const records = res.fields\n        .filter(e => !['structure', 'index', 'compound_id'].includes(e.key))\n        .map(e => ({ key: e.name, value: rcd[e.key] }));\n      const data = {\n        fields: def.defaultFieldProperties([\n          {key: 'key'}, {key: 'value'}\n        ])\n      };\n      d3.select('#properties').call(cmp.createTable, data)\n        .call(cmp.updateTableRecords, records, d => d.key);\n      return rcd;\n    }, fetcher.error);\n}\n\n\nfunction updateChemAliases(resources, qrcd) {\n  const query = {\n    type: 'exact',\n    targets: resources.filter(e => e.domain === 'chemical').map(e => e.id),\n    queryMol: {\n      format: 'dbid',\n      source: qrcd.__source,\n      value: qrcd.compound_id\n    },\n    params: {ignoreHs: true}\n  };\n  return fetcher.get('run', query)\n    .then(fetcher.json)\n    .then(res => {\n      const records = res.records\n        .filter(rcd => rcd.compound_id !== qrcd.compound_id ||\n                rcd.__source !== qrcd.__source)\n        .map(rcd => {\n          return {\n            compound_id: `<a href=\"profile.html?compound=${rcd.compound_id}\" target=\"_blank\">${rcd.compound_id}</a>`,\n            database: resources.find(e => e.id === rcd.__source).name\n          };\n        });\n      const data = {\n        fields: def.defaultFieldProperties([\n          {key: 'compound_id'}, {key: 'database'}\n        ])\n      };\n      d3.select('#aliases').call(cmp.createTable, data)\n        .call(cmp.updateTableRecords, records, d => d.compound_id);\n    }, fetcher.error);\n}\n\n\nfunction updateActivities() {\n  const compound = win.URLQuery().compound;\n  // Prevent implicit submission\n  document.getElementById('search')\n    .addEventListener('keypress', event => {\n      if (event.keyCode === 13) event.preventDefault();\n    });\n  d3.select('#search').on('keyup', function () {\n    const match = obj => Object.values(obj)\n      .some(e => fmt.partialMatch(d3form.value(this), e));\n    d3.select('#results tbody').selectAll('tr')\n      .style('visibility', d => match(d) ? null : 'hidden')\n      .style('position', d => match(d) ? null : 'absolute');\n  });\n  const query = {\n    type: 'profile',\n    compound_id: compound\n  };\n  return fetcher.get('run', query)\n    .then(fetcher.json)\n    .then(res => {\n      const table = {\n        fields: def.defaultFieldProperties([\n          {key: 'assay_id', name: 'Assay ID', format: 'text'},\n          {key: 'value_type', name: 'Value type', format: 'text'},\n          {key: 'value', name: 'Value', format: 'numeric'}\n        ])\n      };\n      d3.select('#results').call(cmp.createTable, table)\n        .call(cmp.updateTableRecords, res.records, d => d.index)\n        .call(cmp.addSort);\n    }, fetcher.error);\n}\n\n\nfunction run() {\n  return common.loader()\n    .then(() => store.getResources())\n    .then(rsrcs => Promise.all([\n      updateChem(rsrcs).then(qrcd => updateChemAliases(rsrcs, qrcd)),\n      updateActivities()\n    ]));\n}\n\n\nexport default {\n  run\n};\n"],"names":["numericAsc","a","b","fa","parseFloat","fb","isNaN","String","localeCompare","textAsc","singleToMulti","mapping","newMapping","Object","entries","forEach","m","created","fields","field","key","updateTableAttribute","id","value","store","updateItem","item","revision","catch","err","console","error","Promise","reject","v07_to_v08_nodes","json","columns","map","e","format","name","dataType","dataTypeConv","schemaVersion","status","statusConv","records","query","taskCount","searchCount","doneCount","searchDoneCount","resultCount","recordCount","progress","execTime","startDate","responseDate","v07_to_v08_convert","hasOwnProperty","nodes","edges","nodeFields","snp","fieldTransform","snapshot","nodePositions","nodeColor","nodeSize","nodeLabel","edge","scale","find","column","domain","range","unknown","size","text","visible","nodeContent","structure","label","reference","nodeTableId","def","defaultFieldProperties","networkThreshold","v07_to_v08_edges","readFile","file","sizeLimit","blob","resolve","reader","FileReader","truncated","slice","onload","event","target","result","onerror","readAsArrayBuffer","readAsText","parseJSON","data","compressed","pako","inflate","to","JSON","parse","nodesID","idx_converter","i","index","_structure","_index","source","downloadDataFile","url","window","URL","createObjectURL","Blob","document","createElement","download","href","dispatchEvent","MouseEvent","view","bubbles","cancelable","updateTableRecords","selection","rcds","keyFunc","header","select","selectAll","rowSelection","exit","remove","rowEntered","enter","append","d","merge","classed","html","undefined","fmt","formatNum","d3_format","each","d3","call","registerServiceWorker","navigator","serviceWorker","register","then","reg","info","scope","selector","node","valueInt","parseInt","valueFloat","checked","firstFile","files","inputValues","checkboxValues","optionValues","textareaLines","split","filter","length","optionData","si","property","checkboxData","sortType","includes","ongoing","d3format","Number","partialMatch","toString","toUpperCase","indexOf","numericDesc","textDesc","KArray","Array","[object Object]","this","reduce","push","prototype","apply","all","res","obj","kv","URLQuery","from","location","search","substring","toObject","baseURL","get","q","keys","stringify","fetch","credentials","Error","statusText","response","post","formdata","method","body","getSDFPropList","str","re","uniqCols","Set","arr","exec","add","uuidv4","replace","c","r","Math","random","mappingToTable","mp","keyField","concat","entry","rcd","f","tableToMapping","table","ignore","Date","row","csvToMapping","csvString","lines","shift","now","headerIdx","h","line","values","k","fd","unique","schema","app","items","resources","idb","Dexie","version","stores","where","equals","first","putAppSetting","v","put","toArray","putResources","bulkPut","getAllItems","orderBy","reverse","getItemsByDataType","type","sortBy","getItemById","tableId","callback","modify","deleteItem","delete","putItem","getAppSetting","setAppSetting","getResources","setResources","rsrcs","getAllTables","getTablesByDataType","getTable","setFieldProperties","updates","visibles","formats","d3_formats","joinFields","mapper","insertTable","updateTable","assign","deleteTable","reset","Queued","In progress","Aborting","Aborted","Completed","Failure","datatable","connection","loadJSON","endsWith","fetchJSON","decoded","decodeURIComponent","arrayBuffer","downloadJSON","compress","gzip","showPlot","vegaSpec","vega","View","initialize","run","plotThumbnail","toImageURL","selectOptions","options","attr","checkboxList","entered","updated","checkboxListT","description","createTable","cols","appendTableRows","newRcds","addSort","style","on","isAsc","isNum","cmp","sort","formatNumbers","col","colIdx","digit","pickDialog","ids","targets","d3form","fetcher","propDialog","extend","operator","structDialog","rdk","thldtype","dispatch","queryMol","params","measure","threshold","ignoreHs","diameter","maxTreeSize","molSizeCutoff","timeout","command","sdfDialog","getElementById","misc","implh","recalc","formData","FormData","columnDialog","dataFields","generalFormat","win","fieldFetchDialog","compoundIDs","addEventListener","keyCode","preventDefault","dataKeys","resourceFields","match","selected","targetFields","fieldFileDialog","isCsv","pop","hfile","tbl","datum","plotCols","ps","p","himg","img","graphDialog","graphConfigDialog","currentThld","minThld","newThld","communityDialog","nulliso","importConfirmDialog","interactiveInsert","found","$","modal","dialog","action","fetchResults","loader","server","local","serverStatus","clientInstance","debugMode","instance","templates","compoundIDPlaceholder","defaultDataType","rdkit","common","compound","compound_id","__source","updateChem","qrcd","database","updateChemAliases","some","updateActivities"],"mappings":"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"}