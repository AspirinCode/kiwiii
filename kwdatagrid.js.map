{"version":3,"file":"kwdatagrid.js","sources":["../src/common/file.js","../src/common/legacySchema.js","../src/common/mapper.js","../src/datagrid/component.js","../src/datagrid/sort.js","../src/datagrid/view.js","../src/component/modal.js","../src/component/formListBox.js","../src/component/table.js","../src/dialog/fieldConfig.js","../src/component/formBox.js","../src/dialog/formGroup.js","../src/datagrid/datagridApp.js","../src/datagrid/newDatagrid.js","../src/common/misc.js","../src/common/idb.js","../src/common/fetcher.js","../src/common/core.js","../src/datagrid/state.js","../src/common/image.js","../src/component/button.js","../src/dialog/fieldFile.js","../src/dialog/networkgen.js","../src/dialog/rename.js","../src/datagrid/rowFilter.js","../src/dialog/search.js","../src/dialog/struct.js","../src/dialog/filter.js","../src/dialog/sdf.js","../src/datagrid.js"],"sourcesContent":["\n/** @module common/file */\n\nimport pako from 'pako';\n\n\nfunction readFile(file, sizeLimit, blob) {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    const truncated = sizeLimit ? file.slice(0, sizeLimit) : file;\n    reader.onload = event => resolve(event.target.result);\n    reader.onerror = error => reject(error);\n    if (blob) {\n      reader.readAsArrayBuffer(truncated);\n    } else {\n      reader.readAsText(truncated);\n    }\n  });\n}\n\n\nfunction parseJSON(data, compressed) {\n  const text = compressed ? pako.inflate(data, {to: 'string'}) : data;\n  return JSON.parse(text);\n}\n\n\nfunction loadJSON(file) {\n  const compressed = file.name.endsWith('c') || file.name.endsWith('.gz');\n  return readFile(file, false, compressed)\n    .then(data => parseJSON(data, compressed));\n}\n\n\nfunction fetchJSON(url) {\n  const decoded = decodeURIComponent(url);\n  const compressed = decoded.endsWith('c') || decoded.endsWith('.gz');\n  return fetch(decoded)\n    .then(res => compressed ? res.arrayBuffer() : res.json())\n    .then(data => parseJSON(data, compressed));\n}\n\n\nfunction downloadDataFile(data, name) {\n  try {\n    // cannot hundle large file with dataURI scheme\n    // url = 'data:application/json,' + encodeURIComponent(JSON.stringify(json))\n    const url = window.URL.createObjectURL(new Blob([data]));\n    const a = document.createElement('a');\n    a.download = name;\n    a.href = url;\n    // a.click() does not work on firefox\n    a.dispatchEvent(new MouseEvent('click', {\n      'view': window,\n      'bubbles': true,\n      'cancelable': false\n    }));\n    // window.URL.revokeObjectURL(url) does not work on firefox\n  } catch (e) {\n    // no DOM (unit testing)\n  }\n}\n\n\nfunction downloadJSON(json, name, compress=true) {\n  const str = JSON.stringify(json);\n  const data = compress ? pako.gzip(str) : str;\n  const c = compress ? 'c' : 'r';\n  const ext = json.hasOwnProperty('edges') ? `.gf${c}` :  `.nd${c}`;\n  downloadDataFile(data, `${name}${ext}`);\n}\n\n\nexport default {\n  readFile, parseJSON, loadJSON, fetchJSON,\n  downloadDataFile, downloadJSON\n};\n","\n/** @module common/legacySchema */\n\nimport d3 from 'd3';\nimport {default as misc} from './misc.js';\n\n\nconst statusConv = {\n  Queued: 'ready',\n  'In progress': 'running',\n  Aborting: 'running',\n  Aborted: 'aborted',\n  Completed: 'done',\n  Failure: 'failure'\n};\n\nconst dataTypeConv = {\n  datatable: 'nodes',\n  connection: 'edges'\n};\n\nfunction v07_to_v08_nodes(json) {\n  const fields = json.columns.map(e => {\n    if (e.sort === 'numeric') {\n      e.format = 'numeric';\n    } else if (e.sort === 'text') {\n      e.format = 'text';\n    } else if (e.sort === 'none') {\n      e.format = 'raw';\n    }\n    return e;\n  });\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    status: statusConv[json.status],\n    fields: fields,\n    records: json.records,\n    query: json.query,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n  };\n}\n\nfunction v07_to_v08_edges(json, nodeFields) {\n  const snp = {\n    fieldTransform: json.snapshot.fieldTransform,\n    nodePositions: json.snapshot.nodePositions,\n    nodeColor: {},\n    nodeSize: {},\n    nodeLabel: {},\n    edge: {}\n  };\n  if (json.snapshot.hasOwnProperty('nodeColor')) {\n    snp.nodeColor.id = json.snapshot.nodeColor.id;\n    snp.nodeColor.scale = json.snapshot.nodeColor.scale;\n    snp.nodeColor.field = nodeFields.find(e => e.key === json.snapshot.nodeColor.column);\n  } else {\n    snp.nodeColor = {\n      id: 'color', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeSize')) {\n    snp.nodeSize.id = json.snapshot.nodeSize.id;\n    snp.nodeSize.scale = json.snapshot.nodeSize.scale;\n    snp.nodeSize.field = nodeFields.find(e => e.key === json.snapshot.nodeSize.column);\n  } else {\n    snp.nodeSize = {\n      id: 'size', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: [20, 20], unknown: 20}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeLabel')) {\n    snp.nodeLabel.id = json.snapshot.nodeLabel.id;\n    snp.nodeLabel.size = json.snapshot.nodeLabel.size;\n    snp.nodeLabel.text = json.snapshot.nodeLabel.text;\n    snp.nodeLabel.visible = json.snapshot.nodeLabel.visible;\n    snp.nodeLabel.scale = json.snapshot.nodeLabel.scale;\n    snp.nodeLabel.field = nodeFields.find(e => e.key === json.snapshot.nodeLabel.column);\n  } else {\n    snp.nodeLabel = {\n      id: 'label', size: 12, text: 'index', visible: false, field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeContent')) {\n    snp.nodeContent = json.snapshot.nodeContent;\n  } else {\n    snp.nodeContent = {structure: {visible: false}};\n  }\n  if (json.snapshot.hasOwnProperty('edge')) {\n    snp.edge = json.snapshot.edge;\n  } else {\n    snp.edge = {\n      id: 'label', label: {size: 10, visible: false}, visible: true,\n      scale: {scale: 'linear', domain: [0, 1], range: [5, 5], unknown: 5}\n    };\n  }\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    reference: {\n      nodes: json.nodeTableId\n    },\n    status: statusConv[json.status],\n    fields: misc.defaultFieldProperties([\n      {'key': 'source'},\n      {'key': 'target'},\n      {'key': 'weight'}\n    ]),\n    records: json.records,\n    query: json.query,\n    networkThreshold: json.networkThreshold,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n    snapshot: snp\n  };\n}\n\n\nfunction v08_nodes(json) {\n  json.records.forEach((e, i) => {\n    e.index = i;\n    e.structure = e._structure;\n    delete e._index;\n    delete e._structure;\n  });\n  json.fields.forEach(e => {\n    if (e.key === '_index') e.key = 'index';\n    if (e.key === '_structure') e.key = 'structure';\n    if (e.sort === 'numeric') e.format = 'numeric';\n    if (e.sort === 'text') e.format = 'text';\n    if (e.sort === 'none') e.format = 'raw';\n  });\n  return json;\n}\n\nfunction v08_graph(json) {\n  if (!json.edges.hasOwnProperty('reference')) { // ver0.8.0-0.8.1\n    json.edges.reference = {nodes: json.edges.nodesID};\n  }\n  if (json.nodes.fields.find(e => e.key === '_index')) {\n    const idx_converter = {};\n    json.nodes.records.forEach((e, i) => {\n        e.index = i;\n        e.structure = e._structure;\n        idx_converter[e._index] = e.index;\n        delete e._index;\n        delete e._structure;\n    });\n    json.edges.records.forEach(e => {\n        e.source = idx_converter[e.source];\n        e.target = idx_converter[e.target];\n    });\n    json.nodes.fields.forEach(e => {\n      if (e.key === '_index') e.key = 'index';\n      if (e.key === '_structure') e.key = 'structure';\n      if (e.sort === 'numeric') e.format = 'numeric';\n      if (e.sort === 'text') e.format = 'text';\n      if (e.sort === 'none') e.format = 'raw';\n    });\n  }\n  return json;\n}\n\nfunction v10_nodes(json) {\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: json.dataType,\n    schemaVersion: '0.10',\n    revision: json.revision,\n    status: json.status,\n    fields: json.fields,\n    records: json.records,\n    query: json.query,\n    progress: json.progress,\n    execTime: json.execTime,\n    created: json.created,\n    reference: {}\n  };\n}\n\n\nfunction v10_edges(json) {\n  const snapshot = {\n    networkThreshold: json.networkThreshold\n  };\n  snapshot.nodeContentVisible = json.snapshot.nodeContent.structure.visible;\n  snapshot.nodeColor = json.snapshot.nodeColor.scale || {};\n  if (snapshot.nodeColor.field) {\n    snapshot.nodeColor.field = json.snapshot.nodeColor.field.key;\n    if (snapshot.nodeColor.field === '_index') {\n      snapshot.nodeColor.field = 'index';\n    }\n  }\n  if (snapshot.nodeColor.scale === 'ordinal') {\n    snapshot.nodeColor.range = d3.schemeCategory20;\n  }\n  snapshot.nodeSize = json.snapshot.nodeSize.scale || {};\n  if (json.snapshot.nodeSize.field) {\n    snapshot.nodeSize.field = json.snapshot.nodeSize.field.key;\n    if (snapshot.nodeSize.field === '_index') {\n      snapshot.nodeSize.field = 'index';\n    }\n  }\n  snapshot.nodeLabel = {};\n  if (json.snapshot.nodeLabel.text) {\n    snapshot.nodeLabel.text = json.snapshot.nodeLabel.text.key;\n    if (snapshot.nodeLabel.text === '_index') {\n      snapshot.nodeLabel.text = 'index';\n    }\n  }\n  snapshot.nodeLabel.size = json.snapshot.nodeLabel.size;\n  snapshot.nodeLabel.visible = json.snapshot.nodeLabel.visible;\n  snapshot.nodeLabelColor = json.snapshot.nodeLabel.scale || {};\n  if (json.snapshot.nodeLabel.field) {\n    snapshot.nodeLabelColor.field = json.snapshot.nodeLabel.field.key;\n    if (snapshot.nodeLabelColor.field === '_index') {\n      snapshot.nodeLabelColor.field = 'index';\n    }\n  }\n  if (snapshot.nodeLabelColor.scale === 'ordinal') {\n    snapshot.nodeLabelColor.range = d3.schemeCategory20;\n  }\n  snapshot.edgeVisible = json.snapshot.edge.visible;\n  snapshot.edgeWidth = json.snapshot.edge.scale || {};\n  snapshot.edgeLabel = {};\n  snapshot.edgeLabel.size = json.snapshot.edge.label.size;\n  snapshot.edgeLabel.visible = json.snapshot.edge.label.visible;\n  snapshot.networkThreshold = json.networkThreshold || json.query.threshold;\n  snapshot.coords = json.snapshot.nodePositions;\n  // TODO: when created date is lost\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: json.dataType,\n    schemaVersion: '0.10',\n    revision: json.revision,\n    status: json.status,\n    fields: json.fields,\n    records: json.records,\n    query: {params: json.query},\n    progress: json.progress,\n    execTime: json.execTime,\n    created: json.created,\n    snapshot: snapshot,\n    reference: json.reference\n  };\n}\n\nfunction convertTable(json) {\n  let data = json;\n  if (!(data.hasOwnProperty('schemaVersion') || data.hasOwnProperty('$schema'))) { // v0.7\n    data = v07_to_v08_nodes(data);\n  }\n  if (data.schemaVersion == '0.8') {\n    data = v08_nodes(data);\n    data = v10_nodes(data);\n  }\n  if (!data.hasOwnProperty('$schema')) {\n    delete data.schemaVersion;\n    delete data.revision;\n    data.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n  }\n  return data;\n}\n\nfunction convertNetwork(json) {\n  let data = json;\n  if (!(data.edges.hasOwnProperty('schemaVersion') || data.edges.hasOwnProperty('$schema'))) { // v0.7\n    data.nodes = v07_to_v08_nodes(data.nodes);\n    data.edges = v07_to_v08_edges(data.edges, data.nodes.fields);\n  }\n  if (data.edges.schemaVersion == '0.8' || data.edges.schemaVersion === 0.1) {  // wrong conversion of '0.10'\n    data = v08_graph(data);\n    data.nodes = v10_nodes(data.nodes);\n    data.edges = v10_edges(data.edges);\n  }\n  if (!data.edges.hasOwnProperty('$schema')) {\n    delete data.nodes.schemaVersion;\n    delete data.edges.schemaVersion;\n    delete data.nodes.revision;\n    delete data.edges.revision;\n    data.nodes.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n    data.edges.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n  }\n  return data;\n}\n\n\nexport default {\n  convertTable, convertNetwork\n};\n","\n/** @module common/mapper */\n\nimport _ from 'lodash';\n\nimport {default as misc} from './misc.js';\n\n\n/**\n * Convert single field mapping to multi field mapping\n * @param {object} mapping - single field mapping\n * @return {object} multi field mapping\n */\nfunction singleToMulti(mapping) {\n  const newMapping = {};\n  Object.entries(mapping.mapping).forEach(m => {\n    newMapping[m[0]] = [m[1]];\n  });\n  return {\n    created: mapping.created,\n    fields: [mapping.field],\n    key: mapping.key,\n    mapping: newMapping\n  };\n}\n\n\n/**\n * Convert field mapping to table\n * @param {object} mapping - field mapping\n * @return {object} table object\n */\nfunction mappingToTable(mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  const keyField = {key: mp.key, format: 'text'};\n  const data = {\n    fields: misc.defaultFieldProperties([keyField].concat(mp.fields)),\n    records: Object.entries(mp.mapping).map(entry => {\n      const rcd = {};\n      rcd[mp.key] = entry[0];\n      mp.fields.forEach((f, i) => {\n        rcd[f.key] = entry[1][i];\n      });\n      return rcd;\n    })\n  };\n  return data;\n}\n\n\n/**\n * Convert table to field mapping\n * @param {object} table - table\n * @param {object} key - key\n * @return {object} field mapping\n */\nfunction tableToMapping(table, key, ignore=['index']) {\n  const now = new Date();\n  const mapping = {\n    created: now.toString(),\n    fields: misc.defaultFieldProperties(table.fields\n      .filter(e => e.key !== key)\n      .filter(e => !ignore.includes(e.key))),\n    key: key,\n    mapping: {}\n  };\n  table.records.forEach(row => {\n    mapping.mapping[row[key]] = mapping.fields.map(e => row[e.key]);\n  });\n  return mapping;\n}\n\n\n/**\n * Convert csv text to field mapping\n * @param {string} csvString - csv data text\n * @return {object} field mapping\n */\nfunction csvToMapping(csvString) {\n  const lines = csvString.split(/\\n|\\r|\\r\\n/);\n  const header = lines.shift().split(',');\n  const key = header.shift();\n  const now = new Date();\n  const headerIdx = [];\n  const fields = [];\n  header.forEach((h, i) => {\n    if (h === '') return;\n    headerIdx.push(i);\n    fields.push({key: h, format: 'text'});\n  });\n  const mapping = {\n    created: now.toString(),\n    fields: misc.defaultFieldProperties(fields),\n    key: key,\n    mapping: {}\n  };\n  lines.forEach(line => {\n    const values = line.split(',');\n    const k = values.shift();\n    mapping.mapping[k] = Array(headerIdx.length);\n    headerIdx.forEach(i => {\n      mapping.mapping[k][i] = values[i];\n    });\n  });\n  return mapping;\n}\n\n\n/**\n * Apply mapping to the data (in-place)\n * @param {object} data - datatable JSON\n * @param {object} mapping - mapping JSON\n * @return {undefined} undefined\n */\nfunction apply(data, mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  data.records\n    .filter(rcd => mp.mapping.hasOwnProperty(rcd[mp.key]))\n    .forEach(rcd => {\n      mp.fields.forEach((fd, i) => {\n        rcd[fd.key] = mp.mapping[rcd[mp.key]][i];\n      });\n    });\n  data.fields =  _(data.fields)\n    .concat(misc.defaultFieldProperties(mp.fields))\n    .uniqBy('key')\n    .value();\n}\n\nexport default {\n  singleToMulti, mappingToTable, tableToMapping, csvToMapping, apply\n};\n","\n/** @module datagrid/component */\n\nimport d3 from 'd3';\n\nimport {default as misc} from '../common/misc.js';\nimport {default as img} from '../common/image.js';\n\n\nfunction updateContents(selection, state) {\n  const header = selection.select('.dg-header')\n    .selectAll('.dg-hcell')\n      .data(state.visibleFields, d => d.key);\n  header.exit().remove();\n  header.enter().append('div')\n      .classed('dg-hcell', true)\n      .style('display', 'inline-block')\n    .merge(header)\n      .style('width', d => `${d.width}px`)\n      .text(d => d.name);\n  selection.call(updateViewport, state);\n}\n\n\nfunction updateViewport(selection, state) {\n  selection.style('width', `${state.contentWidth}px`);\n  selection.select('.dg-body')\n    .style('position', \"relative\");\n  selection.select('.dg-viewport')\n    .style('overflow-y', 'auto')\n    .on('scroll', function () {\n      const scrollTop = d3.select(this).node().scrollTop;\n      const pos = Math.floor(scrollTop / state.rowHeight);\n      if (pos !== state.previousViewportTop) {\n        state.setScrollPosition(pos);\n        selection.call(updateRows, state, updateRowFunc(state.visibleFields));\n      }\n    })\n    .dispatch('scroll');\n}\n\n\nfunction updateRowFunc(fields) {\n  return (selection, record) => {\n    fields.forEach(field => {\n      const value = record[field.key];\n      const cell = selection.append('div')\n        .classed('dg-cell', true)\n        .classed('align-middle', true)\n        .style('display', 'inline-block')\n        .style('width', `${field.width}px`);\n      if (value === undefined) return;\n      if (field.format === 'd3_format') {\n        cell.text(misc.formatNum(value, field.d3_format));\n      } else if (['numeric', 'text', 'raw'].includes(field.format)) {\n        cell.text(value);\n      } else if (field.format === 'compound_id') {\n        cell.append('a')\n            .attr('href',`profile.html?compound=${value}`)\n            .attr('target', '_blank')\n            .text(value);\n      } else if (field.format === 'plot') {\n        cell.call(img.plotCell, value);  // TODO:\n      } else if (field.format === 'image') {\n        cell.append('img')\n            .attr('width', 180)\n            .attr('height', 180)\n            .attr('src', value);\n      } else if (field.format === 'control') {\n        cell.call(value);\n      } else {\n        cell.html(value);\n      }\n    });\n  };\n}\n\n\nfunction updateRows(selection, state, rowFactory) {\n  selection.select('.dg-body')\n    .style('height', `${state.bodyHeight}px`);\n  const rows = selection.select('.dg-body')\n    .selectAll('.dg-row')\n      .data(state.recordsToShow(), state.keyFunc)\n      .style('height', `${state.rowHeight}px`);\n  rows.exit().remove();\n  rows.enter()\n    .append('div')\n      .attr('class', 'dg-row')\n      .style('position', \"absolute\")\n    .merge(rows)\n      .each(function (d, i) {\n        const rowPos = (state.viewportTop + i) * state.rowHeight;\n        d3.select(this)\n          .style('transform', `translate(0px, ${rowPos}px)`)\n          .classed('odd', (state.viewportTop + i) % 2 === 0);\n        d3.select(this).selectAll('.dg-cell').remove();\n        d3.select(this).call(rowFactory, d);\n      });\n}\n\n\nfunction resizeViewport(selection, state) {\n  // TODO: set width\n  selection.select('.dg-viewport').style('height', `${state.viewportHeight}px`);\n}\n\n\nexport default {\n  updateContents, updateViewport, updateRowFunc, updateRows, resizeViewport\n};\n","\n/** @module datagrid/sort */\n\nimport d3 from 'd3';\n\nimport {default as misc} from '../common/misc.js';\nimport {default as component} from './component.js';\n\n\nfunction numericAsc(a, b) {\n  const fa = parseFloat(a);\n  const fb = parseFloat(b);\n  if (isNaN(fa) || isNaN(fb)) {\n    return String(b).localeCompare(String(a));\n  }\n  return fb - fa;\n}\n\n\nfunction numericDesc(a, b) {\n  return numericAsc(b, a);\n}\n\n\nfunction textAsc(a, b) {\n  return String(b).localeCompare(String(a));\n}\n\n\nfunction textDesc(a, b) {\n  return textAsc(b, a);\n}\n\n\nfunction setSort(selection, state) {\n  selection.select('.dg-header').selectAll('.dg-hcell')\n    .filter(d => misc.sortType(d.format) !== 'none')\n    .append('span').append('a')\n      .attr('id', d => `sort-${d.key}`)\n      .text('^v')\n      .style('display', 'inline-block')\n      .style('width', '30px')\n      .style('text-align', 'center')\n    .on('click', d => {\n      const isAsc = d3.select(`#sort-${d.key}`).text() === 'v';\n      d3.select(`#sort-${d.key}`).text(isAsc ? '^' : 'v');\n      state.setSortOrder(d.key, isAsc ? 'desc' : 'asc');\n      selection.call(\n        component.updateRows, state, component.updateRowFunc(state.visibleFields)\n      );\n    });\n  state.updateContentsNotifier = () => {\n    state.applyData();\n    selection.call(component.updateContents, state)\n      .call(setSort, state);\n  };\n}\n\n\nexport default {\n  setSort\n};\n","\n/** @module datagrid/view */\n\nimport {default as component} from './component.js';\n\n\nfunction resize(selection, state) {\n  const viewport = selection.select('.dg-viewport');\n  const viewportTop = viewport.node().getBoundingClientRect().top;\n  state.setViewportSize(window.innerHeight - viewportTop - 5);\n  selection.call(component.resizeViewport, state);\n}\n\nfunction datagrid(selection, state) {\n  if (selection.selectAll('div').size()) {\n    selection.selectAll('div').remove();\n  }\n  selection.append('div')\n      .classed('dg-header', true);\n  selection.append('div')\n      .classed('dg-viewport', true)\n    .append('div')\n      .classed('dg-body', true);\n  selection.call(resize, state);\n  state.updateContentsNotifier = () => {\n    state.applyData();\n    selection.call(component.updateContents, state);\n  };\n  state.updateFilterNotifier = value => {\n    state.setFilterText(value);\n    selection.call(\n      component.updateRows, state, component.updateRowFunc(state.visibleFields)\n    );\n  };\n  state.updateContentsNotifier();\n}\n\n\nexport default {\n  resize, datagrid\n};\n","\n/** @module component/modal */\n\nimport d3 from 'd3';\n\n\nfunction dialogBase(selection, id) {\n  selection\n      .classed('modal', true)\n      .attr('tabindex', -1)\n      .attr('role', 'dialog')\n      .attr('aria-labelledby', '')\n      .attr('aria-hidden', true)\n      .attr('id', id);\n  selection.select('.modal-dialog').remove();  // Clean up\n  selection.append('div')\n      .classed('modal-dialog', true)\n      .attr('role', 'document')\n    .append('div')\n      .classed('modal-content', true);\n}\n\n\nfunction confirmDialog(selection, id, message) {\n  const base = selection.call(dialogBase, id)\n      .select('.modal-content');\n  // body\n  base.append('div')\n      .classed('modal-body', true)\n    .append('div')\n      .classed('message', true)\n      .text(message);\n  // footer\n  const footer = base.append('div')\n      .classed('modal-footer', true);\n  footer.append('button')\n      .classed('btn', true)\n      .classed('btn-outline-secondary', true)\n      .classed('cancel', true)\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .text('Cancel');\n  footer.append('button')\n      .classed('btn', true)\n      .classed('btn-warning', true)\n      .classed('ok', true)\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .attr('data-target', `${id}-submit`)\n      .text('OK')\n      .on('click', () => {\n        d3.select('#loading-icon').style('display', 'inline');\n        selection.dispatch('submit');\n      });\n}\n\n\nfunction submitDialog(selection, id, title) {\n  const base = selection.call(dialogBase, id)\n      .select('.modal-content');\n  // header\n  const header = base.append('div')\n      .classed('modal-header', true);\n  header.append('h4')\n      .classed('modal-title', true)\n      .text(title);\n  header.append('button')\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .attr('aria-label', 'Close')\n      .classed('close', true)\n    .append('span')\n      .attr('aria-hidden', true)\n      .html('&times;');\n  // body\n  base.append('div')\n      .classed('modal-body', true);\n  // footer\n  base.append('div')\n      .classed('modal-footer', true)\n    .append('button')\n      .classed('btn', true)\n      .classed('btn-primary', true)\n      .classed('submit', true)\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .attr('data-target', `${id}-submit`)\n      .text('Submit')\n      .on('click', () => {\n        d3.select('#loading-icon').style('display', 'inline');\n        selection.dispatch('submit');\n      });\n}\n\n\nexport default {\n  confirmDialog, submitDialog\n};\n","\n/** @module component/formListBox */\n\nimport d3 from 'd3';\n\n\n/**\n * Render select box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction selectBox(selection, id, label, fields, value) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .attr('for', id)\n      .text(label);\n  selection.append('select')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('id', id);\n  if (fields) {\n    selection.call(selectBoxItems, fields);\n    selection.call(updateSelectBox, value);\n  }\n}\n\nfunction selectBoxItems(selection, items) {\n  const options = selection.select('select')\n    .selectAll('option')\n      .data(items, d => d.key);\n  options.exit().remove();\n  options.enter()\n    .append('option')\n      .attr('value', d => d.key)\n      .text(d => d.name);\n}\n\nfunction updateSelectBox(selection, value) {\n  selection.select('select').property('value', value);\n}\n\nfunction selectBoxValue(selection) {\n  return selection.select('select').property('value');\n}\n\n\n/**\n * Render select box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction checklistBox(selection, id, label, fields, values) {\n  // TODO: scroll\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('ul')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('id', id);\n  if (fields) {\n    selection.call(checklistBoxItems, fields);\n    selection.call(updateChecklistBox, values);\n  }\n}\n\nfunction checklistBoxItems(selection, items) {\n  const listitems = selection.select('ul')\n    .selectAll('li')\n      .data(items, d => d.key);\n  listitems.exit().remove();\n  const form = listitems.enter()\n    .append('li')\n      .attr('class', 'form-check')\n    .append('label')\n      .attr('class', 'form-check-label');\n  form.append('input')\n      .attr('type', 'checkbox')\n      .attr('class', 'form-check-input')\n      .property('value', d => d.key);\n  form.append('span')\n      .text(d => d.name);\n}\n\nfunction updateChecklistBox(selection, values) {\n  if (!values) return;\n  selection.selectAll('input')\n    .each(function (d) {\n      d3.select(this).property('checked', values.includes(d.key));\n    });\n}\n\nfunction checklistBoxValue(selection) {\n  return selection.selectAll('input:checked').data().map(d => d.key);\n}\n\n\nexport default {\n  selectBox, selectBoxItems, updateSelectBox, selectBoxValue,\n  checklistBox, checklistBoxItems, updateChecklistBox, checklistBoxValue\n};\n","\n/** @module component/table */\n\n// Simple tables\n// use dataGrid.js for interactive and smooth datatable\n\n\nimport d3 from 'd3';\n\nimport {default as misc} from '../common/misc.js';\n\n\nfunction render(selection, id, caption, fields, records) {\n  selection\n      .classed('table', true)\n      .classed('table-striped', true)\n      .classed('table-hover', true)\n      .attr('id', id);\n  if (caption) {\n    selection.append('caption').text(caption);\n  }\n  selection.append('thead').append('tr');\n  selection.append('tbody');\n  if (fields) {\n    selection.call(updateHeader, fields, records);\n  }\n}\n\n\nfunction updateHeader(selection, fields, records) {\n  const header = selection.select('thead tr')\n    .selectAll('th')\n      .data(fields);\n  header.exit().remove();\n  header.enter().append('th')\n      .text(d => d.name);\n  if (records) {\n    selection.call(updateContents, records, d => d.key, updateRowFunc(fields));\n  }\n}\n\n\nfunction updateContents(selection, records, keyFunc, rowFactory) {  // TODO: specify key\n  const rows = selection.select('tbody')\n    .selectAll('tr')\n      .data(records, keyFunc);\n  rows.exit().remove();\n  rows.enter().append('tr')\n    .merge(rows)\n      .each(function (d) {\n        d3.select(this).selectAll('td').remove();\n        d3.select(this).call(rowFactory, d);\n      });\n}\n\n\nfunction updateRowFunc(fields) {\n  return (selection, record) => {\n    fields.forEach(field => {\n      const value = record[field.key];\n      const cell = selection.append('td')\n        .classed('align-middle', true);\n      if (value === undefined) return;\n      if (field.format === 'd3_format') {\n        cell.text(misc.formatNum(value, field.d3_format));\n      }\n      else if (field.format === 'plot') {\n        cell.text('[plot]');\n      }\n      else if (field.format === 'image') {\n        cell.text('[image]');\n      }\n      else if (field.format === 'control') {\n        cell.call(value);\n      } else {\n        cell.text(value);\n      }\n    });\n  };\n}\n\n\nexport default {\n  render, updateHeader, updateContents\n};\n","\n/** @module dialog/fieldConfig */\n\nimport d3 from 'd3';\n\nimport {default as misc} from '../common/misc.js';\n\nimport {default as button} from '../component/button.js';\nimport {default as lbox} from '../component/formListBox.js';\nimport {default as modal} from '../component/modal.js';\nimport {default as table} from '../component/table.js';\n\n\nconst id = 'fieldconf-dialog';\nconst title = 'Field Setting';\n\n\nfunction menuLink(selection) {\n  selection.call(button.dropdownMenuModal, 'fieldconf', title, id);\n}\n\n\nfunction updateRowFunc(selection, record) {\n  selection.append('td')\n      .classed('name', true)\n      .text(record.name);\n  selection.append('td')\n      .classed('visible', true)\n    .append('input')\n      .attr('type', 'checkbox')\n      .property('checked', record.visible);\n  const generalFormat = ['text', 'numeric', 'd3_format', 'raw', 'compound_id'];\n  const fs = generalFormat.includes(record.format) ? generalFormat : [record.format];\n  const items = fs.map(e => ({key: e, name: e}));\n  const format = selection.append('td')\n      .classed('format', true);\n  const formatSelect = format.append('select');\n  format.call(lbox.selectBoxItems, items);\n  formatSelect\n      .property('disabled', !generalFormat.includes(record.format))\n      .property('value', record.format);\n  selection.append('td')\n      .classed('d3format', true)\n    .append('input')\n      .attr('size', 10)\n      .property('disabled', record.format === 'd3_format' ? null : true)\n      .property('value', record.d3_format || null);\n  formatSelect\n      .on('change', function () {\n        selection.select('.d3format')\n          .select('input')\n            .property('disabled', this.value !== 'd3_format');\n      });\n}\n\n\nfunction tableRowValue(selection) {\n  const value = {};\n  value.visible = selection.select('.visible')\n    .select('input').property('checked');\n  value.format = selection.select('.format')\n    .select('select').property('value');\n  if (value.format === 'd3_format') {\n    value.d3_format = selection.select('.d3format')\n      .select('input').property('value');\n  }\n  return value;\n}\n\n\nfunction body(selection) {\n  const fields = misc.defaultFieldProperties([\n    {key: 'name', format: 'text'},\n    {key: 'visible', format: 'control'},\n    {key: 'format', format: 'control'},\n    {key: 'd3_format', format: 'control'}\n  ]);\n  selection\n      .call(modal.submitDialog, id, title)\n    .select('.modal-body')\n    .append('table')\n      .classed('field', true)\n      .call(table.render, null, null, fields);\n}\n\n\nfunction updateBody(selection, state) {\n  selection.select('.field')\n      .call(table.updateContents, state.fields, d => d.key, updateRowFunc);\n}\n\n\nfunction value(selection) {\n  const fields = [];\n  selection.select('tbody').selectAll('tr')\n    .each(function (d) {\n      const field = tableRowValue(d3.select(this));\n      field.key = d.key;\n      field.name = d.name;\n      fields.push(field);\n    });\n  return fields;\n}\n\n\nexport default {\n  menuLink, updateRowFunc, body, updateBody, value\n};\n","\n/** @module component/formBox */\n\n\nfunction textBox(selection, id, label, size, value) {  // TODO: remove size\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .attr('for', id)\n      .text(label);\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('id', id)\n      .attr('type', 'text')\n      .attr('size', size);\n  selection.call(updateTextBox, value);\n}\n\nfunction updateTextBox(selection, value) {\n  selection.select('input').property('value', value);\n}\n\nfunction textBoxValue(selection) {\n  return selection.select('input').property('value');\n}\n\n\nfunction readonlyBox(selection, id, label, value) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .attr('for', id)\n      .text(label);\n  selection.append('input')\n      .classed('form-control-plaintext', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('id', id)\n      .attr('type', 'text')\n      .property('readonly', true);\n  selection.call(updateTextBox, value);\n}\n\n\nfunction textareaBox(selection, id, label, rows, placeholder, value) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .attr('for', id)\n      .text(label);\n  selection.append('textarea')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('rows', rows)\n      .attr('placeholder', placeholder)\n      .attr('id', id);\n  selection.call(updateTextareaBox, value);\n}\n\nfunction updateTextareaBox(selection, value) {\n  selection.select('textarea').property('value', value);\n}\n\nfunction textareaBoxValue(selection) {\n  const value = selection.select('textarea').property('value');\n  if (value) return value;  // TODO: 0 is falsy\n  const placeholder = selection.select('textarea').attr('placeholder');\n  if (placeholder) return placeholder;\n  return '';\n}\n\nfunction textareaBoxLines(selection) {\n  const value = selection.select('textarea').property('value');\n  if (value) return value.split('\\n').filter(e => e.length > 0);\n  const placeholder = selection.select('textarea').attr('placeholder');\n  if (placeholder) return placeholder.split('\\n').filter(e => e.length > 0);\n  return [];\n}\n\n\nfunction checkBox(selection, id, label, checked) {\n  const box = selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('form-check', true)\n    .append('label')\n      .classed('form-check-label', true)\n      .classed('col-form-label-sm', true);\n  box.append('input')\n      .classed('form-check-input', true)\n      .attr('type', 'checkbox')\n      .attr('id', id);\n  box.append('span')\n      .text(label);\n  selection.call(updateCheckBox, checked);\n}\n\nfunction updateCheckBox(selection, checked) {\n  selection.select('input').property('checked', checked);\n}\n\nfunction checkBoxValue(selection) {\n  return selection.select('input').property('checked');\n}\n\n\nfunction numberBox(selection, id, label, min, max, step, value) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .attr('for', id)\n      .text(label);\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('id', id)\n      .attr('type', 'number')\n      .attr('min', min)\n      .attr('max', max)\n      .attr('step', step);\n  selection.call(updateNumberBox, value);\n}\n\nfunction updateNumberBox(selection, value) {\n  selection.select('input').property('value', value);\n}\n\nfunction numberBoxValue(selection) {\n  return selection.select('input').property('value');\n}\n\n\nfunction fileInputBox(selection, id, label, accept) {\nselection\n    .classed('form-group', true)\n    .classed('form-row', true);\nselection.append('label')\n    .classed('col-form-label', true)\n    .classed('col-form-label-sm', true)\n    .classed('col-4', true)\n    .attr('for', id)\n    .text(label);\nselection.append('input')\n    .classed('form-control', true)\n    .classed('form-control-sm', true)\n    .classed('form-control-file', true)\n    .classed('col-8', true)\n    .attr('type', 'file')\n    .attr('accept', accept)\n    .attr('id', id);\n}\n\nfunction fileInputBoxValue(selection) {\n  return selection.select('input').property('files')[0];\n}\n\n\nexport default {\n  textBox, updateTextBox, textBoxValue, readonlyBox,\n  textareaBox, updateTextareaBox, textareaBoxValue, textareaBoxLines,\n  checkBox, updateCheckBox, checkBoxValue,\n  numberBox, updateNumberBox, numberBoxValue,\n  fileInputBox, fileInputBoxValue\n};\n","\n/** @module dialog/formGroup */\n\nimport d3 from 'd3';\n\nimport {default as fetcher} from '../common/fetcher.js';\n\nimport {default as button} from '../component/button.js';\nimport {default as box} from '../component/formBox.js';\nimport {default as lbox} from '../component/formListBox.js';\n\n\n/**\n * Render color range control box group\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction queryMolGroup(selection, id, resources) {\n  selection\n      .classed('mb-3', true);\n  selection.append('div')\n      .classed('format', true)\n      .classed('mb-1', true)\n      .call(lbox.selectBox, `${id}-format`, 'Format',\n            [\n              {key: 'molfile', name: 'MDL Molfile'},\n              {key: 'dbid', name: 'Compound ID'}\n            ], 'molfile');\n  const res = resources.map(d => ({key: d.id, name: d.name}));\n  selection.append('div')\n      .classed('source', true)\n      .classed('mb-1', true)\n      .call(lbox.selectBox, `${id}-source`, 'Source', res, null);\n  selection.append('div')\n      .classed('textquery', true)\n      .classed('mb-1', true)\n      .call(box.textBox, `${id}-textquery`, 'Query', null, '');\n  selection.append('div')\n      .classed('areaquery', true)\n      .classed('mb-1', true)\n      .call(box.textareaBox, `${id}-areaquery`, 'Query', 6, null, '');\n  // Popover\n  $(function () {\n    $('[data-toggle=\"popover\"]')\n      .popover({html: true, trigger: 'focus'});\n  });\n  selection.append('div')\n      .classed('form-row', true)\n      .classed('justify-content-end', true)\n    .append('button')\n      .classed('preview', true)\n      .attr('data-toggle', 'popover')\n      .attr('data-html', 'true')\n      .attr('data-content', '<div id=\"previmg\"></div>')\n      .call(button.menuButton, `${id}-preview`, 'Structure preview', 'primary');\n  selection.call(updateQueryMolGroup);\n}\n\nfunction updateQueryMolGroup(selection) {\n  selection.select('.format')\n    .on('change', function () {\n      const value = lbox.selectBoxValue(d3.select(this));\n      selection.select('.source')\n        .select('select')\n          .property('disabled', value !== 'dbid');\n      selection.select('.textquery')\n          .property('hidden', value !== 'dbid');\n      selection.select('.areaquery')\n          .property('hidden', value !== 'molfile');\n    })\n    .dispatch('change');\n  selection.select('.preview')\n    .on('click', function () {\n      const query = queryMolGroupValue(selection);\n      return fetcher.get('strprev', query)\n        .then(fetcher.text)\n        .then(res => d3.select('#previmg').html(res), fetcher.error);\n    });\n}\n\nfunction queryMolGroupValue(selection) {\n  const format = lbox.selectBoxValue(selection.select('.format'));\n  const source = lbox.selectBoxValue(selection.select('.source'));\n  const textquery = box.textBoxValue(selection.select('.textquery'));\n  const areaquery = box.textareaBoxLines(selection.select('.areaquery'));\n  return {\n    format: format,\n    source: format === 'dbid' ? source : null,\n    value: format === 'molfile' ? areaquery : textquery\n  };\n}\n\n\nfunction simOptionGroup(selection, id) {\n  selection\n      .classed('mb-3', true)\n    .append('p')\n    .append('button')\n      .classed('btn', true)\n      .classed('btn-sm', true)\n      .classed('btn-outline-primary', true)\n      .classed('dropdown-toggle', true)\n      .attr('data-toggle', 'collapse')\n      .attr('data-target', `#${id}-collapse`)\n      .attr('aria-expanded', 'false')\n      .attr('aria-controls', `${id}-collapse`)\n      .text('Optional parameters');\n  const collapse = selection.append('div')\n      .classed('collapse', true)\n      .attr('id', `${id}-collapse`)\n    .append('div')\n      .classed('card', true)\n      .classed('card-body', true);\n  collapse.append('div')\n      .classed('ignoreh', true)\n      .classed('mb-1', true)\n      .call(box.checkBox, `${id}-ignoreh`, 'Ignore explicit hydrogens', true);\n  collapse.append('div')\n      .classed('timeout', true)\n      .classed('mb-1', true)\n      .call(box.numberBox, `${id}-timeout`, 'Timeout (RDKit FMCS)', 1, 999, 1, 2);\n  collapse.append('div')\n      .classed('diam', true)\n      .classed('mb-1', true)\n      .call(box.numberBox, `${id}-diam`, 'Diameter (MCS-DR/GLS)', 4, 999, 1, 8);\n  collapse.append('div')\n      .classed('tree', true)\n      .classed('mb-1', true)\n      .call(box.numberBox, `${id}-tree`, 'Max tree size (MCS-DR/GLS)', 20, 999, 1, 40);\n  collapse.append('div')\n      .classed('skip', true)\n      .classed('mb-1', true)\n      .call(box.numberBox, `${id}-skip`, 'Mol size cutoff (MCS-DR/GLS)', 20, 999, 1, 500);\n  collapse.selectAll('label.col-form-label')\n      .classed('col-4', false)\n      .classed('col-6', true);\n  collapse.selectAll('input.form-control')\n      .classed('col-8', false)\n      .classed('col-6', true);\n}\n\nfunction simOptionGroupValue(selection) {\n  const timeout = selection.select('.timeout');\n  const diam = selection.select('.diam');\n  const tree = selection.select('.tree');\n  const skip = selection.select('.skip');\n  const query = {\n    ignoreHs: box.checkBoxValue(selection.select('.ignoreh'))\n  };\n  if (!timeout.select('input').property('disabled')) {\n    query.timeout = box.numberBoxValue(timeout);\n  }\n  if (!diam.select('input').property('disabled')) {\n    query.diameter = box.numberBoxValue(diam);\n  }\n  if (!tree.select('input').property('disabled')) {\n    query.maxTreeSize = box.numberBoxValue(tree);\n  }\n  if (!skip.select('input').property('disabled')) {\n    query.molSizeCutoff = box.numberBoxValue(skip);\n  }\n  return query;\n}\n\n\nexport default {\n  queryMolGroup, updateQueryMolGroup, queryMolGroupValue,\n  simOptionGroup, simOptionGroupValue\n};\n","\n/** @module datagrid/datagridApp */\n\nimport d3 from 'd3';\n\nimport {default as core} from '../common/core.js';\nimport {default as idb} from '../common/idb.js';\nimport {default as fetcher} from '../common/fetcher.js';\nimport {default as hfile} from '../common/file.js';\nimport {default as misc} from '../common/misc.js';\n\nimport {default as button} from '../component/button.js';\nimport {default as modal} from '../component/modal.js';\n\nimport {default as fieldConfigDialog} from '../dialog/fieldConfig.js';\nimport {default as fieldFileDialog} from '../dialog/fieldFile.js';\nimport {default as networkgenDialog} from '../dialog/networkgen.js';\nimport {default as renameDialog} from '../dialog/rename.js';\n\nimport {default as view} from './view.js';\nimport {default as sort} from './sort.js';\nimport {default as rowf} from './rowFilter.js';\nimport DatagridState from './state.js';\n\n\nfunction app(data, serverStatus) {\n  const menubar = d3.select('#menubar');\n  menubar.selectAll('div,span,a').remove();  // Clean up\n  const dialogs = d3.select('#dialogs');\n  dialogs.selectAll('div').remove();  // Clean up\n\n  const state = new DatagridState(data);\n  state.serverStatus = serverStatus;\n  d3.select('#datagrid')\n      .call(view.datagrid, state)\n      .call(sort.setSort, state);\n  d3.select('#dg-search')\n      .call(rowf.setFilter, state);\n\n  // Resize window\n  window.onresize = () =>\n    d3.select('#datagrid').call(view.resize, state);\n\n  // Datagrid view control\n  const menu = menubar.append('div')\n      .call(button.dropdownMenuButton, null, 'View control', 'primary')\n      .select('.dropdown-menu');\n  menu.append('a')\n      .call(fieldConfigDialog.menuLink);\n  menu.append('a')\n      .call(fieldFileDialog.menuLink);\n  menu.append('a')\n      .classed('networkgend', true)\n      .call(networkgenDialog.menuLink);\n  menu.append('a')\n      .call(renameDialog.menuLink);\n  menu.append('a')\n      .classed('saveview', true)\n      .call(button.dropdownMenuItem, null, 'Save to local storage')\n      .on('click', function () {\n        if (state.data.storeID) {\n          return idb.updateItem(state.data.storeID, item => {\n            item.id = misc.uuidv4();\n            item.name = state.data.name;\n            item.fields = state.data.fields;\n            item.records = state.data.records;\n          })\n          .then(() => console.info('Datagrid saved'));\n        } else {\n          return idb.putItem(state.export())\n            .then(storeID => {\n              window.location = `datagrid.html?id=${storeID}`;\n            });\n        }\n      });\n  menu.append('a')\n      .classed('exportjson', true)\n      .call(button.dropdownMenuItem, null, 'Export to JSON')\n      .on('click', () => {\n        const data = state.export();\n        // Delete local store information\n        delete data.storeID;\n        hfile.downloadJSON(data, data.name);\n      });\n  menu.append('a')\n      .classed('exportexcel', true)\n      .call(button.dropdownMenuItem, null, 'Export to Excel worksheet')\n      .on('click', () => {\n        const data = state.export();\n        const formData = new FormData();\n        formData.append('contents', new Blob([JSON.stringify(data)]));\n        return fetcher.post('xlsx', formData)\n          .then(fetcher.blob)\n          .then(blob => hfile.downloadDataFile(blob, `${data.name}.xlsx`));\n      });\n  // Open control panel\n  menubar.append('a')\n      .call(button.menuButtonLink, null, 'Control panel', 'outline-secondary')\n      .attr('href', 'control.html')\n      .attr('target', '_blank');\n  // Fetch control\n  const ongoing = ['running', 'ready'].includes(state.data.status);\n  if (ongoing) {\n  menubar.append('a')\n      .classed('refresh', true)\n      .call(button.menuButtonLink, null, 'Refresh', 'outline-secondary')\n      .on('click', function () {\n        return core.fetchProgress(state.data.storeID)\n          .then(() => idb.getItemByID(state.data.storeID))\n          .then(item => app(item, state.serverStatus));\n      });\n  menubar.append('a')\n      .call(button.menuButtonLink, null, 'Abort server job', 'warning')\n      .attr('data-toggle', 'modal')\n      .attr('data-target', '#abort-dialog');\n  menubar.append('span')\n      .classed('progress', true)\n    .append('progress')\n      .attr('max', 100)\n      .attr('value', state.data.progress)\n      .text(`${state.data.progress}%`);\n  }\n  menubar.append('span')\n    .classed('title', true)\n    .text(state.data.name);\n  menubar.append('span')\n      .classed('status', true)\n      .text(`(${state.data.status} - ${state.data.records.length} records found in ${state.data.execTime} sec.)`);\n\n  // disable on-line commands\n  if (!serverStatus.instance) {\n    menu.selectAll('.networkgend, .exportexcel')\n      .attr('data-target', null)\n      .classed('disabled', true)\n      .on('click', null);\n  }\n\n  // Dialogs\n  dialogs.append('div')\n      .classed('fieldconfd', true)\n      .call(fieldConfigDialog.body);\n  dialogs.append('div')\n      .classed('fieldfiled', true)\n      .call(fieldFileDialog.body);\n  dialogs.append('div')\n      .classed('netgend', true)\n      .call(networkgenDialog.body, serverStatus.rdkit);\n  dialogs.append('div')\n      .classed('renamed', true)\n      .call(renameDialog.body, state.data.name);\n  dialogs.append('div')\n      .classed('abortd', true)\n      .call(\n        modal.confirmDialog, 'abort-dialog',\n        'Are you sure you want to abort this calculation job?'\n      );\n  updateApp(state);\n}\n\n\nfunction updateApp(state) {\n  d3.select('#loading-icon').style('display', 'none');\n  // Title\n  d3.select('title').text(state.data.name);\n  d3.select('#menubar').select('.title').text(state.data.name);\n  // Dialogs\n  const dialogs = d3.select('#dialogs');\n  dialogs.select('.fieldconfd')\n      .call(fieldConfigDialog.updateBody, state)\n      .on('submit', function () {\n        state.data.fields = fieldConfigDialog.value(d3.select(this));\n        state.updateContentsNotifier();\n        updateApp(state);\n      });\n  dialogs.select('.fieldfiled')\n      .on('submit', function () {\n        return fieldFileDialog.readFile(d3.select(this))\n          .then(data => {\n            state.joinFields(data);\n            state.updateContentsNotifier();\n            updateApp(state);\n          });\n      });\n  dialogs.select('.netgend')\n      .on('submit', function () {\n        const formData = new FormData();\n        const params = networkgenDialog.queryParams(d3.select(this));\n        formData.append('params', JSON.stringify(params));\n        formData.append('contents', new Blob([JSON.stringify(state.export())]));\n        return fetcher.post(`${params.measure}net`, formData)\n          .then(fetcher.json)\n          .then(data => {\n            data.reference.nodes = state.data.storeID;\n            data.fields = misc.defaultFieldProperties(data.fields);\n            return data;\n          })\n          .then(idb.putItem)\n          .then(storeID => {\n            d3.select('#loading-icon').style('display', 'none');\n            window.open(`network.html?id=${storeID}`, '_blank');\n          });\n      });\n  dialogs.select('.renamed')\n      .call(renameDialog.updateBody, state)\n      .on('submit', function () {\n        state.data.name = renameDialog.value(d3.select(this));\n        updateApp(state);\n  });\n  dialogs.select('.abortd')\n      .on('submit', function () {\n        core.fetchProgress(state.data.storeID, 'abort')\n          .then(() => idb.getItemByID(state.data.storeID))\n          .then(item => app(item, state.serverStatus));\n      });\n}\n\n\nexport default {\n  app, updateApp\n};\n","\n/** @module datagrid/newDatagrid */\n\nimport d3 from 'd3';\n\nimport {default as misc} from '../common/misc.js';\nimport {default as idb} from '../common/idb.js';\nimport {default as fetcher} from '../common/fetcher.js';\nimport {default as hfile} from '../common/file.js';\n\nimport {default as button} from '../component/button.js';\n\nimport {default as searchDialog} from '../dialog/search.js';\nimport {default as structDialog} from '../dialog/struct.js';\nimport {default as filterDialog} from '../dialog/filter.js';\nimport {default as sdfDialog} from '../dialog/sdf.js';\n\nimport {default as datagridApp} from './datagridApp.js';\n\n\nfunction registerWorkflow(fetched) {\n  return fetcher.json(fetched)\n    .then(data => {\n      data.fields = misc.defaultFieldProperties(data.fields);\n      return data;\n    })\n    .then(idb.putItem)\n    .then(storeID => {\n      window.location = `datagrid.html?id=${storeID}`;\n    });\n  }\n\n\nfunction app(serverStatus, schema) {\n  const menubar = d3.select('#menubar');\n  menubar.selectAll('div,span,a').remove();  // Clean up\n  const dialogs = d3.select('#dialogs');\n  dialogs.selectAll('div').remove();  // Clean up\n\n  // New datagrid menu\n  const menu = menubar.append('div')\n      .call(button.dropdownMenuButton, null, '+ New datagrid', 'primary')\n      .select('.dropdown-menu');\n  menu.append('a')\n      .classed('searchd', true)\n      .call(searchDialog.menuLink);\n  menu.append('a')\n      .classed('structd', true)\n      .call(structDialog.menuLink);\n  menu.append('a')\n      .classed('filterd', true)\n      .call(filterDialog.menuLink);\n  menu.append('a')\n      .classed('sdfd', true)\n      .call(sdfDialog.menuLink);\n  menu.append('a')\n      .classed('import', true)\n      .call(button.dropdownMenuFile, 'import', 'Import view', '.ndc,.ndr,.json,.gz')\n      .on('change', function () {\n        const file = button.dropdownMenuFileValue(d3.select(this));\n        hfile.loadJSON(file)\n          .then(item => datagridApp.app(item, serverStatus, schema));\n      });\n  // Control panel\n  menubar.append('a')\n      .call(button.menuButtonLink, null, 'Control panel', 'outline-secondary')\n      .attr('href', 'control.html')\n      .attr('target', '_blank');\n\n  // disable on-line commands\n  if (!serverStatus.instance) {\n    menu.selectAll('.searchd, .structd, .filterd, .sdfd')\n      .attr('data-target', null)\n      .classed('disabled', true);\n  }\n\n  // Dialogs\n  const chemrsrc = schema.resources.filter(e => e.domain === 'chemical');\n  // ID search\n  dialogs.append('div')\n      .call(searchDialog.body, schema.compoundIDPlaceholder)\n      .on('submit', function () {\n        const targets = chemrsrc.map(e => e.id);\n        const query = searchDialog.query(d3.select(this), targets);\n        return fetcher.get(query.workflow, query)\n          .then(registerWorkflow);  // TODO: if err -> show err img\n      });\n  // Structure search\n  dialogs.append('div')\n      .call(structDialog.body, chemrsrc, serverStatus.rdkit)\n      .on('submit', function () {\n        const query = structDialog.query(d3.select(this));\n        return fetcher.get(query.workflow, query)\n          .then(registerWorkflow);\n      });\n  // Filter\n  dialogs.append('div')\n      .call(filterDialog.body, chemrsrc)\n      .on('submit', function () {\n        const query = filterDialog.query(d3.select(this));\n        return fetcher.get(query.workflow, query)\n          .then(registerWorkflow);\n      });\n  // Import SDFile\n  dialogs.append('div')\n      .call(sdfDialog.body, chemrsrc)\n      .on('submit', function () {\n        const formData = sdfDialog.queryFormData(d3.select(this));\n        return fetcher.post('sdfin', formData)\n          .then(registerWorkflow);\n      });\n}\n\n\nexport default {\n  app\n};\n","\n/** @module common/misc */\n\nimport d3 from 'd3';\nimport _ from 'lodash';\n\n\nfunction defaultFieldProperties(fields) {\n  return fields.map(e => {\n    if (!e.hasOwnProperty('name')) e.name = e.key;\n    if (!e.hasOwnProperty('visible')) e.visible = true;\n    if (e.hasOwnProperty('d3_format')) e.format = 'd3_format';\n    if (!e.hasOwnProperty('format')) e.format = 'raw';\n    return e;\n  });\n}\n\n\nfunction sortType(fmt) {\n  if (['numeric', 'd3_format'].includes(fmt)) return 'numeric';\n  if (['text', 'compound_id'].includes(fmt)) return 'text';\n  return 'none';\n}\n\n\n/**\n * Format number\n * @param {object} value - value\n * @param {string} type - si | scientific | rounded | raw\n */\nfunction formatNum(value, d3format) {\n  if (value === undefined || value === null || Number.isNaN(value)) return '';\n  return value == parseFloat(value) ? d3.format(d3format)(value) : value;\n}\n\n\nfunction partialMatch(query, target) {\n  if (target === undefined || target === null || target === '') return false;\n  return target.toString().toUpperCase()\n    .indexOf(query.toString().toUpperCase()) !== -1;\n}\n\n\nfunction URLQuery() {\n  const pairs = window.location.search.substring(1).split(\"&\")\n    .map(e => e.split('='));\n  return _.fromPairs(pairs);\n}\n\n\n// Ref. https://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript\nfunction uuidv4() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n    var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\n    return v.toString(16);\n  });\n}\n\n\nexport default {\n  defaultFieldProperties, sortType, formatNum, partialMatch, URLQuery, uuidv4\n};\n","\n/** @module common/idb */\n\nimport Dexie from 'Dexie';\n\nimport {default as misc} from './misc.js';\n\n\nconst schema = {\n  items: 'storeID, dataType, created'\n};\n\nlet idb = new Dexie('Store');\nidb.version(1).stores(schema);\n\n\n/**\n * Returns all data store items\n * @return {array} data store objects\n */\nfunction getAllItems() {\n  return idb.items\n    .orderBy('created')\n    .reverse()\n    .toArray();\n}\n\n\n/**\n * Get data store items by data type\n * @param {string} type - 'nodes' or 'edges'\n * @return {array} data store objects\n */\nfunction getItemsByDataType(type) {\n  return idb.items\n    .where('dataType')\n    .equals(type)\n    .reverse()\n    .sortBy('created')\n    .catch(err => {\n      console.error(`IDBError: Unexpected dataType: ${type}`, err);\n    });\n}\n\n\n/**\n * Get data store items by store ID\n * @param {string} storeID - store ID\n * @return {array} data store object\n */\nfunction getItemByID(storeID) {\n  return idb.items\n    .where('storeID')\n    .equals(storeID)\n    .first()\n    .catch(err => {\n      console.error(`IDBError: Unexpected table ID: ${storeID}`, err);\n    });\n}\n\n\n/**\n * Delete a data object from the store\n * @param {string} storeID - store ID\n * @return {integer} - number of deleted items\n */\nfunction deleteItem(storeID) {\n  return idb.items\n    .where('storeID')\n    .equals(storeID)\n    .delete();\n}\n\n\n/**\n * Insert a data object to the store\n * @param {object} data - data\n * @return {string} - storeID if sucessfully added\n */\nfunction putItem(data) {\n  if (!data.storeID) {\n    data.storeID = misc.uuidv4();\n  }\n  return idb.items.put(data);\n}\n\n\n/**\n * Update data object in the store\n * @param {string} storeID - store ID\n * @param {function} updateFunc - update function\n * @return {integer} - number of updated items\n */\nfunction updateItem(storeID, updateFunc) {\n  return idb.items\n    .where('storeID')\n    .equals(storeID)\n    .modify(updateFunc)\n    .catch(err => {\n      console.error('IDBError: Update failed', err);\n    });\n}\n\n\n/**\n * Delete all data store\n * Try this before dealing with local db issues\n */\nfunction reset() {\n  return idb.delete().then(() => {\n    idb = new Dexie('Store');\n    idb.version(1).stores(schema);\n  });\n}\n\n\nexport default {\n  getAllItems, getItemsByDataType, getItemByID,\n  deleteItem, putItem, updateItem, reset\n};\n","\n/** @module common/fetcher */\n\n\nconst baseURL = '';\n\nfunction get(url, query={}) {\n  const isEmpty = Object.keys(query).length;\n  const q = isEmpty ? `?query=${JSON.stringify(query)}` : '';\n  return fetch(\n    `${baseURL}${url}${q}`,\n    {\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\nfunction json(response) {\n  return response.json();\n}\n\nfunction text(response) {\n  return response.text();\n}\n\nfunction blob(response) {\n  return response.blob();\n}\n\nfunction post(url, formdata) {\n  return fetch(\n    `${baseURL}${url}`,\n    {\n      method: 'POST',\n      body: formdata,\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\n\nfunction error(err) {\n  console.error(err);\n  return null;\n}\n\n\nexport default {\n  get, json, text, blob, post, error\n};\n","\n/** @module common/core */\n\nimport {default as idb} from './idb.js';\nimport {default as fetcher} from './fetcher.js';\nimport {default as misc} from './misc.js';\n\n\nfunction fetchProgress(storeID, command='update') {\n  return idb.getItemByID(storeID)\n    .then(data => {\n      if (!data) return Promise.reject(`Store: ${storeID} is not available`);\n      if (!['ready', 'running'].includes(data.status)) return;\n      const query = {id: data.reference.workflow, command: command};\n      return fetcher.get('progress', query)\n        .then(fetcher.json)\n        .then(data => {\n          if (data.status === 'failure') {  // No data found on server\n            return idb.updateItem(storeID, item => {\n              item.status = 'failure';\n            });\n          }\n          return idb.updateItem(storeID, item => {\n            item.status = data.status;\n            item.progress = data.progress;\n            item.execTime = data.execTime;\n            item.fields = misc.defaultFieldProperties(data.fields);\n            item.records = data.records;\n          });\n        });\n    });\n}\n\n\nexport default {\n  fetchProgress\n};\n","\n/** @module datagrid/state */\n\nimport _ from 'lodash';\n\nimport {default as legacy} from '../common/legacySchema.js';\nimport {default as mapper} from '../common/mapper.js';\nimport {default as misc} from '../common/misc.js';\n\n\nexport default class DatagridState {\n  constructor(data) {\n\n    // Import from legacy format data\n    this.data = legacy.convertTable(data);\n\n    this.fields = null;\n    this.visibleFields = null;\n    this.sortedRecords = null;\n    this.filteredRecords = null;\n\n    // Snapshot\n    const snp = this.data.snapshot || {sortOrder: [], filterText: null};\n    this.sortOrder = snp.sortOrder || [];\n    this.filterText = snp.filterText || null;\n\n    this.defaultColumnWidth = {\n      numeric: 120,\n      text: 200,\n      none: 200\n    };\n    this.defaultColumnHeight = {\n      numeric: 40,\n      text: 40,\n      none: 200\n    };\n    this.scrollBarSpace = 20;\n\n    this.keyFunc = d => d.index;\n\n    // Size\n    this.rowHeight = null;\n    this.contentWidth = null;\n    this.bodyHeight = null;\n\n    // Viewport\n    this.viewportHeight = null;\n    this.numViewportRows = null;\n    this.previousNumViewportRows = null;\n    this.viewportTop = null;\n    this.previousVieportTop = null;\n    this.viewportBottom = null;\n\n    // Event notifier\n    this.updateContentsNotifier = null;\n    this.updateFilterNotifier = null;\n\n    // Initialize\n    this.applyData();\n  }\n\n  setViewportSize(height) {\n    this.viewportHeight = height;\n    this.previousNumViewportRows = this.numViewportRows;\n    this.numViewportRows = Math.ceil(this.viewportHeight / this.rowHeight) + 1;\n  }\n\n  setScrollPosition(position) {\n    this.previousVieportTop = this.viewportTop;\n    this.viewportTop = position;\n    this.viewportBottom = Math.min(\n      this.viewportTop + this.numViewportRows, this.filteredRecords.length);\n  }\n\n  setSortOrder(key, order) {\n    const ki  = this.sortOrder.findIndex(e => e.key);\n    const obj = {key: key, order: order};\n    if (ki !== -1) this.sortOrder.splice(ki, 1);\n    this.sortOrder.splice(0, 0, obj);\n    this.applyOrder(key, order);\n  }\n\n  setFilterText(text) {\n    this.filterText = text;\n    this.applyFilter();\n  }\n\n  joinFields(mapping) {\n    mapper.apply(this.data, mapping);\n    this.applyData();\n  }\n\n  applyData() {\n    this.fields = this.data.fields.map(e => {\n      const field = {\n        width: this.defaultColumnWidth[misc.sortType(e.format)],\n        height: this.defaultColumnHeight[misc.sortType(e.format)]\n      };\n      return Object.assign(field, e);\n    });\n    this.visibleFields = this.fields.filter(e => e.visible);\n    this.rowHeight = this.visibleFields\n      .reduce((a, b) => a.height > b.height ? a : b).height;\n    this.contentWidth = this.visibleFields\n      .reduce((a, b) => ({width: a.width + b.width})).width + this.scrollBarSpace;\n    this.applyOrder();\n  }\n\n  applyOrder(key, order) {\n    if (key) {\n      this.sortedRecords = _.orderBy(this.data.records.slice(), [key], [order]);\n    } else {\n      const keys = this.sortOrder.map(e => e.key);\n      const orders = this.sortOrder.map(e => e.order);\n      if (keys) {\n        this.sortedRecords = _.orderBy(this.data.records.slice(), keys, orders);\n      }\n    }\n    this.applyFilter();\n  }\n\n  applyFilter() {\n    if (this.filterText === null) {\n      this.filteredRecords = this.sortedRecords.slice();\n    } else {\n      const fields = this.visibleFields\n        .filter(e => misc.sortType(e.format) !== 'none')\n        .map(e => e.key);\n      this.filteredRecords = this.sortedRecords.filter(row => {\n        return fields.some(f => misc.partialMatch(this.filterText, row[f]));\n      });\n    }\n    this.bodyHeight = this.filteredRecords.length * this.rowHeight;\n    this.setScrollPosition(0);\n  }\n\n  recordsToShow() {\n    return this.filteredRecords.slice(this.viewportTop, this.viewportBottom);\n  }\n\n  export() {\n    this.data.id = misc.uuidv4();\n    return this.data;\n  }\n\n}\n","\n/** @module common/image */\n\nimport vega from 'vega';\n\nfunction showPlot(vegaSpec, selector) {\n  new vega.View(vega.parse(vegaSpec))\n    .initialize(selector)\n    .run();\n}\n\n\nfunction plotThumbnail(vegaSpec) {\n  const view = new vega.View(vega.parse(vegaSpec));\n  return view.toImageURL('png');  // Promise\n}\n\n\nexport default {\n  showPlot, plotThumbnail\n};\n","\n/** @module component/button */\n\nimport d3 from 'd3';\n\n\nfunction buttonBox(selection, id, label, type) {\n  selection\n      .classed('form-group', true)\n      .classed('mb-1', true)\n    .append('button')\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed('btn-sm', true)\n      .attr('id', id)\n      .text(label);\n}\n\n\nfunction menuButton(selection, id, label, type) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .attr('id', id)\n      .text(label);\n}\n\n\nfunction menuButtonLink(selection, id, label, type) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .attr('role', 'button')\n      .attr('href', '#')\n      .attr('id', id)\n      .text(label);\n}\n\n\nfunction menuModalLink(selection, id, label, type, target) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .attr('id', id)\n      .attr('href', '#')\n      .attr('role', 'button')\n      .attr('data-toggle', 'modal')\n      .attr('data-target', `#${target}`)\n      .text(label);\n}\n\n\nfunction dropdownMenuButton(selection, id, label, type) {\n  selection\n      .classed('btn-group', true)\n      .classed('mr-1', true)\n      .attr('id', id);\n  selection.append('button')\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed('btn-sm', true)\n      .classed('dropdown-toggle', true)\n      .attr('data-toggle', 'dropdown')\n      .text(label);\n  selection.append('div')\n      .classed('dropdown-menu', true);\n}\n\n\nfunction dropdownMenuItem(selection, id, label) {\n  selection.classed('dropdown-item', true)\n      .attr('id', id)\n      .attr('href', '#')\n      .text(label);\n}\n\nfunction dropdownMenuModal(selection, id, label, target) {\n  selection.classed('dropdown-item', true)\n      .attr('id', id)\n      .attr('href', '#')\n      .attr('data-toggle', 'modal')\n      .attr('data-target', `#${target}`)\n      .text(label);\n}\n\n\nfunction dropdownMenuFile(selection, id, label, accept) {\n  selection.classed('dropdown-item', true)\n      .attr('id', id)\n      .attr('href', '#')\n      .text(label)\n      .on('click', function () {\n        d3.select(this).select('input').node().click();\n      })\n    .append('form')\n      .style('display', 'none')\n    .append('input')\n      .attr('type', 'file')\n      .attr('accept', accept);\n}\n\n\nfunction dropdownMenuFileValue(selection) {\n  return selection.select('input').node().files[0];\n}\n\n\nexport default {\n  buttonBox, menuButton, menuButtonLink, menuModalLink,\n  dropdownMenuButton, dropdownMenuItem, dropdownMenuModal,\n  dropdownMenuFile, dropdownMenuFileValue\n};\n","\n/** @module dialog/fieldFile */\n\nimport {default as mapper} from '../common/mapper.js';\nimport {default as hfile} from '../common/file.js';\nimport {default as himg} from '../common/image.js';\n\nimport {default as button} from '../component/button.js';\nimport {default as box} from '../component/formBox.js';\nimport {default as modal} from '../component/modal.js';\nimport {default as table} from '../component/table.js';\n\n\nconst id = 'fieldfile-dialog';\nconst title = 'Import fields from file';\n\n\nfunction menuLink(selection) {\n  selection.call(button.dropdownMenuModal, 'fieldfile', title, id);\n}\n\n\nfunction body(selection) {\n  const dialog = selection.call(modal.submitDialog, id, title);\n  const fileInput = dialog.select('.modal-body').append('div')\n      .classed('file', true)\n      .call(box.fileInputBox, 'fieldfile-file', 'File', '.json,.csv');\n  const preview = dialog.select('.modal-body').append('div')\n      .classed('preview', true)\n      .call(table.render);\n  fileInput\n      .on('change', () => {\n        const file = box.fileInputBoxValue(fileInput);\n        const isCsv = file.name.split('.').pop() === 'csv';\n        hfile.readFile(file)\n          .then(res => {\n            const mapping = isCsv ? mapper.csvToMapping(res) : JSON.parse(res);\n            const tbl = mapper.mappingToTable(mapping);\n            preview.call(table.updateHeader, tbl.fields, tbl.records.slice(0, 5));\n          });\n      });\n}\n\n\nfunction readFile(selection) {\n  const file = box.fileInputBoxValue(selection.select('.file'));\n  const isCsv = file.name.split('.').pop() === 'csv';\n  return hfile.readFile(file)\n    .then(res => {\n      let mapping = isCsv ? mapper.csvToMapping(res) : JSON.parse(res);\n      if (mapping.hasOwnProperty('field')) {\n        mapping = mapper.singleToMulti(mapping);\n      }\n      const plotCols = [];\n      mapping.fields.forEach((e, i) => {\n        if (e.format === 'plot') {\n          mapping.fields[i].format = 'image';\n          plotCols.push(i);\n        }\n      });\n      if (plotCols.length > 0) {\n        const ps = [];\n        Object.entries(mapping.mapping).forEach(m => {\n          plotCols.forEach(e => {\n            const p = himg.plotThumbnail(m[1][e])\n              .then(img => {\n                mapping.mapping[m[0]][e] = img;\n              });\n            ps.push(p);\n          });\n        });\n        return Promise.all(ps).then(() => mapping);\n      } else {\n        return mapping;\n      }\n    });\n}\n\n\nexport default {\n  menuLink, body, readFile\n};\n","\n/** @module dialog/networkgen */\n\nimport d3 from 'd3';\n\nimport {default as button} from '../component/button.js';\nimport {default as box} from '../component/formBox.js';\nimport {default as lbox} from '../component/formListBox.js';\nimport {default as modal} from '../component/modal.js';\n\nimport {default as group} from './formGroup.js';\n\n\nconst id = 'networkgen-dialog';\nconst title = 'Generate similarity network';\n\n\nfunction menuLink(selection) {\n  selection.call(button.dropdownMenuModal, 'fieldconf', title, id);\n}\n\n\nfunction body(selection, rdk) {\n  const dialog = selection.call(modal.submitDialog, id, title);\n  // Similarity measure\n  const measures = [\n    {key: 'gls', name: 'Graph-based local similarity(GLS)'}\n  ];\n  if (rdk) {\n    measures.push({key: 'rdmorgan', name: 'RDKit Morgan similarity'});\n    measures.push({key: 'rdfmcs', name: 'RDKit FMCS'});\n  }\n  dialog.select('.modal-body').append('div')\n      .classed('measure', true)\n      .call(lbox.selectBox, 'networkgen-measure', 'Measure', measures, 'gls');\n  // Threshold\n  dialog.select('.modal-body').append('div')\n      .classed('thld', true)\n      .call(box.numberBox, 'networkgen-thld', 'Threshold',\n            0.5, 1, 0.01, 0.5);\n  // Similarity search options\n  dialog.select('.modal-body').append('div')\n      .classed('option', true)\n      .call(group.simOptionGroup, 'networkgen');\n  // Events\n  dialog.select('.measure')\n      .on('change', function () {\n        const value = lbox.selectBoxValue(d3.select(this));\n        dialog.selectAll('.diam, .tree, .skip')\n          .select('input')\n            .property('disabled', value !== 'gls');\n        dialog.select('.timeout')\n          .select('input')\n            .property('disabled', value !== 'rdfmcs');\n      })\n      .dispatch('change');\n}\n\n\nfunction queryParams(selection) {\n  const measure = selection.select('.measure');\n  const thld = selection.select('.thld');\n  const params = group.simOptionGroupValue(selection.select('.option'));\n  if (!measure.select('select').property('disabled')) {\n    params.measure = lbox.selectBoxValue(measure);\n  }\n  if (!thld.select('input').property('disabled')) {\n    params.threshold = box.numberBoxValue(thld);\n  }\n  return params;\n}\n\n\n\nexport default {\n  menuLink, body, queryParams\n};\n","\n/** @module dialog/rename */\n\n\nimport {default as button} from '../component/button.js';\nimport {default as box} from '../component/formBox.js';\nimport {default as modal} from '../component/modal.js';\n\n\nconst id = 'rename-dialog';\nconst title = 'Rename view';\n\n\nfunction menuLink(selection) {\n  selection.call(button.dropdownMenuModal, 'rename', title, id);\n}\n\n\nfunction body(selection, name) {\n  selection.call(modal.submitDialog, id, title)\n    .select('.modal-body').append('div')\n      .classed('rename', true)\n      .call(box.textBox, 'rename', 'New name', 40, name);\n}\n\n\nfunction updateBody(selection, state) {\n  selection.select('.rename')\n      .call(box.updateTextBox, state.data.name);\n}\n\n\nfunction value(selection) {\n  return box.textBoxValue(selection.select('.rename'));\n}\n\n\nexport default {\n  menuLink, body, updateBody, value\n};\n","\n/** @module datagrid/rowFilter */\n\nimport {default as box} from '../component/formBox.js';\n\n\nfunction setFilter(selection, state) {\n  const searchBox = selection\n      .classed('row', true)\n      .classed('justify-content-end', true)\n    .append('div')\n      .classed('col-5', true)\n      .call(box.textBox, null, 'Search', 40, null);\n  searchBox.select('label').classed('text-right', true);\n  searchBox.select('input')\n    .on('keyup', function () {\n      state.updateFilterNotifier(box.textBoxValue(searchBox));\n    });\n}\n\n\nexport default {\n  setFilter\n};\n","\n/** @module dialog/search */\n\n\nimport {default as button} from '../component/button.js';\nimport {default as box} from '../component/formBox.js';\nimport {default as modal} from '../component/modal.js';\n\n\nconst id = 'search-dialog';\nconst title = 'Search by compound ID';\n\n\nfunction menuLink(selection) {\n  selection.call(button.dropdownMenuModal, 'search', title, id);\n}\n\n\nfunction body(selection, placeholder) {\n  selection.call(modal.submitDialog, id, title)\n    .select('.modal-body').append('div')\n      .classed('ids', true)\n      .call(box.textareaBox, 'search-query', 'Query', 20, placeholder, '');\n}\n\n\nfunction query(selection, targets) {\n  return {\n    workflow: 'search',\n    targets: targets,\n    key: 'compound_id',\n    values: box.textareaBoxLines(selection.select('.ids'))\n  };\n}\n\n\nexport default {\n  menuLink, body, query\n};\n","\n/** @module dialog/struct */\n\nimport d3 from 'd3';\n\nimport {default as button} from '../component/button.js';\nimport {default as box} from '../component/formBox.js';\nimport {default as lbox} from '../component/formListBox.js';\nimport {default as modal} from '../component/modal.js';\nimport {default as group} from './formGroup.js';\n\n\nconst id = 'struct-dialog';\nconst title = 'Search by structure';\n\n\nfunction menuLink(selection) {\n  selection.call(button.dropdownMenuModal, 'struct', title, id);\n}\n\n\nfunction body(selection, resources, rdk) {\n  const dialog = selection.call(modal.submitDialog, id, title);\n  // Query molecule\n  dialog.select('.modal-body').append('div')\n      .classed('qmol', true)\n      .call(group.queryMolGroup, 'struct', resources, null);\n  // Search type\n  const methodList = [\n    {key: 'exact', name: 'Exact match'},\n    {key: 'substr', name: 'Substructure'},\n    {key: 'supstr', name: 'Superstructure'},\n    {key: 'gls', name: 'MCS-DR/GLS'}\n  ];\n  if (rdk) {\n    methodList.push({key: 'rdmorgan', name: 'RDKit Morgan similarity'});\n    methodList.push({key: 'rdfmcs', name: 'RDKit FMCS'});\n  }\n  dialog.select('.modal-body').append('div')\n      .classed('method', true)\n      .call(lbox.selectBox, 'struct-method', 'Method', methodList, 'exact');\n  // Measure\n  dialog.select('.modal-body').append('div')\n      .classed('measure', true)\n      .call(lbox.selectBox, 'struct-measure', 'Measure',\n            [\n              {key: 'sim', name: 'Similarity'},\n              {key: 'edge', name: 'Edge count'}\n            ], 'sim');\n  // Threshold\n  dialog.select('.modal-body').append('div')\n      .classed('thld', true)\n      .call(box.numberBox, 'struct-thld', 'Threshold',\n            0.5, 1, 0.01, 0.5);\n  // Similarity search options\n  dialog.select('.modal-body').append('div')\n      .classed('option', true)\n      .call(group.simOptionGroup, 'struct');\n  // Targets\n  const res = resources.map(d => ({key: d.id, name: d.name}));\n  dialog.select('.modal-body').append('div')\n      .classed('target', true)\n      .call(lbox.checklistBox, 'struct-target', 'Target databases', res, null);\n\n  // Events\n  dialog.select('.method')\n      .on('change', function () {\n        const value = lbox.selectBoxValue(d3.select(this));\n        const mcs = ['gls', 'rdfmcs'].includes(value);\n        dialog.select('.measure')\n          .select('select')\n            .property('value', mcs ? undefined : 'sim')\n            .property('disabled', !mcs);\n        dialog.selectAll('.thld')\n          .select('input')\n            .property('disabled', ['exact', 'substr', 'supstr'].includes(value));\n        dialog.selectAll('.diam, .tree, .skip')\n          .select('input')\n            .property('disabled', value !== 'gls');\n        dialog.select('.timeout')\n          .select('input')\n            .property('disabled', value !== 'rdfmcs');\n      })\n      .dispatch('change');\n}\n\n\nfunction query(selection) {\n  const params = group.simOptionGroupValue(selection.select('.option'));\n  const measure = selection.select('.measure');\n  const thld = selection.select('.thld');\n  if (!measure.select('select').property('disabled')) {\n    params.measure = lbox.selectBoxValue(measure);\n  }\n  if (!thld.select('input').property('disabled')) {\n    params.threshold = box.numberBoxValue(thld);\n  }\n  const query = {\n    workflow: lbox.selectBoxValue(selection.select('.method')),\n    targets: lbox.checklistBoxValue(selection.select('.target')),\n    queryMol: group.queryMolGroupValue(selection.select('.qmol')),\n    params: params\n  };\n  return query;\n}\n\n\nexport default {\n  menuLink, body, query\n};\n","\n/** @module dialog/filter */\n\nimport _ from 'lodash';\n\nimport {default as button} from '../component/button.js';\nimport {default as box} from '../component/formBox.js';\nimport {default as lbox} from '../component/formListBox.js';\nimport {default as modal} from '../component/modal.js';\n\n\nconst id = 'filter-dialog';\nconst title = 'Search by properties';\n\n\nfunction menuLink(selection) {\n  selection.call(button.dropdownMenuModal, 'prop', title, id);\n}\n\n\nfunction body(selection, resources) {\n  const dialog = selection.call(modal.submitDialog, id, title);\n  const fields = _(resources.map(e => e.fields))\n    .flatten()\n    .uniqBy('key')\n    .value()\n    .filter(e => e.hasOwnProperty('d3_format')\n                 || ['compound_id', 'numeric', 'text'].includes(e.format));\n  dialog.select('.modal-body').append('div')\n    .classed('key', true)\n    .call(lbox.selectBox, 'filter-field', 'Field', fields, null);\n  dialog.select('.modal-body').append('div')\n    .classed('operator', true)\n    .call(lbox.selectBox, 'filter-op', 'Operator',\n          [\n            {key: 'eq', name: '='},\n            {key: 'gt', name: '>'},\n            {key: 'lt', name: '<'},\n            {key: 'ge', name: '>='},\n            {key: 'le', name: '>='},\n            {key: 'lk', name: 'LIKE'}\n          ], 'eq');\n  dialog.select('.modal-body').append('div')\n    .classed('value', true)\n    .call(box.textBox, 'filter-value', 'Value', null, '');\n  // Targets\n  const res = resources.map(d => ({key: d.id, name: d.name}));\n  dialog.select('.modal-body').append('div')\n      .classed('target', true)\n      .call(lbox.checklistBox, 'struct-target', 'Target databases', res, null);\n}\n\n\nfunction query(selection) {\n  return {\n    workflow: 'filter',\n    targets: lbox.checklistBoxValue(selection.select('.target')),\n    key: lbox.selectBoxValue(selection.select('.key')),\n    value: box.textBoxValue(selection.select('.value')),\n    operator: lbox.selectBoxValue(selection.select('.operator'))\n  };\n}\n\n\nexport default {\n  menuLink, body, query\n};\n","\n/** @module dialog/sdf */\n\nimport d3 from 'd3';\n\nimport {default as hfile} from '../common/file.js';\n\nimport {default as button} from '../component/button.js';\nimport {default as box} from '../component/formBox.js';\nimport {default as lbox} from '../component/formListBox.js';\nimport {default as modal} from '../component/modal.js';\n\n\nfunction getSDFPropList(str) {\n  const re = />.*?<(\\S+)>/g;\n  const uniqCols = new Set();\n  let arr;\n  while ((arr = re.exec(str)) !== null) {\n    uniqCols.add(arr[1]);\n  }\n  return Array.from(uniqCols);\n}\n\n\nconst id = 'sdf-dialog';\nconst title = 'Import SDFile';\n\n\nfunction menuLink(selection) {\n  selection.call(button.dropdownMenuModal, 'sdf', title, id);\n}\n\n\nfunction body(selection) {\n  const dialog = selection.call(modal.submitDialog, id, title);\n  dialog.select('.modal-body').append('div')\n      .classed('file', true)\n      .call(box.fileInputBox, 'sdf-file', 'File', '.mol,.sdf');\n  dialog.select('.modal-body').append('div')\n      .classed('field', true)\n      .call(lbox.checklistBox, 'sdf-fields', 'Fields', [], null);\n  dialog.select('.modal-body').append('div')\n      .classed('implh', true)\n      .call(box.checkBox, 'sdf-implh', 'Make hydrogens implicit', true);\n  dialog.select('.modal-body').append('div')\n      .classed('recalc', true)\n      .call(box.checkBox, 'sdf-recalc', 'Recalculate 2D coords', false);\n\n  dialog.select('.file')\n      .on('change', function () {\n        const file = box.fileInputBoxValue(d3.select(this));\n        // Scan only first 100mb of the file due to memory limit.\n        return hfile.readFile(file, 100 * 1024 * 1024, false)\n          .then(data => {\n            const fields = getSDFPropList(data)\n              .map(e => ({key: e, name: e}));\n            dialog.select('.field')\n              .call(lbox.checklistBoxItems, fields);\n          });\n      });\n}\n\n\nfunction queryFormData(selection) {\n  const params = {\n    fields: lbox.checklistBoxValue(selection.select('.field')),\n    implh: box.checkBoxValue(selection.select('.implh')),\n    recalc: box.checkBoxValue(selection.select('.recalc'))\n  };\n  const formData = new FormData();\n  formData.append('contents', box.fileInputBoxValue(selection.select('.file')));\n  formData.append('params', JSON.stringify(params));\n  return formData;\n}\n\n\n\nexport default {\n  menuLink, body, queryFormData\n};\n","\n/** @module datagrid */\n\nimport {default as core} from './common/core.js';\nimport {default as fetcher} from './common/fetcher.js';\nimport {default as hfile} from './common/file.js';\nimport {default as idb} from './common/idb.js';\nimport {default as misc} from './common/misc.js';\n\nimport DatagridState from './datagrid/state.js';\nimport {default as sort} from './datagrid/sort.js';\nimport {default as view} from './datagrid/view.js';\nimport {default as datagridApp} from './datagrid/datagridApp.js';\nimport {default as newDatagrid} from './datagrid/newDatagrid.js';\n\n\nfunction run() {\n  // TODO: offline mode flags\n  const localFile = document.location.protocol !== \"file:\";  // TODO\n  const offLine = 'onLine' in navigator && !navigator.onLine;  // TODO\n  const response = {};\n  return fetcher.get('server')\n    .then(fetcher.json)\n    .then(res => {\n      response.server = res;\n    })\n    .then(() => fetcher.get('schema'))\n    .then(fetcher.json)\n    .then(res => {\n      response.schema = res;\n    })\n    .catch(() => {\n      console.info('Server did not respond');\n      response.server = {};\n      response.schema = {\n        resources: [], templates: [], compoundIDPlaceholder: null\n      };\n    })\n    .then(() => {\n      console.info('Off-line mode is disabled for debugging');\n      const storeID = misc.URLQuery().id || null;\n      const dataURL = misc.URLQuery().location || null;\n      const error = misc.URLQuery().err || null;\n      if (error) {\n        console.error(decodeURI(error));\n      }\n      if (storeID) {\n        // Load from IndexedDB store\n        core.fetchProgress(storeID, 'update')\n          .then(() => idb.getItemByID(storeID))\n          .then(item => datagridApp.app(item, response.server))\n          .catch(err => {\n            window.location = `datagrid.html?err=${err}`;\n          });\n      } else if (dataURL) {\n        // Fetch via HTTP\n        hfile.fetchJSON(dataURL)\n          .then(item => datagridApp.app(item, response.server));\n      } else {\n        // New datagrid\n        newDatagrid.app(response.server, response.schema);\n      }\n    });\n}\n\n\nexport default {\n  DatagridState, sort, view, run\n};\n"],"names":["readFile","file","sizeLimit","blob","Promise","resolve","reject","reader","FileReader","truncated","slice","onload","event","target","result","onerror","error","readAsArrayBuffer","readAsText","parseJSON","data","compressed","text","pako","inflate","to","JSON","parse","downloadDataFile","name","url","window","URL","createObjectURL","Blob","a","document","createElement","download","href","dispatchEvent","MouseEvent","view","bubbles","cancelable","e","v07_to_v08_nodes","json","fields","columns","map","sort","format","id","dataType","dataTypeConv","schemaVersion","revision","status","statusConv","records","query","taskCount","searchCount","doneCount","searchDoneCount","resultCount","recordCount","progress","execTime","created","startDate","responseDate","v10_nodes","reference","singleToMulti","mapping","newMapping","Object","entries","forEach","m","field","key","updateViewport","selection","state","style","contentWidth","select","on","scrollTop","d3","this","node","pos","Math","floor","rowHeight","previousViewportTop","setScrollPosition","call","updateRows","updateRowFunc","visibleFields","dispatch","record","value","cell","append","classed","width","undefined","misc","formatNum","d3_format","includes","attr","img","plotCell","html","rowFactory","bodyHeight","rows","selectAll","recordsToShow","keyFunc","exit","remove","enter","merge","each","d","i","rowPos","viewportTop","setSort","filter","sortType","isAsc","setSortOrder","component","updateContentsNotifier","applyData","updateContents","resize","getBoundingClientRect","top","setViewportSize","innerHeight","resizeViewport","dialogBase","selectBoxItems","items","options","updateSelectBox","property","checklistBoxItems","listitems","form","updateChecklistBox","values","updateHeader","header","visible","generalFormat","formatSelect","lbox","updateTextBox","updateTextareaBox","updateCheckBox","checked","updateNumberBox","updateQueryMolGroup","selectBoxValue","queryMolGroupValue","fetcher","get","then","res","source","textquery","box","textBoxValue","areaquery","textareaBoxLines","app","serverStatus","menubar","dialogs","DatagridState","datagrid","rowf","setFilter","onresize","menu","button","dropdownMenuButton","fieldConfigDialog","menuLink","fieldFileDialog","networkgenDialog","renameDialog","dropdownMenuItem","storeID","idb","updateItem","item","uuidv4","console","info","putItem","export","location","hfile","downloadJSON","formData","FormData","stringify","post","menuButtonLink","core","fetchProgress","getItemByID","length","instance","body","rdkit","modal","confirmDialog","updateApp","updateBody","joinFields","params","queryParams","measure","nodes","defaultFieldProperties","open","registerWorkflow","fetched","hasOwnProperty","fmt","d3format","Number","isNaN","parseFloat","partialMatch","toString","toUpperCase","indexOf","URLQuery","pairs","search","substring","split","_","fromPairs","replace","c","r","random","schema","Dexie","version","stores","getAllItems","orderBy","reverse","toArray","getItemsByDataType","type","where","equals","sortBy","catch","err","first","deleteItem","delete","put","updateFunc","modify","reset","baseURL","q","keys","fetch","credentials","Error","statusText","response","formdata","method","command","workflow","loadJSON","endsWith","fetchJSON","decoded","decodeURIComponent","arrayBuffer","compress","str","gzip","Queued","In progress","Aborting","Aborted","Completed","Failure","datatable","connection","convertTable","index","structure","_structure","_index","v08_nodes","$schema","convertNetwork","edges","nodeFields","snp","fieldTransform","snapshot","nodePositions","nodeColor","nodeSize","nodeLabel","edge","scale","find","column","domain","range","unknown","size","nodeContent","label","nodeTableId","networkThreshold","v07_to_v08_edges","nodesID","idx_converter","v08_graph","nodeContentVisible","schemeCategory20","nodeLabelColor","edgeVisible","edgeWidth","edgeLabel","threshold","coords","v10_edges","mappingToTable","mp","keyField","concat","entry","rcd","f","tableToMapping","table","ignore","Date","row","csvToMapping","csvString","lines","shift","now","headerIdx","h","push","line","k","Array","apply","fd","uniqBy","[object Object]","legacy","sortedRecords","filteredRecords","sortOrder","filterText","defaultColumnWidth","numeric","none","defaultColumnHeight","scrollBarSpace","viewportHeight","numViewportRows","previousNumViewportRows","previousVieportTop","viewportBottom","updateFilterNotifier","height","ceil","position","min","order","ki","findIndex","obj","splice","applyOrder","applyFilter","mapper","assign","reduce","b","orders","some","showPlot","vegaSpec","selector","vega","View","initialize","run","plotThumbnail","toImageURL","setFilterText","buttonBox","menuButton","menuModalLink","dropdownMenuModal","dropdownMenuFile","accept","click","dropdownMenuFileValue","files","message","base","footer","submitDialog","title","selectBox","checklistBox","checklistBoxValue","render","caption","tableRowValue","textBox","readonlyBox","textareaBox","placeholder","textareaBoxValue","checkBox","checkBoxValue","numberBox","max","step","numberBoxValue","fileInputBox","fileInputBoxValue","dialog","fileInput","preview","isCsv","pop","tbl","plotCols","ps","p","himg","all","queryMolGroup","resources","$","popover","trigger","simOptionGroup","collapse","simOptionGroupValue","timeout","diam","tree","skip","ignoreHs","diameter","maxTreeSize","molSizeCutoff","rdk","measures","group","thld","searchBox","targets","methodList","mcs","queryMol","flatten","operator","re","uniqCols","Set","arr","exec","add","from","getSDFPropList","queryFormData","implh","recalc","searchDialog","structDialog","filterDialog","sdfDialog","datagridApp","chemrsrc","compoundIDPlaceholder","protocol","navigator","onLine","server","templates","dataURL","decodeURI","newDatagrid"],"mappings":"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"}