{"version":3,"file":"profileApp.js","sources":["../src/common/misc.js","../src/common/fetcher.js","../src/component/button.js","../src/component/table.js","../src/common/mapper.js","../src/datagrid/rowFactory.js","../src/common/image.js","../src/datagrid/state.js","../src/datagrid/component.js","../src/datagrid/view.js","../src/component/formBox.js","../src/datagrid/rowfilter.js","../src/profileApp.js"],"sourcesContent":["\n/** @module common/misc */\n\nimport d3 from 'd3';\nimport _ from 'lodash';\n\n\nfunction defaultFieldProperties(fields) {\n  return fields.map(e => {\n    if (!e.hasOwnProperty('name')) e.name = e.key;\n    if (!e.hasOwnProperty('visible')) e.visible = true;\n    if (e.hasOwnProperty('d3_format')) e.format = 'd3_format';\n    if (!e.hasOwnProperty('format')) e.format = 'raw';\n    return e;\n  });\n}\n\n\nfunction sortType(fmt) {\n  if (['numeric', 'd3_format'].includes(fmt)) return 'numeric';\n  if (['text', 'compound_id', 'assay_id', 'list'].includes(fmt)) return 'text';\n  return 'none';\n}\n\n\n/**\n * Format number\n * @param {object} value - value\n * @param {string} type - si | scientific | rounded | raw\n */\nfunction formatNum(value, d3format) {\n  if (value === undefined || value === null || Number.isNaN(value)) return '';\n  return value == parseFloat(value) ? d3.format(d3format)(value) : value;\n}\n\n\nfunction partialMatch(query, target) {\n  if (target === undefined || target === null || target === '') return false;\n  return target.toString().toUpperCase()\n    .indexOf(query.toString().toUpperCase()) !== -1;\n}\n\n\nfunction URLQuery() {\n  const pairs = window.location.search.substring(1).split(\"&\")\n    .map(e => e.split('='));\n  return _.fromPairs(pairs);\n}\n\n\n// Ref. https://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript\nfunction uuidv4() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n    var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\n    return v.toString(16);\n  });\n}\n\n\nexport default {\n  defaultFieldProperties, sortType, formatNum, partialMatch, URLQuery, uuidv4\n};\n","\n/** @module common/fetcher */\n\n\nconst baseURL = '';\n\nfunction get(url, query={}) {\n  const isEmpty = Object.keys(query).length;\n  const q = isEmpty ? `?query=${JSON.stringify(query)}` : '';\n  return fetch(\n    `${baseURL}${url}${q}`,\n    {\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\nfunction json(response) {\n  return response.json();\n}\n\nfunction text(response) {\n  return response.text();\n}\n\nfunction blob(response) {\n  return response.blob();\n}\n\nfunction post(url, formdata) {\n  return fetch(\n    `${baseURL}${url}`,\n    {\n      method: 'POST',\n      body: formdata,\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\n\nfunction error(err) {\n  console.error(err);\n  return null;\n}\n\n\nexport default {\n  get, json, text, blob, post, error\n};\n","\n/** @module component/button */\n\nimport d3 from 'd3';\n\n\nfunction buttonBox(selection, id, label, type) {\n  selection\n      .classed('form-group', true)\n      .classed('mb-1', true)\n    .append('button')\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed('btn-sm', true)\n      .attr('id', id)\n      .text(label);\n}\n\n\nfunction menuButton(selection, label, type, id) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .attr('id', id)\n      .text(label);\n}\n\n\nfunction menuButtonLink(selection, label, type, icon, id) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .attr('role', 'button')\n      .attr('href', '#')\n      .attr('id', id);\n  selection.append('img')\n      .attr('src', icon ? `./assets/icon/${icon}.svg` : null)\n      .style('width', '1.25rem')\n      .style('height', '1.25rem');\n  selection.append('span')\n      .style('vertical-align', 'middle')\n      .text(label);\n}\n\n\nfunction menuModalLink(selection, target, label, type, icon, id) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .attr('id', id)\n      .attr('href', '#')\n      .attr('role', 'button')\n      .attr('data-toggle', 'modal')\n      .attr('data-target', `#${target}`);\n  selection.append('img')\n      .attr('src', icon ? `./assets/icon/${icon}.svg` : null)\n      .style('width', '1.25rem')\n      .style('height', '1.25rem');\n  selection.append('span')\n      .classed('label', true)\n      .style('vertical-align', 'middle')\n      .text(label);\n}\n\n\nfunction dropdownMenuButton(selection, label, type, icon, id) {\n  selection\n      .classed('btn-group', true)\n      .classed('mr-1', true)\n      .attr('id', id);\n  const button = selection.append('button')\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed('btn-sm', true)\n      .classed('dropdown-toggle', true)\n      .attr('data-toggle', 'dropdown');\n  button.append('img')\n      .attr('src', icon ? `./assets/icon/${icon}.svg` : null)\n      .style('width', '1.25rem')\n      .style('height', '1.25rem');\n  button.append('span')\n      .style('vertical-align', 'middle')\n      .text(label);\n  selection.append('div')\n      .classed('dropdown-menu', true);\n}\n\n\nfunction dropdownMenuItem(selection, label, icon, id) {\n  selection.classed('dropdown-item', true)\n      .attr('id', id)\n      .attr('href', '#');\n  selection.append('img')\n      .attr('src', icon ? `./assets/icon/${icon}.svg` : null)\n      .classed('mr-1', true)\n      .style('width', '2rem')\n      .style('height', '2rem');\n  selection.append('span')\n      .text(label);\n}\n\nfunction dropdownMenuModal(selection, label, target, icon, id) {\n  selection.classed('dropdown-item', true)\n      .attr('id', id)\n      .attr('href', '#')\n      .attr('data-toggle', 'modal')\n      .attr('data-target', `#${target}`);\n  selection.append('img')\n      .attr('src', `./assets/icon/${icon}.svg`)\n      .classed('mr-1', true)\n      .style('width', '2rem')\n      .style('height', '2rem');\n  selection.append('span')\n      .text(label);\n}\n\n\nfunction dropdownMenuFile(selection, label, accept, icon, id) {\n  selection.classed('dropdown-item', true)\n      .attr('id', id)\n      .attr('href', '#')\n      .on('click', function () {\n        d3.select(this).select('input').node().click();\n      });\n  selection.append('form')\n      .style('display', 'none')\n    .append('input')\n      .attr('type', 'file')\n      .attr('accept', accept);\n  selection.append('img')\n      .attr('src', `./assets/icon/${icon}.svg`)\n      .classed('mr-1', true)\n      .style('width', '2rem')\n      .style('height', '2rem');\n  selection.append('span')\n      .text(label);\n}\n\n\nfunction dropdownMenuFileValue(selection) {\n  return selection.select('input').node().files[0];\n}\n\n\nexport default {\n  buttonBox, menuButton, menuButtonLink, menuModalLink,\n  dropdownMenuButton, dropdownMenuItem, dropdownMenuModal,\n  dropdownMenuFile, dropdownMenuFileValue\n};\n","\n/** @module component/table */\n\n// Simple tables\n// use dataGrid.js for interactive and smooth datatable\n\n\nimport d3 from 'd3';\n\nimport {default as misc} from '../common/misc.js';\n\n\nfunction render(selection, id, caption, fields, records) {\n  selection\n      .classed('table', true)\n      .classed('table-striped', true)\n      .classed('table-hover', true)\n      .attr('id', id);\n  if (caption) {\n    selection.append('caption').text(caption);\n  }\n  selection.append('thead').append('tr');\n  selection.append('tbody');\n  if (fields) {\n    selection.call(updateHeader, fields, records);\n  }\n}\n\n\nfunction updateHeader(selection, fields, records) {\n  const header = selection.select('thead tr')\n    .selectAll('th')\n      .data(fields);\n  header.exit().remove();\n  header.enter().append('th')\n      .text(d => d.name);\n  if (records) {\n    selection.call(updateContents, records, d => d.key, updateRowFunc(fields));\n  }\n}\n\n\nfunction updateContents(selection, records, keyFunc, rowFactory) {  // TODO: specify key\n  const rows = selection.select('tbody')\n    .selectAll('tr')\n      .data(records, keyFunc);\n  rows.exit().remove();\n  rows.enter().append('tr')\n    .merge(rows)\n      .each(function (d) {\n        d3.select(this).selectAll('td').remove();\n        d3.select(this).call(rowFactory, d);\n      });\n}\n\n\nfunction updateRowFunc(fields) {\n  return (selection, record) => {\n    fields.forEach(field => {\n      const value = record[field.key];\n      const cell = selection.append('td')\n        .classed('align-middle', true);\n      if (value === undefined) return;\n      if (field.format === 'd3_format') {\n        cell.text(misc.formatNum(value, field.d3_format));\n      }\n      else if (field.format === 'plot') {\n        cell.text('[plot]');\n      }\n      else if (field.format === 'image') {\n        cell.text('[image]');\n      }\n      else if (field.format === 'control') {\n        cell.call(value);\n      } else {\n        cell.text(value);\n      }\n    });\n  };\n}\n\n\nexport default {\n  render, updateHeader, updateContents\n};\n","\n/** @module common/mapper */\n\nimport _ from 'lodash';\n\nimport {default as misc} from './misc.js';\n\n\n/**\n * Convert single field mapping to multi field mapping\n * @param {object} mapping - single field mapping\n * @return {object} multi field mapping\n */\nfunction singleToMulti(mapping) {\n  const newMapping = {};\n  Object.entries(mapping.mapping).forEach(m => {\n    newMapping[m[0]] = [m[1]];\n  });\n  return {\n    created: mapping.created,\n    fields: [mapping.field],\n    key: mapping.key,\n    mapping: newMapping\n  };\n}\n\n\n/**\n * Convert field mapping to table\n * @param {object} mapping - field mapping\n * @return {object} table object\n */\nfunction mappingToTable(mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  const keyField = {key: mp.key, format: 'text'};\n  const data = {\n    fields: misc.defaultFieldProperties([keyField].concat(mp.fields)),\n    records: Object.entries(mp.mapping).map(entry => {\n      const rcd = {};\n      rcd[mp.key] = entry[0];\n      mp.fields.forEach((f, i) => {\n        rcd[f.key] = entry[1][i];\n      });\n      return rcd;\n    })\n  };\n  return data;\n}\n\n\n/**\n * Convert table to field mapping\n * @param {object} table - table\n * @param {object} key - key\n * @return {object} field mapping\n */\nfunction tableToMapping(table, key, ignore=['index']) {\n  const now = new Date();\n  const mapping = {\n    created: now.toString(),\n    fields: misc.defaultFieldProperties(table.fields\n      .filter(e => e.key !== key)\n      .filter(e => !ignore.includes(e.key))),\n    key: key,\n    mapping: {}\n  };\n  table.records.forEach(row => {\n    mapping.mapping[row[key]] = mapping.fields.map(e => row[e.key]);\n  });\n  return mapping;\n}\n\n\n/**\n * Convert csv text to field mapping\n * @param {string} csvString - csv data text\n * @return {object} field mapping\n */\nfunction csvToMapping(csvString) {\n  const lines = csvString.split(/\\n|\\r|\\r\\n/);\n  const header = lines.shift().split(',');\n  const key = header.shift();\n  const now = new Date();\n  const headerIdx = [];\n  const fields = [];\n  header.forEach((h, i) => {\n    if (h === '') return;\n    headerIdx.push(i);\n    fields.push({key: h, format: 'text'});\n  });\n  const mapping = {\n    created: now.toString(),\n    fields: misc.defaultFieldProperties(fields),\n    key: key,\n    mapping: {}\n  };\n  lines.forEach(line => {\n    const values = line.split(',');\n    const k = values.shift();\n    mapping.mapping[k] = Array(headerIdx.length);\n    headerIdx.forEach(i => {\n      mapping.mapping[k][i] = values[i];\n    });\n  });\n  return mapping;\n}\n\n\n/**\n * Apply mapping to the data (in-place)\n * @param {object} data - datatable JSON\n * @param {object} mapping - mapping JSON\n * @return {undefined} undefined\n */\nfunction apply(data, mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  data.records\n    .filter(rcd => mp.mapping.hasOwnProperty(rcd[mp.key]))\n    .forEach(rcd => {\n      mp.fields.forEach((fd, i) => {\n        rcd[fd.key] = mp.mapping[rcd[mp.key]][i];\n      });\n    });\n  data.fields =  _(data.fields)\n    .concat(misc.defaultFieldProperties(mp.fields))\n    .uniqBy('key')\n    .value();\n}\n\nexport default {\n  singleToMulti, mappingToTable, tableToMapping, csvToMapping, apply\n};\n","\n/** @module datagrid/rowFactory */\n\nimport {default as misc} from '../common/misc.js';\nimport {default as img} from '../common/image.js';\n\n\nfunction d3Format(selection, record, field) {\n  selection.text(misc.formatNum(record[field.key], field.d3_format));\n}\n\n\nfunction text(selection, record, field) {\n  selection.text(record[field.key]);\n}\n\n\nfunction html(selection, record, field) {\n  selection.html(record[field.key]);\n}\n\n\nfunction compound_id(selection, record, field) {\n  selection.append('a')\n      .attr('href',`profile.html?compound=${record[field.key]}`)\n      .attr('target', '_blank')\n      .text(record[field.key]);\n}\n\n\nfunction image(selection, record, field) {\n  selection.append('img')\n      .attr('width', 180)\n      .attr('height', 180)\n      .attr('src', record[field.key]);\n}\n\nfunction checkbox(selection, record, field) {\n  selection.append('input')\n      .attr('type', 'checkbox')\n      .property('checked', record[field.key])\n      .property('disabled', field.disabled ? record[field.disabled] : false)\n      .on('click', function () {\n        record[field.key] = this.checked;\n      });\n}\n\nfunction textField(selection, record, field) {\n  selection.append('input')\n      .attr('type', 'text')\n      .style('width', '90%')\n      .property('value', record[field.key])\n      .on('change', function () {\n        record[field.key] = this.value;\n      });\n}\n\nfunction call(selection, value) {\n  selection.call(value);\n}\n\n\nconst cellFunc = {\n  numeric: text,\n  text: text,\n  raw: text,\n  d3_format: d3Format,\n  compound_id: compound_id,\n  assay_id: text,\n  list: text,\n  plot: img.plotCell,\n  image: image,\n  checkbox: checkbox,\n  text_field: textField,\n  control: call,\n  svg: html,\n  html: html\n};\n\n\nfunction rowFactory(fields) {\n  return (selection, record) => {\n    fields.forEach(field => {\n      const cell = selection.append('div')\n        .classed('dg-cell', true)\n        .classed('align-middle', true)\n        .classed('text-truncate', true)\n        .style('display', 'inline-block')\n        .style('width', `${field.width}%`);\n      if (!record.hasOwnProperty(field.key)) return;\n      cell.call(cellFunc[field.format], record, field);\n    });\n  };\n}\n\n\nexport default {\n  d3Format, text, html, compound_id, image, checkbox, textField, call, rowFactory\n};\n","\n/** @module common/image */\n\nimport vega from 'vega';\n\n\nfunction plotCell(selection, record, field) {\n  new vega.View(vega.parse(record[field.key]))\n    .initialize(selection.node())\n    .run();\n}\n\n\nfunction plotThumbnail(vegaSpec) {\n  const view = new vega.View(vega.parse(vegaSpec));\n  return view.toImageURL('png');  // Promise\n}\n\n\nfunction binaryToDataURI(binary) {\n  return new Promise(resolve => {\n    const reader = new FileReader();\n    reader.onload = event => {\n      resolve(event.target.result);\n    };\n    reader.readAsDataURL(binary);\n  });\n}\n\n\nexport default {\n  plotCell, plotThumbnail, binaryToDataURI\n};\n","\n/** @module datagrid/state */\n\nimport _ from 'lodash';\n\nimport {default as mapper} from '../common/mapper.js';\nimport {default as misc} from '../common/misc.js';\n\nimport {default as factory} from './rowFactory.js';\n\n\nexport default class DatagridState {\n  constructor(data) {\n    this.data = data;\n\n    this.visibleFields = null;\n    this.sortedRecords = null;\n    this.filteredRecords = null;\n\n    // Snapshot\n    const snp = this.data.snapshot || {sortOrder: [], filterText: null};\n    this.sortOrder = snp.sortOrder || [];\n    this.filterText = snp.filterText || null;\n\n    this.defaultColumnHeight = {\n      numeric: 40,\n      text: 40,\n      none: 200\n    };\n    this.scrollBarSpace = 20;\n    this.keyFunc = d => d.index;\n\n    // Size\n    this.rowHeight = null;\n    this.contentWidth = null;\n    this.bodyHeight = null;\n\n    // Viewport\n    this.viewportHeight = null;\n    this.numViewportRows = null;\n    this.previousNumViewportRows = null;\n    this.viewportTop = null;\n    this.previousVieportTop = null;\n    this.viewportBottom = null;\n    this.currentScrollTop = 0;\n\n    this.fixedViewportHeight = null;\n\n    // Event notifier\n    this.updateContentsNotifier = null;\n    this.updateFilterNotifier = null;\n\n    this.rowFactory = () => factory.rowFactory(this.visibleFields);\n\n    // Initialize\n    this.applyData();\n  }\n\n  setViewportSize(height) {\n    this.viewportHeight = this.fixedViewportHeight || height;\n    this.previousNumViewportRows = this.numViewportRows;\n    this.numViewportRows = Math.ceil(this.viewportHeight / this.rowHeight) + 1;\n  }\n\n  setScrollPosition(position) {\n    this.previousViewportTop = this.viewportTop;\n    this.viewportTop = position;\n    this.viewportBottom = Math.min(\n      this.viewportTop + this.numViewportRows, this.filteredRecords.length);\n  }\n\n  setSortOrder(key, order) {\n    const ki  = this.sortOrder.findIndex(e => e.key);\n    const obj = {key: key, order: order};\n    if (ki !== -1) this.sortOrder.splice(ki, 1);\n    this.sortOrder.splice(0, 0, obj);\n    this.applyOrder(key, order);\n  }\n\n  setFilterText(text) {\n    this.filterText = text;\n    this.applyFilter();\n  }\n\n  joinFields(mapping) {\n    mapper.apply(this.data, mapping);\n    this.applyData();\n  }\n\n  applyData() {\n    this.visibleFields = this.data.fields.filter(e => e.visible);\n    const widthfSum = this.visibleFields.reduce((a, c) => a + (c.widthf || 1), 0);\n    this.visibleFields = this.visibleFields.map(e => {\n      const field = {\n        width: (e.widthf || 1) / widthfSum * 100,\n        height: e.height || this.defaultColumnHeight[misc.sortType(e.format)]\n      };\n      return Object.assign(field, e);\n    });\n    this.rowHeight = this.visibleFields\n      .reduce((a, b) => a.height > b.height ? a : b).height;\n    this.applyOrder();\n  }\n\n  applyOrder(key, order) {\n    if (key) {\n      this.sortedRecords = _.orderBy(this.data.records.slice(), [key], [order]);\n    } else {\n      const keys = this.sortOrder.map(e => e.key);\n      const orders = this.sortOrder.map(e => e.order);\n      if (keys) {\n        this.sortedRecords = _.orderBy(this.data.records.slice(), keys, orders);\n      }\n    }\n    this.applyFilter();\n  }\n\n  applyFilter() {\n    if (this.filterText === null) {\n      this.filteredRecords = this.sortedRecords.slice();\n    } else {\n      const fields = this.visibleFields\n        .filter(e => misc.sortType(e.format) !== 'none')\n        .map(e => e.key);\n      this.filteredRecords = this.sortedRecords.filter(row => {\n        return fields.some(f => misc.partialMatch(this.filterText, row[f]));\n      });\n    }\n    this.bodyHeight = this.filteredRecords.length * this.rowHeight;\n  }\n\n  recordsToShow() {\n    return this.filteredRecords.slice(this.viewportTop, this.viewportBottom);\n  }\n\n  export() {\n    this.data.id = misc.uuidv4();\n    return this.data;\n  }\n\n}\n","\n/** @module datagrid/component */\n\nimport d3 from 'd3';\n\n\nfunction updateHeader(selection, state) {\n  const header = selection.select('.dg-header');\n  header.selectAll('.dg-hcell').remove();\n  header.selectAll('.dg-hcell').data(state.visibleFields)\n    .enter().append('div')\n      .classed('dg-hcell', true)\n      .style('display', 'inline-block')\n      .style('width', d => `${d.width}%`)\n      .text(d => d.name);\n  selection\n      .style('width', '100%')\n      .dispatch('resize');\n  const pos = Math.floor(state.currentScrollTop / state.rowHeight);\n  state.setScrollPosition(pos);\n  selection.call(updateRows, state);\n}\n\n\nfunction updateRows(selection, state) {\n  selection.select('.dg-body')\n    .style('height', `${state.bodyHeight}px`);\n  const rows = selection.select('.dg-body')\n    .selectAll('.dg-row')\n      .data(state.recordsToShow(), state.keyFunc);\n  rows.exit().remove();\n  rows.enter()\n    .append('div')\n      .attr('class', 'dg-row')\n      .style('position', 'absolute')\n      .style('width', '100%')\n    .merge(rows)\n      .style('height', `${state.rowHeight}px`)\n      .each(function (d, i) {\n        const rowIndex = state.viewportTop + i;\n        const rowPos = rowIndex * state.rowHeight;\n        d3.select(this)\n          .style('transform', `translate(0px, ${rowPos}px)`)\n          .classed('odd', (rowIndex) % 2 === 0);\n        d3.select(this).selectAll('.dg-cell').remove();\n        d3.select(this).call(state.rowFactory(), d, rowIndex);\n      });\n}\n\n\nfunction resizeViewport(selection, state) {\n  selection.select('.dg-viewport').style('height', `${state.viewportHeight}px`);\n}\n\n\nexport default {\n  updateHeader, updateRows, resizeViewport\n};\n","\n/** @module datagrid/view */\n\nimport {default as component} from './component.js';\n\n\nfunction resize(selection, state) {\n  const viewport = selection.select('.dg-viewport');\n  const viewportTop = viewport.node().getBoundingClientRect().top;\n  state.setViewportSize(window.innerHeight - viewportTop - 5);\n  selection.call(component.resizeViewport, state);\n}\n\n\nfunction datagrid(selection, state) {\n  selection.selectAll('div').remove();\n  selection.on('resize', () => selection.call(resize, state));\n  selection.append('div')\n      .classed('dg-header', true);\n  selection.append('div')\n      .classed('dg-viewport', true)\n      .style('overflow-y', 'auto')\n      .on('scroll', function () {\n        const pos = Math.floor(this.scrollTop / state.rowHeight);\n        state.currentScrollTop = this.scrollTop;\n        if (pos !== state.previousViewportTop) {\n          state.setScrollPosition(pos);\n          selection.call(component.updateRows, state);\n        }\n      })\n    .append('div')\n      .classed('dg-body', true)\n      .style('position', 'relative');\n  state.updateContentsNotifier = () => {\n    state.applyData();\n    selection.call(component.updateHeader, state);\n  };\n  state.updateFilterNotifier = value => {\n    state.setFilterText(value);\n    state.setScrollPosition(0);\n    selection.call(component.updateRows, state);\n    selection.select('.dg-viewport').node().scrollTop = 0;\n  };\n  state.updateContentsNotifier();\n}\n\n\nexport default {\n  resize, datagrid\n};\n","\n/** @module component/formBox */\n\n\nfunction textBox(selection, id, label, size, value) {  // TODO: remove size\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .attr('for', id)\n      .text(label);\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('id', id)\n      .attr('type', 'text')\n      .attr('size', size);\n  selection.call(updateTextBox, value);\n}\n\nfunction updateTextBox(selection, value) {\n  selection.select('input').property('value', value);\n}\n\nfunction textBoxValue(selection) {\n  return selection.select('input').property('value');\n}\n\n\nfunction readonlyBox(selection, id, label, value) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .attr('for', id)\n      .text(label);\n  selection.append('input')\n      .classed('form-control-plaintext', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('id', id)\n      .attr('type', 'text')\n      .property('readonly', true);\n  selection.call(updateTextBox, value);\n}\n\n\nfunction textareaBox(selection, id, label, rows, placeholder, value) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .attr('for', id)\n      .text(label);\n  selection.append('textarea')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('rows', rows)\n      .attr('placeholder', placeholder)\n      .attr('id', id);\n  selection.call(updateTextareaBox, value);\n}\n\nfunction updateTextareaBox(selection, value) {\n  selection.select('textarea').property('value', value);\n}\n\nfunction textareaBoxValue(selection) {\n  const value = selection.select('textarea').property('value');\n  if (value) return value;  // TODO: 0 is falsy\n  const placeholder = selection.select('textarea').attr('placeholder');\n  if (placeholder) return placeholder;\n  return '';\n}\n\nfunction textareaBoxLines(selection) {\n  const value = selection.select('textarea').property('value');\n  if (value) return value.split('\\n').filter(e => e.length > 0);\n  const placeholder = selection.select('textarea').attr('placeholder');\n  if (placeholder) return placeholder.split('\\n').filter(e => e.length > 0);\n  return [];\n}\n\n\nfunction checkBox(selection, id, label, checked) {\n  const box = selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('form-check', true)\n    .append('label')\n      .classed('form-check-label', true)\n      .classed('col-form-label-sm', true);\n  box.append('input')\n      .classed('form-check-input', true)\n      .attr('type', 'checkbox')\n      .attr('id', id);\n  box.append('span')\n      .text(label);\n  selection.call(updateCheckBox, checked);\n}\n\nfunction updateCheckBox(selection, checked) {\n  selection.select('input').property('checked', checked);\n}\n\nfunction checkBoxValue(selection) {\n  return selection.select('input').property('checked');\n}\n\n\nfunction numberBox(selection, id, label, min, max, step, value) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .attr('for', id)\n      .text(label);\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('id', id)\n      .attr('type', 'number')\n      .attr('min', min)\n      .attr('max', max)\n      .attr('step', step);\n  selection.call(updateNumberBox, value);\n}\n\nfunction updateNumberBox(selection, value) {\n  selection.select('input').property('value', value);\n}\n\nfunction numberBoxValue(selection) {\n  return selection.select('input').property('value');\n}\n\n\nfunction fileInputBox(selection, id, label, accept) {\nselection\n    .classed('form-group', true)\n    .classed('form-row', true);\nselection.append('label')\n    .classed('col-form-label', true)\n    .classed('col-form-label-sm', true)\n    .classed('col-4', true)\n    .attr('for', id)\n    .text(label);\nselection.append('input')\n    .classed('form-control', true)\n    .classed('form-control-sm', true)\n    .classed('form-control-file', true)\n    .classed('col-8', true)\n    .attr('type', 'file')\n    .attr('accept', accept)\n    .attr('id', id);\n}\n\nfunction fileInputBoxValue(selection) {\n  return selection.select('input').property('files')[0];\n}\n\n\nexport default {\n  textBox, updateTextBox, textBoxValue, readonlyBox,\n  textareaBox, updateTextareaBox, textareaBoxValue, textareaBoxLines,\n  checkBox, updateCheckBox, checkBoxValue,\n  numberBox, updateNumberBox, numberBoxValue,\n  fileInputBox, fileInputBoxValue\n};\n","\n/** @module datagrid/rowFilter */\n\nimport {default as box} from '../component/formBox.js';\n\n\nfunction setFilter(selection, state) {\n  const searchBox = selection\n      .classed('row', true)\n      .classed('justify-content-end', true)\n    .append('div')\n      .classed('col-5', true)\n      .call(box.textBox, null, 'Search', 40, null);\n  searchBox.select('label').classed('text-right', true);\n  searchBox.select('input')\n    .on('keyup', function () {\n      state.updateFilterNotifier(box.textBoxValue(searchBox));\n    });\n}\n\n\nexport default {\n  setFilter\n};\n","\n/** @module profile */\n\nimport d3 from 'd3';\n\nimport {default as misc} from './common/misc.js';\nimport {default as fetcher} from './common/fetcher.js';\n\nimport {default as button} from './component/button.js';\nimport {default as table} from './component/table.js';\n\nimport DatagridState from './datagrid/state.js';\nimport {default as view} from './datagrid/view.js';\nimport {default as rowf} from './datagrid/rowfilter.js';\n\n\nfunction fetchProfile(compoundID, resources) {\n  const profile = {};\n  // Compound properties\n  const cmpdQuery = {\n    workflow: 'search',\n    targets: resources.filter(e => e.domain === 'chemical').map(e => e.id),\n    key: 'compound_id',\n    values: [compoundID]\n  };\n  return fetcher.get(cmpdQuery.workflow, cmpdQuery)\n    .then(fetcher.json)\n    .then(res => {\n      profile.compound = {\n        fields: [\n          {key: 'key', name: 'key'},\n          {key: 'value', name: 'value'}\n        ],\n        records: [\n          {key: 'Formula', value: res.records[0]._formula},\n          {key: 'Molecular weight', value: res.records[0]._mw},\n          {key: 'Wildman-Crippen logP', value: res.records[0]._logp},\n          {key: 'Non-hydrogen atom count', value: res.records[0]._nonH}\n        ]\n      };\n      profile.cid = res.records[0].compound_id;\n      profile.name = res.records[0].name;\n      profile.src = res.records[0].__source;\n      profile.struct = res.records[0].structure;\n    })\n    .then(() => {\n      const aliasQuery = {\n        workflow: 'exact',\n        targets: resources.filter(e => e.domain === 'chemical').map(e => e.id),\n        queryMol: {\n          format: 'dbid',\n          source: profile.src,\n          value: profile.cid\n        },\n        params: {ignoreHs: true}\n      };\n      return fetcher.get(aliasQuery.workflow, aliasQuery);\n    })\n    .then(fetcher.json)\n    .then(res => {\n      profile.aliases = res;\n      profile.aliases.fields = misc.defaultFieldProperties([\n        {key: 'index', name: 'Index', d3_format: 'd'},\n        {key: 'compound_id', name: 'Compound ID', format: 'compound_id'},\n        {key: 'name', name: 'Name', format: 'text'},\n        {key: '__source', name: 'Source', format: 'text'}\n      ]);\n    })\n    .then(() => {\n      const assayQuery = {\n        workflow: 'profile',\n        compound_id: compoundID,\n        targets: resources.filter(e => e.domain === 'activity').map(e => e.id),\n      };\n      return fetcher.get(assayQuery.workflow, assayQuery);\n    })\n    .then(fetcher.json)\n    .then(res => {\n      profile.assays = res;\n      profile.assays.fields = misc.defaultFieldProperties([\n        {key: 'index', name: 'Index', d3_format: 'd'},\n        {key: 'assay_id', name: 'Assay ID', format: 'assay_id'},\n        {key: 'value_type', name: 'Value type', format: 'text'},\n        {key: 'value', name: 'Value', format: 'numeric'}\n      ]);\n      return profile;\n    });\n}\n\n\nfunction render(compoundID) {\n  fetcher.get('schema')\n    .then(fetcher.json)\n    .then(schema => fetchProfile(compoundID, schema.resources))\n    .catch(() => {\n      console.info('Server did not respond');\n      return {\n        aliases: {},\n        assays: {},\n        compound: {}\n      };\n    })\n    .then(res => {\n      const contents = d3.select('#contents')\n          .style('padding-left', '10%')\n          .style('padding-right', '10%');\n      contents.append('h2').classed('mt-5', true)\n          .text('Compound ID');\n      contents.append('div').classed('mb-5', true)\n          .text(res.cid);\n      contents.append('h2').classed('mt-5', true)\n          .text('Name');\n      contents.append('div').classed('mb-5', true)\n          .text(res.name);\n      contents.append('h2').classed('mt-5', true)\n          .text('Source');\n      contents.append('div').classed('mb-5', true)\n          .text(res.src);\n      contents.append('h2').classed('mt-5', true)\n          .text('Structure');\n      contents.append('div').classed('mb-5', true)\n          .html(res.struct);\n      contents.append('h2').classed('mt-5', true)\n          .text('Chemical properties');\n      contents.append('div').classed('mb-5', true)\n        .append('table')\n          .call(\n            table.render, null, null, res.compound.fields, res.compound.records)\n          .style('width', '400px');\n      contents.append('h2').classed('mt-5', true)\n          .text('Aliases');\n      contents.append('div').classed('mb-5', true)\n          .attr('id', 'aliases');\n      contents.append('h2').classed('mt-5', true)\n          .text('Assay results');\n      contents.append('div').classed('mb-5', true)\n          .attr('id', 'assays');\n\n      const aliasState = new DatagridState(res.aliases);\n      const aliasFilter = d3.select('#aliases').append('div')\n          .classed('alias-filter', true);\n      const aliasdg = d3.select('#aliases').append('div')\n          .classed('alias-dg', true);\n      aliasState.fixedViewportHeight = 150;\n      aliasdg.call(view.datagrid, aliasState);\n      aliasFilter.call(rowf.setFilter, aliasState);\n\n      const assayState = new DatagridState(res.assays);\n      const assayFilter = d3.select('#assays').append('div')\n          .classed('assay-filter', true);\n      const assaydg = d3.select('#assays').append('div')\n          .classed('assay-dg', true);\n      assayState.fixedViewportHeight = 400;\n      assaydg.call(view.datagrid, assayState);\n      assayFilter.call(rowf.setFilter, assayState);\n    });\n}\n\n\nfunction run() {\n  // Menubar\n  const menubar = d3.select('#menubar');\n  menubar.append('a')\n      .call(button.menuButtonLink, 'Dashboard', 'outline-secondary', 'db-gray')\n      .attr('href', 'dashboard.html')\n      .attr('target', '_blank');\n  const compoundID = misc.URLQuery().compound || null;\n  if (!compoundID) return;\n  // TODO: offline mode flags\n  const localFile = document.location.protocol !== \"file:\";\n  const offLine = 'onLine' in navigator && !navigator.onLine;\n  console.info('Off-line mode is disabled for debugging');\n  return render(compoundID);\n}\n\n\nexport default {\n  run\n};\n"],"names":["defaultFieldProperties","fields","map","e","hasOwnProperty","name","key","visible","format","sortType","fmt","includes","formatNum","value","d3format","Number","isNaN","parseFloat","d3","partialMatch","query","target","toString","toUpperCase","indexOf","URLQuery","pairs","window","location","search","substring","split","_","fromPairs","uuidv4","replace","c","r","Math","random","baseURL","get","url","q","Object","keys","length","JSON","stringify","fetch","credentials","then","res","status","Promise","reject","Error","statusText","resolve","json","response","text","blob","post","formdata","method","body","error","err","console","buttonBox","selection","id","label","type","classed","append","attr","menuButton","menuButtonLink","icon","style","menuModalLink","dropdownMenuButton","button","dropdownMenuItem","dropdownMenuModal","dropdownMenuFile","accept","on","select","this","node","click","dropdownMenuFileValue","files","updateHeader","records","header","selectAll","data","exit","remove","enter","d","call","updateContents","record","forEach","field","cell","undefined","misc","d3_format","updateRowFunc","keyFunc","rowFactory","rows","merge","each","render","caption","singleToMulti","mapping","newMapping","entries","m","created","mappingToTable","mp","keyField","concat","entry","rcd","f","i","tableToMapping","table","ignore","Date","filter","row","csvToMapping","csvString","lines","shift","now","headerIdx","h","push","line","values","k","Array","apply","fd","uniqBy","d3Format","html","compound_id","image","checkbox","property","disabled","checked","textField","cellFunc","numeric","raw","assay_id","list","plot","plotCell","vega","View","parse","initialize","run","plotThumbnail","vegaSpec","toImageURL","binaryToDataURI","binary","reader","FileReader","onload","event","result","readAsDataURL","text_field","control","svg","width","DatagridState","[object Object]","visibleFields","sortedRecords","filteredRecords","snp","snapshot","sortOrder","filterText","defaultColumnHeight","none","scrollBarSpace","index","rowHeight","contentWidth","bodyHeight","viewportHeight","numViewportRows","previousNumViewportRows","viewportTop","previousVieportTop","viewportBottom","currentScrollTop","fixedViewportHeight","updateContentsNotifier","updateFilterNotifier","factory","applyData","height","ceil","position","previousViewportTop","min","order","ki","findIndex","obj","splice","applyOrder","applyFilter","mapper","widthfSum","reduce","a","widthf","assign","b","orderBy","slice","orders","some","updateRows","state","recordsToShow","rowIndex","rowPos","dispatch","pos","floor","setScrollPosition","resizeViewport","resize","getBoundingClientRect","top","setViewportSize","innerHeight","component","datagrid","scrollTop","setFilterText","updateTextBox","updateTextareaBox","updateCheckBox","updateNumberBox","textBox","size","textBoxValue","readonlyBox","textareaBox","placeholder","textareaBoxValue","textareaBoxLines","checkBox","box","checkBoxValue","numberBox","max","step","numberBoxValue","fileInputBox","fileInputBoxValue","setFilter","searchBox","compoundID","fetcher","schema","resources","profile","cmpdQuery","workflow","targets","domain","compound","_formula","_mw","_logp","_nonH","cid","src","__source","struct","structure","aliasQuery","queryMol","source","params","ignoreHs","aliases","assayQuery","assays","fetchProfile","catch","info","contents","aliasState","aliasFilter","aliasdg","view","rowf","assayState","assayFilter","assaydg","document","protocol","navigator","onLine"],"mappings":"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"}